<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>ext/openssl/openssl.c</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<a id='TOP' name='TOP'></a><h2 class='header'><a href='../mains.html'>root</a>/<a href='../files/1743.html'>ext</a>/<a href='../files/1812.html'>openssl</a>/openssl.c</h2>
<em class='comment'>/* [&lt;][&gt;]<a href='#L564'>[^]</a><a href='#L5473'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</em>
<hr />
<h2 class='header'>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L564' title='Defined at 564.'>php_openssl_get_x509_list_id</a></li>
<li><a href='#L571' title='Defined at 571.'>php_pkey_free</a></li>
<li><a href='#L580' title='Defined at 580.'>php_x509_free</a></li>
<li><a href='#L586' title='Defined at 586.'>php_csr_free</a></li>
<li><a href='#L594' title='Defined at 594.'>php_openssl_open_base_dir_chk</a></li>
<li><a href='#L604' title='Defined at 604.'>php_openssl_get_stream_from_ssl_handle</a></li>
<li><a href='#L609' title='Defined at 609.'>php_openssl_get_ssl_stream_data_index</a></li>
<li><a href='#L648' title='Defined at 648.'>STACK_OF</a></li>
<li><a href='#L713' title='Defined at 713.'>add_assoc_asn1_string</a></li>
<li><a href='#L719' title='Defined at 719.'>asn1_time_to_time_t</a></li>
<li><a href='#L812' title='Defined at 812.'>php_openssl_config_check_syntax</a></li>
<li><a href='#L832' title='Defined at 832.'>add_oid_section</a></li>
<li><a href='#L881' title='Defined at 881.'>openssl_spki_cleanup</a></li>
<li><a href='#L899' title='Defined at 899.'>php_openssl_parse_config</a></li>
<li><a href='#L992' title='Defined at 992.'>php_openssl_dispose_config</a></li>
<li><a href='#L1009' title='Defined at 1009.'>php_openssl_load_rand_file</a></li>
<li><a href='#L1038' title='Defined at 1038.'>php_openssl_write_rand_file</a></li>
<li><a href='#L1059' title='Defined at 1059.'>php_openssl_get_evp_md_from_algo</a></li>
<li><a href='#L1105' title='Defined at 1105.'>php_openssl_get_evp_cipher_from_algo</a></li>
<li><a href='#L1149' title='Defined at 1149.'>PHP_INI_BEGIN</a></li>
<li><a href='#L1302' title='Defined at 1302.'>PHP_MINFO_FUNCTION</a></li>
<li><a href='#L1316' title='Defined at 1316.'>PHP_MSHUTDOWN_FUNCTION</a></li>
<li><a href='#L1354' title='Defined at 1354.'>PHP_FUNCTION</a></li>
<li><a href='#L1381' title='Defined at 1381.'>php_openssl_x509_from_zval</a></li>
<li><a href='#L1451' title='Defined at 1451.'>PHP_FUNCTION</a></li>
<li><a href='#L1497' title='Defined at 1497.'>PHP_FUNCTION</a></li>
<li><a href='#L1598' title='Defined at 1598.'>PHP_FUNCTION</a></li>
<li><a href='#L1659' title='Defined at 1659.'>PHP_FUNCTION</a></li>
<li><a href='#L1730' title='Defined at 1730.'>PHP_FUNCTION</a></li>
<li><a href='#L1774' title='Defined at 1774.'>PHP_FUNCTION</a></li>
<li><a href='#L1814' title='Defined at 1814.'>php_openssl_x509_fingerprint</a></li>
<li><a href='#L1840' title='Defined at 1840.'>PHP_FUNCTION</a></li>
<li><a href='#L1874' title='Defined at 1874.'>PHP_FUNCTION</a></li>
<li><a href='#L1908' title='Defined at 1908.'>openssl_x509v3_subjectAltName</a></li>
<li><a href='#L1974' title='Defined at 1974.'>PHP_FUNCTION</a></li>
<li><a href='#L2105' title='Defined at 2105.'>STACK_OF</a></li>
<li><a href='#L2159' title='Defined at 2159.'>check_cert</a></li>
<li><a href='#L2182' title='Defined at 2182.'>PHP_FUNCTION</a></li>
<li><a href='#L2240' title='Defined at 2240.'>setup_verify</a></li>
<li><a href='#L2300' title='Defined at 2300.'>PHP_FUNCTION</a></li>
<li><a href='#L2321' title='Defined at 2321.'>PHP_FUNCTION</a></li>
<li><a href='#L2339' title='Defined at 2339.'>php_sk_X509_free</a></li>
<li><a href='#L2350' title='Defined at 2350.'>STACK_OF</a></li>
<li><a href='#L2401' title='Defined at 2401.'>PHP_FUNCTION</a></li>
<li><a href='#L2484' title='Defined at 2484.'>PHP_FUNCTION</a></li>
<li><a href='#L2556' title='Defined at 2556.'>PHP_FUNCTION</a></li>
<li><a href='#L2661' title='Defined at 2661.'>php_openssl_make_REQ</a></li>
<li><a href='#L2807' title='Defined at 2807.'>php_openssl_csr_from_zval</a></li>
<li><a href='#L2853' title='Defined at 2853.'>PHP_FUNCTION</a></li>
<li><a href='#L2898' title='Defined at 2898.'>PHP_FUNCTION</a></li>
<li><a href='#L2944' title='Defined at 2944.'>PHP_FUNCTION</a></li>
<li><a href='#L3079' title='Defined at 3079.'>PHP_FUNCTION</a></li>
<li><a href='#L3160' title='Defined at 3160.'>PHP_FUNCTION</a></li>
<li><a href='#L3188' title='Defined at 3188.'>PHP_FUNCTION</a></li>
<li><a href='#L3229' title='Defined at 3229.'>php_openssl_evp_from_zval</a></li>
<li><a href='#L3387' title='Defined at 3387.'>php_openssl_generate_private_key</a></li>
<li><a href='#L3492' title='Defined at 3492.'>php_openssl_is_private_key</a></li>
<li><a href='#L3568' title='Defined at 3568.'>PHP_FUNCTION</a></li>
<li><a href='#L3671' title='Defined at 3671.'>PHP_FUNCTION</a></li>
<li><a href='#L3748' title='Defined at 3748.'>PHP_FUNCTION</a></li>
<li><a href='#L3825' title='Defined at 3825.'>PHP_FUNCTION</a></li>
<li><a href='#L3845' title='Defined at 3845.'>PHP_FUNCTION</a></li>
<li><a href='#L3862' title='Defined at 3862.'>PHP_FUNCTION</a></li>
<li><a href='#L3886' title='Defined at 3886.'>PHP_FUNCTION</a></li>
<li><a href='#L4020' title='Defined at 4020.'>PHP_FUNCTION</a></li>
<li><a href='#L4079' title='Defined at 4079.'>PHP_FUNCTION</a></li>
<li><a href='#L4192' title='Defined at 4192.'>PHP_FUNCTION</a></li>
<li><a href='#L4319' title='Defined at 4319.'>PHP_FUNCTION</a></li>
<li><a href='#L4426' title='Defined at 4426.'>PHP_FUNCTION</a></li>
<li><a href='#L4497' title='Defined at 4497.'>PHP_FUNCTION</a></li>
<li><a href='#L4557' title='Defined at 4557.'>PHP_FUNCTION</a></li>
<li><a href='#L4625' title='Defined at 4625.'>PHP_FUNCTION</a></li>
<li><a href='#L4684' title='Defined at 4684.'>PHP_FUNCTION</a></li>
<li><a href='#L4754' title='Defined at 4754.'>PHP_FUNCTION</a></li>
<li><a href='#L4774' title='Defined at 4774.'>PHP_FUNCTION</a></li>
<li><a href='#L4837' title='Defined at 4837.'>PHP_FUNCTION</a></li>
<li><a href='#L4894' title='Defined at 4894.'>PHP_FUNCTION</a></li>
<li><a href='#L5023' title='Defined at 5023.'>PHP_FUNCTION</a></li>
<li><a href='#L5104' title='Defined at 5104.'>openssl_add_method_or_alias</a></li>
<li><a href='#L5110' title='Defined at 5110.'>openssl_add_method</a></li>
<li><a href='#L5120' title='Defined at 5120.'>PHP_FUNCTION</a></li>
<li><a href='#L5136' title='Defined at 5136.'>PHP_FUNCTION</a></li>
<li><a href='#L5152' title='Defined at 5152.'>PHP_FUNCTION</a></li>
<li><a href='#L5197' title='Defined at 5197.'>php_openssl_validate_iv</a></li>
<li><a href='#L5233' title='Defined at 5233.'>PHP_FUNCTION</a></li>
<li><a href='#L5316' title='Defined at 5316.'>PHP_FUNCTION</a></li>
<li><a href='#L5404' title='Defined at 5404.'>PHP_FUNCTION</a></li>
<li><a href='#L5432' title='Defined at 5432.'>PHP_FUNCTION</a></li>
<li><a href='#L5473' title='Defined at 5473.'>PHP_FUNCTION</a></li>
</ol>
<hr />
<pre>
<a id='L1' name='L1'></a>   1 <em class='comment'>/*</em>
<a id='L2' name='L2'></a>   2 <em class='comment'>   +----------------------------------------------------------------------+</em>
<a id='L3' name='L3'></a>   3 <em class='comment'>   | PHP Version 7                                                        |</em>
<a id='L4' name='L4'></a>   4 <em class='comment'>   +----------------------------------------------------------------------+</em>
<a id='L5' name='L5'></a>   5 <em class='comment'>   | Copyright (c) 1997-2016 The PHP Group                                |</em>
<a id='L6' name='L6'></a>   6 <em class='comment'>   +----------------------------------------------------------------------+</em>
<a id='L7' name='L7'></a>   7 <em class='comment'>   | This source file is subject to version 3.01 of the PHP license,      |</em>
<a id='L8' name='L8'></a>   8 <em class='comment'>   | that is bundled with this package in the file LICENSE, and is        |</em>
<a id='L9' name='L9'></a>   9 <em class='comment'>   | available through the world-wide-web at the following url:           |</em>
<a id='L10' name='L10'></a>  10 <em class='comment'>   | http://www.php.net/license/3_01.txt                                  |</em>
<a id='L11' name='L11'></a>  11 <em class='comment'>   | If you did not receive a copy of the PHP license and are unable to   |</em>
<a id='L12' name='L12'></a>  12 <em class='comment'>   | obtain it through the world-wide-web, please send a note to          |</em>
<a id='L13' name='L13'></a>  13 <em class='comment'>   | license@php.net so we can mail you a copy immediately.               |</em>
<a id='L14' name='L14'></a>  14 <em class='comment'>   +----------------------------------------------------------------------+</em>
<a id='L15' name='L15'></a>  15 <em class='comment'>   | Authors: Stig Venaas &lt;venaas@php.net&gt;                                |</em>
<a id='L16' name='L16'></a>  16 <em class='comment'>   |          Wez Furlong &lt;wez@thebrainroom.com&gt;                          |</em>
<a id='L17' name='L17'></a>  17 <em class='comment'>   |          Sascha Kettler &lt;kettler@gmx.net&gt;                            |</em>
<a id='L18' name='L18'></a>  18 <em class='comment'>   |          Pierre-Alain Joye &lt;pierre@php.net&gt;                          |</em>
<a id='L19' name='L19'></a>  19 <em class='comment'>   |          Marc Delling &lt;delling@silpion.de&gt; (PKCS12 functions)        |</em>
<a id='L20' name='L20'></a>  20 <em class='comment'>   +----------------------------------------------------------------------+</em>
<a id='L21' name='L21'></a>  21 <em class='comment'> */</em>
<a id='L22' name='L22'></a>  22 
<a id='L23' name='L23'></a>  23 <em class='comment'>/* $Id$ */</em>
<a id='L24' name='L24'></a>  24 
<a id='L25' name='L25'></a>  25 <em class='sharp'>#ifdef</em> <a href='../Y/2735.html' title='Multiple used in 331 places.'>HAVE_CONFIG_H</a>
<a id='L26' name='L26'></a>  26 <em class='sharp'>#include</em> "<a href='../I/132.html'>config.h</a>"
<a id='L27' name='L27'></a>  27 <em class='sharp'>#endif</em>
<a id='L28' name='L28'></a>  28 
<a id='L29' name='L29'></a>  29 <em class='sharp'>#include</em> "<a href='1378.html'>php.h</a>"
<a id='L30' name='L30'></a>  30 <em class='sharp'>#include</em> "<a href='1385.html'>php_ini.h</a>"
<a id='L31' name='L31'></a>  31 <em class='sharp'>#include</em> "<a href='852.html'>php_openssl.h</a>"
<a id='L32' name='L32'></a>  32 
<a id='L33' name='L33'></a>  33 <em class='comment'>/* PHP Includes */</em>
<a id='L34' name='L34'></a>  34 <em class='sharp'>#include</em> "<a href='../I/296.html'>ext/standard/file.h</a>"
<a id='L35' name='L35'></a>  35 <em class='sharp'>#include</em> "<a href='1114.html'>ext/standard/info.h</a>"
<a id='L36' name='L36'></a>  36 <em class='sharp'>#include</em> "<a href='1143.html'>ext/standard/php_fopen_wrappers.h</a>"
<a id='L37' name='L37'></a>  37 <em class='sharp'>#include</em> "<a href='1123.html'>ext/standard/md5.h</a>"
<a id='L38' name='L38'></a>  38 <em class='sharp'>#include</em> "<a href='../I/1189.html'>ext/standard/base64.h</a>"
<a id='L39' name='L39'></a>  39 <em class='sharp'>#ifdef</em> <a href='../Y/5051.html' title='Multiple used in 686 places.'>PHP_WIN32</a>
<a id='L40' name='L40'></a>  40 <em class='sharp'># include</em> "<a href='1624.html'>win32/winutil.h</a>"
<a id='L41' name='L41'></a>  41 <em class='sharp'>#endif</em>
<a id='L42' name='L42'></a>  42 
<a id='L43' name='L43'></a>  43 <em class='comment'>/* OpenSSL includes */</em>
<a id='L44' name='L44'></a>  44 <em class='sharp'>#include</em> &lt;openssl/evp.h&gt;
<a id='L45' name='L45'></a>  45 <em class='sharp'>#include</em> &lt;openssl/bn.h&gt;
<a id='L46' name='L46'></a>  46 <em class='sharp'>#include</em> &lt;openssl/rsa.h&gt;
<a id='L47' name='L47'></a>  47 <em class='sharp'>#include</em> &lt;openssl/dsa.h&gt;
<a id='L48' name='L48'></a>  48 <em class='sharp'>#include</em> &lt;openssl/dh.h&gt;
<a id='L49' name='L49'></a>  49 <em class='sharp'>#include</em> &lt;openssl/x509.h&gt;
<a id='L50' name='L50'></a>  50 <em class='sharp'>#include</em> &lt;openssl/x509v3.h&gt;
<a id='L51' name='L51'></a>  51 <em class='sharp'>#include</em> &lt;openssl/crypto.h&gt;
<a id='L52' name='L52'></a>  52 <em class='sharp'>#include</em> &lt;openssl/pem.h&gt;
<a id='L53' name='L53'></a>  53 <em class='sharp'>#include</em> &lt;openssl/err.h&gt;
<a id='L54' name='L54'></a>  54 <em class='sharp'>#include</em> &lt;openssl/conf.h&gt;
<a id='L55' name='L55'></a>  55 <em class='sharp'>#include</em> &lt;openssl/rand.h&gt;
<a id='L56' name='L56'></a>  56 <em class='sharp'>#include</em> &lt;openssl/ssl.h&gt;
<a id='L57' name='L57'></a>  57 <em class='sharp'>#include</em> &lt;openssl/pkcs12.h&gt;
<a id='L58' name='L58'></a>  58 
<a id='L59' name='L59'></a>  59 <em class='comment'>/* Common */</em>
<a id='L60' name='L60'></a>  60 <em class='sharp'>#include</em> &lt;<a href='1621.html'>time.h</a>&gt;
<a id='L61' name='L61'></a>  61 
<a id='L62' name='L62'></a>  62 <em class='sharp'>#if</em> <strong class='reserved'>defined</strong>(<a href='../Y/4215.html' title='Multiple used in 139 places.'>NETWARE</a>) || (<strong class='reserved'>defined</strong>(<a href='../Y/5051.html' title='Multiple used in 686 places.'>PHP_WIN32</a>) &amp;&amp; <strong class='reserved'>defined</strong>(<a href='../Y/7792.html' title='Multiple used in 65 places.'>_MSC_VER</a>) &amp;&amp; <a href='../Y/7792.html' title='Multiple used in 65 places.'>_MSC_VER</a> &gt;= 1900)
<a id='L63' name='L63'></a>  63 <em class='sharp'>#define</em> <a href='../R/28675.html' title='Multiple referred from 34 places.'>timezone</a> <a href='../Y/8375.html' title='Multiple used in 3 places.'>_timezone</a>      <em class='comment'>/* timezone is called _timezone in LibC */</em>
<a id='L64' name='L64'></a>  64 <em class='sharp'>#endif</em>
<a id='L65' name='L65'></a>  65 
<a id='L66' name='L66'></a>  66 <em class='sharp'>#define</em> DEFAULT_KEY_LENGTH      512
<a id='L67' name='L67'></a>  67 <em class='sharp'>#define</em> <a href='../R/4481.html' title='Multiple referred from 2 places.'>MIN_KEY_LENGTH</a>          384
<a id='L68' name='L68'></a>  68 
<a id='L69' name='L69'></a>  69 <em class='sharp'>#define</em> <a href='../R/5553.html' title='Multiple referred from 4 places.'>OPENSSL_ALGO_SHA1</a>       1
<a id='L70' name='L70'></a>  70 <em class='sharp'>#define</em> <a href='../R/5551.html' title='Multiple referred from 3 places.'>OPENSSL_ALGO_MD5</a>        2
<a id='L71' name='L71'></a>  71 <em class='sharp'>#define</em> <a href='../R/5550.html' title='Multiple referred from 2 places.'>OPENSSL_ALGO_MD4</a>        3
<a id='L72' name='L72'></a>  72 <em class='sharp'>#ifdef</em> <a href='../Y/2940.html' title='Multiple used in 3 places.'>HAVE_OPENSSL_MD2_H</a>
<a id='L73' name='L73'></a>  73 <em class='sharp'>#define</em> <a href='../R/5549.html' title='Multiple referred from 2 places.'>OPENSSL_ALGO_MD2</a>        4
<a id='L74' name='L74'></a>  74 <em class='sharp'>#endif</em>
<a id='L75' name='L75'></a>  75 <em class='sharp'>#define</em> <a href='../R/5548.html' title='Multiple referred from 2 places.'>OPENSSL_ALGO_DSS1</a>       5
<a id='L76' name='L76'></a>  76 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &gt;= 0x0090708fL
<a id='L77' name='L77'></a>  77 <em class='sharp'>#define</em> <a href='../R/5554.html' title='Multiple referred from 2 places.'>OPENSSL_ALGO_SHA224</a> 6
<a id='L78' name='L78'></a>  78 <em class='sharp'>#define</em> <a href='../R/5555.html' title='Multiple referred from 2 places.'>OPENSSL_ALGO_SHA256</a> 7
<a id='L79' name='L79'></a>  79 <em class='sharp'>#define</em> <a href='../R/5556.html' title='Multiple referred from 2 places.'>OPENSSL_ALGO_SHA384</a> 8
<a id='L80' name='L80'></a>  80 <em class='sharp'>#define</em> <a href='../R/5557.html' title='Multiple referred from 2 places.'>OPENSSL_ALGO_SHA512</a> 9
<a id='L81' name='L81'></a>  81 <em class='sharp'>#define</em> <a href='../R/5552.html' title='Multiple referred from 2 places.'>OPENSSL_ALGO_RMD160</a> 10
<a id='L82' name='L82'></a>  82 <em class='sharp'>#endif</em>
<a id='L83' name='L83'></a>  83 <em class='sharp'>#define</em> <a href='../R/1354.html' title='Multiple referred from 2 places.'>DEBUG_SMIME</a>     0
<a id='L84' name='L84'></a>  84 
<a id='L85' name='L85'></a>  85 <em class='sharp'>#if</em> !<strong class='reserved'>defined</strong>(OPENSSL_NO_EC) &amp;&amp; <strong class='reserved'>defined</strong>(<a href='../Y/2133.html' title='Multiple used in 5 places.'>EVP_PKEY_EC</a>)
<a id='L86' name='L86'></a>  86 <em class='sharp'>#define</em> <a href='../R/2974.html' title='Multiple referred from 6 places.'>HAVE_EVP_PKEY_EC</a> 1
<a id='L87' name='L87'></a>  87 <em class='sharp'>#endif</em>
<a id='L88' name='L88'></a>  88 
<a id='L89' name='L89'></a>  89 <em class='comment'>/* FIXME: Use the openssl constants instead of</em>
<a id='L90' name='L90'></a>  90 <em class='comment'> * enum. It is now impossible to match real values</em>
<a id='L91' name='L91'></a>  91 <em class='comment'> * against php constants. Also sorry to break the</em>
<a id='L92' name='L92'></a>  92 <em class='comment'> * enum principles here, BC...</em>
<a id='L93' name='L93'></a>  93 <em class='comment'> */</em>
<a id='L94' name='L94'></a>  94 <strong class='reserved'>enum</strong> php_openssl_key_type <em class='brace'>{</em>
<a id='L95' name='L95'></a>  95         <a href='../R/5567.html' title='Multiple referred from 4 places.'>OPENSSL_KEYTYPE_RSA</a>,
<a id='L96' name='L96'></a>  96         <a href='../R/5565.html' title='Multiple referred from 3 places.'>OPENSSL_KEYTYPE_DSA</a>,
<a id='L97' name='L97'></a>  97         <a href='../R/5564.html' title='Multiple referred from 4 places.'>OPENSSL_KEYTYPE_DH</a>,
<a id='L98' name='L98'></a>  98         <a href='../S/851.html#L934' title='Referred from 934 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_DEFAULT</a> = <a href='../S/851.html#L95' title='Defined at 95 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_RSA</a>,
<a id='L99' name='L99'></a>  99 <em class='sharp'>#ifdef</em> <a href='../S/851.html#L86' title='Defined at 86 in ext/openssl/openssl.c.'>HAVE_EVP_PKEY_EC</a>
<a id='L100' name='L100'></a> 100         <a href='../R/5566.html' title='Multiple referred from 2 places.'>OPENSSL_KEYTYPE_EC</a> = <a href='../S/851.html#L97' title='Defined at 97 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_DH</a> +1
<a id='L101' name='L101'></a> 101 <em class='sharp'>#endif</em>
<a id='L102' name='L102'></a> 102 <em class='brace'>}</em>;
<a id='L103' name='L103'></a> 103 
<a id='L104' name='L104'></a> 104 <strong class='reserved'>enum</strong> php_openssl_cipher_type <em class='brace'>{</em>
<a id='L105' name='L105'></a> 105         <a href='../R/7438.html' title='Multiple referred from 3 places.'>PHP_OPENSSL_CIPHER_RC2_40</a>,
<a id='L106' name='L106'></a> 106         <a href='../R/7437.html' title='Multiple referred from 2 places.'>PHP_OPENSSL_CIPHER_RC2_128</a>,
<a id='L107' name='L107'></a> 107         <a href='../R/7439.html' title='Multiple referred from 2 places.'>PHP_OPENSSL_CIPHER_RC2_64</a>,
<a id='L108' name='L108'></a> 108         <a href='../R/7436.html' title='Multiple referred from 2 places.'>PHP_OPENSSL_CIPHER_DES</a>,
<a id='L109' name='L109'></a> 109         <a href='../R/7431.html' title='Multiple referred from 2 places.'>PHP_OPENSSL_CIPHER_3DES</a>,
<a id='L110' name='L110'></a> 110         <a href='../R/7432.html' title='Multiple referred from 2 places.'>PHP_OPENSSL_CIPHER_AES_128_CBC</a>,
<a id='L111' name='L111'></a> 111         <a href='../R/7433.html' title='Multiple referred from 2 places.'>PHP_OPENSSL_CIPHER_AES_192_CBC</a>,
<a id='L112' name='L112'></a> 112         <a href='../R/7434.html' title='Multiple referred from 2 places.'>PHP_OPENSSL_CIPHER_AES_256_CBC</a>,
<a id='L113' name='L113'></a> 113 
<a id='L114' name='L114'></a> 114         <a href='../S/851.html#L4202' title='Referred from 4202 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_DEFAULT</a> = <a href='../S/851.html#L105' title='Defined at 105 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_RC2_40</a>
<a id='L115' name='L115'></a> 115 <em class='brace'>}</em>;
<a id='L116' name='L116'></a> 116 
<a id='L117' name='L117'></a> 117 <a href='../D/7986.html' title='Multiple defined in 2072 places.'>PHP_FUNCTION</a>(<a href='../Y/29747.html' title='Multiple used in 3 places.'>openssl_get_md_methods</a>);
<a id='L118' name='L118'></a> 118 <a href='../D/7986.html' title='Multiple defined in 2072 places.'>PHP_FUNCTION</a>(<a href='../Y/29746.html' title='Multiple used in 3 places.'>openssl_get_cipher_methods</a>);
<a id='L119' name='L119'></a> 119 
<a id='L120' name='L120'></a> 120 <a href='../D/7986.html' title='Multiple defined in 2072 places.'>PHP_FUNCTION</a>(<a href='../Y/29740.html' title='Multiple used in 3 places.'>openssl_digest</a>);
<a id='L121' name='L121'></a> 121 <a href='../D/7986.html' title='Multiple defined in 2072 places.'>PHP_FUNCTION</a>(<a href='../Y/29741.html' title='Multiple used in 3 places.'>openssl_encrypt</a>);
<a id='L122' name='L122'></a> 122 <a href='../D/7986.html' title='Multiple defined in 2072 places.'>PHP_FUNCTION</a>(<a href='../Y/29738.html' title='Multiple used in 3 places.'>openssl_decrypt</a>);
<a id='L123' name='L123'></a> 123 <a href='../D/7986.html' title='Multiple defined in 2072 places.'>PHP_FUNCTION</a>(<a href='../Y/29731.html' title='Multiple used in 3 places.'>openssl_cipher_iv_length</a>);
<a id='L124' name='L124'></a> 124 
<a id='L125' name='L125'></a> 125 <a href='../D/7986.html' title='Multiple defined in 2072 places.'>PHP_FUNCTION</a>(<a href='../Y/29739.html' title='Multiple used in 3 places.'>openssl_dh_compute_key</a>);
<a id='L126' name='L126'></a> 126 <a href='../D/7986.html' title='Multiple defined in 2072 places.'>PHP_FUNCTION</a>(<a href='../Y/29773.html' title='Multiple used in 3 places.'>openssl_random_pseudo_bytes</a>);
<a id='L127' name='L127'></a> 127 
<a id='L128' name='L128'></a> 128 <em class='comment'>/* {{{ arginfo */</em>
<a id='L129' name='L129'></a> 129 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10913.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_export_to_file</a>, 0, 0, 2)
<a id='L130' name='L130'></a> 130         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>)
<a id='L131' name='L131'></a> 131         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>)
<a id='L132' name='L132'></a> 132         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a>)
<a id='L133' name='L133'></a> 133 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L134' name='L134'></a> 134 
<a id='L135' name='L135'></a> 135 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10912.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_export</a>, 0, 0, 2)
<a id='L136' name='L136'></a> 136         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>)
<a id='L137' name='L137'></a> 137         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, <a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>)
<a id='L138' name='L138'></a> 138         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a>)
<a id='L139' name='L139'></a> 139 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L140' name='L140'></a> 140 
<a id='L141' name='L141'></a> 141 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10914.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_fingerprint</a>, 0, 0, 1)
<a id='L142' name='L142'></a> 142         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>)
<a id='L143' name='L143'></a> 143         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>)
<a id='L144' name='L144'></a> 144         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/33992.html' title='Multiple used in 60 places.'>raw_output</a>)
<a id='L145' name='L145'></a> 145 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L146' name='L146'></a> 146 
<a id='L147' name='L147'></a> 147 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10910.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_check_private_key</a>, 0)
<a id='L148' name='L148'></a> 148         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>)
<a id='L149' name='L149'></a> 149         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>)
<a id='L150' name='L150'></a> 150 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L151' name='L151'></a> 151 
<a id='L152' name='L152'></a> 152 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10916.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_parse</a>, 0)
<a id='L153' name='L153'></a> 153         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>)
<a id='L154' name='L154'></a> 154         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/36082.html' title='Multiple used in 3 places.'>shortname</a>)
<a id='L155' name='L155'></a> 155 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L156' name='L156'></a> 156 
<a id='L157' name='L157'></a> 157 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10911.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_checkpurpose</a>, 0, 0, 3)
<a id='L158' name='L158'></a> 158         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, x509cert)
<a id='L159' name='L159'></a> 159         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/33738.html' title='Multiple used in 7 places.'>purpose</a>)
<a id='L160' name='L160'></a> 160         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/13213.html' title='Multiple used in 17 places.'>cainfo</a>) <em class='comment'>/* array */</em>
<a id='L161' name='L161'></a> 161         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, untrustedfile)
<a id='L162' name='L162'></a> 162 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L163' name='L163'></a> 163 
<a id='L164' name='L164'></a> 164 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10917.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_read</a>, 0)
<a id='L165' name='L165'></a> 165         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>)
<a id='L166' name='L166'></a> 166 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L167' name='L167'></a> 167 
<a id='L168' name='L168'></a> 168 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10915.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_free</a>, 0)
<a id='L169' name='L169'></a> 169         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>)
<a id='L170' name='L170'></a> 170 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L171' name='L171'></a> 171 
<a id='L172' name='L172'></a> 172 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10885.html' title='Multiple used in 2 places.'>arginfo_openssl_pkcs12_export_to_file</a>, 0, 0, 4)
<a id='L173' name='L173'></a> 173         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>)
<a id='L174' name='L174'></a> 174         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>)
<a id='L175' name='L175'></a> 175         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>)
<a id='L176' name='L176'></a> 176         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../S/279.html#L54' title='Defined at 54 in ext/hash/hash_tiger.c.'>pass</a>)
<a id='L177' name='L177'></a> 177         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>) <em class='comment'>/* array */</em>
<a id='L178' name='L178'></a> 178 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L179' name='L179'></a> 179 
<a id='L180' name='L180'></a> 180 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10884.html' title='Multiple used in 2 places.'>arginfo_openssl_pkcs12_export</a>, 0)
<a id='L181' name='L181'></a> 181         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>)
<a id='L182' name='L182'></a> 182         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, <a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>)
<a id='L183' name='L183'></a> 183         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>)
<a id='L184' name='L184'></a> 184         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../S/279.html#L54' title='Defined at 54 in ext/hash/hash_tiger.c.'>pass</a>)
<a id='L185' name='L185'></a> 185         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>) <em class='comment'>/* array */</em>
<a id='L186' name='L186'></a> 186 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L187' name='L187'></a> 187 
<a id='L188' name='L188'></a> 188 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10886.html' title='Multiple used in 2 places.'>arginfo_openssl_pkcs12_read</a>, 0)
<a id='L189' name='L189'></a> 189         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/5069.html' title='Multiple used in 4 places.'>PKCS12</a>)
<a id='L190' name='L190'></a> 190         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, certs) <em class='comment'>/* array */</em>
<a id='L191' name='L191'></a> 191         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../S/279.html#L54' title='Defined at 54 in ext/hash/hash_tiger.c.'>pass</a>)
<a id='L192' name='L192'></a> 192 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L193' name='L193'></a> 193 
<a id='L194' name='L194'></a> 194 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10869.html' title='Multiple used in 2 places.'>arginfo_openssl_csr_export_to_file</a>, 0, 0, 2)
<a id='L195' name='L195'></a> 195         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>)
<a id='L196' name='L196'></a> 196         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>)
<a id='L197' name='L197'></a> 197         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a>)
<a id='L198' name='L198'></a> 198 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L199' name='L199'></a> 199 
<a id='L200' name='L200'></a> 200 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10868.html' title='Multiple used in 2 places.'>arginfo_openssl_csr_export</a>, 0, 0, 2)
<a id='L201' name='L201'></a> 201         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>)
<a id='L202' name='L202'></a> 202         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, <a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>)
<a id='L203' name='L203'></a> 203         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a>)
<a id='L204' name='L204'></a> 204 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L205' name='L205'></a> 205 
<a id='L206' name='L206'></a> 206 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10873.html' title='Multiple used in 2 places.'>arginfo_openssl_csr_sign</a>, 0, 0, 4)
<a id='L207' name='L207'></a> 207         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>)
<a id='L208' name='L208'></a> 208         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>)
<a id='L209' name='L209'></a> 209         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>)
<a id='L210' name='L210'></a> 210         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/15149.html' title='Multiple used in 41 places.'>days</a>)
<a id='L211' name='L211'></a> 211         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/14273.html' title='Multiple used in 3 places.'>config_args</a>) <em class='comment'>/* array */</em>
<a id='L212' name='L212'></a> 212         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/35723.html' title='Multiple used in 4 places.'>serial</a>)
<a id='L213' name='L213'></a> 213 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L214' name='L214'></a> 214 
<a id='L215' name='L215'></a> 215 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10872.html' title='Multiple used in 2 places.'>arginfo_openssl_csr_new</a>, 0, 0, 2)
<a id='L216' name='L216'></a> 216         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/15850.html' title='Multiple used in 52 places.'>dn</a>) <em class='comment'>/* array */</em>
<a id='L217' name='L217'></a> 217         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, <a href='../Y/33407.html' title='Multiple used in 12 places.'>privkey</a>)
<a id='L218' name='L218'></a> 218         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/14279.html' title='Multiple used in 2 places.'>configargs</a>)
<a id='L219' name='L219'></a> 219         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, extraattribs)
<a id='L220' name='L220'></a> 220 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L221' name='L221'></a> 221 
<a id='L222' name='L222'></a> 222 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10871.html' title='Multiple used in 2 places.'>arginfo_openssl_csr_get_subject</a>, 0)
<a id='L223' name='L223'></a> 223         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>)
<a id='L224' name='L224'></a> 224 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L225' name='L225'></a> 225 
<a id='L226' name='L226'></a> 226 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10870.html' title='Multiple used in 2 places.'>arginfo_openssl_csr_get_public_key</a>, 0)
<a id='L227' name='L227'></a> 227         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>)
<a id='L228' name='L228'></a> 228 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L229' name='L229'></a> 229 
<a id='L230' name='L230'></a> 230 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10897.html' title='Multiple used in 2 places.'>arginfo_openssl_pkey_new</a>, 0, 0, 0)
<a id='L231' name='L231'></a> 231         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/14279.html' title='Multiple used in 2 places.'>configargs</a>) <em class='comment'>/* array */</em>
<a id='L232' name='L232'></a> 232 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L233' name='L233'></a> 233 
<a id='L234' name='L234'></a> 234 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10892.html' title='Multiple used in 2 places.'>arginfo_openssl_pkey_export_to_file</a>, 0, 0, 2)
<a id='L235' name='L235'></a> 235         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>)
<a id='L236' name='L236'></a> 236         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>)
<a id='L237' name='L237'></a> 237         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>)
<a id='L238' name='L238'></a> 238         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/14273.html' title='Multiple used in 3 places.'>config_args</a>) <em class='comment'>/* array */</em>
<a id='L239' name='L239'></a> 239 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L240' name='L240'></a> 240 
<a id='L241' name='L241'></a> 241 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10891.html' title='Multiple used in 2 places.'>arginfo_openssl_pkey_export</a>, 0, 0, 2)
<a id='L242' name='L242'></a> 242         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>)
<a id='L243' name='L243'></a> 243         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, <a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>)
<a id='L244' name='L244'></a> 244         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>)
<a id='L245' name='L245'></a> 245         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/14273.html' title='Multiple used in 3 places.'>config_args</a>) <em class='comment'>/* array */</em>
<a id='L246' name='L246'></a> 246 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L247' name='L247'></a> 247 
<a id='L248' name='L248'></a> 248 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10896.html' title='Multiple used in 3 places.'>arginfo_openssl_pkey_get_public</a>, 0)
<a id='L249' name='L249'></a> 249         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>)
<a id='L250' name='L250'></a> 250 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L251' name='L251'></a> 251 
<a id='L252' name='L252'></a> 252 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10893.html' title='Multiple used in 3 places.'>arginfo_openssl_pkey_free</a>, 0)
<a id='L253' name='L253'></a> 253         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>)
<a id='L254' name='L254'></a> 254 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L255' name='L255'></a> 255 
<a id='L256' name='L256'></a> 256 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10895.html' title='Multiple used in 3 places.'>arginfo_openssl_pkey_get_private</a>, 0, 0, 1)
<a id='L257' name='L257'></a> 257         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>)
<a id='L258' name='L258'></a> 258         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>)
<a id='L259' name='L259'></a> 259 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L260' name='L260'></a> 260 
<a id='L261' name='L261'></a> 261 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10894.html' title='Multiple used in 2 places.'>arginfo_openssl_pkey_get_details</a>, 0)
<a id='L262' name='L262'></a> 262         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>)
<a id='L263' name='L263'></a> 263 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L264' name='L264'></a> 264 
<a id='L265' name='L265'></a> 265 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &gt;= 0x10000000L
<a id='L266' name='L266'></a> 266 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10883.html' title='Multiple used in 2 places.'>arginfo_openssl_pbkdf2</a>, 0, 0, 4)
<a id='L267' name='L267'></a> 267         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>)
<a id='L268' name='L268'></a> 268         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/35287.html' title='Multiple used in 131 places.'>salt</a>)
<a id='L269' name='L269'></a> 269         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/24457.html' title='Multiple used in 81 places.'>key_length</a>)
<a id='L270' name='L270'></a> 270         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/24222.html' title='Multiple used in 11 places.'>iterations</a>)
<a id='L271' name='L271'></a> 271         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, digest_algorithm)
<a id='L272' name='L272'></a> 272 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L273' name='L273'></a> 273 <em class='sharp'>#endif</em>
<a id='L274' name='L274'></a> 274 
<a id='L275' name='L275'></a> 275 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10890.html' title='Multiple used in 2 places.'>arginfo_openssl_pkcs7_verify</a>, 0, 0, 2)
<a id='L276' name='L276'></a> 276         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>)
<a id='L277' name='L277'></a> 277         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a>)
<a id='L278' name='L278'></a> 278         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, signerscerts)
<a id='L279' name='L279'></a> 279         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/13213.html' title='Multiple used in 17 places.'>cainfo</a>) <em class='comment'>/* array */</em>
<a id='L280' name='L280'></a> 280         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/17424.html' title='Multiple used in 5 places.'>extracerts</a>)
<a id='L281' name='L281'></a> 281         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/14352.html' title='Multiple used in 409 places.'>content</a>)
<a id='L282' name='L282'></a> 282 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L283' name='L283'></a> 283 
<a id='L284' name='L284'></a> 284 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10888.html' title='Multiple used in 2 places.'>arginfo_openssl_pkcs7_encrypt</a>, 0, 0, 4)
<a id='L285' name='L285'></a> 285         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a>)
<a id='L286' name='L286'></a> 286         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a>)
<a id='L287' name='L287'></a> 287         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/34172.html' title='Multiple used in 8 places.'>recipcerts</a>)
<a id='L288' name='L288'></a> 288         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/19923.html' title='Multiple used in 212 places.'>headers</a>) <em class='comment'>/* array */</em>
<a id='L289' name='L289'></a> 289         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a>)
<a id='L290' name='L290'></a> 290         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>)
<a id='L291' name='L291'></a> 291 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L292' name='L292'></a> 292 
<a id='L293' name='L293'></a> 293 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10889.html' title='Multiple used in 2 places.'>arginfo_openssl_pkcs7_sign</a>, 0, 0, 5)
<a id='L294' name='L294'></a> 294         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a>)
<a id='L295' name='L295'></a> 295         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a>)
<a id='L296' name='L296'></a> 296         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, signcert)
<a id='L297' name='L297'></a> 297         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, signkey)
<a id='L298' name='L298'></a> 298         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/19923.html' title='Multiple used in 212 places.'>headers</a>) <em class='comment'>/* array */</em>
<a id='L299' name='L299'></a> 299         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a>)
<a id='L300' name='L300'></a> 300         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/17426.html' title='Multiple used in 5 places.'>extracertsfilename</a>)
<a id='L301' name='L301'></a> 301 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L302' name='L302'></a> 302 
<a id='L303' name='L303'></a> 303 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10887.html' title='Multiple used in 2 places.'>arginfo_openssl_pkcs7_decrypt</a>, 0, 0, 3)
<a id='L304' name='L304'></a> 304         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/23139.html' title='Multiple used in 14 places.'>infilename</a>)
<a id='L305' name='L305'></a> 305         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>)
<a id='L306' name='L306'></a> 306         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/34171.html' title='Multiple used in 5 places.'>recipcert</a>)
<a id='L307' name='L307'></a> 307         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/34173.html' title='Multiple used in 4 places.'>recipkey</a>)
<a id='L308' name='L308'></a> 308 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L309' name='L309'></a> 309 
<a id='L310' name='L310'></a> 310 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10899.html' title='Multiple used in 2 places.'>arginfo_openssl_private_encrypt</a>, 0, 0, 3)
<a id='L311' name='L311'></a> 311         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>)
<a id='L312' name='L312'></a> 312         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, <a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>)
<a id='L313' name='L313'></a> 313         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>)
<a id='L314' name='L314'></a> 314         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a>)
<a id='L315' name='L315'></a> 315 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L316' name='L316'></a> 316 
<a id='L317' name='L317'></a> 317 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10898.html' title='Multiple used in 2 places.'>arginfo_openssl_private_decrypt</a>, 0, 0, 3)
<a id='L318' name='L318'></a> 318         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>)
<a id='L319' name='L319'></a> 319         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, <a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>)
<a id='L320' name='L320'></a> 320         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>)
<a id='L321' name='L321'></a> 321         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a>)
<a id='L322' name='L322'></a> 322 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L323' name='L323'></a> 323 
<a id='L324' name='L324'></a> 324 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10901.html' title='Multiple used in 2 places.'>arginfo_openssl_public_encrypt</a>, 0, 0, 3)
<a id='L325' name='L325'></a> 325         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>)
<a id='L326' name='L326'></a> 326         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, <a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>)
<a id='L327' name='L327'></a> 327         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>)
<a id='L328' name='L328'></a> 328         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a>)
<a id='L329' name='L329'></a> 329 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L330' name='L330'></a> 330 
<a id='L331' name='L331'></a> 331 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10900.html' title='Multiple used in 2 places.'>arginfo_openssl_public_decrypt</a>, 0, 0, 3)
<a id='L332' name='L332'></a> 332         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>)
<a id='L333' name='L333'></a> 333         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, <a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>)
<a id='L334' name='L334'></a> 334         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>)
<a id='L335' name='L335'></a> 335         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a>)
<a id='L336' name='L336'></a> 336 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L337' name='L337'></a> 337 
<a id='L338' name='L338'></a> 338 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10878.html' title='Multiple used in 2 places.'>arginfo_openssl_error_string</a>, 0)
<a id='L339' name='L339'></a> 339 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L340' name='L340'></a> 340 
<a id='L341' name='L341'></a> 341 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10904.html' title='Multiple used in 2 places.'>arginfo_openssl_sign</a>, 0, 0, 3)
<a id='L342' name='L342'></a> 342         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>)
<a id='L343' name='L343'></a> 343         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, <a href='../Y/36171.html' title='Multiple used in 91 places.'>signature</a>)
<a id='L344' name='L344'></a> 344         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>)
<a id='L345' name='L345'></a> 345         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>)
<a id='L346' name='L346'></a> 346 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L347' name='L347'></a> 347 
<a id='L348' name='L348'></a> 348 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10909.html' title='Multiple used in 2 places.'>arginfo_openssl_verify</a>, 0, 0, 3)
<a id='L349' name='L349'></a> 349         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>)
<a id='L350' name='L350'></a> 350         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/36171.html' title='Multiple used in 91 places.'>signature</a>)
<a id='L351' name='L351'></a> 351         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>)
<a id='L352' name='L352'></a> 352         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>)
<a id='L353' name='L353'></a> 353 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L354' name='L354'></a> 354 
<a id='L355' name='L355'></a> 355 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10903.html' title='Multiple used in 2 places.'>arginfo_openssl_seal</a>, 0, 0, 4)
<a id='L356' name='L356'></a> 356         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>)
<a id='L357' name='L357'></a> 357         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, <a href='../Y/35545.html' title='Multiple used in 5 places.'>sealdata</a>)
<a id='L358' name='L358'></a> 358         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, <a href='../Y/16518.html' title='Multiple used in 6 places.'>ekeys</a>) <em class='comment'>/* arary */</em>
<a id='L359' name='L359'></a> 359         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/33726.html' title='Multiple used in 4 places.'>pubkeys</a>) <em class='comment'>/* array */</em>
<a id='L360' name='L360'></a> 360         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>)
<a id='L361' name='L361'></a> 361         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, <a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>)
<a id='L362' name='L362'></a> 362 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L363' name='L363'></a> 363 
<a id='L364' name='L364'></a> 364 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10882.html' title='Multiple used in 2 places.'>arginfo_openssl_open</a>, 0)
<a id='L365' name='L365'></a> 365         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>)
<a id='L366' name='L366'></a> 366         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, <a href='../Y/29722.html' title='Multiple used in 5 places.'>opendata</a>)
<a id='L367' name='L367'></a> 367         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/16516.html' title='Multiple used in 35 places.'>ekey</a>)
<a id='L368' name='L368'></a> 368         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/33407.html' title='Multiple used in 12 places.'>privkey</a>)
<a id='L369' name='L369'></a> 369         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>)
<a id='L370' name='L370'></a> 370 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L371' name='L371'></a> 371 
<a id='L372' name='L372'></a> 372 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10881.html' title='Multiple used in 2 places.'>arginfo_openssl_get_md_methods</a>, 0, 0, 0)
<a id='L373' name='L373'></a> 373         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/9070.html' title='Multiple used in 21 places.'>aliases</a>)
<a id='L374' name='L374'></a> 374 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L375' name='L375'></a> 375 
<a id='L376' name='L376'></a> 376 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10880.html' title='Multiple used in 2 places.'>arginfo_openssl_get_cipher_methods</a>, 0, 0, 0)
<a id='L377' name='L377'></a> 377         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/9070.html' title='Multiple used in 21 places.'>aliases</a>)
<a id='L378' name='L378'></a> 378 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L379' name='L379'></a> 379 
<a id='L380' name='L380'></a> 380 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10876.html' title='Multiple used in 2 places.'>arginfo_openssl_digest</a>, 0, 0, 2)
<a id='L381' name='L381'></a> 381         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>)
<a id='L382' name='L382'></a> 382         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>)
<a id='L383' name='L383'></a> 383         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/33992.html' title='Multiple used in 60 places.'>raw_output</a>)
<a id='L384' name='L384'></a> 384 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L385' name='L385'></a> 385 
<a id='L386' name='L386'></a> 386 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10877.html' title='Multiple used in 2 places.'>arginfo_openssl_encrypt</a>, 0, 0, 3)
<a id='L387' name='L387'></a> 387         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>)
<a id='L388' name='L388'></a> 388         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>)
<a id='L389' name='L389'></a> 389         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>)
<a id='L390' name='L390'></a> 390         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/25509.html' title='Multiple defined in 3 places.'>options</a>)
<a id='L391' name='L391'></a> 391         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>)
<a id='L392' name='L392'></a> 392 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L393' name='L393'></a> 393 
<a id='L394' name='L394'></a> 394 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10874.html' title='Multiple used in 2 places.'>arginfo_openssl_decrypt</a>, 0, 0, 3)
<a id='L395' name='L395'></a> 395         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>)
<a id='L396' name='L396'></a> 396         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>)
<a id='L397' name='L397'></a> 397         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>)
<a id='L398' name='L398'></a> 398         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/25509.html' title='Multiple defined in 3 places.'>options</a>)
<a id='L399' name='L399'></a> 399         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>)
<a id='L400' name='L400'></a> 400 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L401' name='L401'></a> 401 
<a id='L402' name='L402'></a> 402 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10867.html' title='Multiple used in 2 places.'>arginfo_openssl_cipher_iv_length</a>, 0)
<a id='L403' name='L403'></a> 403         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>)
<a id='L404' name='L404'></a> 404 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L405' name='L405'></a> 405 
<a id='L406' name='L406'></a> 406 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10875.html' title='Multiple used in 2 places.'>arginfo_openssl_dh_compute_key</a>, 0)
<a id='L407' name='L407'></a> 407         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/33720.html' title='Multiple used in 8 places.'>pub_key</a>)
<a id='L408' name='L408'></a> 408         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, dh_key)
<a id='L409' name='L409'></a> 409 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L410' name='L410'></a> 410 
<a id='L411' name='L411'></a> 411 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10902.html' title='Multiple used in 2 places.'>arginfo_openssl_random_pseudo_bytes</a>, 0, 0, 1)
<a id='L412' name='L412'></a> 412         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>)
<a id='L413' name='L413'></a> 413         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(1, result_is_strong)
<a id='L414' name='L414'></a> 414 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L415' name='L415'></a> 415 
<a id='L416' name='L416'></a> 416 <a href='../D/15967.html' title='Multiple defined in 46 places.'>ZEND_BEGIN_ARG_INFO_EX</a>(<a href='../Y/10907.html' title='Multiple used in 2 places.'>arginfo_openssl_spki_new</a>, 0, 0, 2)
<a id='L417' name='L417'></a> 417         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/33407.html' title='Multiple used in 12 places.'>privkey</a>)
<a id='L418' name='L418'></a> 418         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/13526.html' title='Multiple used in 7 places.'>challenge</a>)
<a id='L419' name='L419'></a> 419         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/9053.html' title='Multiple used in 59 places.'>algo</a>)
<a id='L420' name='L420'></a> 420 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L421' name='L421'></a> 421 
<a id='L422' name='L422'></a> 422 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10908.html' title='Multiple used in 2 places.'>arginfo_openssl_spki_verify</a>, 0)
<a id='L423' name='L423'></a> 423         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>)
<a id='L424' name='L424'></a> 424 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L425' name='L425'></a> 425 
<a id='L426' name='L426'></a> 426 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10905.html' title='Multiple used in 2 places.'>arginfo_openssl_spki_export</a>, 0)
<a id='L427' name='L427'></a> 427         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>)
<a id='L428' name='L428'></a> 428 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L429' name='L429'></a> 429 
<a id='L430' name='L430'></a> 430 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10906.html' title='Multiple used in 2 places.'>arginfo_openssl_spki_export_challenge</a>, 0)
<a id='L431' name='L431'></a> 431         <a href='../S/1632.html#L102' title='Defined at 102 in Zend/zend_API.h.'>ZEND_ARG_INFO</a>(0, <a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>)
<a id='L432' name='L432'></a> 432 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L433' name='L433'></a> 433 
<a id='L434' name='L434'></a> 434 <a href='../S/1632.html#L120' title='Defined at 120 in Zend/zend_API.h.'>ZEND_BEGIN_ARG_INFO</a>(<a href='../Y/10879.html' title='Multiple used in 2 places.'>arginfo_openssl_get_cert_locations</a>, 0)
<a id='L435' name='L435'></a> 435 <a href='../S/1632.html#L122' title='Defined at 122 in Zend/zend_API.h.'>ZEND_END_ARG_INFO</a>()
<a id='L436' name='L436'></a> 436 <em class='comment'>/* }}} */</em>
<a id='L437' name='L437'></a> 437 
<a id='L438' name='L438'></a> 438 <em class='comment'>/* {{{ openssl_functions[]</em>
<a id='L439' name='L439'></a> 439 <em class='comment'> */</em>
<a id='L440' name='L440'></a> 440 <strong class='reserved'>const</strong> <a href='../Y/43758.html' title='Multiple used in 300 places.'>zend_function_entry</a> <a href='../Y/29744.html' title='Multiple used in 2 places.'>openssl_functions</a>[] = <em class='brace'>{</em>
<a id='L441' name='L441'></a> 441         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29745.html' title='Multiple used in 3 places.'>openssl_get_cert_locations</a>, <a href='../Y/10879.html' title='Multiple used in 2 places.'>arginfo_openssl_get_cert_locations</a>)
<a id='L442' name='L442'></a> 442 
<a id='L443' name='L443'></a> 443 <em class='comment'>/* spki functions */</em>
<a id='L444' name='L444'></a> 444         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29778.html' title='Multiple used in 3 places.'>openssl_spki_new</a>, <a href='../Y/10907.html' title='Multiple used in 2 places.'>arginfo_openssl_spki_new</a>)
<a id='L445' name='L445'></a> 445         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29779.html' title='Multiple used in 3 places.'>openssl_spki_verify</a>, <a href='../Y/10908.html' title='Multiple used in 2 places.'>arginfo_openssl_spki_verify</a>)
<a id='L446' name='L446'></a> 446         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29776.html' title='Multiple used in 3 places.'>openssl_spki_export</a>, <a href='../Y/10905.html' title='Multiple used in 2 places.'>arginfo_openssl_spki_export</a>)
<a id='L447' name='L447'></a> 447         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29777.html' title='Multiple used in 3 places.'>openssl_spki_export_challenge</a>, <a href='../Y/10906.html' title='Multiple used in 2 places.'>arginfo_openssl_spki_export_challenge</a>)
<a id='L448' name='L448'></a> 448 
<a id='L449' name='L449'></a> 449 <em class='comment'>/* public/private key functions */</em>
<a id='L450' name='L450'></a> 450         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29762.html' title='Multiple used in 4 places.'>openssl_pkey_free</a>,                       <a href='../Y/10893.html' title='Multiple used in 3 places.'>arginfo_openssl_pkey_free</a>)
<a id='L451' name='L451'></a> 451         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29766.html' title='Multiple used in 3 places.'>openssl_pkey_new</a>,                        <a href='../Y/10897.html' title='Multiple used in 2 places.'>arginfo_openssl_pkey_new</a>)
<a id='L452' name='L452'></a> 452         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29760.html' title='Multiple used in 3 places.'>openssl_pkey_export</a>,                     <a href='../Y/10891.html' title='Multiple used in 2 places.'>arginfo_openssl_pkey_export</a>)
<a id='L453' name='L453'></a> 453         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29761.html' title='Multiple used in 3 places.'>openssl_pkey_export_to_file</a>,     <a href='../Y/10892.html' title='Multiple used in 2 places.'>arginfo_openssl_pkey_export_to_file</a>)
<a id='L454' name='L454'></a> 454         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29764.html' title='Multiple used in 4 places.'>openssl_pkey_get_private</a>,        <a href='../Y/10895.html' title='Multiple used in 3 places.'>arginfo_openssl_pkey_get_private</a>)
<a id='L455' name='L455'></a> 455         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29765.html' title='Multiple used in 4 places.'>openssl_pkey_get_public</a>,         <a href='../Y/10896.html' title='Multiple used in 3 places.'>arginfo_openssl_pkey_get_public</a>)
<a id='L456' name='L456'></a> 456         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29763.html' title='Multiple used in 3 places.'>openssl_pkey_get_details</a>,        <a href='../Y/10894.html' title='Multiple used in 2 places.'>arginfo_openssl_pkey_get_details</a>)
<a id='L457' name='L457'></a> 457 
<a id='L458' name='L458'></a> 458         <a href='../S/1378.html#L344' title='Defined at 344 in main/php.h.'>PHP_FALIAS</a>(openssl_free_key,            <a href='../Y/29762.html' title='Multiple used in 4 places.'>openssl_pkey_free</a>,                      <a href='../Y/10893.html' title='Multiple used in 3 places.'>arginfo_openssl_pkey_free</a>)
<a id='L459' name='L459'></a> 459         <a href='../S/1378.html#L344' title='Defined at 344 in main/php.h.'>PHP_FALIAS</a>(openssl_get_privatekey,      <a href='../Y/29764.html' title='Multiple used in 4 places.'>openssl_pkey_get_private</a>,       <a href='../Y/10895.html' title='Multiple used in 3 places.'>arginfo_openssl_pkey_get_private</a>)
<a id='L460' name='L460'></a> 460         <a href='../S/1378.html#L344' title='Defined at 344 in main/php.h.'>PHP_FALIAS</a>(openssl_get_publickey,       <a href='../Y/29765.html' title='Multiple used in 4 places.'>openssl_pkey_get_public</a>,        <a href='../Y/10896.html' title='Multiple used in 3 places.'>arginfo_openssl_pkey_get_public</a>)
<a id='L461' name='L461'></a> 461 
<a id='L462' name='L462'></a> 462 <em class='comment'>/* x.509 cert funcs */</em>
<a id='L463' name='L463'></a> 463         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29788.html' title='Multiple used in 3 places.'>openssl_x509_read</a>,                               <a href='../Y/10917.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_read</a>)
<a id='L464' name='L464'></a> 464         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29786.html' title='Multiple used in 3 places.'>openssl_x509_free</a>,                               <a href='../Y/10915.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_free</a>)
<a id='L465' name='L465'></a> 465         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29787.html' title='Multiple used in 3 places.'>openssl_x509_parse</a>,                              <a href='../Y/10916.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_parse</a>)
<a id='L466' name='L466'></a> 466         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29782.html' title='Multiple used in 3 places.'>openssl_x509_checkpurpose</a>,               <a href='../Y/10911.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_checkpurpose</a>)
<a id='L467' name='L467'></a> 467         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29781.html' title='Multiple used in 3 places.'>openssl_x509_check_private_key</a>,  <a href='../Y/10910.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_check_private_key</a>)
<a id='L468' name='L468'></a> 468         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29783.html' title='Multiple used in 3 places.'>openssl_x509_export</a>,                             <a href='../Y/10912.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_export</a>)
<a id='L469' name='L469'></a> 469         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29785.html' title='Multiple used in 3 places.'>openssl_x509_fingerprint</a>,                        <a href='../Y/10914.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_fingerprint</a>)
<a id='L470' name='L470'></a> 470         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29784.html' title='Multiple used in 3 places.'>openssl_x509_export_to_file</a>,             <a href='../Y/10913.html' title='Multiple used in 2 places.'>arginfo_openssl_x509_export_to_file</a>)
<a id='L471' name='L471'></a> 471 
<a id='L472' name='L472'></a> 472 <em class='comment'>/* PKCS12 funcs */</em>
<a id='L473' name='L473'></a> 473         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29753.html' title='Multiple used in 3 places.'>openssl_pkcs12_export</a>,                   <a href='../Y/10884.html' title='Multiple used in 2 places.'>arginfo_openssl_pkcs12_export</a>)
<a id='L474' name='L474'></a> 474         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29754.html' title='Multiple used in 3 places.'>openssl_pkcs12_export_to_file</a>,   <a href='../Y/10885.html' title='Multiple used in 2 places.'>arginfo_openssl_pkcs12_export_to_file</a>)
<a id='L475' name='L475'></a> 475         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29755.html' title='Multiple used in 3 places.'>openssl_pkcs12_read</a>,                             <a href='../Y/10886.html' title='Multiple used in 2 places.'>arginfo_openssl_pkcs12_read</a>)
<a id='L476' name='L476'></a> 476 
<a id='L477' name='L477'></a> 477 <em class='comment'>/* CSR funcs */</em>
<a id='L478' name='L478'></a> 478         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29736.html' title='Multiple used in 3 places.'>openssl_csr_new</a>,                         <a href='../Y/10872.html' title='Multiple used in 2 places.'>arginfo_openssl_csr_new</a>)
<a id='L479' name='L479'></a> 479         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29732.html' title='Multiple used in 3 places.'>openssl_csr_export</a>,                      <a href='../Y/10868.html' title='Multiple used in 2 places.'>arginfo_openssl_csr_export</a>)
<a id='L480' name='L480'></a> 480         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29733.html' title='Multiple used in 3 places.'>openssl_csr_export_to_file</a>,      <a href='../Y/10869.html' title='Multiple used in 2 places.'>arginfo_openssl_csr_export_to_file</a>)
<a id='L481' name='L481'></a> 481         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29737.html' title='Multiple used in 3 places.'>openssl_csr_sign</a>,                        <a href='../Y/10873.html' title='Multiple used in 2 places.'>arginfo_openssl_csr_sign</a>)
<a id='L482' name='L482'></a> 482         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29735.html' title='Multiple used in 3 places.'>openssl_csr_get_subject</a>,         <a href='../Y/10871.html' title='Multiple used in 2 places.'>arginfo_openssl_csr_get_subject</a>)
<a id='L483' name='L483'></a> 483         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29734.html' title='Multiple used in 3 places.'>openssl_csr_get_public_key</a>,      <a href='../Y/10870.html' title='Multiple used in 2 places.'>arginfo_openssl_csr_get_public_key</a>)
<a id='L484' name='L484'></a> 484 
<a id='L485' name='L485'></a> 485         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29740.html' title='Multiple used in 3 places.'>openssl_digest</a>,                          <a href='../Y/10876.html' title='Multiple used in 2 places.'>arginfo_openssl_digest</a>)
<a id='L486' name='L486'></a> 486         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29741.html' title='Multiple used in 3 places.'>openssl_encrypt</a>,                         <a href='../Y/10877.html' title='Multiple used in 2 places.'>arginfo_openssl_encrypt</a>)
<a id='L487' name='L487'></a> 487         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29738.html' title='Multiple used in 3 places.'>openssl_decrypt</a>,                         <a href='../Y/10874.html' title='Multiple used in 2 places.'>arginfo_openssl_decrypt</a>)
<a id='L488' name='L488'></a> 488         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29731.html' title='Multiple used in 3 places.'>openssl_cipher_iv_length</a>,        <a href='../Y/10867.html' title='Multiple used in 2 places.'>arginfo_openssl_cipher_iv_length</a>)
<a id='L489' name='L489'></a> 489         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29775.html' title='Multiple used in 3 places.'>openssl_sign</a>,                            <a href='../Y/10904.html' title='Multiple used in 2 places.'>arginfo_openssl_sign</a>)
<a id='L490' name='L490'></a> 490         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29780.html' title='Multiple used in 3 places.'>openssl_verify</a>,                          <a href='../Y/10909.html' title='Multiple used in 2 places.'>arginfo_openssl_verify</a>)
<a id='L491' name='L491'></a> 491         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29774.html' title='Multiple used in 3 places.'>openssl_seal</a>,                            <a href='../Y/10903.html' title='Multiple used in 2 places.'>arginfo_openssl_seal</a>)
<a id='L492' name='L492'></a> 492         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29751.html' title='Multiple used in 3 places.'>openssl_open</a>,                            <a href='../Y/10882.html' title='Multiple used in 2 places.'>arginfo_openssl_open</a>)
<a id='L493' name='L493'></a> 493 
<a id='L494' name='L494'></a> 494 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &gt;= 0x10000000L
<a id='L495' name='L495'></a> 495         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29752.html' title='Multiple used in 3 places.'>openssl_pbkdf2</a>,  <a href='../Y/10883.html' title='Multiple used in 2 places.'>arginfo_openssl_pbkdf2</a>)
<a id='L496' name='L496'></a> 496 <em class='sharp'>#endif</em>
<a id='L497' name='L497'></a> 497 
<a id='L498' name='L498'></a> 498 <em class='comment'>/* for S/MIME handling */</em>
<a id='L499' name='L499'></a> 499         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29759.html' title='Multiple used in 3 places.'>openssl_pkcs7_verify</a>,            <a href='../Y/10890.html' title='Multiple used in 2 places.'>arginfo_openssl_pkcs7_verify</a>)
<a id='L500' name='L500'></a> 500         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29756.html' title='Multiple used in 3 places.'>openssl_pkcs7_decrypt</a>,           <a href='../Y/10887.html' title='Multiple used in 2 places.'>arginfo_openssl_pkcs7_decrypt</a>)
<a id='L501' name='L501'></a> 501         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29758.html' title='Multiple used in 3 places.'>openssl_pkcs7_sign</a>,                      <a href='../Y/10889.html' title='Multiple used in 2 places.'>arginfo_openssl_pkcs7_sign</a>)
<a id='L502' name='L502'></a> 502         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29757.html' title='Multiple used in 3 places.'>openssl_pkcs7_encrypt</a>,           <a href='../Y/10888.html' title='Multiple used in 2 places.'>arginfo_openssl_pkcs7_encrypt</a>)
<a id='L503' name='L503'></a> 503 
<a id='L504' name='L504'></a> 504         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29768.html' title='Multiple used in 3 places.'>openssl_private_encrypt</a>,         <a href='../Y/10899.html' title='Multiple used in 2 places.'>arginfo_openssl_private_encrypt</a>)
<a id='L505' name='L505'></a> 505         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29767.html' title='Multiple used in 3 places.'>openssl_private_decrypt</a>,         <a href='../Y/10898.html' title='Multiple used in 2 places.'>arginfo_openssl_private_decrypt</a>)
<a id='L506' name='L506'></a> 506         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29772.html' title='Multiple used in 3 places.'>openssl_public_encrypt</a>,          <a href='../Y/10901.html' title='Multiple used in 2 places.'>arginfo_openssl_public_encrypt</a>)
<a id='L507' name='L507'></a> 507         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29771.html' title='Multiple used in 3 places.'>openssl_public_decrypt</a>,          <a href='../Y/10900.html' title='Multiple used in 2 places.'>arginfo_openssl_public_decrypt</a>)
<a id='L508' name='L508'></a> 508 
<a id='L509' name='L509'></a> 509         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29747.html' title='Multiple used in 3 places.'>openssl_get_md_methods</a>,          <a href='../Y/10881.html' title='Multiple used in 2 places.'>arginfo_openssl_get_md_methods</a>)
<a id='L510' name='L510'></a> 510         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29746.html' title='Multiple used in 3 places.'>openssl_get_cipher_methods</a>,      <a href='../Y/10880.html' title='Multiple used in 2 places.'>arginfo_openssl_get_cipher_methods</a>)
<a id='L511' name='L511'></a> 511 
<a id='L512' name='L512'></a> 512         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29739.html' title='Multiple used in 3 places.'>openssl_dh_compute_key</a>,          <a href='../Y/10875.html' title='Multiple used in 2 places.'>arginfo_openssl_dh_compute_key</a>)
<a id='L513' name='L513'></a> 513 
<a id='L514' name='L514'></a> 514         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29773.html' title='Multiple used in 3 places.'>openssl_random_pseudo_bytes</a>,     <a href='../Y/10902.html' title='Multiple used in 2 places.'>arginfo_openssl_random_pseudo_bytes</a>)
<a id='L515' name='L515'></a> 515         <a href='../S/1378.html#L342' title='Defined at 342 in main/php.h.'>PHP_FE</a>(<a href='../Y/29742.html' title='Multiple used in 3 places.'>openssl_error_string</a>, <a href='../Y/10878.html' title='Multiple used in 2 places.'>arginfo_openssl_error_string</a>)
<a id='L516' name='L516'></a> 516         <a href='../S/1378.html#L350' title='Defined at 350 in main/php.h.'>PHP_FE_END</a>
<a id='L517' name='L517'></a> 517 <em class='brace'>}</em>;
<a id='L518' name='L518'></a> 518 <em class='comment'>/* }}} */</em>
<a id='L519' name='L519'></a> 519 
<a id='L520' name='L520'></a> 520 <em class='comment'>/* {{{ openssl_module_entry</em>
<a id='L521' name='L521'></a> 521 <em class='comment'> */</em>
<a id='L522' name='L522'></a> 522 <a href='../S/1695.html#L70' title='Defined at 70 in Zend/zend_modules.h.'>zend_module_entry</a> <a href='../Y/29750.html' title='Multiple used in 3 places.'>openssl_module_entry</a> = <em class='brace'>{</em>
<a id='L523' name='L523'></a> 523         <a href='../S/1695.html#L44' title='Defined at 44 in Zend/zend_modules.h.'>STANDARD_MODULE_HEADER</a>,
<a id='L524' name='L524'></a> 524         "openssl",
<a id='L525' name='L525'></a> 525         <a href='../Y/29744.html' title='Multiple used in 2 places.'>openssl_functions</a>,
<a id='L526' name='L526'></a> 526         <a href='../S/1378.html#L365' title='Defined at 365 in main/php.h.'>PHP_MINIT</a>(<a href='../Y/29730.html' title='Multiple used in 17 places.'>openssl</a>),
<a id='L527' name='L527'></a> 527         <a href='../S/1378.html#L366' title='Defined at 366 in main/php.h.'>PHP_MSHUTDOWN</a>(<a href='../Y/29730.html' title='Multiple used in 17 places.'>openssl</a>),
<a id='L528' name='L528'></a> 528         <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>,
<a id='L529' name='L529'></a> 529         <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>,
<a id='L530' name='L530'></a> 530         <a href='../S/1378.html#L369' title='Defined at 369 in main/php.h.'>PHP_MINFO</a>(<a href='../Y/29730.html' title='Multiple used in 17 places.'>openssl</a>),
<a id='L531' name='L531'></a> 531         <a href='../S/852.html#L30' title='Defined at 30 in ext/openssl/php_openssl.h.'>PHP_OPENSSL_VERSION</a>,
<a id='L532' name='L532'></a> 532         <a href='../S/1695.html#L61' title='Defined at 61 in Zend/zend_modules.h.'>STANDARD_MODULE_PROPERTIES</a>
<a id='L533' name='L533'></a> 533 <em class='brace'>}</em>;
<a id='L534' name='L534'></a> 534 <em class='comment'>/* }}} */</em>
<a id='L535' name='L535'></a> 535 
<a id='L536' name='L536'></a> 536 <em class='sharp'>#ifdef</em> COMPILE_DL_OPENSSL
<a id='L537' name='L537'></a> 537 <a href='../D/16546.html' title='Multiple defined in 30 places.'>ZEND_GET_MODULE</a>(<a href='../Y/29730.html' title='Multiple used in 17 places.'>openssl</a>)
<a id='L538' name='L538'></a> 538 <em class='sharp'>#endif</em>
<a id='L539' name='L539'></a> 539 
<a id='L540' name='L540'></a> 540 <em class='comment'>/* number conversion flags checks */</em>
<a id='L541' name='L541'></a> 541 <em class='sharp'>#define</em> <a href='../R/7428.html' title='Multiple referred from 3 places.'>PHP_OPENSSL_CHECK_NUMBER_CONVERSION</a>(<a href='../Y/8141.html' title='Multiple used in 2 places.'>_cond</a>, <a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>) \
<a id='L542' name='L542'></a> 542         <strong class='reserved'>do</strong> <em class='brace'>{</em> \
<a id='L543' name='L543'></a> 543                 <strong class='reserved'>if</strong> (<a href='../Y/8141.html' title='Multiple used in 2 places.'>_cond</a>) <em class='brace'>{</em> \
<a id='L544' name='L544'></a> 544                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, #<a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>" is too long"); \
<a id='L545' name='L545'></a> 545                         <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>; \
<a id='L546' name='L546'></a> 546                 <em class='brace'>}</em> \
<a id='L547' name='L547'></a> 547         <em class='brace'>}</em> <strong class='reserved'>while</strong>(0)
<a id='L548' name='L548'></a> 548 <em class='comment'>/* check if size_t can be safely casted to int */</em>
<a id='L549' name='L549'></a> 549 <em class='sharp'>#define</em> <a href='../R/7429.html' title='Multiple referred from 17 places.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/8400.html' title='Multiple used in 6 places.'>_var</a>, <a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>) \
<a id='L550' name='L550'></a> 550         <a href='../S/851.html#L541' title='Defined at 541 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_NUMBER_CONVERSION</a>(<a href='../S/1711.html#L54' title='Defined at 54 in Zend/zend_range_check.h.'>ZEND_SIZE_T_INT_OVFL</a>(<a href='../Y/8400.html' title='Multiple used in 6 places.'>_var</a>), <a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>)
<a id='L551' name='L551'></a> 551 <em class='comment'>/* check if size_t can be safely casted to unsigned int */</em>
<a id='L552' name='L552'></a> 552 <em class='sharp'>#define</em> <a href='../S/851.html#L4856' title='Referred from 4856 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_UINT</a>(<a href='../Y/8400.html' title='Multiple used in 6 places.'>_var</a>, <a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>) \
<a id='L553' name='L553'></a> 553         <a href='../S/851.html#L541' title='Defined at 541 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_NUMBER_CONVERSION</a>(<a href='../D/17262.html' title='Multiple defined in 2 places.'>ZEND_SIZE_T_UINT_OVFL</a>(<a href='../Y/8400.html' title='Multiple used in 6 places.'>_var</a>), <a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>)
<a id='L554' name='L554'></a> 554 <em class='comment'>/* check if long can be safely casted to int */</em>
<a id='L555' name='L555'></a> 555 <em class='sharp'>#define</em> <a href='../R/7427.html' title='Multiple referred from 3 places.'>PHP_OPENSSL_CHECK_LONG_TO_INT</a>(<a href='../Y/8400.html' title='Multiple used in 6 places.'>_var</a>, <a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>) \
<a id='L556' name='L556'></a> 556         <a href='../S/851.html#L541' title='Defined at 541 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_NUMBER_CONVERSION</a>(<a href='../D/16870.html' title='Multiple defined in 2 places.'>ZEND_LONG_EXCEEDS_INT</a>(<a href='../Y/8400.html' title='Multiple used in 6 places.'>_var</a>), <a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>)
<a id='L557' name='L557'></a> 557 
<a id='L558' name='L558'></a> 558 
<a id='L559' name='L559'></a> 559 <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../Y/24897.html' title='Multiple used in 14 places.'>le_key</a>;
<a id='L560' name='L560'></a> 560 <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../Y/24937.html' title='Multiple used in 9 places.'>le_x509</a>;
<a id='L561' name='L561'></a> 561 <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../Y/24875.html' title='Multiple used in 4 places.'>le_csr</a>;
<a id='L562' name='L562'></a> 562 <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../Y/37061.html' title='Multiple used in 4 places.'>ssl_stream_data_index</a>;
<a id='L563' name='L563'></a> 563 
<a id='L564' name='L564'></a> 564 <strong class='reserved'>int</strong> <a href='../R/24305.html' title='Multiple referred from 3 places.'>php_openssl_get_x509_list_id</a>(<strong class='reserved'>void</strong>) <em class='comment'>/* {{{ */</em>
<a id='L565' name='L565'></a> 565 <em class='brace'>{</em>
<a id='L566' name='L566'></a> 566         <strong class='reserved'>return</strong> <a href='../Y/24937.html' title='Multiple used in 9 places.'>le_x509</a>;
<a id='L567' name='L567'></a> 567 <em class='brace'>}</em>
<a id='L568' name='L568'></a> 568 <em class='comment'>/* }}} */</em>
<a id='L569' name='L569'></a> 569 
<a id='L570' name='L570'></a> 570 <em class='comment'>/* {{{ resource destructors */</em>
<a id='L571' name='L571'></a> 571 <strong class='reserved'>static</strong> <strong class='reserved'>void</strong> <a href='../S/851.html#L1161' title='Referred from 1161 in ext/openssl/openssl.c.'>php_pkey_free</a>(<a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/35082.html' title='Multiple used in 154 places.'>rsrc</a>)
<a id='L572' name='L572'></a> 572 <em class='brace'>{</em>
<a id='L573' name='L573'></a> 573         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = (<a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *)<a href='../Y/35082.html' title='Multiple used in 154 places.'>rsrc</a>-&gt;<a href='../Y/33697.html' title='Multiple used in 2885 places.'>ptr</a>;
<a id='L574' name='L574'></a> 574 
<a id='L575' name='L575'></a> 575         <a href='../S/1378.html#L85' title='Defined at 85 in main/php.h.'>assert</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L576' name='L576'></a> 576 
<a id='L577' name='L577'></a> 577         <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L578' name='L578'></a> 578 <em class='brace'>}</em>
<a id='L579' name='L579'></a> 579 
<a id='L580' name='L580'></a> 580 <strong class='reserved'>static</strong> <strong class='reserved'>void</strong> <a href='../S/851.html#L1162' title='Referred from 1162 in ext/openssl/openssl.c.'>php_x509_free</a>(<a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/35082.html' title='Multiple used in 154 places.'>rsrc</a>)
<a id='L581' name='L581'></a> 581 <em class='brace'>{</em>
<a id='L582' name='L582'></a> 582         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> *<a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a> = (<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> *)<a href='../Y/35082.html' title='Multiple used in 154 places.'>rsrc</a>-&gt;<a href='../Y/33697.html' title='Multiple used in 2885 places.'>ptr</a>;
<a id='L583' name='L583'></a> 583         <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>);
<a id='L584' name='L584'></a> 584 <em class='brace'>}</em>
<a id='L585' name='L585'></a> 585 
<a id='L586' name='L586'></a> 586 <strong class='reserved'>static</strong> <strong class='reserved'>void</strong> <a href='../S/851.html#L1163' title='Referred from 1163 in ext/openssl/openssl.c.'>php_csr_free</a>(<a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/35082.html' title='Multiple used in 154 places.'>rsrc</a>)
<a id='L587' name='L587'></a> 587 <em class='brace'>{</em>
<a id='L588' name='L588'></a> 588         <a href='../Y/7405.html' title='Multiple used in 12 places.'>X509_REQ</a> * <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> = (<a href='../Y/7405.html' title='Multiple used in 12 places.'>X509_REQ</a>*)<a href='../Y/35082.html' title='Multiple used in 154 places.'>rsrc</a>-&gt;<a href='../Y/33697.html' title='Multiple used in 2885 places.'>ptr</a>;
<a id='L589' name='L589'></a> 589         <a href='../Y/7407.html' title='Multiple used in 5 places.'>X509_REQ_free</a>(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>);
<a id='L590' name='L590'></a> 590 <em class='brace'>}</em>
<a id='L591' name='L591'></a> 591 <em class='comment'>/* }}} */</em>
<a id='L592' name='L592'></a> 592 
<a id='L593' name='L593'></a> 593 <em class='comment'>/* {{{ openssl open_basedir check */</em>
<a id='L594' name='L594'></a> 594 <strong class='reserved'>inline</strong> <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../R/24311.html' title='Multiple referred from 15 places.'>php_openssl_open_base_dir_chk</a>(<strong class='reserved'>char</strong> *<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>)
<a id='L595' name='L595'></a> 595 <em class='brace'>{</em>
<a id='L596' name='L596'></a> 596         <strong class='reserved'>if</strong> (<a href='../S/1368.html#L277' title='Defined at 277 in main/fopen_wrappers.c.'>php_check_open_basedir</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>)) <em class='brace'>{</em>
<a id='L597' name='L597'></a> 597                 <strong class='reserved'>return</strong> -1;
<a id='L598' name='L598'></a> 598         <em class='brace'>}</em>
<a id='L599' name='L599'></a> 599 
<a id='L600' name='L600'></a> 600         <strong class='reserved'>return</strong> 0;
<a id='L601' name='L601'></a> 601 <em class='brace'>}</em>
<a id='L602' name='L602'></a> 602 <em class='comment'>/* }}} */</em>
<a id='L603' name='L603'></a> 603 
<a id='L604' name='L604'></a> 604 <a href='../S/1397.html#L100' title='Defined at 100 in main/php_streams.h.'>php_stream</a>* <a href='../R/24304.html' title='Multiple referred from 2 places.'>php_openssl_get_stream_from_ssl_handle</a>(<strong class='reserved'>const</strong> <a href='../Y/6145.html' title='Multiple used in 17 places.'>SSL</a> *<a href='../S/800.html#L863' title='Defined at 863 in ext/mysqlnd/mysqlnd_structs.h.'>ssl</a>)
<a id='L605' name='L605'></a> 605 <em class='brace'>{</em>
<a id='L606' name='L606'></a> 606         <strong class='reserved'>return</strong> (<a href='../S/1397.html#L100' title='Defined at 100 in main/php_streams.h.'>php_stream</a>*)<a href='../Y/6217.html' title='Multiple used in 3 places.'>SSL_get_ex_data</a>(<a href='../S/800.html#L863' title='Defined at 863 in ext/mysqlnd/mysqlnd_structs.h.'>ssl</a>, <a href='../Y/37061.html' title='Multiple used in 4 places.'>ssl_stream_data_index</a>);
<a id='L607' name='L607'></a> 607 <em class='brace'>}</em>
<a id='L608' name='L608'></a> 608 
<a id='L609' name='L609'></a> 609 <strong class='reserved'>int</strong> <a href='../R/24303.html' title='Multiple referred from 4 places.'>php_openssl_get_ssl_stream_data_index</a>()
<a id='L610' name='L610'></a> 610 <em class='brace'>{</em>
<a id='L611' name='L611'></a> 611         <strong class='reserved'>return</strong> <a href='../Y/37061.html' title='Multiple used in 4 places.'>ssl_stream_data_index</a>;
<a id='L612' name='L612'></a> 612 <em class='brace'>}</em>
<a id='L613' name='L613'></a> 613 
<a id='L614' name='L614'></a> 614 <em class='comment'>/* openssl -&gt; PHP "bridging" */</em>
<a id='L615' name='L615'></a> 615 <em class='comment'>/* true global; readonly after module startup */</em>
<a id='L616' name='L616'></a> 616 <strong class='reserved'>static</strong> <strong class='reserved'>char</strong> <a href='../Y/15465.html' title='Multiple used in 6 places.'>default_ssl_conf_filename</a>[<a href='../D/4806.html' title='Multiple defined in 9 places.'>MAXPATHLEN</a>];
<a id='L617' name='L617'></a> 617 
<a id='L618' name='L618'></a> 618 <strong class='reserved'>struct</strong> <a href='../R/25133.html' title='Multiple referred from 11 places.'>php_x509_request</a> <em class='brace'>{</em> <em class='comment'>/* {{{ */</em>
<a id='L619' name='L619'></a> 619 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &gt;= 0x10000002L
<a id='L620' name='L620'></a> 620         <a href='../Y/3829.html' title='Multiple used in 3 places.'>LHASH_OF</a>(<a href='../Y/554.html' title='Multiple used in 7 places.'>CONF_VALUE</a>) * <a href='../Y/19325.html' title='Multiple used in 6 places.'>global_config</a>;   <em class='comment'>/* Global SSL config */</em>
<a id='L621' name='L621'></a> 621         <a href='../Y/3829.html' title='Multiple used in 3 places.'>LHASH_OF</a>(<a href='../Y/554.html' title='Multiple used in 7 places.'>CONF_VALUE</a>) * <a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>;              <em class='comment'>/* SSL config for this request */</em>
<a id='L622' name='L622'></a> 622 <em class='sharp'>#else</em>
<a id='L623' name='L623'></a> 623         <a href='../Y/3828.html' title='Multiple used in 3 places.'>LHASH</a> * <a href='../Y/19325.html' title='Multiple used in 6 places.'>global_config</a>;  <em class='comment'>/* Global SSL config */</em>
<a id='L624' name='L624'></a> 624         <a href='../Y/3828.html' title='Multiple used in 3 places.'>LHASH</a> * <a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>;     <em class='comment'>/* SSL config for this request */</em>
<a id='L625' name='L625'></a> 625 <em class='sharp'>#endif</em>
<a id='L626' name='L626'></a> 626         <strong class='reserved'>const</strong> <a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> * <a href='../Y/26414.html' title='Multiple used in 4 places.'>md_alg</a>;
<a id='L627' name='L627'></a> 627         <strong class='reserved'>const</strong> <a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> * <a href='../Y/15696.html' title='Multiple used in 282 places.'>digest</a>;
<a id='L628' name='L628'></a> 628         <strong class='reserved'>char</strong>    * <a href='../Y/35586.html' title='Multiple used in 13 places.'>section_name</a>,
<a id='L629' name='L629'></a> 629                         * <a href='../Y/14275.html' title='Multiple used in 13 places.'>config_filename</a>,
<a id='L630' name='L630'></a> 630                         * <a href='../Y/15700.html' title='Multiple used in 6 places.'>digest_name</a>,
<a id='L631' name='L631'></a> 631                         * <a href='../Y/17394.html' title='Multiple used in 5 places.'>extensions_section</a>,
<a id='L632' name='L632'></a> 632                         * <a href='../Y/34572.html' title='Multiple used in 6 places.'>request_extensions_section</a>;
<a id='L633' name='L633'></a> 633         <strong class='reserved'>int</strong> <a href='../Y/33386.html' title='Multiple used in 10 places.'>priv_key_bits</a>;
<a id='L634' name='L634'></a> 634         <strong class='reserved'>int</strong> <a href='../Y/33389.html' title='Multiple used in 3 places.'>priv_key_type</a>;
<a id='L635' name='L635'></a> 635 
<a id='L636' name='L636'></a> 636         <strong class='reserved'>int</strong> <a href='../Y/33387.html' title='Multiple used in 7 places.'>priv_key_encrypt</a>;
<a id='L637' name='L637'></a> 637 
<a id='L638' name='L638'></a> 638         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>;
<a id='L639' name='L639'></a> 639 
<a id='L640' name='L640'></a> 640         <strong class='reserved'>const</strong> <a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a> * <a href='../Y/33388.html' title='Multiple used in 7 places.'>priv_key_encrypt_cipher</a>;
<a id='L641' name='L641'></a> 641 <em class='brace'>}</em>;
<a id='L642' name='L642'></a> 642 <em class='comment'>/* }}} */</em>
<a id='L643' name='L643'></a> 643 
<a id='L644' name='L644'></a> 644 <strong class='reserved'>static</strong> <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>, <strong class='reserved'>int</strong> <a href='../Y/25757.html' title='Multiple used in 8 places.'>makeresource</a>, <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> **<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a>);
<a id='L645' name='L645'></a> 645 <strong class='reserved'>static</strong> <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>, <strong class='reserved'>int</strong> <a href='../Y/33729.html' title='Multiple used in 21 places.'>public_key</a>, <strong class='reserved'>char</strong> * <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>, <strong class='reserved'>int</strong> <a href='../Y/25757.html' title='Multiple used in 8 places.'>makeresource</a>, <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> **<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a>);
<a id='L646' name='L646'></a> 646 <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../S/851.html#L3492' title='Defined at 3492 in ext/openssl/openssl.c.'>php_openssl_is_private_key</a>(<a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a>* <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L647' name='L647'></a> 647 <strong class='reserved'>static</strong> <a href='../Y/7417.html' title='Multiple used in 7 places.'>X509_STORE</a> * <a href='../S/851.html#L2240' title='Defined at 2240 in ext/openssl/openssl.c.'>setup_verify</a>(<a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/13242.html' title='Multiple used in 4 places.'>calist</a>);
<a id='L648' name='L648'></a> 648 <strong class='reserved'>static</strong> <a href='../R/10333.html' title='Multiple referred from 17 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) * <a href='../Y/25249.html' title='Multiple used in 5 places.'>load_all_certs_from_file</a>(<strong class='reserved'>char</strong> *<a href='../Y/13485.html' title='Multiple used in 12 places.'>certfile</a>);
<a id='L649' name='L649'></a> 649 <strong class='reserved'>static</strong> <a href='../Y/7405.html' title='Multiple used in 12 places.'>X509_REQ</a> * <a href='../S/851.html#L2807' title='Defined at 2807 in ext/openssl/openssl.c.'>php_openssl_csr_from_zval</a>(<a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>, <strong class='reserved'>int</strong> <a href='../Y/25757.html' title='Multiple used in 8 places.'>makeresource</a>, <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> ** <a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a>);
<a id='L650' name='L650'></a> 650 <strong class='reserved'>static</strong> <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../S/851.html#L3387' title='Defined at 3387 in ext/openssl/openssl.c.'>php_openssl_generate_private_key</a>(<strong class='reserved'>struct</strong> <a href='../S/851.html#L618' title='Defined at 618 in ext/openssl/openssl.c.'>php_x509_request</a> * <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>);
<a id='L651' name='L651'></a> 651 
<a id='L652' name='L652'></a> 652 <strong class='reserved'>static</strong> <strong class='reserved'>void</strong> <a href='../Y/8825.html' title='Multiple used in 4 places.'>add_assoc_name_entry</a>(<a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>, <strong class='reserved'>char</strong> * <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, <a href='../S/853.html#L50' title='Defined at 50 in ext/openssl/xp_ssl.c.'>X509_NAME</a> * <a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>, <strong class='reserved'>int</strong> <a href='../Y/36082.html' title='Multiple used in 3 places.'>shortname</a>) <em class='comment'>/* {{{ */</em>
<a id='L653' name='L653'></a> 653 <em class='brace'>{</em>
<a id='L654' name='L654'></a> 654         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>;
<a id='L655' name='L655'></a> 655         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> <a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>, <a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>;
<a id='L656' name='L656'></a> 656         <strong class='reserved'>int</strong> <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>;
<a id='L657' name='L657'></a> 657         <strong class='reserved'>char</strong> *<a href='../Y/36355.html' title='Multiple used in 28 places.'>sname</a>;
<a id='L658' name='L658'></a> 658         <strong class='reserved'>int</strong> <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>;
<a id='L659' name='L659'></a> 659         X509_NAME_ENTRY * <a href='../Y/28055.html' title='Multiple used in 12 places.'>ne</a>;
<a id='L660' name='L660'></a> 660         <a href='../Y/121.html' title='Multiple used in 3 places.'>ASN1_STRING</a> * <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L661' name='L661'></a> 661         <a href='../Y/119.html' title='Multiple used in 2 places.'>ASN1_OBJECT</a> * <a href='../Y/29030.html' title='Multiple used in 1907 places.'>obj</a>;
<a id='L662' name='L662'></a> 662 
<a id='L663' name='L663'></a> 663         <strong class='reserved'>if</strong> (<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L664' name='L664'></a> 664                 <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(&amp;<a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>);
<a id='L665' name='L665'></a> 665         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L666' name='L666'></a> 666                 <a href='../S/1731.html#L848' title='Defined at 848 in Zend/zend_types.h.'>ZVAL_COPY_VALUE</a>(&amp;<a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>, <a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>);
<a id='L667' name='L667'></a> 667         <em class='brace'>}</em>
<a id='L668' name='L668'></a> 668 
<a id='L669' name='L669'></a> 669         <strong class='reserved'>for</strong> (<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> = 0; <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> &lt; <a href='../Y/7387.html' title='Multiple used in 2 places.'>X509_NAME_entry_count</a>(<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>); <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>++) <em class='brace'>{</em>
<a id='L670' name='L670'></a> 670                 <strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *<a href='../Y/38737.html' title='Multiple used in 6 places.'>to_add</a>;
<a id='L671' name='L671'></a> 671                 <strong class='reserved'>int</strong> <a href='../Y/38738.html' title='Multiple used in 7 places.'>to_add_len</a> = 0;
<a id='L672' name='L672'></a> 672 
<a id='L673' name='L673'></a> 673 
<a id='L674' name='L674'></a> 674                 <a href='../Y/28055.html' title='Multiple used in 12 places.'>ne</a> = <a href='../Y/7388.html' title='Multiple used in 2 places.'>X509_NAME_get_entry</a>(<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>, <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>);
<a id='L675' name='L675'></a> 675                 <a href='../Y/29030.html' title='Multiple used in 1907 places.'>obj</a> = X509_NAME_ENTRY_get_object(<a href='../Y/28055.html' title='Multiple used in 12 places.'>ne</a>);
<a id='L676' name='L676'></a> 676                 <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a> = <a href='../Y/4352.html' title='Multiple used in 4 places.'>OBJ_obj2nid</a>(<a href='../Y/29030.html' title='Multiple used in 1907 places.'>obj</a>);
<a id='L677' name='L677'></a> 677 
<a id='L678' name='L678'></a> 678                 <strong class='reserved'>if</strong> (<a href='../Y/36082.html' title='Multiple used in 3 places.'>shortname</a>) <em class='brace'>{</em>
<a id='L679' name='L679'></a> 679                         <a href='../Y/36355.html' title='Multiple used in 28 places.'>sname</a> = (<strong class='reserved'>char</strong> *) <a href='../Y/4351.html' title='Multiple used in 4 places.'>OBJ_nid2sn</a>(<a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>);
<a id='L680' name='L680'></a> 680                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L681' name='L681'></a> 681                         <a href='../Y/36355.html' title='Multiple used in 28 places.'>sname</a> = (<strong class='reserved'>char</strong> *) <a href='../Y/4349.html' title='Multiple used in 2 places.'>OBJ_nid2ln</a>(<a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>);
<a id='L682' name='L682'></a> 682                 <em class='brace'>}</em>
<a id='L683' name='L683'></a> 683 
<a id='L684' name='L684'></a> 684                 <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> = <a href='../Y/7383.html' title='Multiple used in 2 places.'>X509_NAME_ENTRY_get_data</a>(<a href='../Y/28055.html' title='Multiple used in 12 places.'>ne</a>);
<a id='L685' name='L685'></a> 685                 <strong class='reserved'>if</strong> (<a href='../Y/127.html' title='Multiple used in 5 places.'>ASN1_STRING_type</a>(<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>) != V_ASN1_UTF8STRING) <em class='brace'>{</em>
<a id='L686' name='L686'></a> 686                         <a href='../Y/38738.html' title='Multiple used in 7 places.'>to_add_len</a> = <a href='../Y/126.html' title='Multiple used in 3 places.'>ASN1_STRING_to_UTF8</a>(&amp;<a href='../Y/38737.html' title='Multiple used in 6 places.'>to_add</a>, <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>);
<a id='L687' name='L687'></a> 687                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L688' name='L688'></a> 688                         <a href='../Y/38737.html' title='Multiple used in 6 places.'>to_add</a> = <a href='../Y/122.html' title='Multiple used in 7 places.'>ASN1_STRING_data</a>(<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>);
<a id='L689' name='L689'></a> 689                         <a href='../Y/38738.html' title='Multiple used in 7 places.'>to_add_len</a> = <a href='../Y/123.html' title='Multiple used in 9 places.'>ASN1_STRING_length</a>(<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>);
<a id='L690' name='L690'></a> 690                 <em class='brace'>}</em>
<a id='L691' name='L691'></a> 691 
<a id='L692' name='L692'></a> 692                 <strong class='reserved'>if</strong> (<a href='../Y/38738.html' title='Multiple used in 7 places.'>to_add_len</a> != -1) <em class='brace'>{</em>
<a id='L693' name='L693'></a> 693                         <strong class='reserved'>if</strong> ((<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a> = <a href='../S/1667.html#L1987' title='Defined at 1987 in Zend/zend_hash.c.'>zend_hash_str_find</a>(<a href='../S/1731.html#L527' title='Defined at 527 in Zend/zend_types.h.'>Z_ARRVAL</a>(<a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>), <a href='../Y/36355.html' title='Multiple used in 28 places.'>sname</a>, <a href='../S/868.html#L369' title='Defined at 369 in ext/pcre/pcrelib/pcre_internal.h.'>strlen</a>(<a href='../Y/36355.html' title='Multiple used in 28 places.'>sname</a>))) != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L694' name='L694'></a> 694                                 <strong class='reserved'>if</strong> (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>) == <a href='../S/1731.html#L309' title='Defined at 309 in Zend/zend_types.h.'>IS_ARRAY</a>) <em class='brace'>{</em>
<a id='L695' name='L695'></a> 695                                         <a href='../S/1631.html#L1556' title='Defined at 1556 in Zend/zend_API.c.'>add_next_index_stringl</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, (<strong class='reserved'>char</strong> *)<a href='../Y/38737.html' title='Multiple used in 6 places.'>to_add</a>, <a href='../Y/38738.html' title='Multiple used in 7 places.'>to_add_len</a>);
<a id='L696' name='L696'></a> 696                                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong> (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>) == <a href='../S/1731.html#L308' title='Defined at 308 in Zend/zend_types.h.'>IS_STRING</a>) <em class='brace'>{</em>
<a id='L697' name='L697'></a> 697                                         <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(&amp;<a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>);
<a id='L698' name='L698'></a> 698                                         <a href='../S/1631.html#L1538' title='Defined at 1538 in Zend/zend_API.c.'>add_next_index_str</a>(&amp;<a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>, <a href='../S/1725.html#L164' title='Defined at 164 in Zend/zend_string.h.'>zend_string_copy</a>(<a href='../S/1731.html#L513' title='Defined at 513 in Zend/zend_types.h.'>Z_STR_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>)));
<a id='L699' name='L699'></a> 699                                         <a href='../S/1631.html#L1556' title='Defined at 1556 in Zend/zend_API.c.'>add_next_index_stringl</a>(&amp;<a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>, (<strong class='reserved'>char</strong> *)<a href='../Y/38737.html' title='Multiple used in 6 places.'>to_add</a>, <a href='../Y/38738.html' title='Multiple used in 7 places.'>to_add_len</a>);
<a id='L700' name='L700'></a> 700                                         <a href='../S/1668.html#L91' title='Defined at 91 in Zend/zend_hash.h.'>zend_hash_str_update</a>(<a href='../S/1731.html#L527' title='Defined at 527 in Zend/zend_types.h.'>Z_ARRVAL</a>(<a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>), <a href='../Y/36355.html' title='Multiple used in 28 places.'>sname</a>, <a href='../S/868.html#L369' title='Defined at 369 in ext/pcre/pcrelib/pcre_internal.h.'>strlen</a>(<a href='../Y/36355.html' title='Multiple used in 28 places.'>sname</a>), &amp;<a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>);
<a id='L701' name='L701'></a> 701                                 <em class='brace'>}</em>
<a id='L702' name='L702'></a> 702                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L703' name='L703'></a> 703                                 <a href='../S/1632.html#L407' title='Defined at 407 in Zend/zend_API.h.'>add_assoc_stringl</a>(&amp;<a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>, <a href='../Y/36355.html' title='Multiple used in 28 places.'>sname</a>, (<strong class='reserved'>char</strong> *)<a href='../Y/38737.html' title='Multiple used in 6 places.'>to_add</a>, <a href='../Y/38738.html' title='Multiple used in 7 places.'>to_add_len</a>);
<a id='L704' name='L704'></a> 704                         <em class='brace'>}</em>
<a id='L705' name='L705'></a> 705                 <em class='brace'>}</em>
<a id='L706' name='L706'></a> 706         <em class='brace'>}</em>
<a id='L707' name='L707'></a> 707         <strong class='reserved'>if</strong> (<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L708' name='L708'></a> 708                 <a href='../S/1668.html#L91' title='Defined at 91 in Zend/zend_hash.h.'>zend_hash_str_update</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>), <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, <a href='../S/868.html#L369' title='Defined at 369 in ext/pcre/pcrelib/pcre_internal.h.'>strlen</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>), &amp;<a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>);
<a id='L709' name='L709'></a> 709         <em class='brace'>}</em>
<a id='L710' name='L710'></a> 710 <em class='brace'>}</em>
<a id='L711' name='L711'></a> 711 <em class='comment'>/* }}} */</em>
<a id='L712' name='L712'></a> 712 
<a id='L713' name='L713'></a> 713 <strong class='reserved'>static</strong> <strong class='reserved'>void</strong> <a href='../R/16672.html' title='Multiple referred from 3 places.'>add_assoc_asn1_string</a>(<a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>, <strong class='reserved'>char</strong> * <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, <a href='../Y/121.html' title='Multiple used in 3 places.'>ASN1_STRING</a> * <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>) <em class='comment'>/* {{{ */</em>
<a id='L714' name='L714'></a> 714 <em class='brace'>{</em>
<a id='L715' name='L715'></a> 715         <a href='../S/1632.html#L407' title='Defined at 407 in Zend/zend_API.h.'>add_assoc_stringl</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, (<strong class='reserved'>char</strong> *)<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>-&gt;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>-&gt;<a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>);
<a id='L716' name='L716'></a> 716 <em class='brace'>}</em>
<a id='L717' name='L717'></a> 717 <em class='comment'>/* }}} */</em>
<a id='L718' name='L718'></a> 718 
<a id='L719' name='L719'></a> 719 <strong class='reserved'>static</strong> <a href='../Y/38483.html' title='Multiple used in 174 places.'>time_t</a> <a href='../R/17013.html' title='Multiple referred from 2 places.'>asn1_time_to_time_t</a>(ASN1_UTCTIME * <a href='../Y/38521.html' title='Multiple used in 11 places.'>timestr</a>) <em class='comment'>/* {{{ */</em>
<a id='L720' name='L720'></a> 720 <em class='brace'>{</em>
<a id='L721' name='L721'></a> 721 <em class='comment'>/*</em>
<a id='L722' name='L722'></a> 722 <em class='comment'>        This is how the time string is formatted:</em>
<a id='L723' name='L723'></a> 723 <em class='comment'></em>
<a id='L724' name='L724'></a> 724 <em class='comment'>   snprintf(p, sizeof(p), "%02d%02d%02d%02d%02d%02dZ",ts-&gt;tm_year%100,</em>
<a id='L725' name='L725'></a> 725 <em class='comment'>      ts-&gt;tm_mon+1,ts-&gt;tm_mday,ts-&gt;tm_hour,ts-&gt;tm_min,ts-&gt;tm_sec);</em>
<a id='L726' name='L726'></a> 726 <em class='comment'>*/</em>
<a id='L727' name='L727'></a> 727 
<a id='L728' name='L728'></a> 728         <a href='../Y/38483.html' title='Multiple used in 174 places.'>time_t</a> <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a>;
<a id='L729' name='L729'></a> 729         <strong class='reserved'>struct</strong> <a href='../Y/38567.html' title='Multiple used in 223 places.'>tm</a> <a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>;
<a id='L730' name='L730'></a> 730         <strong class='reserved'>char</strong> * <a href='../Y/37556.html' title='Multiple used in 4 places.'>strbuf</a>;
<a id='L731' name='L731'></a> 731         <strong class='reserved'>char</strong> * <a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a>;
<a id='L732' name='L732'></a> 732         <strong class='reserved'>long</strong> <a href='../Y/19355.html' title='Multiple used in 4 places.'>gmadjust</a> = 0;
<a id='L733' name='L733'></a> 733 
<a id='L734' name='L734'></a> 734         <strong class='reserved'>if</strong> (<a href='../Y/127.html' title='Multiple used in 5 places.'>ASN1_STRING_type</a>(<a href='../Y/38521.html' title='Multiple used in 11 places.'>timestr</a>) != <a href='../Y/7158.html' title='Multiple used in 2 places.'>V_ASN1_UTCTIME</a> &amp;&amp; <a href='../Y/127.html' title='Multiple used in 5 places.'>ASN1_STRING_type</a>(<a href='../Y/38521.html' title='Multiple used in 11 places.'>timestr</a>) != <a href='../Y/7157.html' title='Multiple used in 3 places.'>V_ASN1_GENERALIZEDTIME</a>) <em class='brace'>{</em>
<a id='L735' name='L735'></a> 735                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "illegal ASN1 data type for timestamp");
<a id='L736' name='L736'></a> 736                 <strong class='reserved'>return</strong> (<a href='../Y/38483.html' title='Multiple used in 174 places.'>time_t</a>)-1;
<a id='L737' name='L737'></a> 737         <em class='brace'>}</em>
<a id='L738' name='L738'></a> 738 
<a id='L739' name='L739'></a> 739         <strong class='reserved'>if</strong> (<a href='../Y/123.html' title='Multiple used in 9 places.'>ASN1_STRING_length</a>(<a href='../Y/38521.html' title='Multiple used in 11 places.'>timestr</a>) != <a href='../S/868.html#L369' title='Defined at 369 in ext/pcre/pcrelib/pcre_internal.h.'>strlen</a>((<strong class='reserved'>const</strong> <strong class='reserved'>char</strong>*)<a href='../Y/122.html' title='Multiple used in 7 places.'>ASN1_STRING_data</a>(<a href='../Y/38521.html' title='Multiple used in 11 places.'>timestr</a>))) <em class='brace'>{</em>
<a id='L740' name='L740'></a> 740                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "illegal length in timestamp");
<a id='L741' name='L741'></a> 741                 <strong class='reserved'>return</strong> (<a href='../Y/38483.html' title='Multiple used in 174 places.'>time_t</a>)-1;
<a id='L742' name='L742'></a> 742         <em class='brace'>}</em>
<a id='L743' name='L743'></a> 743 
<a id='L744' name='L744'></a> 744         <strong class='reserved'>if</strong> (<a href='../Y/123.html' title='Multiple used in 9 places.'>ASN1_STRING_length</a>(<a href='../Y/38521.html' title='Multiple used in 11 places.'>timestr</a>) &lt; 13) <em class='brace'>{</em>
<a id='L745' name='L745'></a> 745                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "unable to parse time string %s correctly", <a href='../Y/38521.html' title='Multiple used in 11 places.'>timestr</a>-&gt;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>);
<a id='L746' name='L746'></a> 746                 <strong class='reserved'>return</strong> (<a href='../Y/38483.html' title='Multiple used in 174 places.'>time_t</a>)-1;
<a id='L747' name='L747'></a> 747         <em class='brace'>}</em>
<a id='L748' name='L748'></a> 748 
<a id='L749' name='L749'></a> 749         <strong class='reserved'>if</strong> (<a href='../Y/127.html' title='Multiple used in 5 places.'>ASN1_STRING_type</a>(<a href='../Y/38521.html' title='Multiple used in 11 places.'>timestr</a>) == <a href='../Y/7157.html' title='Multiple used in 3 places.'>V_ASN1_GENERALIZEDTIME</a> &amp;&amp; <a href='../Y/123.html' title='Multiple used in 9 places.'>ASN1_STRING_length</a>(<a href='../Y/38521.html' title='Multiple used in 11 places.'>timestr</a>) &lt; 15) <em class='brace'>{</em>
<a id='L750' name='L750'></a> 750                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "unable to parse time string %s correctly", <a href='../Y/38521.html' title='Multiple used in 11 places.'>timestr</a>-&gt;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>);
<a id='L751' name='L751'></a> 751                 <strong class='reserved'>return</strong> (<a href='../Y/38483.html' title='Multiple used in 174 places.'>time_t</a>)-1;
<a id='L752' name='L752'></a> 752         <em class='brace'>}</em>
<a id='L753' name='L753'></a> 753 
<a id='L754' name='L754'></a> 754         <a href='../Y/37556.html' title='Multiple used in 4 places.'>strbuf</a> = <a href='../S/1629.html#L172' title='Defined at 172 in Zend/zend_alloc.h.'>estrdup</a>((<strong class='reserved'>char</strong> *)<a href='../Y/122.html' title='Multiple used in 7 places.'>ASN1_STRING_data</a>(<a href='../Y/38521.html' title='Multiple used in 11 places.'>timestr</a>));
<a id='L755' name='L755'></a> 755 
<a id='L756' name='L756'></a> 756         <a href='../S/868.html#L374' title='Defined at 374 in ext/pcre/pcrelib/pcre_internal.h.'>memset</a>(&amp;<a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>, 0, <strong class='reserved'>sizeof</strong>(<a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>));
<a id='L757' name='L757'></a> 757 
<a id='L758' name='L758'></a> 758         <em class='comment'>/* we work backwards so that we can use atoi more easily */</em>
<a id='L759' name='L759'></a> 759 
<a id='L760' name='L760'></a> 760         <a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a> = <a href='../Y/37556.html' title='Multiple used in 4 places.'>strbuf</a> + <a href='../Y/123.html' title='Multiple used in 9 places.'>ASN1_STRING_length</a>(<a href='../Y/38521.html' title='Multiple used in 11 places.'>timestr</a>) - 3;
<a id='L761' name='L761'></a> 761 
<a id='L762' name='L762'></a> 762         <a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>.<a href='../Y/38577.html' title='Multiple used in 29 places.'>tm_sec</a> = <a href='../Y/12071.html' title='Multiple used in 124 places.'>atoi</a>(<a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a>);
<a id='L763' name='L763'></a> 763         *<a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a> = '\0';
<a id='L764' name='L764'></a> 764         <a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a> -= 2;
<a id='L765' name='L765'></a> 765         <a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>.<a href='../Y/38574.html' title='Multiple used in 27 places.'>tm_min</a> = <a href='../Y/12071.html' title='Multiple used in 124 places.'>atoi</a>(<a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a>);
<a id='L766' name='L766'></a> 766         *<a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a> = '\0';
<a id='L767' name='L767'></a> 767         <a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a> -= 2;
<a id='L768' name='L768'></a> 768         <a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>.<a href='../Y/38571.html' title='Multiple used in 27 places.'>tm_hour</a> = <a href='../Y/12071.html' title='Multiple used in 124 places.'>atoi</a>(<a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a>);
<a id='L769' name='L769'></a> 769         *<a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a> = '\0';
<a id='L770' name='L770'></a> 770         <a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a> -= 2;
<a id='L771' name='L771'></a> 771         <a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>.<a href='../Y/38573.html' title='Multiple used in 28 places.'>tm_mday</a> = <a href='../Y/12071.html' title='Multiple used in 124 places.'>atoi</a>(<a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a>);
<a id='L772' name='L772'></a> 772         *<a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a> = '\0';
<a id='L773' name='L773'></a> 773         <a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a> -= 2;
<a id='L774' name='L774'></a> 774         <a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>.<a href='../Y/38575.html' title='Multiple used in 34 places.'>tm_mon</a> = <a href='../Y/12071.html' title='Multiple used in 124 places.'>atoi</a>(<a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a>)-1;
<a id='L775' name='L775'></a> 775 
<a id='L776' name='L776'></a> 776         *<a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a> = '\0';
<a id='L777' name='L777'></a> 777         <strong class='reserved'>if</strong>( <a href='../Y/127.html' title='Multiple used in 5 places.'>ASN1_STRING_type</a>(<a href='../Y/38521.html' title='Multiple used in 11 places.'>timestr</a>) == <a href='../Y/7158.html' title='Multiple used in 2 places.'>V_ASN1_UTCTIME</a> ) <em class='brace'>{</em>
<a id='L778' name='L778'></a> 778                 <a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a> -= 2;
<a id='L779' name='L779'></a> 779                 <a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>.<a href='../Y/38580.html' title='Multiple used in 41 places.'>tm_year</a> = <a href='../Y/12071.html' title='Multiple used in 124 places.'>atoi</a>(<a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a>);
<a id='L780' name='L780'></a> 780 
<a id='L781' name='L781'></a> 781                 <strong class='reserved'>if</strong> (<a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>.<a href='../Y/38580.html' title='Multiple used in 41 places.'>tm_year</a> &lt; 68) <em class='brace'>{</em>
<a id='L782' name='L782'></a> 782                         <a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>.<a href='../Y/38580.html' title='Multiple used in 41 places.'>tm_year</a> += 100;
<a id='L783' name='L783'></a> 783                 <em class='brace'>}</em>
<a id='L784' name='L784'></a> 784         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>( <a href='../Y/127.html' title='Multiple used in 5 places.'>ASN1_STRING_type</a>(<a href='../Y/38521.html' title='Multiple used in 11 places.'>timestr</a>) == <a href='../Y/7157.html' title='Multiple used in 3 places.'>V_ASN1_GENERALIZEDTIME</a> ) <em class='brace'>{</em>
<a id='L785' name='L785'></a> 785                 <a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a> -= 4;
<a id='L786' name='L786'></a> 786                 <a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>.<a href='../Y/38580.html' title='Multiple used in 41 places.'>tm_year</a> = <a href='../Y/12071.html' title='Multiple used in 124 places.'>atoi</a>(<a href='../Y/38306.html' title='Multiple used in 20 places.'>thestr</a>) - 1900;
<a id='L787' name='L787'></a> 787         <em class='brace'>}</em>
<a id='L788' name='L788'></a> 788 
<a id='L789' name='L789'></a> 789 
<a id='L790' name='L790'></a> 790         <a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>.<a href='../Y/38572.html' title='Multiple used in 19 places.'>tm_isdst</a> = -1;
<a id='L791' name='L791'></a> 791         <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a> = <a href='../Y/26661.html' title='Multiple used in 14 places.'>mktime</a>(&amp;<a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>);
<a id='L792' name='L792'></a> 792 
<a id='L793' name='L793'></a> 793 <em class='sharp'>#if</em> <a href='../Y/3114.html' title='Multiple used in 4 places.'>HAVE_TM_GMTOFF</a>
<a id='L794' name='L794'></a> 794         <a href='../Y/19355.html' title='Multiple used in 4 places.'>gmadjust</a> = <a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>.<a href='../Y/38570.html' title='Multiple used in 5 places.'>tm_gmtoff</a>;
<a id='L795' name='L795'></a> 795 <em class='sharp'>#else</em>
<a id='L796' name='L796'></a> 796         <em class='comment'>/*</em>
<a id='L797' name='L797'></a> 797 <em class='comment'>        ** If correcting for daylight savings time, we set the adjustment to</em>
<a id='L798' name='L798'></a> 798 <em class='comment'>        ** the value of timezone - 3600 seconds. Otherwise, we need to overcorrect and</em>
<a id='L799' name='L799'></a> 799 <em class='comment'>        ** set the adjustment to the main timezone + 3600 seconds.</em>
<a id='L800' name='L800'></a> 800 <em class='comment'>        */</em>
<a id='L801' name='L801'></a> 801         <a href='../Y/19355.html' title='Multiple used in 4 places.'>gmadjust</a> = -(<a href='../Y/38307.html' title='Multiple used in 15 places.'>thetime</a>.<a href='../Y/38572.html' title='Multiple used in 19 places.'>tm_isdst</a> ? (<strong class='reserved'>long</strong>)<a href='../D/32002.html' title='Multiple defined in 2 places.'>timezone</a> - 3600 : (<strong class='reserved'>long</strong>)<a href='../D/32002.html' title='Multiple defined in 2 places.'>timezone</a> + 3600);
<a id='L802' name='L802'></a> 802 <em class='sharp'>#endif</em>
<a id='L803' name='L803'></a> 803         <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a> += <a href='../Y/19355.html' title='Multiple used in 4 places.'>gmadjust</a>;
<a id='L804' name='L804'></a> 804 
<a id='L805' name='L805'></a> 805         <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/37556.html' title='Multiple used in 4 places.'>strbuf</a>);
<a id='L806' name='L806'></a> 806 
<a id='L807' name='L807'></a> 807         <strong class='reserved'>return</strong> <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a>;
<a id='L808' name='L808'></a> 808 <em class='brace'>}</em>
<a id='L809' name='L809'></a> 809 <em class='comment'>/* }}} */</em>
<a id='L810' name='L810'></a> 810 
<a id='L811' name='L811'></a> 811 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &gt;= 0x10000002L
<a id='L812' name='L812'></a> 812 <strong class='reserved'>static</strong> <strong class='reserved'>inline</strong> <strong class='reserved'>int</strong> <a href='../R/24295.html' title='Multiple referred from 2 places.'>php_openssl_config_check_syntax</a>(<strong class='reserved'>const</strong> <strong class='reserved'>char</strong> * <a href='../Y/35585.html' title='Multiple used in 3 places.'>section_label</a>, <strong class='reserved'>const</strong> <strong class='reserved'>char</strong> * <a href='../Y/14275.html' title='Multiple used in 13 places.'>config_filename</a>, <strong class='reserved'>const</strong> <strong class='reserved'>char</strong> * <a href='../Y/35582.html' title='Multiple used in 25 places.'>section</a>, <a href='../Y/3829.html' title='Multiple used in 3 places.'>LHASH_OF</a>(<a href='../Y/554.html' title='Multiple used in 7 places.'>CONF_VALUE</a>) * <a href='../Y/14272.html' title='Multiple used in 462 places.'>config</a>) <em class='comment'>/* {{{ */</em>
<a id='L813' name='L813'></a> 813 <em class='sharp'>#else</em>
<a id='L814' name='L814'></a> 814 <strong class='reserved'>static</strong> <strong class='reserved'>inline</strong> <strong class='reserved'>int</strong> <a href='../S/851.html#L812' title='Defined at 812 in ext/openssl/openssl.c.'>php_openssl_config_check_syntax</a>(<strong class='reserved'>const</strong> <strong class='reserved'>char</strong> * <a href='../Y/35585.html' title='Multiple used in 3 places.'>section_label</a>, <strong class='reserved'>const</strong> <strong class='reserved'>char</strong> * <a href='../Y/14275.html' title='Multiple used in 13 places.'>config_filename</a>, <strong class='reserved'>const</strong> <strong class='reserved'>char</strong> * <a href='../Y/35582.html' title='Multiple used in 25 places.'>section</a>, <a href='../Y/3828.html' title='Multiple used in 3 places.'>LHASH</a> * <a href='../Y/14272.html' title='Multiple used in 462 places.'>config</a>)
<a id='L815' name='L815'></a> 815 <em class='sharp'>#endif</em>
<a id='L816' name='L816'></a> 816 <em class='brace'>{</em>
<a id='L817' name='L817'></a> 817         <a href='../Y/7360.html' title='Multiple used in 3 places.'>X509V3_CTX</a> <a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>;
<a id='L818' name='L818'></a> 818 
<a id='L819' name='L819'></a> 819         X509V3_set_ctx_test(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>);
<a id='L820' name='L820'></a> 820         <a href='../Y/7366.html' title='Multiple used in 3 places.'>X509V3_set_conf_lhash</a>(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>, <a href='../Y/14272.html' title='Multiple used in 462 places.'>config</a>);
<a id='L821' name='L821'></a> 821         <strong class='reserved'>if</strong> (!<a href='../Y/7363.html' title='Multiple used in 2 places.'>X509V3_EXT_add_conf</a>(<a href='../Y/14272.html' title='Multiple used in 462 places.'>config</a>, &amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>, (<strong class='reserved'>char</strong> *)<a href='../Y/35582.html' title='Multiple used in 25 places.'>section</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>)) <em class='brace'>{</em>
<a id='L822' name='L822'></a> 822                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Error loading %s section %s of %s",
<a id='L823' name='L823'></a> 823                                 <a href='../Y/35585.html' title='Multiple used in 3 places.'>section_label</a>,
<a id='L824' name='L824'></a> 824                                 <a href='../Y/35582.html' title='Multiple used in 25 places.'>section</a>,
<a id='L825' name='L825'></a> 825                                 <a href='../Y/14275.html' title='Multiple used in 13 places.'>config_filename</a>);
<a id='L826' name='L826'></a> 826                 <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L827' name='L827'></a> 827         <em class='brace'>}</em>
<a id='L828' name='L828'></a> 828         <strong class='reserved'>return</strong> <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>;
<a id='L829' name='L829'></a> 829 <em class='brace'>}</em>
<a id='L830' name='L830'></a> 830 <em class='comment'>/* }}} */</em>
<a id='L831' name='L831'></a> 831 
<a id='L832' name='L832'></a> 832 <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../S/851.html#L922' title='Referred from 922 in ext/openssl/openssl.c.'>add_oid_section</a>(<strong class='reserved'>struct</strong> <a href='../S/851.html#L618' title='Defined at 618 in ext/openssl/openssl.c.'>php_x509_request</a> * <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>) <em class='comment'>/* {{{ */</em>
<a id='L833' name='L833'></a> 833 <em class='brace'>{</em>
<a id='L834' name='L834'></a> 834         <strong class='reserved'>char</strong> * <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>;
<a id='L835' name='L835'></a> 835         <a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/554.html' title='Multiple used in 7 places.'>CONF_VALUE</a>) * <a href='../Y/36312.html' title='Multiple used in 5 places.'>sktmp</a>;
<a id='L836' name='L836'></a> 836         <a href='../Y/554.html' title='Multiple used in 7 places.'>CONF_VALUE</a> * <a href='../Y/13950.html' title='Multiple used in 4 places.'>cnf</a>;
<a id='L837' name='L837'></a> 837         <strong class='reserved'>int</strong> <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>;
<a id='L838' name='L838'></a> 838 
<a id='L839' name='L839'></a> 839         <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> = <a href='../Y/558.html' title='Multiple used in 12 places.'>CONF_get_string</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, "oid_section");
<a id='L840' name='L840'></a> 840         <strong class='reserved'>if</strong> (<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L841' name='L841'></a> 841                 <strong class='reserved'>return</strong> <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>;
<a id='L842' name='L842'></a> 842         <em class='brace'>}</em>
<a id='L843' name='L843'></a> 843         <a href='../Y/36312.html' title='Multiple used in 5 places.'>sktmp</a> = <a href='../Y/557.html' title='Multiple used in 3 places.'>CONF_get_section</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>);
<a id='L844' name='L844'></a> 844         <strong class='reserved'>if</strong> (<a href='../Y/36312.html' title='Multiple used in 5 places.'>sktmp</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L845' name='L845'></a> 845                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "problem loading oid section %s", <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>);
<a id='L846' name='L846'></a> 846                 <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L847' name='L847'></a> 847         <em class='brace'>}</em>
<a id='L848' name='L848'></a> 848         <strong class='reserved'>for</strong> (<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> = 0; <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> &lt; <a href='../Y/36262.html' title='Multiple used in 3 places.'>sk_CONF_VALUE_num</a>(<a href='../Y/36312.html' title='Multiple used in 5 places.'>sktmp</a>); <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>++) <em class='brace'>{</em>
<a id='L849' name='L849'></a> 849                 <a href='../Y/13950.html' title='Multiple used in 4 places.'>cnf</a> = <a href='../Y/36263.html' title='Multiple used in 3 places.'>sk_CONF_VALUE_value</a>(<a href='../Y/36312.html' title='Multiple used in 5 places.'>sktmp</a>, <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>);
<a id='L850' name='L850'></a> 850                 <strong class='reserved'>if</strong> (OBJ_create(<a href='../Y/13950.html' title='Multiple used in 4 places.'>cnf</a>-&gt;<a href='../D/32633.html' title='Multiple defined in 3 places.'>value</a>, <a href='../Y/13950.html' title='Multiple used in 4 places.'>cnf</a>-&gt;<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>, <a href='../Y/13950.html' title='Multiple used in 4 places.'>cnf</a>-&gt;<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>) == <a href='../Y/4236.html' title='Multiple used in 6 places.'>NID_undef</a>) <em class='brace'>{</em>
<a id='L851' name='L851'></a> 851                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "problem creating object %s=%s", <a href='../Y/13950.html' title='Multiple used in 4 places.'>cnf</a>-&gt;<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>, <a href='../Y/13950.html' title='Multiple used in 4 places.'>cnf</a>-&gt;<a href='../D/32633.html' title='Multiple defined in 3 places.'>value</a>);
<a id='L852' name='L852'></a> 852                         <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L853' name='L853'></a> 853                 <em class='brace'>}</em>
<a id='L854' name='L854'></a> 854         <em class='brace'>}</em>
<a id='L855' name='L855'></a> 855         <strong class='reserved'>return</strong> <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>;
<a id='L856' name='L856'></a> 856 <em class='brace'>}</em>
<a id='L857' name='L857'></a> 857 <em class='comment'>/* }}} */</em>
<a id='L858' name='L858'></a> 858 
<a id='L859' name='L859'></a> 859 <em class='sharp'>#define</em> <a href='../R/7723.html' title='Multiple referred from 5 places.'>PHP_SSL_REQ_INIT</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>)           <a href='../S/868.html#L374' title='Defined at 374 in ext/pcre/pcrelib/pcre_internal.h.'>memset</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>, 0, <strong class='reserved'>sizeof</strong>(*<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>))
<a id='L860' name='L860'></a> 860 <em class='sharp'>#define</em> <a href='../R/7722.html' title='Multiple referred from 5 places.'>PHP_SSL_REQ_DISPOSE</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>)        <a href='../S/851.html#L992' title='Defined at 992 in ext/openssl/openssl.c.'>php_openssl_dispose_config</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>)
<a id='L861' name='L861'></a> 861 <em class='sharp'>#define</em> <a href='../R/7724.html' title='Multiple referred from 5 places.'>PHP_SSL_REQ_PARSE</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>, <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a>)    <a href='../S/851.html#L899' title='Defined at 899 in ext/openssl/openssl.c.'>php_openssl_parse_config</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>, <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a>)
<a id='L862' name='L862'></a> 862 
<a id='L863' name='L863'></a> 863 <em class='sharp'>#define</em> <a href='../R/7721.html' title='Multiple referred from 2 places.'>PHP_SSL_CONFIG_SYNTAX_CHECK</a>(<a href='../Y/40116.html' title='Multiple used in 3940 places.'>var</a>) <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/40116.html' title='Multiple used in 3940 places.'>var</a> &amp;&amp; <a href='../S/851.html#L812' title='Defined at 812 in ext/openssl/openssl.c.'>php_openssl_config_check_syntax</a>(#<a href='../Y/40116.html' title='Multiple used in 3940 places.'>var</a>, \
<a id='L864' name='L864'></a> 864                         <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/14275.html' title='Multiple used in 13 places.'>config_filename</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/40116.html' title='Multiple used in 3940 places.'>var</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>
<a id='L865' name='L865'></a> 865 
<a id='L866' name='L866'></a> 866 <em class='sharp'>#define</em> <a href='../R/9087.html' title='Multiple referred from 5 places.'>SET_OPTIONAL_STRING_ARG</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, <a href='../Y/40189.html' title='Multiple used in 342 places.'>varname</a>, <a href='../Y/15497.html' title='Multiple used in 15 places.'>defval</a>)   \
<a id='L867' name='L867'></a> 867                 <strong class='reserved'>if</strong> (<a href='../Y/29866.html' title='Multiple used in 5 places.'>optional_args</a> &amp;&amp; (<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a> = <a href='../S/1667.html#L1987' title='Defined at 1987 in Zend/zend_hash.c.'>zend_hash_str_find</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/29866.html' title='Multiple used in 5 places.'>optional_args</a>), <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, <strong class='reserved'>sizeof</strong>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>)-1)) != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>) == <a href='../S/1731.html#L308' title='Defined at 308 in Zend/zend_types.h.'>IS_STRING</a>) \
<a id='L868' name='L868'></a> 868                 <a href='../Y/40189.html' title='Multiple used in 342 places.'>varname</a> = <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>); \
<a id='L869' name='L869'></a> 869         <strong class='reserved'>else</strong> \
<a id='L870' name='L870'></a> 870                 <a href='../Y/40189.html' title='Multiple used in 342 places.'>varname</a> = <a href='../Y/15497.html' title='Multiple used in 15 places.'>defval</a>
<a id='L871' name='L871'></a> 871 
<a id='L872' name='L872'></a> 872 <em class='sharp'>#define</em> <a href='../R/9086.html' title='Multiple referred from 2 places.'>SET_OPTIONAL_LONG_ARG</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, <a href='../Y/40189.html' title='Multiple used in 342 places.'>varname</a>, <a href='../Y/15497.html' title='Multiple used in 15 places.'>defval</a>)     \
<a id='L873' name='L873'></a> 873         <strong class='reserved'>if</strong> (<a href='../Y/29866.html' title='Multiple used in 5 places.'>optional_args</a> &amp;&amp; (<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a> = <a href='../S/1667.html#L1987' title='Defined at 1987 in Zend/zend_hash.c.'>zend_hash_str_find</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/29866.html' title='Multiple used in 5 places.'>optional_args</a>), <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, <strong class='reserved'>sizeof</strong>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>)-1)) != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>) == <a href='../S/1731.html#L306' title='Defined at 306 in Zend/zend_types.h.'>IS_LONG</a>) \
<a id='L874' name='L874'></a> 874                 <a href='../Y/40189.html' title='Multiple used in 342 places.'>varname</a> = (<strong class='reserved'>int</strong>)<a href='../S/1731.html#L507' title='Defined at 507 in Zend/zend_types.h.'>Z_LVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>); \
<a id='L875' name='L875'></a> 875         <strong class='reserved'>else</strong> \
<a id='L876' name='L876'></a> 876                 <a href='../Y/40189.html' title='Multiple used in 342 places.'>varname</a> = <a href='../Y/15497.html' title='Multiple used in 15 places.'>defval</a>
<a id='L877' name='L877'></a> 877 
<a id='L878' name='L878'></a> 878 <strong class='reserved'>static</strong> <strong class='reserved'>const</strong> <a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a> * <a href='../S/851.html#L1105' title='Defined at 1105 in ext/openssl/openssl.c.'>php_openssl_get_evp_cipher_from_algo</a>(<a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/9053.html' title='Multiple used in 59 places.'>algo</a>);
<a id='L879' name='L879'></a> 879 
<a id='L880' name='L880'></a> 880 <em class='comment'>/* {{{ strip line endings from spkac */</em>
<a id='L881' name='L881'></a> 881 <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../R/22461.html' title='Multiple referred from 3 places.'>openssl_spki_cleanup</a>(<strong class='reserved'>const</strong> <strong class='reserved'>char</strong> *<a href='../Y/36955.html' title='Multiple used in 2297 places.'>src</a>, <strong class='reserved'>char</strong> *<a href='../Y/15598.html' title='Multiple used in 714 places.'>dest</a>)
<a id='L882' name='L882'></a> 882 <em class='brace'>{</em>
<a id='L883' name='L883'></a> 883         <strong class='reserved'>int</strong> <a href='../Y/34468.html' title='Multiple used in 14 places.'>removed</a> = 0;
<a id='L884' name='L884'></a> 884 
<a id='L885' name='L885'></a> 885         <strong class='reserved'>while</strong> (*<a href='../Y/36955.html' title='Multiple used in 2297 places.'>src</a>) <em class='brace'>{</em>
<a id='L886' name='L886'></a> 886                 <strong class='reserved'>if</strong> (*<a href='../Y/36955.html' title='Multiple used in 2297 places.'>src</a> != '\n' &amp;&amp; *<a href='../Y/36955.html' title='Multiple used in 2297 places.'>src</a> != '\r') <em class='brace'>{</em>
<a id='L887' name='L887'></a> 887                         *<a href='../Y/15598.html' title='Multiple used in 714 places.'>dest</a>++ = *<a href='../Y/36955.html' title='Multiple used in 2297 places.'>src</a>;
<a id='L888' name='L888'></a> 888                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L889' name='L889'></a> 889                         ++<a href='../Y/34468.html' title='Multiple used in 14 places.'>removed</a>;
<a id='L890' name='L890'></a> 890                 <em class='brace'>}</em>
<a id='L891' name='L891'></a> 891                 ++<a href='../Y/36955.html' title='Multiple used in 2297 places.'>src</a>;
<a id='L892' name='L892'></a> 892         <em class='brace'>}</em>
<a id='L893' name='L893'></a> 893         *<a href='../Y/15598.html' title='Multiple used in 714 places.'>dest</a> = 0;
<a id='L894' name='L894'></a> 894         <strong class='reserved'>return</strong> <a href='../Y/34468.html' title='Multiple used in 14 places.'>removed</a>;
<a id='L895' name='L895'></a> 895 <em class='brace'>}</em>
<a id='L896' name='L896'></a> 896 <em class='comment'>/* }}} */</em>
<a id='L897' name='L897'></a> 897 
<a id='L898' name='L898'></a> 898 
<a id='L899' name='L899'></a> 899 <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../S/851.html#L861' title='Referred from 861 in ext/openssl/openssl.c.'>php_openssl_parse_config</a>(<strong class='reserved'>struct</strong> <a href='../S/851.html#L618' title='Defined at 618 in ext/openssl/openssl.c.'>php_x509_request</a> * <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>, <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/29866.html' title='Multiple used in 5 places.'>optional_args</a>) <em class='comment'>/* {{{ */</em>
<a id='L900' name='L900'></a> 900 <em class='brace'>{</em>
<a id='L901' name='L901'></a> 901         <strong class='reserved'>char</strong> * <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>;
<a id='L902' name='L902'></a> 902         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>;
<a id='L903' name='L903'></a> 903 
<a id='L904' name='L904'></a> 904         <a href='../S/851.html#L866' title='Defined at 866 in ext/openssl/openssl.c.'>SET_OPTIONAL_STRING_ARG</a>("config", <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/14275.html' title='Multiple used in 13 places.'>config_filename</a>, <a href='../Y/15465.html' title='Multiple used in 6 places.'>default_ssl_conf_filename</a>);
<a id='L905' name='L905'></a> 905         <a href='../S/851.html#L866' title='Defined at 866 in ext/openssl/openssl.c.'>SET_OPTIONAL_STRING_ARG</a>("config_section_name", <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/35586.html' title='Multiple used in 13 places.'>section_name</a>, "req");
<a id='L906' name='L906'></a> 906         <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/19325.html' title='Multiple used in 6 places.'>global_config</a> = <a href='../Y/559.html' title='Multiple used in 2 places.'>CONF_load</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../Y/15465.html' title='Multiple used in 6 places.'>default_ssl_conf_filename</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L907' name='L907'></a> 907         <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a> = <a href='../Y/559.html' title='Multiple used in 2 places.'>CONF_load</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/14275.html' title='Multiple used in 13 places.'>config_filename</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L908' name='L908'></a> 908 
<a id='L909' name='L909'></a> 909         <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L910' name='L910'></a> 910                 <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L911' name='L911'></a> 911         <em class='brace'>}</em>
<a id='L912' name='L912'></a> 912 
<a id='L913' name='L913'></a> 913         <em class='comment'>/* read in the oids */</em>
<a id='L914' name='L914'></a> 914         <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> = <a href='../Y/558.html' title='Multiple used in 12 places.'>CONF_get_string</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, "oid_file");
<a id='L915' name='L915'></a> 915         <strong class='reserved'>if</strong> (<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> &amp;&amp; !<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>)) <em class='brace'>{</em>
<a id='L916' name='L916'></a> 916                 <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> *<a href='../Y/29344.html' title='Multiple used in 4 places.'>oid_bio</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>, "r");
<a id='L917' name='L917'></a> 917                 <strong class='reserved'>if</strong> (<a href='../Y/29344.html' title='Multiple used in 4 places.'>oid_bio</a>) <em class='brace'>{</em>
<a id='L918' name='L918'></a> 918                         OBJ_create_objects(<a href='../Y/29344.html' title='Multiple used in 4 places.'>oid_bio</a>);
<a id='L919' name='L919'></a> 919                         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/29344.html' title='Multiple used in 4 places.'>oid_bio</a>);
<a id='L920' name='L920'></a> 920                 <em class='brace'>}</em>
<a id='L921' name='L921'></a> 921         <em class='brace'>}</em>
<a id='L922' name='L922'></a> 922         <strong class='reserved'>if</strong> (<a href='../S/851.html#L832' title='Defined at 832 in ext/openssl/openssl.c.'>add_oid_section</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L923' name='L923'></a> 923                 <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L924' name='L924'></a> 924         <em class='brace'>}</em>
<a id='L925' name='L925'></a> 925         <a href='../S/851.html#L866' title='Defined at 866 in ext/openssl/openssl.c.'>SET_OPTIONAL_STRING_ARG</a>("digest_alg", <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/15700.html' title='Multiple used in 6 places.'>digest_name</a>,
<a id='L926' name='L926'></a> 926                 <a href='../Y/558.html' title='Multiple used in 12 places.'>CONF_get_string</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/35586.html' title='Multiple used in 13 places.'>section_name</a>, "default_md"));
<a id='L927' name='L927'></a> 927         <a href='../S/851.html#L866' title='Defined at 866 in ext/openssl/openssl.c.'>SET_OPTIONAL_STRING_ARG</a>("x509_extensions", <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/17394.html' title='Multiple used in 5 places.'>extensions_section</a>,
<a id='L928' name='L928'></a> 928                 <a href='../Y/558.html' title='Multiple used in 12 places.'>CONF_get_string</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/35586.html' title='Multiple used in 13 places.'>section_name</a>, "x509_extensions"));
<a id='L929' name='L929'></a> 929         <a href='../S/851.html#L866' title='Defined at 866 in ext/openssl/openssl.c.'>SET_OPTIONAL_STRING_ARG</a>("req_extensions", <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34572.html' title='Multiple used in 6 places.'>request_extensions_section</a>,
<a id='L930' name='L930'></a> 930                 <a href='../Y/558.html' title='Multiple used in 12 places.'>CONF_get_string</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/35586.html' title='Multiple used in 13 places.'>section_name</a>, "req_extensions"));
<a id='L931' name='L931'></a> 931         <a href='../S/851.html#L872' title='Defined at 872 in ext/openssl/openssl.c.'>SET_OPTIONAL_LONG_ARG</a>("private_key_bits", <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33386.html' title='Multiple used in 10 places.'>priv_key_bits</a>,
<a id='L932' name='L932'></a> 932                 CONF_get_number(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/35586.html' title='Multiple used in 13 places.'>section_name</a>, "default_bits"));
<a id='L933' name='L933'></a> 933 
<a id='L934' name='L934'></a> 934         <a href='../S/851.html#L872' title='Defined at 872 in ext/openssl/openssl.c.'>SET_OPTIONAL_LONG_ARG</a>("private_key_type", <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33389.html' title='Multiple used in 3 places.'>priv_key_type</a>, <a href='../S/851.html#L98' title='Defined at 98 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_DEFAULT</a>);
<a id='L935' name='L935'></a> 935 
<a id='L936' name='L936'></a> 936         <strong class='reserved'>if</strong> (<a href='../Y/29866.html' title='Multiple used in 5 places.'>optional_args</a> &amp;&amp; (<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a> = <a href='../S/1667.html#L1987' title='Defined at 1987 in Zend/zend_hash.c.'>zend_hash_str_find</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/29866.html' title='Multiple used in 5 places.'>optional_args</a>), "encrypt_key", <strong class='reserved'>sizeof</strong>("encrypt_key")-1)) != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L937' name='L937'></a> 937                 <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33387.html' title='Multiple used in 7 places.'>priv_key_encrypt</a> = <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>) == <a href='../S/1731.html#L305' title='Defined at 305 in Zend/zend_types.h.'>IS_TRUE</a> ? 1 : 0;
<a id='L938' name='L938'></a> 938         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L939' name='L939'></a> 939                 <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> = <a href='../Y/558.html' title='Multiple used in 12 places.'>CONF_get_string</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/35586.html' title='Multiple used in 13 places.'>section_name</a>, "encrypt_rsa_key");
<a id='L940' name='L940'></a> 940                 <strong class='reserved'>if</strong> (<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L941' name='L941'></a> 941                         <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> = <a href='../Y/558.html' title='Multiple used in 12 places.'>CONF_get_string</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/35586.html' title='Multiple used in 13 places.'>section_name</a>, "encrypt_key");
<a id='L942' name='L942'></a> 942                 <em class='brace'>}</em>
<a id='L943' name='L943'></a> 943                 <strong class='reserved'>if</strong> (<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> &amp;&amp; <a href='../Y/37561.html' title='Multiple used in 563 places.'>strcmp</a>(<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>, "no") == 0) <em class='brace'>{</em>
<a id='L944' name='L944'></a> 944                         <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33387.html' title='Multiple used in 7 places.'>priv_key_encrypt</a> = 0;
<a id='L945' name='L945'></a> 945                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L946' name='L946'></a> 946                         <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33387.html' title='Multiple used in 7 places.'>priv_key_encrypt</a> = 1;
<a id='L947' name='L947'></a> 947                 <em class='brace'>}</em>
<a id='L948' name='L948'></a> 948         <em class='brace'>}</em>
<a id='L949' name='L949'></a> 949 
<a id='L950' name='L950'></a> 950         <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33387.html' title='Multiple used in 7 places.'>priv_key_encrypt</a> &amp;&amp; <a href='../Y/29866.html' title='Multiple used in 5 places.'>optional_args</a> &amp;&amp; (<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a> = <a href='../S/1667.html#L1987' title='Defined at 1987 in Zend/zend_hash.c.'>zend_hash_str_find</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/29866.html' title='Multiple used in 5 places.'>optional_args</a>), "encrypt_key_cipher", <strong class='reserved'>sizeof</strong>("encrypt_key_cipher")-1)) != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>
<a id='L951' name='L951'></a> 951                 &amp;&amp; <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>) == <a href='../S/1731.html#L306' title='Defined at 306 in Zend/zend_types.h.'>IS_LONG</a>) <em class='brace'>{</em>
<a id='L952' name='L952'></a> 952                 <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/13706.html' title='Multiple used in 2 places.'>cipher_algo</a> = <a href='../S/1731.html#L507' title='Defined at 507 in Zend/zend_types.h.'>Z_LVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>);
<a id='L953' name='L953'></a> 953                 <strong class='reserved'>const</strong> <a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a>* <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> = <a href='../S/851.html#L1105' title='Defined at 1105 in ext/openssl/openssl.c.'>php_openssl_get_evp_cipher_from_algo</a>(<a href='../Y/13706.html' title='Multiple used in 2 places.'>cipher_algo</a>);
<a id='L954' name='L954'></a> 954                 <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L955' name='L955'></a> 955                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown cipher algorithm for private key.");
<a id='L956' name='L956'></a> 956                         <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L957' name='L957'></a> 957                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L958' name='L958'></a> 958                         <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33388.html' title='Multiple used in 7 places.'>priv_key_encrypt_cipher</a> = <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>;
<a id='L959' name='L959'></a> 959                 <em class='brace'>}</em>
<a id='L960' name='L960'></a> 960         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L961' name='L961'></a> 961                 <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33388.html' title='Multiple used in 7 places.'>priv_key_encrypt_cipher</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L962' name='L962'></a> 962         <em class='brace'>}</em>
<a id='L963' name='L963'></a> 963 
<a id='L964' name='L964'></a> 964 
<a id='L965' name='L965'></a> 965 
<a id='L966' name='L966'></a> 966         <em class='comment'>/* digest alg */</em>
<a id='L967' name='L967'></a> 967         <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/15700.html' title='Multiple used in 6 places.'>digest_name</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L968' name='L968'></a> 968                 <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/15700.html' title='Multiple used in 6 places.'>digest_name</a> = <a href='../Y/558.html' title='Multiple used in 12 places.'>CONF_get_string</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/35586.html' title='Multiple used in 13 places.'>section_name</a>, "default_md");
<a id='L969' name='L969'></a> 969         <em class='brace'>}</em>
<a id='L970' name='L970'></a> 970         <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/15700.html' title='Multiple used in 6 places.'>digest_name</a>) <em class='brace'>{</em>
<a id='L971' name='L971'></a> 971                 <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/15696.html' title='Multiple used in 282 places.'>digest</a> = <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/26414.html' title='Multiple used in 4 places.'>md_alg</a> = <a href='../Y/2163.html' title='Multiple used in 6 places.'>EVP_get_digestbyname</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/15700.html' title='Multiple used in 6 places.'>digest_name</a>);
<a id='L972' name='L972'></a> 972         <em class='brace'>}</em>
<a id='L973' name='L973'></a> 973         <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/26414.html' title='Multiple used in 4 places.'>md_alg</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L974' name='L974'></a> 974                 <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/26414.html' title='Multiple used in 4 places.'>md_alg</a> = <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/15696.html' title='Multiple used in 282 places.'>digest</a> = <a href='../Y/2172.html' title='Multiple used in 5 places.'>EVP_sha1</a>();
<a id='L975' name='L975'></a> 975         <em class='brace'>}</em>
<a id='L976' name='L976'></a> 976 
<a id='L977' name='L977'></a> 977         <a href='../S/851.html#L863' title='Defined at 863 in ext/openssl/openssl.c.'>PHP_SSL_CONFIG_SYNTAX_CHECK</a>(<a href='../Y/17394.html' title='Multiple used in 5 places.'>extensions_section</a>);
<a id='L978' name='L978'></a> 978 
<a id='L979' name='L979'></a> 979         <em class='comment'>/* set the string mask */</em>
<a id='L980' name='L980'></a> 980         <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> = <a href='../Y/558.html' title='Multiple used in 12 places.'>CONF_get_string</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/35586.html' title='Multiple used in 13 places.'>section_name</a>, "string_mask");
<a id='L981' name='L981'></a> 981         <strong class='reserved'>if</strong> (<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> &amp;&amp; !ASN1_STRING_set_default_mask_asc(<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>)) <em class='brace'>{</em>
<a id='L982' name='L982'></a> 982                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Invalid global string mask setting %s", <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>);
<a id='L983' name='L983'></a> 983                 <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L984' name='L984'></a> 984         <em class='brace'>}</em>
<a id='L985' name='L985'></a> 985 
<a id='L986' name='L986'></a> 986         <a href='../S/851.html#L863' title='Defined at 863 in ext/openssl/openssl.c.'>PHP_SSL_CONFIG_SYNTAX_CHECK</a>(<a href='../Y/34572.html' title='Multiple used in 6 places.'>request_extensions_section</a>);
<a id='L987' name='L987'></a> 987 
<a id='L988' name='L988'></a> 988         <strong class='reserved'>return</strong> <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>;
<a id='L989' name='L989'></a> 989 <em class='brace'>}</em>
<a id='L990' name='L990'></a> 990 <em class='comment'>/* }}} */</em>
<a id='L991' name='L991'></a> 991 
<a id='L992' name='L992'></a> 992 <strong class='reserved'>static</strong> <strong class='reserved'>void</strong> <a href='../S/851.html#L860' title='Referred from 860 in ext/openssl/openssl.c.'>php_openssl_dispose_config</a>(<strong class='reserved'>struct</strong> <a href='../S/851.html#L618' title='Defined at 618 in ext/openssl/openssl.c.'>php_x509_request</a> * <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>) <em class='comment'>/* {{{ */</em>
<a id='L993' name='L993'></a> 993 <em class='brace'>{</em>
<a id='L994' name='L994'></a> 994         <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>) <em class='brace'>{</em>
<a id='L995' name='L995'></a> 995                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>);
<a id='L996' name='L996'></a> 996                 <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L997' name='L997'></a> 997         <em class='brace'>}</em>
<a id='L998' name='L998'></a> 998         <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/19325.html' title='Multiple used in 6 places.'>global_config</a>) <em class='brace'>{</em>
<a id='L999' name='L999'></a> 999                 <a href='../Y/555.html' title='Multiple used in 2 places.'>CONF_free</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/19325.html' title='Multiple used in 6 places.'>global_config</a>);
<a id='L1000' name='L1000'></a>1000                 <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/19325.html' title='Multiple used in 6 places.'>global_config</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1001' name='L1001'></a>1001         <em class='brace'>}</em>
<a id='L1002' name='L1002'></a>1002         <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>) <em class='brace'>{</em>
<a id='L1003' name='L1003'></a>1003                 <a href='../Y/555.html' title='Multiple used in 2 places.'>CONF_free</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>);
<a id='L1004' name='L1004'></a>1004                 <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1005' name='L1005'></a>1005         <em class='brace'>}</em>
<a id='L1006' name='L1006'></a>1006 <em class='brace'>}</em>
<a id='L1007' name='L1007'></a>1007 <em class='comment'>/* }}} */</em>
<a id='L1008' name='L1008'></a>1008 
<a id='L1009' name='L1009'></a>1009 <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../S/851.html#L3400' title='Referred from 3400 in ext/openssl/openssl.c.'>php_openssl_load_rand_file</a>(<strong class='reserved'>const</strong> <strong class='reserved'>char</strong> * <a href='../Y/17806.html' title='Multiple used in 617 places.'>file</a>, <strong class='reserved'>int</strong> *<a href='../Y/16510.html' title='Multiple used in 8 places.'>egdsocket</a>, <strong class='reserved'>int</strong> *<a href='../Y/35613.html' title='Multiple used in 12 places.'>seeded</a>) <em class='comment'>/* {{{ */</em>
<a id='L1010' name='L1010'></a>1010 <em class='brace'>{</em>
<a id='L1011' name='L1011'></a>1011         <strong class='reserved'>char</strong> <a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>[<a href='../D/4806.html' title='Multiple defined in 9 places.'>MAXPATHLEN</a>];
<a id='L1012' name='L1012'></a>1012 
<a id='L1013' name='L1013'></a>1013         *<a href='../Y/16510.html' title='Multiple used in 8 places.'>egdsocket</a> = 0;
<a id='L1014' name='L1014'></a>1014         *<a href='../Y/35613.html' title='Multiple used in 12 places.'>seeded</a> = 0;
<a id='L1015' name='L1015'></a>1015 
<a id='L1016' name='L1016'></a>1016         <strong class='reserved'>if</strong> (<a href='../Y/17806.html' title='Multiple used in 617 places.'>file</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1017' name='L1017'></a>1017                 <a href='../Y/17806.html' title='Multiple used in 617 places.'>file</a> = <a href='../Y/5307.html' title='Multiple used in 2 places.'>RAND_file_name</a>(<a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>, <strong class='reserved'>sizeof</strong>(<a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>));
<a id='L1018' name='L1018'></a>1018 <em class='sharp'>#ifdef</em> HAVE_RAND_EGD
<a id='L1019' name='L1019'></a>1019         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong> (RAND_egd(<a href='../Y/17806.html' title='Multiple used in 617 places.'>file</a>) &gt; 0) <em class='brace'>{</em>
<a id='L1020' name='L1020'></a>1020                 <em class='comment'>/* if the given filename is an EGD socket, don't</em>
<a id='L1021' name='L1021'></a>1021 <em class='comment'>                 * write anything back to it */</em>
<a id='L1022' name='L1022'></a>1022                 *<a href='../Y/16510.html' title='Multiple used in 8 places.'>egdsocket</a> = 1;
<a id='L1023' name='L1023'></a>1023                 <strong class='reserved'>return</strong> <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>;
<a id='L1024' name='L1024'></a>1024 <em class='sharp'>#endif</em>
<a id='L1025' name='L1025'></a>1025         <em class='brace'>}</em>
<a id='L1026' name='L1026'></a>1026         <strong class='reserved'>if</strong> (<a href='../Y/17806.html' title='Multiple used in 617 places.'>file</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> || !RAND_load_file(<a href='../Y/17806.html' title='Multiple used in 617 places.'>file</a>, -1)) <em class='brace'>{</em>
<a id='L1027' name='L1027'></a>1027                 <strong class='reserved'>if</strong> (RAND_status() == 0) <em class='brace'>{</em>
<a id='L1028' name='L1028'></a>1028                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "unable to load random state; not enough random data!");
<a id='L1029' name='L1029'></a>1029                         <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L1030' name='L1030'></a>1030                 <em class='brace'>}</em>
<a id='L1031' name='L1031'></a>1031                 <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L1032' name='L1032'></a>1032         <em class='brace'>}</em>
<a id='L1033' name='L1033'></a>1033         *<a href='../Y/35613.html' title='Multiple used in 12 places.'>seeded</a> = 1;
<a id='L1034' name='L1034'></a>1034         <strong class='reserved'>return</strong> <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>;
<a id='L1035' name='L1035'></a>1035 <em class='brace'>}</em>
<a id='L1036' name='L1036'></a>1036 <em class='comment'>/* }}} */</em>
<a id='L1037' name='L1037'></a>1037 
<a id='L1038' name='L1038'></a>1038 <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../S/851.html#L3478' title='Referred from 3478 in ext/openssl/openssl.c.'>php_openssl_write_rand_file</a>(<strong class='reserved'>const</strong> <strong class='reserved'>char</strong> * <a href='../Y/17806.html' title='Multiple used in 617 places.'>file</a>, <strong class='reserved'>int</strong> <a href='../Y/16510.html' title='Multiple used in 8 places.'>egdsocket</a>, <strong class='reserved'>int</strong> <a href='../Y/35613.html' title='Multiple used in 12 places.'>seeded</a>) <em class='comment'>/* {{{ */</em>
<a id='L1039' name='L1039'></a>1039 <em class='brace'>{</em>
<a id='L1040' name='L1040'></a>1040         <strong class='reserved'>char</strong> <a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>[<a href='../D/4806.html' title='Multiple defined in 9 places.'>MAXPATHLEN</a>];
<a id='L1041' name='L1041'></a>1041 
<a id='L1042' name='L1042'></a>1042 
<a id='L1043' name='L1043'></a>1043         <strong class='reserved'>if</strong> (<a href='../Y/16510.html' title='Multiple used in 8 places.'>egdsocket</a> || !<a href='../Y/35613.html' title='Multiple used in 12 places.'>seeded</a>) <em class='brace'>{</em>
<a id='L1044' name='L1044'></a>1044                 <em class='comment'>/* if we did not manage to read the seed file, we should not write</em>
<a id='L1045' name='L1045'></a>1045 <em class='comment'>                 * a low-entropy seed file back */</em>
<a id='L1046' name='L1046'></a>1046                 <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L1047' name='L1047'></a>1047         <em class='brace'>}</em>
<a id='L1048' name='L1048'></a>1048         <strong class='reserved'>if</strong> (<a href='../Y/17806.html' title='Multiple used in 617 places.'>file</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1049' name='L1049'></a>1049                 <a href='../Y/17806.html' title='Multiple used in 617 places.'>file</a> = <a href='../Y/5307.html' title='Multiple used in 2 places.'>RAND_file_name</a>(<a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>, <strong class='reserved'>sizeof</strong>(<a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>));
<a id='L1050' name='L1050'></a>1050         <em class='brace'>}</em>
<a id='L1051' name='L1051'></a>1051         <strong class='reserved'>if</strong> (<a href='../Y/17806.html' title='Multiple used in 617 places.'>file</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> || !RAND_write_file(<a href='../Y/17806.html' title='Multiple used in 617 places.'>file</a>)) <em class='brace'>{</em>
<a id='L1052' name='L1052'></a>1052                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "unable to write random state");
<a id='L1053' name='L1053'></a>1053                 <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L1054' name='L1054'></a>1054         <em class='brace'>}</em>
<a id='L1055' name='L1055'></a>1055         <strong class='reserved'>return</strong> <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>;
<a id='L1056' name='L1056'></a>1056 <em class='brace'>}</em>
<a id='L1057' name='L1057'></a>1057 <em class='comment'>/* }}} */</em>
<a id='L1058' name='L1058'></a>1058 
<a id='L1059' name='L1059'></a>1059 <strong class='reserved'>static</strong> <a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> * <a href='../R/24302.html' title='Multiple referred from 3 places.'>php_openssl_get_evp_md_from_algo</a>(<a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/9053.html' title='Multiple used in 59 places.'>algo</a>) <em class='brace'>{</em> <em class='comment'>/* {{{ */</em>
<a id='L1060' name='L1060'></a>1060         <a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *<a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>;
<a id='L1061' name='L1061'></a>1061 
<a id='L1062' name='L1062'></a>1062         <strong class='reserved'>switch</strong> (<a href='../Y/9053.html' title='Multiple used in 59 places.'>algo</a>) <em class='brace'>{</em>
<a id='L1063' name='L1063'></a>1063                 <strong class='reserved'>case</strong> <a href='../S/851.html#L69' title='Defined at 69 in ext/openssl/openssl.c.'>OPENSSL_ALGO_SHA1</a>:
<a id='L1064' name='L1064'></a>1064                         <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = (<a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *) <a href='../Y/2172.html' title='Multiple used in 5 places.'>EVP_sha1</a>();
<a id='L1065' name='L1065'></a>1065                         <strong class='reserved'>break</strong>;
<a id='L1066' name='L1066'></a>1066                 <strong class='reserved'>case</strong> <a href='../S/851.html#L70' title='Defined at 70 in ext/openssl/openssl.c.'>OPENSSL_ALGO_MD5</a>:
<a id='L1067' name='L1067'></a>1067                         <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = (<a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *) EVP_md5();
<a id='L1068' name='L1068'></a>1068                         <strong class='reserved'>break</strong>;
<a id='L1069' name='L1069'></a>1069                 <strong class='reserved'>case</strong> <a href='../S/851.html#L71' title='Defined at 71 in ext/openssl/openssl.c.'>OPENSSL_ALGO_MD4</a>:
<a id='L1070' name='L1070'></a>1070                         <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = (<a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *) EVP_md4();
<a id='L1071' name='L1071'></a>1071                         <strong class='reserved'>break</strong>;
<a id='L1072' name='L1072'></a>1072 <em class='sharp'>#ifdef</em> <a href='../Y/2940.html' title='Multiple used in 3 places.'>HAVE_OPENSSL_MD2_H</a>
<a id='L1073' name='L1073'></a>1073                 <strong class='reserved'>case</strong> <a href='../S/851.html#L73' title='Defined at 73 in ext/openssl/openssl.c.'>OPENSSL_ALGO_MD2</a>:
<a id='L1074' name='L1074'></a>1074                         <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = (<a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *) EVP_md2();
<a id='L1075' name='L1075'></a>1075                         <strong class='reserved'>break</strong>;
<a id='L1076' name='L1076'></a>1076 <em class='sharp'>#endif</em>
<a id='L1077' name='L1077'></a>1077                 <strong class='reserved'>case</strong> <a href='../S/851.html#L75' title='Defined at 75 in ext/openssl/openssl.c.'>OPENSSL_ALGO_DSS1</a>:
<a id='L1078' name='L1078'></a>1078                         <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = (<a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *) EVP_dss1();
<a id='L1079' name='L1079'></a>1079                         <strong class='reserved'>break</strong>;
<a id='L1080' name='L1080'></a>1080 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &gt;= 0x0090708fL
<a id='L1081' name='L1081'></a>1081                 <strong class='reserved'>case</strong> <a href='../S/851.html#L77' title='Defined at 77 in ext/openssl/openssl.c.'>OPENSSL_ALGO_SHA224</a>:
<a id='L1082' name='L1082'></a>1082                         <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = (<a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *) EVP_sha224();
<a id='L1083' name='L1083'></a>1083                         <strong class='reserved'>break</strong>;
<a id='L1084' name='L1084'></a>1084                 <strong class='reserved'>case</strong> <a href='../S/851.html#L78' title='Defined at 78 in ext/openssl/openssl.c.'>OPENSSL_ALGO_SHA256</a>:
<a id='L1085' name='L1085'></a>1085                         <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = (<a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *) EVP_sha256();
<a id='L1086' name='L1086'></a>1086                         <strong class='reserved'>break</strong>;
<a id='L1087' name='L1087'></a>1087                 <strong class='reserved'>case</strong> <a href='../S/851.html#L79' title='Defined at 79 in ext/openssl/openssl.c.'>OPENSSL_ALGO_SHA384</a>:
<a id='L1088' name='L1088'></a>1088                         <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = (<a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *) EVP_sha384();
<a id='L1089' name='L1089'></a>1089                         <strong class='reserved'>break</strong>;
<a id='L1090' name='L1090'></a>1090                 <strong class='reserved'>case</strong> <a href='../S/851.html#L80' title='Defined at 80 in ext/openssl/openssl.c.'>OPENSSL_ALGO_SHA512</a>:
<a id='L1091' name='L1091'></a>1091                         <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = (<a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *) EVP_sha512();
<a id='L1092' name='L1092'></a>1092                         <strong class='reserved'>break</strong>;
<a id='L1093' name='L1093'></a>1093                 <strong class='reserved'>case</strong> <a href='../S/851.html#L81' title='Defined at 81 in ext/openssl/openssl.c.'>OPENSSL_ALGO_RMD160</a>:
<a id='L1094' name='L1094'></a>1094                         <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = (<a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *) EVP_ripemd160();
<a id='L1095' name='L1095'></a>1095                         <strong class='reserved'>break</strong>;
<a id='L1096' name='L1096'></a>1096 <em class='sharp'>#endif</em>
<a id='L1097' name='L1097'></a>1097                 <strong class='reserved'>default</strong>:
<a id='L1098' name='L1098'></a>1098                         <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1099' name='L1099'></a>1099                         <strong class='reserved'>break</strong>;
<a id='L1100' name='L1100'></a>1100         <em class='brace'>}</em>
<a id='L1101' name='L1101'></a>1101         <strong class='reserved'>return</strong> <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>;
<a id='L1102' name='L1102'></a>1102 <em class='brace'>}</em>
<a id='L1103' name='L1103'></a>1103 <em class='comment'>/* }}} */</em>
<a id='L1104' name='L1104'></a>1104 
<a id='L1105' name='L1105'></a>1105 <strong class='reserved'>static</strong> <strong class='reserved'>const</strong> <a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a> * <a href='../R/24301.html' title='Multiple referred from 3 places.'>php_openssl_get_evp_cipher_from_algo</a>(<a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/9053.html' title='Multiple used in 59 places.'>algo</a>) <em class='brace'>{</em> <em class='comment'>/* {{{ */</em>
<a id='L1106' name='L1106'></a>1106         <strong class='reserved'>switch</strong> (<a href='../Y/9053.html' title='Multiple used in 59 places.'>algo</a>) <em class='brace'>{</em>
<a id='L1107' name='L1107'></a>1107 <em class='sharp'>#ifndef</em> <a href='../Y/4652.html' title='Multiple used in 2 places.'>OPENSSL_NO_RC2</a>
<a id='L1108' name='L1108'></a>1108                 <strong class='reserved'>case</strong> <a href='../S/851.html#L105' title='Defined at 105 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_RC2_40</a>:
<a id='L1109' name='L1109'></a>1109                         <strong class='reserved'>return</strong> EVP_rc2_40_cbc();
<a id='L1110' name='L1110'></a>1110                         <strong class='reserved'>break</strong>;
<a id='L1111' name='L1111'></a>1111                 <strong class='reserved'>case</strong> <a href='../S/851.html#L107' title='Defined at 107 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_RC2_64</a>:
<a id='L1112' name='L1112'></a>1112                         <strong class='reserved'>return</strong> EVP_rc2_64_cbc();
<a id='L1113' name='L1113'></a>1113                         <strong class='reserved'>break</strong>;
<a id='L1114' name='L1114'></a>1114                 <strong class='reserved'>case</strong> <a href='../S/851.html#L106' title='Defined at 106 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_RC2_128</a>:
<a id='L1115' name='L1115'></a>1115                         <strong class='reserved'>return</strong> EVP_rc2_cbc();
<a id='L1116' name='L1116'></a>1116                         <strong class='reserved'>break</strong>;
<a id='L1117' name='L1117'></a>1117 <em class='sharp'>#endif</em>
<a id='L1118' name='L1118'></a>1118 
<a id='L1119' name='L1119'></a>1119 <em class='sharp'>#ifndef</em> <a href='../Y/4648.html' title='Multiple used in 2 places.'>OPENSSL_NO_DES</a>
<a id='L1120' name='L1120'></a>1120                 <strong class='reserved'>case</strong> <a href='../S/851.html#L108' title='Defined at 108 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_DES</a>:
<a id='L1121' name='L1121'></a>1121                         <strong class='reserved'>return</strong> EVP_des_cbc();
<a id='L1122' name='L1122'></a>1122                         <strong class='reserved'>break</strong>;
<a id='L1123' name='L1123'></a>1123                 <strong class='reserved'>case</strong> <a href='../S/851.html#L109' title='Defined at 109 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_3DES</a>:
<a id='L1124' name='L1124'></a>1124                         <strong class='reserved'>return</strong> <a href='../Y/2160.html' title='Multiple used in 3 places.'>EVP_des_ede3_cbc</a>();
<a id='L1125' name='L1125'></a>1125                         <strong class='reserved'>break</strong>;
<a id='L1126' name='L1126'></a>1126 <em class='sharp'>#endif</em>
<a id='L1127' name='L1127'></a>1127 
<a id='L1128' name='L1128'></a>1128 <em class='sharp'>#ifndef</em> <a href='../Y/4647.html' title='Multiple used in 2 places.'>OPENSSL_NO_AES</a>
<a id='L1129' name='L1129'></a>1129                 <strong class='reserved'>case</strong> <a href='../S/851.html#L110' title='Defined at 110 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_AES_128_CBC</a>:
<a id='L1130' name='L1130'></a>1130                         <strong class='reserved'>return</strong> EVP_aes_128_cbc();
<a id='L1131' name='L1131'></a>1131                         <strong class='reserved'>break</strong>;
<a id='L1132' name='L1132'></a>1132                 <strong class='reserved'>case</strong> <a href='../S/851.html#L111' title='Defined at 111 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_AES_192_CBC</a>:
<a id='L1133' name='L1133'></a>1133                         <strong class='reserved'>return</strong> EVP_aes_192_cbc();
<a id='L1134' name='L1134'></a>1134                         <strong class='reserved'>break</strong>;
<a id='L1135' name='L1135'></a>1135                 <strong class='reserved'>case</strong> <a href='../S/851.html#L112' title='Defined at 112 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_AES_256_CBC</a>:
<a id='L1136' name='L1136'></a>1136                         <strong class='reserved'>return</strong> EVP_aes_256_cbc();
<a id='L1137' name='L1137'></a>1137                         <strong class='reserved'>break</strong>;
<a id='L1138' name='L1138'></a>1138 <em class='sharp'>#endif</em>
<a id='L1139' name='L1139'></a>1139 
<a id='L1140' name='L1140'></a>1140 
<a id='L1141' name='L1141'></a>1141                 <strong class='reserved'>default</strong>:
<a id='L1142' name='L1142'></a>1142                         <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1143' name='L1143'></a>1143                         <strong class='reserved'>break</strong>;
<a id='L1144' name='L1144'></a>1144         <em class='brace'>}</em>
<a id='L1145' name='L1145'></a>1145 <em class='brace'>}</em>
<a id='L1146' name='L1146'></a>1146 <em class='comment'>/* }}} */</em>
<a id='L1147' name='L1147'></a>1147 
<a id='L1148' name='L1148'></a>1148 <em class='comment'>/* {{{ INI Settings */</em>
<a id='L1149' name='L1149'></a>1149 <a href='../R/7194.html' title='Multiple referred from 8 places.'>PHP_INI_BEGIN</a>()
<a id='L1150' name='L1150'></a>1150         <a href='../S/1385.html#L66' title='Defined at 66 in main/php_ini.h.'>PHP_INI_ENTRY</a>("openssl.cafile", <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1385.html#L46' title='Defined at 46 in main/php_ini.h.'>PHP_INI_PERDIR</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>)
<a id='L1151' name='L1151'></a>1151         <a href='../S/1385.html#L66' title='Defined at 66 in main/php_ini.h.'>PHP_INI_ENTRY</a>("openssl.capath", <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1385.html#L46' title='Defined at 46 in main/php_ini.h.'>PHP_INI_PERDIR</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>)
<a id='L1152' name='L1152'></a>1152 <a href='../S/1385.html#L57' title='Defined at 57 in main/php_ini.h.'>PHP_INI_END</a>()
<a id='L1153' name='L1153'></a>1153 <em class='comment'>/* }}} */</em>
<a id='L1154' name='L1154'></a>1154 
<a id='L1155' name='L1155'></a>1155 <em class='comment'>/* {{{ PHP_MINIT_FUNCTION</em>
<a id='L1156' name='L1156'></a>1156 <em class='comment'> */</em>
<a id='L1157' name='L1157'></a>1157 <a href='../D/8309.html' title='Multiple defined in 96 places.'>PHP_MINIT_FUNCTION</a>(<a href='../Y/29730.html' title='Multiple used in 17 places.'>openssl</a>)
<a id='L1158' name='L1158'></a>1158 <em class='brace'>{</em>
<a id='L1159' name='L1159'></a>1159         <strong class='reserved'>char</strong> * <a href='../Y/14275.html' title='Multiple used in 13 places.'>config_filename</a>;
<a id='L1160' name='L1160'></a>1160 
<a id='L1161' name='L1161'></a>1161         <a href='../Y/24897.html' title='Multiple used in 14 places.'>le_key</a> = <a href='../S/1690.html#L277' title='Defined at 277 in Zend/zend_list.c.'>zend_register_list_destructors_ex</a>(<a href='../S/851.html#L571' title='Defined at 571 in ext/openssl/openssl.c.'>php_pkey_free</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, "OpenSSL key", <a href='../Y/26756.html' title='Multiple used in 210 places.'>module_number</a>);
<a id='L1162' name='L1162'></a>1162         <a href='../Y/24937.html' title='Multiple used in 9 places.'>le_x509</a> = <a href='../S/1690.html#L277' title='Defined at 277 in Zend/zend_list.c.'>zend_register_list_destructors_ex</a>(<a href='../S/851.html#L580' title='Defined at 580 in ext/openssl/openssl.c.'>php_x509_free</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, "OpenSSL X.509", <a href='../Y/26756.html' title='Multiple used in 210 places.'>module_number</a>);
<a id='L1163' name='L1163'></a>1163         <a href='../Y/24875.html' title='Multiple used in 4 places.'>le_csr</a> = <a href='../S/1690.html#L277' title='Defined at 277 in Zend/zend_list.c.'>zend_register_list_destructors_ex</a>(<a href='../S/851.html#L586' title='Defined at 586 in ext/openssl/openssl.c.'>php_csr_free</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, "OpenSSL X.509 CSR", <a href='../Y/26756.html' title='Multiple used in 210 places.'>module_number</a>);
<a id='L1164' name='L1164'></a>1164 
<a id='L1165' name='L1165'></a>1165         <a href='../Y/6226.html' title='Multiple used in 2 places.'>SSL_library_init</a>();
<a id='L1166' name='L1166'></a>1166         <a href='../Y/4838.html' title='Multiple used in 2 places.'>OpenSSL_add_all_ciphers</a>();
<a id='L1167' name='L1167'></a>1167         <a href='../Y/4839.html' title='Multiple used in 2 places.'>OpenSSL_add_all_digests</a>();
<a id='L1168' name='L1168'></a>1168         <a href='../Y/4837.html' title='Multiple used in 2 places.'>OpenSSL_add_all_algorithms</a>();
<a id='L1169' name='L1169'></a>1169 
<a id='L1170' name='L1170'></a>1170         <a href='../Y/6228.html' title='Multiple used in 2 places.'>SSL_load_error_strings</a>();
<a id='L1171' name='L1171'></a>1171 
<a id='L1172' name='L1172'></a>1172         <em class='comment'>/* register a resource id number with OpenSSL so that we can map SSL -&gt; stream structures in</em>
<a id='L1173' name='L1173'></a>1173 <em class='comment'>         * OpenSSL callbacks */</em>
<a id='L1174' name='L1174'></a>1174         <a href='../Y/37061.html' title='Multiple used in 4 places.'>ssl_stream_data_index</a> = SSL_get_ex_new_index(0, "PHP stream index", <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L1175' name='L1175'></a>1175 
<a id='L1176' name='L1176'></a>1176         <a href='../S/1647.html#L44' title='Defined at 44 in Zend/zend_constants.h.'>REGISTER_STRING_CONSTANT</a>("OPENSSL_VERSION_TEXT", <a href='../Y/4659.html' title='Multiple used in 2 places.'>OPENSSL_VERSION_TEXT</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1177' name='L1177'></a>1177         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_VERSION_NUMBER", <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1178' name='L1178'></a>1178 
<a id='L1179' name='L1179'></a>1179         <em class='comment'>/* purposes for cert purpose checking */</em>
<a id='L1180' name='L1180'></a>1180         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("X509_PURPOSE_SSL_CLIENT", X509_PURPOSE_SSL_CLIENT, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1181' name='L1181'></a>1181         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("X509_PURPOSE_SSL_SERVER", X509_PURPOSE_SSL_SERVER, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1182' name='L1182'></a>1182         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("X509_PURPOSE_NS_SSL_SERVER", X509_PURPOSE_NS_SSL_SERVER, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1183' name='L1183'></a>1183         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("X509_PURPOSE_SMIME_SIGN", X509_PURPOSE_SMIME_SIGN, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1184' name='L1184'></a>1184         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("X509_PURPOSE_SMIME_ENCRYPT", X509_PURPOSE_SMIME_ENCRYPT, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1185' name='L1185'></a>1185         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("X509_PURPOSE_CRL_SIGN", X509_PURPOSE_CRL_SIGN, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1186' name='L1186'></a>1186 <em class='sharp'>#ifdef</em> <a href='../Y/7393.html' title='Multiple used in 2 places.'>X509_PURPOSE_ANY</a>
<a id='L1187' name='L1187'></a>1187         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("X509_PURPOSE_ANY", <a href='../Y/7393.html' title='Multiple used in 2 places.'>X509_PURPOSE_ANY</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1188' name='L1188'></a>1188 <em class='sharp'>#endif</em>
<a id='L1189' name='L1189'></a>1189 
<a id='L1190' name='L1190'></a>1190         <em class='comment'>/* signature algorithm constants */</em>
<a id='L1191' name='L1191'></a>1191         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_ALGO_SHA1", <a href='../S/851.html#L69' title='Defined at 69 in ext/openssl/openssl.c.'>OPENSSL_ALGO_SHA1</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1192' name='L1192'></a>1192         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_ALGO_MD5", <a href='../S/851.html#L70' title='Defined at 70 in ext/openssl/openssl.c.'>OPENSSL_ALGO_MD5</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1193' name='L1193'></a>1193         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_ALGO_MD4", <a href='../S/851.html#L71' title='Defined at 71 in ext/openssl/openssl.c.'>OPENSSL_ALGO_MD4</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1194' name='L1194'></a>1194 <em class='sharp'>#ifdef</em> <a href='../Y/2940.html' title='Multiple used in 3 places.'>HAVE_OPENSSL_MD2_H</a>
<a id='L1195' name='L1195'></a>1195         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_ALGO_MD2", <a href='../S/851.html#L73' title='Defined at 73 in ext/openssl/openssl.c.'>OPENSSL_ALGO_MD2</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1196' name='L1196'></a>1196 <em class='sharp'>#endif</em>
<a id='L1197' name='L1197'></a>1197         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_ALGO_DSS1", <a href='../S/851.html#L75' title='Defined at 75 in ext/openssl/openssl.c.'>OPENSSL_ALGO_DSS1</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1198' name='L1198'></a>1198 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &gt;= 0x0090708fL
<a id='L1199' name='L1199'></a>1199         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_ALGO_SHA224", <a href='../S/851.html#L77' title='Defined at 77 in ext/openssl/openssl.c.'>OPENSSL_ALGO_SHA224</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1200' name='L1200'></a>1200         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_ALGO_SHA256", <a href='../S/851.html#L78' title='Defined at 78 in ext/openssl/openssl.c.'>OPENSSL_ALGO_SHA256</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1201' name='L1201'></a>1201         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_ALGO_SHA384", <a href='../S/851.html#L79' title='Defined at 79 in ext/openssl/openssl.c.'>OPENSSL_ALGO_SHA384</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1202' name='L1202'></a>1202         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_ALGO_SHA512", <a href='../S/851.html#L80' title='Defined at 80 in ext/openssl/openssl.c.'>OPENSSL_ALGO_SHA512</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1203' name='L1203'></a>1203         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_ALGO_RMD160", <a href='../S/851.html#L81' title='Defined at 81 in ext/openssl/openssl.c.'>OPENSSL_ALGO_RMD160</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1204' name='L1204'></a>1204 <em class='sharp'>#endif</em>
<a id='L1205' name='L1205'></a>1205 
<a id='L1206' name='L1206'></a>1206         <em class='comment'>/* flags for S/MIME */</em>
<a id='L1207' name='L1207'></a>1207         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("PKCS7_DETACHED", <a href='../Y/5076.html' title='Multiple used in 4 places.'>PKCS7_DETACHED</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1208' name='L1208'></a>1208         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("PKCS7_TEXT", PKCS7_TEXT, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1209' name='L1209'></a>1209         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("PKCS7_NOINTERN", PKCS7_NOINTERN, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1210' name='L1210'></a>1210         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("PKCS7_NOVERIFY", PKCS7_NOVERIFY, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1211' name='L1211'></a>1211         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("PKCS7_NOCHAIN", PKCS7_NOCHAIN, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1212' name='L1212'></a>1212         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("PKCS7_NOCERTS", PKCS7_NOCERTS, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1213' name='L1213'></a>1213         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("PKCS7_NOATTR", PKCS7_NOATTR, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1214' name='L1214'></a>1214         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("PKCS7_BINARY", <a href='../Y/5075.html' title='Multiple used in 2 places.'>PKCS7_BINARY</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1215' name='L1215'></a>1215         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("PKCS7_NOSIGS", PKCS7_NOSIGS, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1216' name='L1216'></a>1216 
<a id='L1217' name='L1217'></a>1217         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_PKCS1_PADDING", <a href='../Y/5398.html' title='Multiple used in 5 places.'>RSA_PKCS1_PADDING</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1218' name='L1218'></a>1218         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_SSLV23_PADDING", RSA_SSLV23_PADDING, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1219' name='L1219'></a>1219         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_NO_PADDING", RSA_NO_PADDING, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1220' name='L1220'></a>1220         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_PKCS1_OAEP_PADDING", <a href='../Y/5397.html' title='Multiple used in 2 places.'>RSA_PKCS1_OAEP_PADDING</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1221' name='L1221'></a>1221 
<a id='L1222' name='L1222'></a>1222         <em class='comment'>/* Informational stream wrapper constants */</em>
<a id='L1223' name='L1223'></a>1223         <a href='../S/1647.html#L44' title='Defined at 44 in Zend/zend_constants.h.'>REGISTER_STRING_CONSTANT</a>("OPENSSL_DEFAULT_STREAM_CIPHERS", <a href='../S/852.html#L41' title='Defined at 41 in ext/openssl/php_openssl.h.'>OPENSSL_DEFAULT_STREAM_CIPHERS</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1224' name='L1224'></a>1224 
<a id='L1225' name='L1225'></a>1225         <em class='comment'>/* Ciphers */</em>
<a id='L1226' name='L1226'></a>1226 <em class='sharp'>#ifndef</em> <a href='../Y/4652.html' title='Multiple used in 2 places.'>OPENSSL_NO_RC2</a>
<a id='L1227' name='L1227'></a>1227         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_CIPHER_RC2_40", <a href='../S/851.html#L105' title='Defined at 105 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_RC2_40</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1228' name='L1228'></a>1228         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_CIPHER_RC2_128", <a href='../S/851.html#L106' title='Defined at 106 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_RC2_128</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1229' name='L1229'></a>1229         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_CIPHER_RC2_64", <a href='../S/851.html#L107' title='Defined at 107 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_RC2_64</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1230' name='L1230'></a>1230 <em class='sharp'>#endif</em>
<a id='L1231' name='L1231'></a>1231 <em class='sharp'>#ifndef</em> <a href='../Y/4648.html' title='Multiple used in 2 places.'>OPENSSL_NO_DES</a>
<a id='L1232' name='L1232'></a>1232         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_CIPHER_DES", <a href='../S/851.html#L108' title='Defined at 108 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_DES</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1233' name='L1233'></a>1233         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_CIPHER_3DES", <a href='../S/851.html#L109' title='Defined at 109 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_3DES</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1234' name='L1234'></a>1234 <em class='sharp'>#endif</em>
<a id='L1235' name='L1235'></a>1235 <em class='sharp'>#ifndef</em> <a href='../Y/4647.html' title='Multiple used in 2 places.'>OPENSSL_NO_AES</a>
<a id='L1236' name='L1236'></a>1236         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_CIPHER_AES_128_CBC", <a href='../S/851.html#L110' title='Defined at 110 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_AES_128_CBC</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1237' name='L1237'></a>1237         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_CIPHER_AES_192_CBC", <a href='../S/851.html#L111' title='Defined at 111 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_AES_192_CBC</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1238' name='L1238'></a>1238         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_CIPHER_AES_256_CBC", <a href='../S/851.html#L112' title='Defined at 112 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_AES_256_CBC</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1239' name='L1239'></a>1239 <em class='sharp'>#endif</em>
<a id='L1240' name='L1240'></a>1240 
<a id='L1241' name='L1241'></a>1241         <em class='comment'>/* Values for key types */</em>
<a id='L1242' name='L1242'></a>1242         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_KEYTYPE_RSA", <a href='../S/851.html#L95' title='Defined at 95 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_RSA</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1243' name='L1243'></a>1243 <em class='sharp'>#ifndef</em> <a href='../Y/4267.html' title='Multiple used in 3 places.'>NO_DSA</a>
<a id='L1244' name='L1244'></a>1244         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_KEYTYPE_DSA", <a href='../S/851.html#L96' title='Defined at 96 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_DSA</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1245' name='L1245'></a>1245 <em class='sharp'>#endif</em>
<a id='L1246' name='L1246'></a>1246         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_KEYTYPE_DH", <a href='../S/851.html#L97' title='Defined at 97 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_DH</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1247' name='L1247'></a>1247 <em class='sharp'>#ifdef</em> <a href='../S/851.html#L86' title='Defined at 86 in ext/openssl/openssl.c.'>HAVE_EVP_PKEY_EC</a>
<a id='L1248' name='L1248'></a>1248         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_KEYTYPE_EC", <a href='../S/851.html#L100' title='Defined at 100 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_EC</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1249' name='L1249'></a>1249 <em class='sharp'>#endif</em>
<a id='L1250' name='L1250'></a>1250 
<a id='L1251' name='L1251'></a>1251         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_RAW_DATA", <a href='../S/852.html#L32' title='Defined at 32 in ext/openssl/php_openssl.h.'>OPENSSL_RAW_DATA</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1252' name='L1252'></a>1252         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_ZERO_PADDING", <a href='../S/852.html#L33' title='Defined at 33 in ext/openssl/php_openssl.h.'>OPENSSL_ZERO_PADDING</a>, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1253' name='L1253'></a>1253 
<a id='L1254' name='L1254'></a>1254 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &gt;= 0x0090806fL &amp;&amp; !<strong class='reserved'>defined</strong>(<a href='../Y/4656.html' title='Multiple used in 2 places.'>OPENSSL_NO_TLSEXT</a>)
<a id='L1255' name='L1255'></a>1255         <em class='comment'>/* SNI support included in OpenSSL &gt;= 0.9.8j */</em>
<a id='L1256' name='L1256'></a>1256         <a href='../S/1647.html#L42' title='Defined at 42 in Zend/zend_constants.h.'>REGISTER_LONG_CONSTANT</a>("OPENSSL_TLSEXT_SERVER_NAME", 1, <a href='../S/1647.html#L27' title='Defined at 27 in Zend/zend_constants.h.'>CONST_CS</a>|<a href='../S/1647.html#L28' title='Defined at 28 in Zend/zend_constants.h.'>CONST_PERSISTENT</a>);
<a id='L1257' name='L1257'></a>1257 <em class='sharp'>#endif</em>
<a id='L1258' name='L1258'></a>1258 
<a id='L1259' name='L1259'></a>1259         <em class='comment'>/* Determine default SSL configuration file */</em>
<a id='L1260' name='L1260'></a>1260         <a href='../Y/14275.html' title='Multiple used in 13 places.'>config_filename</a> = <a href='../Y/19243.html' title='Multiple used in 103 places.'>getenv</a>("OPENSSL_CONF");
<a id='L1261' name='L1261'></a>1261         <strong class='reserved'>if</strong> (<a href='../Y/14275.html' title='Multiple used in 13 places.'>config_filename</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1262' name='L1262'></a>1262                 <a href='../Y/14275.html' title='Multiple used in 13 places.'>config_filename</a> = <a href='../Y/19243.html' title='Multiple used in 103 places.'>getenv</a>("SSLEAY_CONF");
<a id='L1263' name='L1263'></a>1263         <em class='brace'>}</em>
<a id='L1264' name='L1264'></a>1264 
<a id='L1265' name='L1265'></a>1265         <em class='comment'>/* default to 'openssl.cnf' if no environment variable is set */</em>
<a id='L1266' name='L1266'></a>1266         <strong class='reserved'>if</strong> (<a href='../Y/14275.html' title='Multiple used in 13 places.'>config_filename</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1267' name='L1267'></a>1267                 <a href='../D/29935.html' title='Multiple defined in 5 places.'>snprintf</a>(<a href='../Y/15465.html' title='Multiple used in 6 places.'>default_ssl_conf_filename</a>, <strong class='reserved'>sizeof</strong>(<a href='../Y/15465.html' title='Multiple used in 6 places.'>default_ssl_conf_filename</a>), "%s/%s",
<a id='L1268' name='L1268'></a>1268                                 <a href='../Y/7440.html' title='Multiple used in 2 places.'>X509_get_default_cert_area</a>(),
<a id='L1269' name='L1269'></a>1269                                 "openssl.cnf");
<a id='L1270' name='L1270'></a>1270         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L1271' name='L1271'></a>1271                 <a href='../S/1378.html#L128' title='Defined at 128 in main/php.h.'>strlcpy</a>(<a href='../Y/15465.html' title='Multiple used in 6 places.'>default_ssl_conf_filename</a>, <a href='../Y/14275.html' title='Multiple used in 13 places.'>config_filename</a>, <strong class='reserved'>sizeof</strong>(<a href='../Y/15465.html' title='Multiple used in 6 places.'>default_ssl_conf_filename</a>));
<a id='L1272' name='L1272'></a>1272         <em class='brace'>}</em>
<a id='L1273' name='L1273'></a>1273 
<a id='L1274' name='L1274'></a>1274         <a href='../S/1428.html#L32' title='Defined at 32 in main/streams/transports.c.'>php_stream_xport_register</a>("ssl", <a href='../S/853.html#L2540' title='Defined at 2540 in ext/openssl/xp_ssl.c.'>php_openssl_ssl_socket_factory</a>);
<a id='L1275' name='L1275'></a>1275 <em class='sharp'>#ifndef</em> <a href='../Y/4655.html' title='Multiple used in 3 places.'>OPENSSL_NO_SSL3</a>
<a id='L1276' name='L1276'></a>1276         <a href='../S/1428.html#L32' title='Defined at 32 in main/streams/transports.c.'>php_stream_xport_register</a>("sslv3", <a href='../S/853.html#L2540' title='Defined at 2540 in ext/openssl/xp_ssl.c.'>php_openssl_ssl_socket_factory</a>);
<a id='L1277' name='L1277'></a>1277 <em class='sharp'>#endif</em>
<a id='L1278' name='L1278'></a>1278 <em class='sharp'>#ifndef</em> <a href='../Y/4654.html' title='Multiple used in 3 places.'>OPENSSL_NO_SSL2</a>
<a id='L1279' name='L1279'></a>1279         <a href='../S/1428.html#L32' title='Defined at 32 in main/streams/transports.c.'>php_stream_xport_register</a>("sslv2", <a href='../S/853.html#L2540' title='Defined at 2540 in ext/openssl/xp_ssl.c.'>php_openssl_ssl_socket_factory</a>);
<a id='L1280' name='L1280'></a>1280 <em class='sharp'>#endif</em>
<a id='L1281' name='L1281'></a>1281         <a href='../S/1428.html#L32' title='Defined at 32 in main/streams/transports.c.'>php_stream_xport_register</a>("tls", <a href='../S/853.html#L2540' title='Defined at 2540 in ext/openssl/xp_ssl.c.'>php_openssl_ssl_socket_factory</a>);
<a id='L1282' name='L1282'></a>1282         <a href='../S/1428.html#L32' title='Defined at 32 in main/streams/transports.c.'>php_stream_xport_register</a>("tlsv1.0", <a href='../S/853.html#L2540' title='Defined at 2540 in ext/openssl/xp_ssl.c.'>php_openssl_ssl_socket_factory</a>);
<a id='L1283' name='L1283'></a>1283 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &gt;= 0x10001001L
<a id='L1284' name='L1284'></a>1284         <a href='../S/1428.html#L32' title='Defined at 32 in main/streams/transports.c.'>php_stream_xport_register</a>("tlsv1.1", <a href='../S/853.html#L2540' title='Defined at 2540 in ext/openssl/xp_ssl.c.'>php_openssl_ssl_socket_factory</a>);
<a id='L1285' name='L1285'></a>1285         <a href='../S/1428.html#L32' title='Defined at 32 in main/streams/transports.c.'>php_stream_xport_register</a>("tlsv1.2", <a href='../S/853.html#L2540' title='Defined at 2540 in ext/openssl/xp_ssl.c.'>php_openssl_ssl_socket_factory</a>);
<a id='L1286' name='L1286'></a>1286 <em class='sharp'>#endif</em>
<a id='L1287' name='L1287'></a>1287 
<a id='L1288' name='L1288'></a>1288         <em class='comment'>/* override the default tcp socket provider */</em>
<a id='L1289' name='L1289'></a>1289         <a href='../S/1428.html#L32' title='Defined at 32 in main/streams/transports.c.'>php_stream_xport_register</a>("tcp", <a href='../S/853.html#L2540' title='Defined at 2540 in ext/openssl/xp_ssl.c.'>php_openssl_ssl_socket_factory</a>);
<a id='L1290' name='L1290'></a>1290 
<a id='L1291' name='L1291'></a>1291         <a href='../S/1427.html#L1701' title='Defined at 1701 in main/streams/streams.c.'>php_register_url_stream_wrapper</a>("https", &amp;<a href='../Y/32594.html' title='Multiple used in 4 places.'>php_stream_http_wrapper</a>);
<a id='L1292' name='L1292'></a>1292         <a href='../S/1427.html#L1701' title='Defined at 1701 in main/streams/streams.c.'>php_register_url_stream_wrapper</a>("ftps", &amp;<a href='../Y/32590.html' title='Multiple used in 4 places.'>php_stream_ftp_wrapper</a>);
<a id='L1293' name='L1293'></a>1293 
<a id='L1294' name='L1294'></a>1294         <a href='../S/1674.html#L149' title='Defined at 149 in Zend/zend_ini.h.'>REGISTER_INI_ENTRIES</a>();
<a id='L1295' name='L1295'></a>1295 
<a id='L1296' name='L1296'></a>1296         <strong class='reserved'>return</strong> <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>;
<a id='L1297' name='L1297'></a>1297 <em class='brace'>}</em>
<a id='L1298' name='L1298'></a>1298 <em class='comment'>/* }}} */</em>
<a id='L1299' name='L1299'></a>1299 
<a id='L1300' name='L1300'></a>1300 <em class='comment'>/* {{{ PHP_MINFO_FUNCTION</em>
<a id='L1301' name='L1301'></a>1301 <em class='comment'> */</em>
<a id='L1302' name='L1302'></a>1302 <a href='../R/7343.html' title='Multiple referred from 70 places.'>PHP_MINFO_FUNCTION</a>(<a href='../Y/29730.html' title='Multiple used in 17 places.'>openssl</a>)
<a id='L1303' name='L1303'></a>1303 <em class='brace'>{</em>
<a id='L1304' name='L1304'></a>1304         <a href='../S/1113.html#L1097' title='Defined at 1097 in ext/standard/info.c.'>php_info_print_table_start</a>();
<a id='L1305' name='L1305'></a>1305         <a href='../S/1113.html#L1251' title='Defined at 1251 in ext/standard/info.c.'>php_info_print_table_row</a>(2, "OpenSSL support", "enabled");
<a id='L1306' name='L1306'></a>1306         <a href='../S/1113.html#L1251' title='Defined at 1251 in ext/standard/info.c.'>php_info_print_table_row</a>(2, "OpenSSL Library Version", SSLeay_version(SSLEAY_VERSION));
<a id='L1307' name='L1307'></a>1307         <a href='../S/1113.html#L1251' title='Defined at 1251 in ext/standard/info.c.'>php_info_print_table_row</a>(2, "OpenSSL Header Version", <a href='../Y/4659.html' title='Multiple used in 2 places.'>OPENSSL_VERSION_TEXT</a>);
<a id='L1308' name='L1308'></a>1308         <a href='../S/1113.html#L1251' title='Defined at 1251 in ext/standard/info.c.'>php_info_print_table_row</a>(2, "Openssl default config", <a href='../Y/15465.html' title='Multiple used in 6 places.'>default_ssl_conf_filename</a>);
<a id='L1309' name='L1309'></a>1309         <a href='../S/1113.html#L1107' title='Defined at 1107 in ext/standard/info.c.'>php_info_print_table_end</a>();
<a id='L1310' name='L1310'></a>1310         <a href='../S/1674.html#L151' title='Defined at 151 in Zend/zend_ini.h.'>DISPLAY_INI_ENTRIES</a>();
<a id='L1311' name='L1311'></a>1311 <em class='brace'>}</em>
<a id='L1312' name='L1312'></a>1312 <em class='comment'>/* }}} */</em>
<a id='L1313' name='L1313'></a>1313 
<a id='L1314' name='L1314'></a>1314 <em class='comment'>/* {{{ PHP_MSHUTDOWN_FUNCTION</em>
<a id='L1315' name='L1315'></a>1315 <em class='comment'> */</em>
<a id='L1316' name='L1316'></a>1316 <a href='../R/7364.html' title='Multiple referred from 56 places.'>PHP_MSHUTDOWN_FUNCTION</a>(<a href='../Y/29730.html' title='Multiple used in 17 places.'>openssl</a>)
<a id='L1317' name='L1317'></a>1317 <em class='brace'>{</em>
<a id='L1318' name='L1318'></a>1318         EVP_cleanup();
<a id='L1319' name='L1319'></a>1319 
<a id='L1320' name='L1320'></a>1320 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &gt;= 0x00090805f
<a id='L1321' name='L1321'></a>1321         ERR_free_strings();
<a id='L1322' name='L1322'></a>1322 <em class='sharp'>#endif</em>
<a id='L1323' name='L1323'></a>1323 
<a id='L1324' name='L1324'></a>1324         <a href='../S/1427.html#L1712' title='Defined at 1712 in main/streams/streams.c.'>php_unregister_url_stream_wrapper</a>("https");
<a id='L1325' name='L1325'></a>1325         <a href='../S/1427.html#L1712' title='Defined at 1712 in main/streams/streams.c.'>php_unregister_url_stream_wrapper</a>("ftps");
<a id='L1326' name='L1326'></a>1326 
<a id='L1327' name='L1327'></a>1327         <a href='../S/1428.html#L37' title='Defined at 37 in main/streams/transports.c.'>php_stream_xport_unregister</a>("ssl");
<a id='L1328' name='L1328'></a>1328 <em class='sharp'>#ifndef</em> <a href='../Y/4654.html' title='Multiple used in 3 places.'>OPENSSL_NO_SSL2</a>
<a id='L1329' name='L1329'></a>1329         <a href='../S/1428.html#L37' title='Defined at 37 in main/streams/transports.c.'>php_stream_xport_unregister</a>("sslv2");
<a id='L1330' name='L1330'></a>1330 <em class='sharp'>#endif</em>
<a id='L1331' name='L1331'></a>1331 <em class='sharp'>#ifndef</em> <a href='../Y/4655.html' title='Multiple used in 3 places.'>OPENSSL_NO_SSL3</a>
<a id='L1332' name='L1332'></a>1332         <a href='../S/1428.html#L37' title='Defined at 37 in main/streams/transports.c.'>php_stream_xport_unregister</a>("sslv3");
<a id='L1333' name='L1333'></a>1333 <em class='sharp'>#endif</em>
<a id='L1334' name='L1334'></a>1334         <a href='../S/1428.html#L37' title='Defined at 37 in main/streams/transports.c.'>php_stream_xport_unregister</a>("tls");
<a id='L1335' name='L1335'></a>1335         <a href='../S/1428.html#L37' title='Defined at 37 in main/streams/transports.c.'>php_stream_xport_unregister</a>("tlsv1.0");
<a id='L1336' name='L1336'></a>1336 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &gt;= 0x10001001L
<a id='L1337' name='L1337'></a>1337         <a href='../S/1428.html#L37' title='Defined at 37 in main/streams/transports.c.'>php_stream_xport_unregister</a>("tlsv1.1");
<a id='L1338' name='L1338'></a>1338         <a href='../S/1428.html#L37' title='Defined at 37 in main/streams/transports.c.'>php_stream_xport_unregister</a>("tlsv1.2");
<a id='L1339' name='L1339'></a>1339 <em class='sharp'>#endif</em>
<a id='L1340' name='L1340'></a>1340 
<a id='L1341' name='L1341'></a>1341         <em class='comment'>/* reinstate the default tcp handler */</em>
<a id='L1342' name='L1342'></a>1342         <a href='../S/1428.html#L32' title='Defined at 32 in main/streams/transports.c.'>php_stream_xport_register</a>("tcp", <a href='../S/1430.html#L855' title='Defined at 855 in main/streams/xp_socket.c.'>php_stream_generic_socket_factory</a>);
<a id='L1343' name='L1343'></a>1343 
<a id='L1344' name='L1344'></a>1344         <a href='../S/1674.html#L150' title='Defined at 150 in Zend/zend_ini.h.'>UNREGISTER_INI_ENTRIES</a>();
<a id='L1345' name='L1345'></a>1345 
<a id='L1346' name='L1346'></a>1346         <strong class='reserved'>return</strong> <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>;
<a id='L1347' name='L1347'></a>1347 <em class='brace'>}</em>
<a id='L1348' name='L1348'></a>1348 <em class='comment'>/* }}} */</em>
<a id='L1349' name='L1349'></a>1349 
<a id='L1350' name='L1350'></a>1350 <em class='comment'>/* {{{ x509 cert functions */</em>
<a id='L1351' name='L1351'></a>1351 
<a id='L1352' name='L1352'></a>1352 <em class='comment'>/* {{{ proto array openssl_get_cert_locations(void)</em>
<a id='L1353' name='L1353'></a>1353 <em class='comment'>   Retrieve an array mapping available certificate locations */</em>
<a id='L1354' name='L1354'></a>1354 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29745.html' title='Multiple used in 3 places.'>openssl_get_cert_locations</a>)
<a id='L1355' name='L1355'></a>1355 <em class='brace'>{</em>
<a id='L1356' name='L1356'></a>1356         <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>);
<a id='L1357' name='L1357'></a>1357 
<a id='L1358' name='L1358'></a>1358         <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "default_cert_file", (<strong class='reserved'>char</strong> *) X509_get_default_cert_file());
<a id='L1359' name='L1359'></a>1359         <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "default_cert_file_env", (<strong class='reserved'>char</strong> *) X509_get_default_cert_file_env());
<a id='L1360' name='L1360'></a>1360         <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "default_cert_dir", (<strong class='reserved'>char</strong> *) X509_get_default_cert_dir());
<a id='L1361' name='L1361'></a>1361         <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "default_cert_dir_env", (<strong class='reserved'>char</strong> *) X509_get_default_cert_dir_env());
<a id='L1362' name='L1362'></a>1362         <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "default_private_dir", (<strong class='reserved'>char</strong> *) X509_get_default_private_dir());
<a id='L1363' name='L1363'></a>1363         <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "default_default_cert_area", (<strong class='reserved'>char</strong> *) <a href='../Y/7440.html' title='Multiple used in 2 places.'>X509_get_default_cert_area</a>());
<a id='L1364' name='L1364'></a>1364         <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "ini_cafile",
<a id='L1365' name='L1365'></a>1365                 <a href='../S/1673.html#L479' title='Defined at 479 in Zend/zend_ini.c.'>zend_ini_string</a>("openssl.cafile", <strong class='reserved'>sizeof</strong>("openssl.cafile")-1, 0));
<a id='L1366' name='L1366'></a>1366         <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "ini_capath",
<a id='L1367' name='L1367'></a>1367                 <a href='../S/1673.html#L479' title='Defined at 479 in Zend/zend_ini.c.'>zend_ini_string</a>("openssl.capath", <strong class='reserved'>sizeof</strong>("openssl.capath")-1, 0));
<a id='L1368' name='L1368'></a>1368 <em class='brace'>}</em>
<a id='L1369' name='L1369'></a>1369 <em class='comment'>/* }}} */</em>
<a id='L1370' name='L1370'></a>1370 
<a id='L1371' name='L1371'></a>1371 
<a id='L1372' name='L1372'></a>1372 <em class='comment'>/* {{{ php_openssl_x509_from_zval</em>
<a id='L1373' name='L1373'></a>1373 <em class='comment'>        Given a zval, coerce it into an X509 object.</em>
<a id='L1374' name='L1374'></a>1374 <em class='comment'>        The zval can be:</em>
<a id='L1375' name='L1375'></a>1375 <em class='comment'>                . X509 resource created using openssl_read_x509()</em>
<a id='L1376' name='L1376'></a>1376 <em class='comment'>                . if it starts with file:// then it will be interpreted as the path to that cert</em>
<a id='L1377' name='L1377'></a>1377 <em class='comment'>                . it will be interpreted as the cert data</em>
<a id='L1378' name='L1378'></a>1378 <em class='comment'>        If you supply makeresource, the result will be registered as an x509 resource and</em>
<a id='L1379' name='L1379'></a>1379 <em class='comment'>        it's value returned in makeresource.</em>
<a id='L1380' name='L1380'></a>1380 <em class='comment'>*/</em>
<a id='L1381' name='L1381'></a>1381 <strong class='reserved'>static</strong> <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../R/24328.html' title='Multiple referred from 18 places.'>php_openssl_x509_from_zval</a>(<a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>, <strong class='reserved'>int</strong> <a href='../Y/25757.html' title='Multiple used in 8 places.'>makeresource</a>, <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> **<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a>)
<a id='L1382' name='L1382'></a>1382 <em class='brace'>{</em>
<a id='L1383' name='L1383'></a>1383         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> *<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1384' name='L1384'></a>1384 
<a id='L1385' name='L1385'></a>1385         <strong class='reserved'>if</strong> (<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a>) <em class='brace'>{</em>
<a id='L1386' name='L1386'></a>1386                 *<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1387' name='L1387'></a>1387         <em class='brace'>}</em>
<a id='L1388' name='L1388'></a>1388         <strong class='reserved'>if</strong> (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) == <a href='../S/1731.html#L311' title='Defined at 311 in Zend/zend_types.h.'>IS_RESOURCE</a>) <em class='brace'>{</em>
<a id='L1389' name='L1389'></a>1389                 <em class='comment'>/* is it an x509 resource ? */</em>
<a id='L1390' name='L1390'></a>1390                 <strong class='reserved'>void</strong> * <a href='../Y/40693.html' title='Multiple used in 151 places.'>what</a>;
<a id='L1391' name='L1391'></a>1391                 <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a> = <a href='../S/1731.html#L552' title='Defined at 552 in Zend/zend_types.h.'>Z_RES_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>);
<a id='L1392' name='L1392'></a>1392 
<a id='L1393' name='L1393'></a>1393                 <a href='../Y/40693.html' title='Multiple used in 151 places.'>what</a> = <a href='../S/1690.html#L124' title='Defined at 124 in Zend/zend_list.c.'>zend_fetch_resource</a>(<a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>, "OpenSSL X.509", <a href='../Y/24937.html' title='Multiple used in 9 places.'>le_x509</a>);
<a id='L1394' name='L1394'></a>1394                 <strong class='reserved'>if</strong> (!<a href='../Y/40693.html' title='Multiple used in 151 places.'>what</a>) <em class='brace'>{</em>
<a id='L1395' name='L1395'></a>1395                         <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1396' name='L1396'></a>1396                 <em class='brace'>}</em>
<a id='L1397' name='L1397'></a>1397                 <em class='comment'>/* this is so callers can decide if they should free the X509 */</em>
<a id='L1398' name='L1398'></a>1398                 <strong class='reserved'>if</strong> (<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a>) <em class='brace'>{</em>
<a id='L1399' name='L1399'></a>1399                         *<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a> = <a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>;
<a id='L1400' name='L1400'></a>1400                         <a href='../D/17793.html' title='Multiple defined in 3 places.'>Z_ADDREF_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>);
<a id='L1401' name='L1401'></a>1401                 <em class='brace'>}</em>
<a id='L1402' name='L1402'></a>1402                 <strong class='reserved'>return</strong> (<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>*)<a href='../Y/40693.html' title='Multiple used in 151 places.'>what</a>;
<a id='L1403' name='L1403'></a>1403         <em class='brace'>}</em>
<a id='L1404' name='L1404'></a>1404 
<a id='L1405' name='L1405'></a>1405         <strong class='reserved'>if</strong> (!(<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) == <a href='../S/1731.html#L308' title='Defined at 308 in Zend/zend_types.h.'>IS_STRING</a> || <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) == <a href='../S/1731.html#L310' title='Defined at 310 in Zend/zend_types.h.'>IS_OBJECT</a>)) <em class='brace'>{</em>
<a id='L1406' name='L1406'></a>1406                 <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1407' name='L1407'></a>1407         <em class='brace'>}</em>
<a id='L1408' name='L1408'></a>1408 
<a id='L1409' name='L1409'></a>1409         <em class='comment'>/* force it to be a string and check if it refers to a file */</em>
<a id='L1410' name='L1410'></a>1410         <a href='../S/1707.html#L410' title='Defined at 410 in Zend/zend_operators.h.'>convert_to_string_ex</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>);
<a id='L1411' name='L1411'></a>1411 
<a id='L1412' name='L1412'></a>1412         <strong class='reserved'>if</strong> (<a href='../S/1731.html#L519' title='Defined at 519 in Zend/zend_types.h.'>Z_STRLEN_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) &gt; 7 &amp;&amp; <a href='../S/868.html#L371' title='Defined at 371 in ext/pcre/pcrelib/pcre_internal.h.'>memcmp</a>(<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>), "file://", <strong class='reserved'>sizeof</strong>("file://") - 1) == 0) <em class='brace'>{</em>
<a id='L1413' name='L1413'></a>1413                 <em class='comment'>/* read cert from the named file */</em>
<a id='L1414' name='L1414'></a>1414                 <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> *<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>;
<a id='L1415' name='L1415'></a>1415 
<a id='L1416' name='L1416'></a>1416                 <strong class='reserved'>if</strong> (<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) + (<strong class='reserved'>sizeof</strong>("file://") - 1))) <em class='brace'>{</em>
<a id='L1417' name='L1417'></a>1417                         <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1418' name='L1418'></a>1418                 <em class='brace'>}</em>
<a id='L1419' name='L1419'></a>1419 
<a id='L1420' name='L1420'></a>1420                 <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) + (<strong class='reserved'>sizeof</strong>("file://") - 1), "r");
<a id='L1421' name='L1421'></a>1421                 <strong class='reserved'>if</strong> (<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1422' name='L1422'></a>1422                         <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1423' name='L1423'></a>1423                 <em class='brace'>}</em>
<a id='L1424' name='L1424'></a>1424                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../Y/4930.html' title='Multiple used in 2 places.'>PEM_read_bio_X509</a>(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L1425' name='L1425'></a>1425                 <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>);
<a id='L1426' name='L1426'></a>1426         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L1427' name='L1427'></a>1427                 <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> *<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>;
<a id='L1428' name='L1428'></a>1428 
<a id='L1429' name='L1429'></a>1429                 <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> = <a href='../Y/233.html' title='Multiple used in 8 places.'>BIO_new_mem_buf</a>(<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>), (<strong class='reserved'>int</strong>)<a href='../S/1731.html#L519' title='Defined at 519 in Zend/zend_types.h.'>Z_STRLEN_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>));
<a id='L1430' name='L1430'></a>1430                 <strong class='reserved'>if</strong> (<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1431' name='L1431'></a>1431                         <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1432' name='L1432'></a>1432                 <em class='brace'>}</em>
<a id='L1433' name='L1433'></a>1433 <em class='sharp'>#ifdef</em> TYPEDEF_D2I_OF
<a id='L1434' name='L1434'></a>1434                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = (<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> *) <a href='../Y/4923.html' title='Multiple used in 2 places.'>PEM_ASN1_read_bio</a>((d2i_of_void *)<a href='../Y/14954.html' title='Multiple used in 2 places.'>d2i_X509</a>, <a href='../Y/4924.html' title='Multiple used in 2 places.'>PEM_STRING_X509</a>, <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L1435' name='L1435'></a>1435 <em class='sharp'>#else</em>
<a id='L1436' name='L1436'></a>1436                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = (<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> *) <a href='../Y/4923.html' title='Multiple used in 2 places.'>PEM_ASN1_read_bio</a>((<strong class='reserved'>char</strong> *(*)())<a href='../Y/14954.html' title='Multiple used in 2 places.'>d2i_X509</a>, <a href='../Y/4924.html' title='Multiple used in 2 places.'>PEM_STRING_X509</a>, <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L1437' name='L1437'></a>1437 <em class='sharp'>#endif</em>
<a id='L1438' name='L1438'></a>1438                 <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>);
<a id='L1439' name='L1439'></a>1439         <em class='brace'>}</em>
<a id='L1440' name='L1440'></a>1440 
<a id='L1441' name='L1441'></a>1441         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> &amp;&amp; <a href='../Y/25757.html' title='Multiple used in 8 places.'>makeresource</a> &amp;&amp; <a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a>) <em class='brace'>{</em>
<a id='L1442' name='L1442'></a>1442                 *<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a> = <a href='../S/1690.html#L94' title='Defined at 94 in Zend/zend_list.c.'>zend_register_resource</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../Y/24937.html' title='Multiple used in 9 places.'>le_x509</a>);
<a id='L1443' name='L1443'></a>1443         <em class='brace'>}</em>
<a id='L1444' name='L1444'></a>1444         <strong class='reserved'>return</strong> <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>;
<a id='L1445' name='L1445'></a>1445 <em class='brace'>}</em>
<a id='L1446' name='L1446'></a>1446 
<a id='L1447' name='L1447'></a>1447 <em class='comment'>/* }}} */</em>
<a id='L1448' name='L1448'></a>1448 
<a id='L1449' name='L1449'></a>1449 <em class='comment'>/* {{{ proto bool openssl_x509_export_to_file(mixed x509, string outfilename [, bool notext = true])</em>
<a id='L1450' name='L1450'></a>1450 <em class='comment'>   Exports a CERT to file or a var */</em>
<a id='L1451' name='L1451'></a>1451 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29784.html' title='Multiple used in 3 places.'>openssl_x509_export_to_file</a>)
<a id='L1452' name='L1452'></a>1452 <em class='brace'>{</em>
<a id='L1453' name='L1453'></a>1453         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>;
<a id='L1454' name='L1454'></a>1454         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>;
<a id='L1455' name='L1455'></a>1455         <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a> = 1;
<a id='L1456' name='L1456'></a>1456         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>;
<a id='L1457' name='L1457'></a>1457         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>;
<a id='L1458' name='L1458'></a>1458         <strong class='reserved'>char</strong> * <a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>;
<a id='L1459' name='L1459'></a>1459         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/17892.html' title='Multiple used in 356 places.'>filename_len</a>;
<a id='L1460' name='L1460'></a>1460 
<a id='L1461' name='L1461'></a>1461         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "zp|b", &amp;<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, &amp;<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>, &amp;<a href='../Y/17892.html' title='Multiple used in 356 places.'>filename_len</a>, &amp;<a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L1462' name='L1462'></a>1462                 <strong class='reserved'>return</strong>;
<a id='L1463' name='L1463'></a>1463         <em class='brace'>}</em>
<a id='L1464' name='L1464'></a>1464         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L1465' name='L1465'></a>1465 
<a id='L1466' name='L1466'></a>1466         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, 0, &amp;<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>);
<a id='L1467' name='L1467'></a>1467         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1468' name='L1468'></a>1468                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "cannot get cert from parameter 1");
<a id='L1469' name='L1469'></a>1469                 <strong class='reserved'>return</strong>;
<a id='L1470' name='L1470'></a>1470         <em class='brace'>}</em>
<a id='L1471' name='L1471'></a>1471 
<a id='L1472' name='L1472'></a>1472         <strong class='reserved'>if</strong> (<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>)) <em class='brace'>{</em>
<a id='L1473' name='L1473'></a>1473                 <strong class='reserved'>return</strong>;
<a id='L1474' name='L1474'></a>1474         <em class='brace'>}</em>
<a id='L1475' name='L1475'></a>1475 
<a id='L1476' name='L1476'></a>1476         <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>, "w");
<a id='L1477' name='L1477'></a>1477         <strong class='reserved'>if</strong> (<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>) <em class='brace'>{</em>
<a id='L1478' name='L1478'></a>1478                 <strong class='reserved'>if</strong> (!<a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a>) <em class='brace'>{</em>
<a id='L1479' name='L1479'></a>1479                         <a href='../Y/7458.html' title='Multiple used in 2 places.'>X509_print</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L1480' name='L1480'></a>1480                 <em class='brace'>}</em>
<a id='L1481' name='L1481'></a>1481                 <a href='../Y/4935.html' title='Multiple used in 5 places.'>PEM_write_bio_X509</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L1482' name='L1482'></a>1482 
<a id='L1483' name='L1483'></a>1483                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L1484' name='L1484'></a>1484         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L1485' name='L1485'></a>1485                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "error opening file %s", <a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>);
<a id='L1486' name='L1486'></a>1486         <em class='brace'>}</em>
<a id='L1487' name='L1487'></a>1487         <strong class='reserved'>if</strong> (<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) <em class='brace'>{</em>
<a id='L1488' name='L1488'></a>1488                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L1489' name='L1489'></a>1489         <em class='brace'>}</em>
<a id='L1490' name='L1490'></a>1490         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>);
<a id='L1491' name='L1491'></a>1491 <em class='brace'>}</em>
<a id='L1492' name='L1492'></a>1492 <em class='comment'>/* }}} */</em>
<a id='L1493' name='L1493'></a>1493 
<a id='L1494' name='L1494'></a>1494 <em class='comment'>/* {{{ proto string openssl_spki_new(mixed zpkey, string challenge [, mixed method])</em>
<a id='L1495' name='L1495'></a>1495 <em class='comment'>   Creates new private key (or uses existing) and creates a new spki cert</em>
<a id='L1496' name='L1496'></a>1496 <em class='comment'>   outputting results to var */</em>
<a id='L1497' name='L1497'></a>1497 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29778.html' title='Multiple used in 3 places.'>openssl_spki_new</a>)
<a id='L1498' name='L1498'></a>1498 <em class='brace'>{</em>
<a id='L1499' name='L1499'></a>1499         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/13527.html' title='Multiple used in 3 places.'>challenge_len</a>;
<a id='L1500' name='L1500'></a>1500         <strong class='reserved'>char</strong> * <a href='../Y/13526.html' title='Multiple used in 7 places.'>challenge</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, * <a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1501' name='L1501'></a>1501         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> * <a href='../D/29280.html' title='Multiple defined in 6 places.'>s</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1502' name='L1502'></a>1502         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1503' name='L1503'></a>1503         <strong class='reserved'>const</strong> <strong class='reserved'>char</strong> *<a href='../Y/36637.html' title='Multiple used in 7 places.'>spkac</a> = "SPKAC=";
<a id='L1504' name='L1504'></a>1504         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/9053.html' title='Multiple used in 59 places.'>algo</a> = <a href='../S/851.html#L70' title='Defined at 70 in ext/openssl/openssl.c.'>OPENSSL_ALGO_MD5</a>;
<a id='L1505' name='L1505'></a>1505 
<a id='L1506' name='L1506'></a>1506         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1507' name='L1507'></a>1507         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1508' name='L1508'></a>1508         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1509' name='L1509'></a>1509         <a href='../Y/4194.html' title='Multiple used in 4 places.'>NETSCAPE_SPKI</a> *<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>=<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1510' name='L1510'></a>1510         <strong class='reserved'>const</strong> <a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *<a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>;
<a id='L1511' name='L1511'></a>1511 
<a id='L1512' name='L1512'></a>1512         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "rs|z", &amp;<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, &amp;<a href='../Y/13526.html' title='Multiple used in 7 places.'>challenge</a>, &amp;<a href='../Y/13527.html' title='Multiple used in 3 places.'>challenge_len</a>, &amp;<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L1513' name='L1513'></a>1513                 <strong class='reserved'>return</strong>;
<a id='L1514' name='L1514'></a>1514         <em class='brace'>}</em>
<a id='L1515' name='L1515'></a>1515         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L1516' name='L1516'></a>1516 
<a id='L1517' name='L1517'></a>1517         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, 0, <a href='../Y/13526.html' title='Multiple used in 7 places.'>challenge</a>, 1, &amp;<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>);
<a id='L1518' name='L1518'></a>1518 
<a id='L1519' name='L1519'></a>1519         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1520' name='L1520'></a>1520                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to use supplied private key");
<a id='L1521' name='L1521'></a>1521                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1522' name='L1522'></a>1522         <em class='brace'>}</em>
<a id='L1523' name='L1523'></a>1523 
<a id='L1524' name='L1524'></a>1524         <strong class='reserved'>if</strong> (<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1525' name='L1525'></a>1525                 <strong class='reserved'>if</strong> (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>) == <a href='../S/1731.html#L306' title='Defined at 306 in Zend/zend_types.h.'>IS_LONG</a>) <em class='brace'>{</em>
<a id='L1526' name='L1526'></a>1526                         <a href='../Y/9053.html' title='Multiple used in 59 places.'>algo</a> = <a href='../S/1731.html#L507' title='Defined at 507 in Zend/zend_types.h.'>Z_LVAL_P</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>);
<a id='L1527' name='L1527'></a>1527                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L1528' name='L1528'></a>1528                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Algorithm must be of supported type");
<a id='L1529' name='L1529'></a>1529                         <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1530' name='L1530'></a>1530                 <em class='brace'>}</em>
<a id='L1531' name='L1531'></a>1531         <em class='brace'>}</em>
<a id='L1532' name='L1532'></a>1532         <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = <a href='../S/851.html#L1059' title='Defined at 1059 in ext/openssl/openssl.c.'>php_openssl_get_evp_md_from_algo</a>(<a href='../Y/9053.html' title='Multiple used in 59 places.'>algo</a>);
<a id='L1533' name='L1533'></a>1533 
<a id='L1534' name='L1534'></a>1534         <strong class='reserved'>if</strong> (!<a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>) <em class='brace'>{</em>
<a id='L1535' name='L1535'></a>1535                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown signature algorithm");
<a id='L1536' name='L1536'></a>1536                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1537' name='L1537'></a>1537         <em class='brace'>}</em>
<a id='L1538' name='L1538'></a>1538 
<a id='L1539' name='L1539'></a>1539         <strong class='reserved'>if</strong> ((<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a> = NETSCAPE_SPKI_new()) == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1540' name='L1540'></a>1540                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to create new SPKAC");
<a id='L1541' name='L1541'></a>1541                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1542' name='L1542'></a>1542         <em class='brace'>}</em>
<a id='L1543' name='L1543'></a>1543 
<a id='L1544' name='L1544'></a>1544         <strong class='reserved'>if</strong> (<a href='../Y/13526.html' title='Multiple used in 7 places.'>challenge</a>) <em class='brace'>{</em>
<a id='L1545' name='L1545'></a>1545                 <strong class='reserved'>if</strong> (!ASN1_STRING_set(<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>-&gt;<a href='../Y/36637.html' title='Multiple used in 7 places.'>spkac</a>-&gt;<a href='../Y/13526.html' title='Multiple used in 7 places.'>challenge</a>, <a href='../Y/13526.html' title='Multiple used in 7 places.'>challenge</a>, (<strong class='reserved'>int</strong>)<a href='../Y/13527.html' title='Multiple used in 3 places.'>challenge_len</a>)) <em class='brace'>{</em>
<a id='L1546' name='L1546'></a>1546                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to set challenge data");
<a id='L1547' name='L1547'></a>1547                         <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1548' name='L1548'></a>1548                 <em class='brace'>}</em>
<a id='L1549' name='L1549'></a>1549         <em class='brace'>}</em>
<a id='L1550' name='L1550'></a>1550 
<a id='L1551' name='L1551'></a>1551         <strong class='reserved'>if</strong> (!NETSCAPE_SPKI_set_pubkey(<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>, <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>)) <em class='brace'>{</em>
<a id='L1552' name='L1552'></a>1552                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to embed public key");
<a id='L1553' name='L1553'></a>1553                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1554' name='L1554'></a>1554         <em class='brace'>}</em>
<a id='L1555' name='L1555'></a>1555 
<a id='L1556' name='L1556'></a>1556         <strong class='reserved'>if</strong> (!NETSCAPE_SPKI_sign(<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>, <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>, <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>)) <em class='brace'>{</em>
<a id='L1557' name='L1557'></a>1557                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to sign with specified algorithm");
<a id='L1558' name='L1558'></a>1558                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1559' name='L1559'></a>1559         <em class='brace'>}</em>
<a id='L1560' name='L1560'></a>1560 
<a id='L1561' name='L1561'></a>1561         <a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a> = NETSCAPE_SPKI_b64_encode(<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>);
<a id='L1562' name='L1562'></a>1562         <strong class='reserved'>if</strong> (!<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a>)<em class='brace'>{</em>
<a id='L1563' name='L1563'></a>1563                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to encode SPKAC");
<a id='L1564' name='L1564'></a>1564                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1565' name='L1565'></a>1565         <em class='brace'>}</em>
<a id='L1566' name='L1566'></a>1566 
<a id='L1567' name='L1567'></a>1567         <a href='../D/29280.html' title='Multiple defined in 6 places.'>s</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(<a href='../S/868.html#L369' title='Defined at 369 in ext/pcre/pcrelib/pcre_internal.h.'>strlen</a>(<a href='../Y/36637.html' title='Multiple used in 7 places.'>spkac</a>) + <a href='../S/868.html#L369' title='Defined at 369 in ext/pcre/pcrelib/pcre_internal.h.'>strlen</a>(<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a>), 0);
<a id='L1568' name='L1568'></a>1568         <a href='../D/30283.html' title='Multiple defined in 5 places.'>sprintf</a>(<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../D/29280.html' title='Multiple defined in 6 places.'>s</a>), "%s%s", <a href='../Y/36637.html' title='Multiple used in 7 places.'>spkac</a>, <a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a>);
<a id='L1569' name='L1569'></a>1569         <a href='../S/1725.html#L41' title='Defined at 41 in Zend/zend_string.h.'>ZSTR_LEN</a>(<a href='../D/29280.html' title='Multiple defined in 6 places.'>s</a>) = <a href='../S/868.html#L369' title='Defined at 369 in ext/pcre/pcrelib/pcre_internal.h.'>strlen</a>(<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../D/29280.html' title='Multiple defined in 6 places.'>s</a>));
<a id='L1570' name='L1570'></a>1570 
<a id='L1571' name='L1571'></a>1571         <a href='../S/1632.html#L615' title='Defined at 615 in Zend/zend_API.h.'>RETVAL_STR</a>(<a href='../D/29280.html' title='Multiple defined in 6 places.'>s</a>);
<a id='L1572' name='L1572'></a>1572         <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1573' name='L1573'></a>1573 
<a id='L1574' name='L1574'></a>1574 <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>:
<a id='L1575' name='L1575'></a>1575 
<a id='L1576' name='L1576'></a>1576         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1577' name='L1577'></a>1577                 <a href='../Y/4197.html' title='Multiple used in 3 places.'>NETSCAPE_SPKI_free</a>(<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>);
<a id='L1578' name='L1578'></a>1578         <em class='brace'>}</em>
<a id='L1579' name='L1579'></a>1579         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1580' name='L1580'></a>1580                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L1581' name='L1581'></a>1581         <em class='brace'>}</em>
<a id='L1582' name='L1582'></a>1582         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1583' name='L1583'></a>1583                 <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a>);
<a id='L1584' name='L1584'></a>1584         <em class='brace'>}</em>
<a id='L1585' name='L1585'></a>1585 
<a id='L1586' name='L1586'></a>1586         <strong class='reserved'>if</strong> (<a href='../D/29280.html' title='Multiple defined in 6 places.'>s</a> &amp;&amp; <a href='../S/1725.html#L41' title='Defined at 41 in Zend/zend_string.h.'>ZSTR_LEN</a>(<a href='../D/29280.html' title='Multiple defined in 6 places.'>s</a>) &lt;= 0) <em class='brace'>{</em>
<a id='L1587' name='L1587'></a>1587                 <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L1588' name='L1588'></a>1588         <em class='brace'>}</em>
<a id='L1589' name='L1589'></a>1589 
<a id='L1590' name='L1590'></a>1590         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../D/29280.html' title='Multiple defined in 6 places.'>s</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1591' name='L1591'></a>1591                 <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../D/29280.html' title='Multiple defined in 6 places.'>s</a>);
<a id='L1592' name='L1592'></a>1592         <em class='brace'>}</em>
<a id='L1593' name='L1593'></a>1593 <em class='brace'>}</em>
<a id='L1594' name='L1594'></a>1594 <em class='comment'>/* }}} */</em>
<a id='L1595' name='L1595'></a>1595 
<a id='L1596' name='L1596'></a>1596 <em class='comment'>/* {{{ proto bool openssl_spki_verify(string spki)</em>
<a id='L1597' name='L1597'></a>1597 <em class='comment'>   Verifies spki returns boolean */</em>
<a id='L1598' name='L1598'></a>1598 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29779.html' title='Multiple used in 3 places.'>openssl_spki_verify</a>)
<a id='L1599' name='L1599'></a>1599 <em class='brace'>{</em>
<a id='L1600' name='L1600'></a>1600         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/36642.html' title='Multiple used in 12 places.'>spkstr_len</a>;
<a id='L1601' name='L1601'></a>1601         <strong class='reserved'>int</strong> <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> = 0, <a href='../Y/36641.html' title='Multiple used in 12 places.'>spkstr_cleaned_len</a> = 0;
<a id='L1602' name='L1602'></a>1602         <strong class='reserved'>char</strong> *<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, * <a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1603' name='L1603'></a>1603 
<a id='L1604' name='L1604'></a>1604         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1605' name='L1605'></a>1605         <a href='../Y/4194.html' title='Multiple used in 4 places.'>NETSCAPE_SPKI</a> *<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1606' name='L1606'></a>1606 
<a id='L1607' name='L1607'></a>1607         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "s", &amp;<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a>, &amp;<a href='../Y/36642.html' title='Multiple used in 12 places.'>spkstr_len</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L1608' name='L1608'></a>1608                 <strong class='reserved'>return</strong>;
<a id='L1609' name='L1609'></a>1609         <em class='brace'>}</em>
<a id='L1610' name='L1610'></a>1610         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L1611' name='L1611'></a>1611 
<a id='L1612' name='L1612'></a>1612         <strong class='reserved'>if</strong> (<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1613' name='L1613'></a>1613                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to use supplied SPKAC");
<a id='L1614' name='L1614'></a>1614                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1615' name='L1615'></a>1615         <em class='brace'>}</em>
<a id='L1616' name='L1616'></a>1616 
<a id='L1617' name='L1617'></a>1617         <a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a> = <a href='../D/21334.html' title='Multiple defined in 2 places.'>emalloc</a>(<a href='../Y/36642.html' title='Multiple used in 12 places.'>spkstr_len</a> + 1);
<a id='L1618' name='L1618'></a>1618         <a href='../Y/36641.html' title='Multiple used in 12 places.'>spkstr_cleaned_len</a> = (<strong class='reserved'>int</strong>)(<a href='../Y/36642.html' title='Multiple used in 12 places.'>spkstr_len</a> - <a href='../S/851.html#L881' title='Defined at 881 in ext/openssl/openssl.c.'>openssl_spki_cleanup</a>(<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a>, <a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a>));
<a id='L1619' name='L1619'></a>1619 
<a id='L1620' name='L1620'></a>1620         <strong class='reserved'>if</strong> (<a href='../Y/36641.html' title='Multiple used in 12 places.'>spkstr_cleaned_len</a> == 0) <em class='brace'>{</em>
<a id='L1621' name='L1621'></a>1621                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Invalid SPKAC");
<a id='L1622' name='L1622'></a>1622                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1623' name='L1623'></a>1623         <em class='brace'>}</em>
<a id='L1624' name='L1624'></a>1624 
<a id='L1625' name='L1625'></a>1625         <a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a> = <a href='../Y/4195.html' title='Multiple used in 3 places.'>NETSCAPE_SPKI_b64_decode</a>(<a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a>, <a href='../Y/36641.html' title='Multiple used in 12 places.'>spkstr_cleaned_len</a>);
<a id='L1626' name='L1626'></a>1626         <strong class='reserved'>if</strong> (<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1627' name='L1627'></a>1627                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to decode supplied SPKAC");
<a id='L1628' name='L1628'></a>1628                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1629' name='L1629'></a>1629         <em class='brace'>}</em>
<a id='L1630' name='L1630'></a>1630 
<a id='L1631' name='L1631'></a>1631         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../Y/7391.html' title='Multiple used in 2 places.'>X509_PUBKEY_get</a>(<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>-&gt;<a href='../Y/36637.html' title='Multiple used in 7 places.'>spkac</a>-&gt;<a href='../Y/33725.html' title='Multiple used in 15 places.'>pubkey</a>);
<a id='L1632' name='L1632'></a>1632         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1633' name='L1633'></a>1633                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to acquire signed public key");
<a id='L1634' name='L1634'></a>1634                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1635' name='L1635'></a>1635         <em class='brace'>}</em>
<a id='L1636' name='L1636'></a>1636 
<a id='L1637' name='L1637'></a>1637         <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> = NETSCAPE_SPKI_verify(<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>, <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L1638' name='L1638'></a>1638         <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1639' name='L1639'></a>1639 
<a id='L1640' name='L1640'></a>1640 <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>:
<a id='L1641' name='L1641'></a>1641         <strong class='reserved'>if</strong> (<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1642' name='L1642'></a>1642                 <a href='../Y/4197.html' title='Multiple used in 3 places.'>NETSCAPE_SPKI_free</a>(<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>);
<a id='L1643' name='L1643'></a>1643         <em class='brace'>}</em>
<a id='L1644' name='L1644'></a>1644         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1645' name='L1645'></a>1645                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L1646' name='L1646'></a>1646         <em class='brace'>}</em>
<a id='L1647' name='L1647'></a>1647         <strong class='reserved'>if</strong> (<a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1648' name='L1648'></a>1648                 <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a>);
<a id='L1649' name='L1649'></a>1649         <em class='brace'>}</em>
<a id='L1650' name='L1650'></a>1650 
<a id='L1651' name='L1651'></a>1651         <strong class='reserved'>if</strong> (<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> &gt; 0) <em class='brace'>{</em>
<a id='L1652' name='L1652'></a>1652                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L1653' name='L1653'></a>1653         <em class='brace'>}</em>
<a id='L1654' name='L1654'></a>1654 <em class='brace'>}</em>
<a id='L1655' name='L1655'></a>1655 <em class='comment'>/* }}} */</em>
<a id='L1656' name='L1656'></a>1656 
<a id='L1657' name='L1657'></a>1657 <em class='comment'>/* {{{ proto string openssl_spki_export(string spki)</em>
<a id='L1658' name='L1658'></a>1658 <em class='comment'>   Exports public key from existing spki to var */</em>
<a id='L1659' name='L1659'></a>1659 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29776.html' title='Multiple used in 3 places.'>openssl_spki_export</a>)
<a id='L1660' name='L1660'></a>1660 <em class='brace'>{</em>
<a id='L1661' name='L1661'></a>1661         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/36642.html' title='Multiple used in 12 places.'>spkstr_len</a>;
<a id='L1662' name='L1662'></a>1662         <strong class='reserved'>char</strong> *<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, * <a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, * <a href='../D/29280.html' title='Multiple defined in 6 places.'>s</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1663' name='L1663'></a>1663         <strong class='reserved'>int</strong> <a href='../Y/36641.html' title='Multiple used in 12 places.'>spkstr_cleaned_len</a>;
<a id='L1664' name='L1664'></a>1664 
<a id='L1665' name='L1665'></a>1665         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1666' name='L1666'></a>1666         <a href='../Y/4194.html' title='Multiple used in 4 places.'>NETSCAPE_SPKI</a> *<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1667' name='L1667'></a>1667         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> *<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1668' name='L1668'></a>1668 
<a id='L1669' name='L1669'></a>1669         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "s", &amp;<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a>, &amp;<a href='../Y/36642.html' title='Multiple used in 12 places.'>spkstr_len</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L1670' name='L1670'></a>1670                 <strong class='reserved'>return</strong>;
<a id='L1671' name='L1671'></a>1671         <em class='brace'>}</em>
<a id='L1672' name='L1672'></a>1672         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L1673' name='L1673'></a>1673 
<a id='L1674' name='L1674'></a>1674         <strong class='reserved'>if</strong> (<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1675' name='L1675'></a>1675                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to use supplied SPKAC");
<a id='L1676' name='L1676'></a>1676                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1677' name='L1677'></a>1677         <em class='brace'>}</em>
<a id='L1678' name='L1678'></a>1678 
<a id='L1679' name='L1679'></a>1679         <a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a> = <a href='../D/21334.html' title='Multiple defined in 2 places.'>emalloc</a>(<a href='../Y/36642.html' title='Multiple used in 12 places.'>spkstr_len</a> + 1);
<a id='L1680' name='L1680'></a>1680         <a href='../Y/36641.html' title='Multiple used in 12 places.'>spkstr_cleaned_len</a> = (<strong class='reserved'>int</strong>)(<a href='../Y/36642.html' title='Multiple used in 12 places.'>spkstr_len</a> - <a href='../S/851.html#L881' title='Defined at 881 in ext/openssl/openssl.c.'>openssl_spki_cleanup</a>(<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a>, <a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a>));
<a id='L1681' name='L1681'></a>1681 
<a id='L1682' name='L1682'></a>1682         <strong class='reserved'>if</strong> (<a href='../Y/36641.html' title='Multiple used in 12 places.'>spkstr_cleaned_len</a> == 0) <em class='brace'>{</em>
<a id='L1683' name='L1683'></a>1683                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Invalid SPKAC");
<a id='L1684' name='L1684'></a>1684                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1685' name='L1685'></a>1685         <em class='brace'>}</em>
<a id='L1686' name='L1686'></a>1686 
<a id='L1687' name='L1687'></a>1687         <a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a> = <a href='../Y/4195.html' title='Multiple used in 3 places.'>NETSCAPE_SPKI_b64_decode</a>(<a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a>, <a href='../Y/36641.html' title='Multiple used in 12 places.'>spkstr_cleaned_len</a>);
<a id='L1688' name='L1688'></a>1688         <strong class='reserved'>if</strong> (<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1689' name='L1689'></a>1689                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to decode supplied SPKAC");
<a id='L1690' name='L1690'></a>1690                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1691' name='L1691'></a>1691         <em class='brace'>}</em>
<a id='L1692' name='L1692'></a>1692 
<a id='L1693' name='L1693'></a>1693         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../Y/7391.html' title='Multiple used in 2 places.'>X509_PUBKEY_get</a>(<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>-&gt;<a href='../Y/36637.html' title='Multiple used in 7 places.'>spkac</a>-&gt;<a href='../Y/33725.html' title='Multiple used in 15 places.'>pubkey</a>);
<a id='L1694' name='L1694'></a>1694         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1695' name='L1695'></a>1695                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to acquire signed public key");
<a id='L1696' name='L1696'></a>1696                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1697' name='L1697'></a>1697         <em class='brace'>}</em>
<a id='L1698' name='L1698'></a>1698 
<a id='L1699' name='L1699'></a>1699         <a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a> = <a href='../Y/231.html' title='Multiple used in 12 places.'>BIO_new</a>(<a href='../Y/237.html' title='Multiple used in 12 places.'>BIO_s_mem</a>());
<a id='L1700' name='L1700'></a>1700         <strong class='reserved'>if</strong> (<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a> &amp;&amp; <a href='../Y/4933.html' title='Multiple used in 2 places.'>PEM_write_bio_PUBKEY</a>(<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>, <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>)) <em class='brace'>{</em>
<a id='L1701' name='L1701'></a>1701                 <a href='../Y/273.html' title='Multiple used in 8 places.'>BUF_MEM</a> *<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>;
<a id='L1702' name='L1702'></a>1702 
<a id='L1703' name='L1703'></a>1703                 <a href='../Y/230.html' title='Multiple used in 9 places.'>BIO_get_mem_ptr</a>(<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>, &amp;<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>);
<a id='L1704' name='L1704'></a>1704                 <a href='../S/1632.html#L620' title='Defined at 620 in Zend/zend_API.h.'>RETVAL_STRINGL</a>((<strong class='reserved'>char</strong> *)<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>);
<a id='L1705' name='L1705'></a>1705         <em class='brace'>}</em>
<a id='L1706' name='L1706'></a>1706         <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1707' name='L1707'></a>1707 
<a id='L1708' name='L1708'></a>1708 <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>:
<a id='L1709' name='L1709'></a>1709 
<a id='L1710' name='L1710'></a>1710         <strong class='reserved'>if</strong> (<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1711' name='L1711'></a>1711                 <a href='../Y/4197.html' title='Multiple used in 3 places.'>NETSCAPE_SPKI_free</a>(<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>);
<a id='L1712' name='L1712'></a>1712         <em class='brace'>}</em>
<a id='L1713' name='L1713'></a>1713         <strong class='reserved'>if</strong> (<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1714' name='L1714'></a>1714                 BIO_free_all(<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>);
<a id='L1715' name='L1715'></a>1715         <em class='brace'>}</em>
<a id='L1716' name='L1716'></a>1716         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1717' name='L1717'></a>1717                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L1718' name='L1718'></a>1718         <em class='brace'>}</em>
<a id='L1719' name='L1719'></a>1719         <strong class='reserved'>if</strong> (<a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1720' name='L1720'></a>1720                 <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a>);
<a id='L1721' name='L1721'></a>1721         <em class='brace'>}</em>
<a id='L1722' name='L1722'></a>1722         <strong class='reserved'>if</strong> (<a href='../D/29280.html' title='Multiple defined in 6 places.'>s</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1723' name='L1723'></a>1723                 <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../D/29280.html' title='Multiple defined in 6 places.'>s</a>);
<a id='L1724' name='L1724'></a>1724         <em class='brace'>}</em>
<a id='L1725' name='L1725'></a>1725 <em class='brace'>}</em>
<a id='L1726' name='L1726'></a>1726 <em class='comment'>/* }}} */</em>
<a id='L1727' name='L1727'></a>1727 
<a id='L1728' name='L1728'></a>1728 <em class='comment'>/* {{{ proto string openssl_spki_export_challenge(string spki)</em>
<a id='L1729' name='L1729'></a>1729 <em class='comment'>   Exports spkac challenge from existing spki to var */</em>
<a id='L1730' name='L1730'></a>1730 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29777.html' title='Multiple used in 3 places.'>openssl_spki_export_challenge</a>)
<a id='L1731' name='L1731'></a>1731 <em class='brace'>{</em>
<a id='L1732' name='L1732'></a>1732         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/36642.html' title='Multiple used in 12 places.'>spkstr_len</a>;
<a id='L1733' name='L1733'></a>1733         <strong class='reserved'>char</strong> *<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, * <a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1734' name='L1734'></a>1734         <strong class='reserved'>int</strong> <a href='../Y/36641.html' title='Multiple used in 12 places.'>spkstr_cleaned_len</a>;
<a id='L1735' name='L1735'></a>1735 
<a id='L1736' name='L1736'></a>1736         <a href='../Y/4194.html' title='Multiple used in 4 places.'>NETSCAPE_SPKI</a> *<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1737' name='L1737'></a>1737 
<a id='L1738' name='L1738'></a>1738         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "s", &amp;<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a>, &amp;<a href='../Y/36642.html' title='Multiple used in 12 places.'>spkstr_len</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L1739' name='L1739'></a>1739                 <strong class='reserved'>return</strong>;
<a id='L1740' name='L1740'></a>1740         <em class='brace'>}</em>
<a id='L1741' name='L1741'></a>1741         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L1742' name='L1742'></a>1742 
<a id='L1743' name='L1743'></a>1743         <strong class='reserved'>if</strong> (<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1744' name='L1744'></a>1744                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to use supplied SPKAC");
<a id='L1745' name='L1745'></a>1745                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1746' name='L1746'></a>1746         <em class='brace'>}</em>
<a id='L1747' name='L1747'></a>1747 
<a id='L1748' name='L1748'></a>1748         <a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a> = <a href='../D/21334.html' title='Multiple defined in 2 places.'>emalloc</a>(<a href='../Y/36642.html' title='Multiple used in 12 places.'>spkstr_len</a> + 1);
<a id='L1749' name='L1749'></a>1749         <a href='../Y/36641.html' title='Multiple used in 12 places.'>spkstr_cleaned_len</a> = (<strong class='reserved'>int</strong>)(<a href='../Y/36642.html' title='Multiple used in 12 places.'>spkstr_len</a> - <a href='../S/851.html#L881' title='Defined at 881 in ext/openssl/openssl.c.'>openssl_spki_cleanup</a>(<a href='../Y/36639.html' title='Multiple used in 19 places.'>spkstr</a>, <a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a>));
<a id='L1750' name='L1750'></a>1750 
<a id='L1751' name='L1751'></a>1751         <strong class='reserved'>if</strong> (<a href='../Y/36641.html' title='Multiple used in 12 places.'>spkstr_cleaned_len</a> == 0) <em class='brace'>{</em>
<a id='L1752' name='L1752'></a>1752                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Invalid SPKAC");
<a id='L1753' name='L1753'></a>1753                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1754' name='L1754'></a>1754         <em class='brace'>}</em>
<a id='L1755' name='L1755'></a>1755 
<a id='L1756' name='L1756'></a>1756         <a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a> = <a href='../Y/4195.html' title='Multiple used in 3 places.'>NETSCAPE_SPKI_b64_decode</a>(<a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a>, <a href='../Y/36641.html' title='Multiple used in 12 places.'>spkstr_cleaned_len</a>);
<a id='L1757' name='L1757'></a>1757         <strong class='reserved'>if</strong> (<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1758' name='L1758'></a>1758                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to decode SPKAC");
<a id='L1759' name='L1759'></a>1759                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1760' name='L1760'></a>1760         <em class='brace'>}</em>
<a id='L1761' name='L1761'></a>1761 
<a id='L1762' name='L1762'></a>1762         <a href='../S/1632.html#L619' title='Defined at 619 in Zend/zend_API.h.'>RETVAL_STRING</a>((<strong class='reserved'>char</strong> *) <a href='../Y/122.html' title='Multiple used in 7 places.'>ASN1_STRING_data</a>(<a href='../Y/36638.html' title='Multiple used in 28 places.'>spki</a>-&gt;<a href='../Y/36637.html' title='Multiple used in 7 places.'>spkac</a>-&gt;<a href='../Y/13526.html' title='Multiple used in 7 places.'>challenge</a>));
<a id='L1763' name='L1763'></a>1763         <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L1764' name='L1764'></a>1764 
<a id='L1765' name='L1765'></a>1765 <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>:
<a id='L1766' name='L1766'></a>1766         <strong class='reserved'>if</strong> (<a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1767' name='L1767'></a>1767                 <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/36640.html' title='Multiple used in 18 places.'>spkstr_cleaned</a>);
<a id='L1768' name='L1768'></a>1768         <em class='brace'>}</em>
<a id='L1769' name='L1769'></a>1769 <em class='brace'>}</em>
<a id='L1770' name='L1770'></a>1770 <em class='comment'>/* }}} */</em>
<a id='L1771' name='L1771'></a>1771 
<a id='L1772' name='L1772'></a>1772 <em class='comment'>/* {{{ proto bool openssl_x509_export(mixed x509, string &amp;out [, bool notext = true])</em>
<a id='L1773' name='L1773'></a>1773 <em class='comment'>   Exports a CERT to file or a var */</em>
<a id='L1774' name='L1774'></a>1774 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29783.html' title='Multiple used in 3 places.'>openssl_x509_export</a>)
<a id='L1775' name='L1775'></a>1775 <em class='brace'>{</em>
<a id='L1776' name='L1776'></a>1776         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>;
<a id='L1777' name='L1777'></a>1777         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, *<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>;
<a id='L1778' name='L1778'></a>1778         <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a> = 1;
<a id='L1779' name='L1779'></a>1779         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>;
<a id='L1780' name='L1780'></a>1780         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>;
<a id='L1781' name='L1781'></a>1781 
<a id='L1782' name='L1782'></a>1782         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "zz/|b", &amp;<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, &amp;<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>, &amp;<a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L1783' name='L1783'></a>1783                 <strong class='reserved'>return</strong>;
<a id='L1784' name='L1784'></a>1784         <em class='brace'>}</em>
<a id='L1785' name='L1785'></a>1785         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L1786' name='L1786'></a>1786 
<a id='L1787' name='L1787'></a>1787         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, 0, &amp;<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>);
<a id='L1788' name='L1788'></a>1788         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1789' name='L1789'></a>1789                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "cannot get cert from parameter 1");
<a id='L1790' name='L1790'></a>1790                 <strong class='reserved'>return</strong>;
<a id='L1791' name='L1791'></a>1791         <em class='brace'>}</em>
<a id='L1792' name='L1792'></a>1792 
<a id='L1793' name='L1793'></a>1793         <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../Y/231.html' title='Multiple used in 12 places.'>BIO_new</a>(<a href='../Y/237.html' title='Multiple used in 12 places.'>BIO_s_mem</a>());
<a id='L1794' name='L1794'></a>1794         <strong class='reserved'>if</strong> (!<a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a>) <em class='brace'>{</em>
<a id='L1795' name='L1795'></a>1795                 <a href='../Y/7458.html' title='Multiple used in 2 places.'>X509_print</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L1796' name='L1796'></a>1796         <em class='brace'>}</em>
<a id='L1797' name='L1797'></a>1797         <strong class='reserved'>if</strong> (<a href='../Y/4935.html' title='Multiple used in 5 places.'>PEM_write_bio_X509</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>)) <em class='brace'>{</em>
<a id='L1798' name='L1798'></a>1798                 <a href='../Y/273.html' title='Multiple used in 8 places.'>BUF_MEM</a> *<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>;
<a id='L1799' name='L1799'></a>1799 
<a id='L1800' name='L1800'></a>1800                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>);
<a id='L1801' name='L1801'></a>1801                 <a href='../Y/230.html' title='Multiple used in 9 places.'>BIO_get_mem_ptr</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, &amp;<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>);
<a id='L1802' name='L1802'></a>1802                 <a href='../S/1632.html#L568' title='Defined at 568 in Zend/zend_API.h.'>ZVAL_STRINGL</a>(<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>);
<a id='L1803' name='L1803'></a>1803 
<a id='L1804' name='L1804'></a>1804                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L1805' name='L1805'></a>1805         <em class='brace'>}</em>
<a id='L1806' name='L1806'></a>1806 
<a id='L1807' name='L1807'></a>1807         <strong class='reserved'>if</strong> (<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) <em class='brace'>{</em>
<a id='L1808' name='L1808'></a>1808                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L1809' name='L1809'></a>1809         <em class='brace'>}</em>
<a id='L1810' name='L1810'></a>1810         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>);
<a id='L1811' name='L1811'></a>1811 <em class='brace'>}</em>
<a id='L1812' name='L1812'></a>1812 <em class='comment'>/* }}} */</em>
<a id='L1813' name='L1813'></a>1813 
<a id='L1814' name='L1814'></a>1814 <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a>* <a href='../R/24327.html' title='Multiple referred from 3 places.'>php_openssl_x509_fingerprint</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> *<a href='../Y/31611.html' title='Multiple used in 17 places.'>peer</a>, <strong class='reserved'>const</strong> <strong class='reserved'>char</strong> *<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>, <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../Y/33988.html' title='Multiple used in 44 places.'>raw</a>)
<a id='L1815' name='L1815'></a>1815 <em class='brace'>{</em>
<a id='L1816' name='L1816'></a>1816         <strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> <a href='../Y/26408.html' title='Multiple used in 726 places.'>md</a>[EVP_MAX_MD_SIZE];
<a id='L1817' name='L1817'></a>1817         <strong class='reserved'>const</strong> <a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *<a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>;
<a id='L1818' name='L1818'></a>1818         <strong class='reserved'>unsigned</strong> <strong class='reserved'>int</strong> <a href='../D/25111.html' title='Multiple defined in 3 places.'>n</a>;
<a id='L1819' name='L1819'></a>1819         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a>;
<a id='L1820' name='L1820'></a>1820 
<a id='L1821' name='L1821'></a>1821         <strong class='reserved'>if</strong> (!(<a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = <a href='../Y/2163.html' title='Multiple used in 6 places.'>EVP_get_digestbyname</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>))) <em class='brace'>{</em>
<a id='L1822' name='L1822'></a>1822                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown signature algorithm");
<a id='L1823' name='L1823'></a>1823                 <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1824' name='L1824'></a>1824         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong> (!X509_digest(<a href='../Y/31611.html' title='Multiple used in 17 places.'>peer</a>, <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>, <a href='../Y/26408.html' title='Multiple used in 726 places.'>md</a>, &amp;<a href='../D/25111.html' title='Multiple defined in 3 places.'>n</a>)) <em class='brace'>{</em>
<a id='L1825' name='L1825'></a>1825                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L25' title='Defined at 25 in Zend/zend_errors.h.'>E_ERROR</a>, "Could not generate signature");
<a id='L1826' name='L1826'></a>1826                 <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1827' name='L1827'></a>1827         <em class='brace'>}</em>
<a id='L1828' name='L1828'></a>1828 
<a id='L1829' name='L1829'></a>1829         <strong class='reserved'>if</strong> (<a href='../Y/33988.html' title='Multiple used in 44 places.'>raw</a>) <em class='brace'>{</em>
<a id='L1830' name='L1830'></a>1830                 <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a> = <a href='../S/1725.html#L155' title='Defined at 155 in Zend/zend_string.h.'>zend_string_init</a>((<strong class='reserved'>char</strong>*)<a href='../Y/26408.html' title='Multiple used in 726 places.'>md</a>, <a href='../D/25111.html' title='Multiple defined in 3 places.'>n</a>, 0);
<a id='L1831' name='L1831'></a>1831         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L1832' name='L1832'></a>1832                 <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(<a href='../D/25111.html' title='Multiple defined in 3 places.'>n</a> * 2, 0);
<a id='L1833' name='L1833'></a>1833                 <a href='../S/1122.html#L32' title='Defined at 32 in ext/standard/md5.c.'>make_digest_ex</a>(<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a>), <a href='../Y/26408.html' title='Multiple used in 726 places.'>md</a>, <a href='../D/25111.html' title='Multiple defined in 3 places.'>n</a>);
<a id='L1834' name='L1834'></a>1834                 <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a>)[<a href='../D/25111.html' title='Multiple defined in 3 places.'>n</a> * 2] = '\0';
<a id='L1835' name='L1835'></a>1835         <em class='brace'>}</em>
<a id='L1836' name='L1836'></a>1836 
<a id='L1837' name='L1837'></a>1837         <strong class='reserved'>return</strong> <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a>;
<a id='L1838' name='L1838'></a>1838 <em class='brace'>}</em>
<a id='L1839' name='L1839'></a>1839 
<a id='L1840' name='L1840'></a>1840 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29785.html' title='Multiple used in 3 places.'>openssl_x509_fingerprint</a>)
<a id='L1841' name='L1841'></a>1841 <em class='brace'>{</em>
<a id='L1842' name='L1842'></a>1842         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> *<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>;
<a id='L1843' name='L1843'></a>1843         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>;
<a id='L1844' name='L1844'></a>1844         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>;
<a id='L1845' name='L1845'></a>1845         <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../Y/33992.html' title='Multiple used in 60 places.'>raw_output</a> = 0;
<a id='L1846' name='L1846'></a>1846         <strong class='reserved'>char</strong> *<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a> = "sha1";
<a id='L1847' name='L1847'></a>1847         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>;
<a id='L1848' name='L1848'></a>1848         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/18002.html' title='Multiple used in 9 places.'>fingerprint</a>;
<a id='L1849' name='L1849'></a>1849 
<a id='L1850' name='L1850'></a>1850         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "z|sb", &amp;<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, &amp;<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>, &amp;<a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>, &amp;<a href='../Y/33992.html' title='Multiple used in 60 places.'>raw_output</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L1851' name='L1851'></a>1851                 <strong class='reserved'>return</strong>;
<a id='L1852' name='L1852'></a>1852         <em class='brace'>}</em>
<a id='L1853' name='L1853'></a>1853 
<a id='L1854' name='L1854'></a>1854         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, 0, &amp;<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>);
<a id='L1855' name='L1855'></a>1855         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1856' name='L1856'></a>1856                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "cannot get cert from parameter 1");
<a id='L1857' name='L1857'></a>1857                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L1858' name='L1858'></a>1858         <em class='brace'>}</em>
<a id='L1859' name='L1859'></a>1859 
<a id='L1860' name='L1860'></a>1860         <a href='../Y/18002.html' title='Multiple used in 9 places.'>fingerprint</a> = <a href='../S/851.html#L1814' title='Defined at 1814 in ext/openssl/openssl.c.'>php_openssl_x509_fingerprint</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>, <a href='../Y/33992.html' title='Multiple used in 60 places.'>raw_output</a>);
<a id='L1861' name='L1861'></a>1861         <strong class='reserved'>if</strong> (<a href='../Y/18002.html' title='Multiple used in 9 places.'>fingerprint</a>) <em class='brace'>{</em>
<a id='L1862' name='L1862'></a>1862                 <a href='../S/1632.html#L615' title='Defined at 615 in Zend/zend_API.h.'>RETVAL_STR</a>(<a href='../Y/18002.html' title='Multiple used in 9 places.'>fingerprint</a>);
<a id='L1863' name='L1863'></a>1863         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L1864' name='L1864'></a>1864                 <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L1865' name='L1865'></a>1865         <em class='brace'>}</em>
<a id='L1866' name='L1866'></a>1866 
<a id='L1867' name='L1867'></a>1867         <strong class='reserved'>if</strong> (<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) <em class='brace'>{</em>
<a id='L1868' name='L1868'></a>1868                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L1869' name='L1869'></a>1869         <em class='brace'>}</em>
<a id='L1870' name='L1870'></a>1870 <em class='brace'>}</em>
<a id='L1871' name='L1871'></a>1871 
<a id='L1872' name='L1872'></a>1872 <em class='comment'>/* {{{ proto bool openssl_x509_check_private_key(mixed cert, mixed key)</em>
<a id='L1873' name='L1873'></a>1873 <em class='comment'>   Checks if a private key corresponds to a CERT */</em>
<a id='L1874' name='L1874'></a>1874 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29781.html' title='Multiple used in 3 places.'>openssl_x509_check_private_key</a>)
<a id='L1875' name='L1875'></a>1875 <em class='brace'>{</em>
<a id='L1876' name='L1876'></a>1876         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, *<a href='../Y/44013.html' title='Multiple used in 14 places.'>zkey</a>;
<a id='L1877' name='L1877'></a>1877         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1878' name='L1878'></a>1878         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1879' name='L1879'></a>1879         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, *<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1880' name='L1880'></a>1880 
<a id='L1881' name='L1881'></a>1881         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L1882' name='L1882'></a>1882 
<a id='L1883' name='L1883'></a>1883         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "zz", &amp;<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, &amp;<a href='../Y/44013.html' title='Multiple used in 14 places.'>zkey</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L1884' name='L1884'></a>1884                 <strong class='reserved'>return</strong>;
<a id='L1885' name='L1885'></a>1885         <em class='brace'>}</em>
<a id='L1886' name='L1886'></a>1886         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, 0, &amp;<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>);
<a id='L1887' name='L1887'></a>1887         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1888' name='L1888'></a>1888                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L1889' name='L1889'></a>1889         <em class='brace'>}</em>
<a id='L1890' name='L1890'></a>1890         <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../Y/44013.html' title='Multiple used in 14 places.'>zkey</a>, 0, "", 1, &amp;<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>);
<a id='L1891' name='L1891'></a>1891         <strong class='reserved'>if</strong> (<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>) <em class='brace'>{</em>
<a id='L1892' name='L1892'></a>1892                 <a href='../S/1632.html#L611' title='Defined at 611 in Zend/zend_API.h.'>RETVAL_BOOL</a>(<a href='../Y/7435.html' title='Multiple used in 4 places.'>X509_check_private_key</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>));
<a id='L1893' name='L1893'></a>1893         <em class='brace'>}</em>
<a id='L1894' name='L1894'></a>1894 
<a id='L1895' name='L1895'></a>1895         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>) <em class='brace'>{</em>
<a id='L1896' name='L1896'></a>1896                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>);
<a id='L1897' name='L1897'></a>1897         <em class='brace'>}</em>
<a id='L1898' name='L1898'></a>1898         <strong class='reserved'>if</strong> (<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) <em class='brace'>{</em>
<a id='L1899' name='L1899'></a>1899                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L1900' name='L1900'></a>1900         <em class='brace'>}</em>
<a id='L1901' name='L1901'></a>1901 <em class='brace'>}</em>
<a id='L1902' name='L1902'></a>1902 <em class='comment'>/* }}} */</em>
<a id='L1903' name='L1903'></a>1903 
<a id='L1904' name='L1904'></a>1904 <em class='comment'>/* Special handling of subjectAltName, see CVE-2013-4073</em>
<a id='L1905' name='L1905'></a>1905 <em class='comment'> * Christian Heimes</em>
<a id='L1906' name='L1906'></a>1906 <em class='comment'> */</em>
<a id='L1907' name='L1907'></a>1907 
<a id='L1908' name='L1908'></a>1908 <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../S/851.html#L2076' title='Referred from 2076 in ext/openssl/openssl.c.'>openssl_x509v3_subjectAltName</a>(<a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> *<a href='../Y/12669.html' title='Multiple used in 28 places.'>bio</a>, <a href='../Y/7370.html' title='Multiple used in 2 places.'>X509_EXTENSION</a> *<a href='../Y/17383.html' title='Multiple used in 145 places.'>extension</a>)
<a id='L1909' name='L1909'></a>1909 <em class='brace'>{</em>
<a id='L1910' name='L1910'></a>1910         <a href='../Y/2510.html' title='Multiple used in 4 places.'>GENERAL_NAMES</a> *<a href='../S/800.html#L1199' title='Defined at 1199 in ext/mysqlnd/mysqlnd_structs.h.'>names</a>;
<a id='L1911' name='L1911'></a>1911         <strong class='reserved'>const</strong> X509V3_EXT_METHOD *<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1912' name='L1912'></a>1912         <strong class='reserved'>long</strong> <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>, <a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>, <a href='../Y/28824.html' title='Multiple used in 1143 places.'>num</a>;
<a id='L1913' name='L1913'></a>1913         <strong class='reserved'>const</strong> <strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *<a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a>;
<a id='L1914' name='L1914'></a>1914 
<a id='L1915' name='L1915'></a>1915         <a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a> = X509V3_EXT_get(<a href='../Y/17383.html' title='Multiple used in 145 places.'>extension</a>);
<a id='L1916' name='L1916'></a>1916         <strong class='reserved'>if</strong> (<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1917' name='L1917'></a>1917                 <strong class='reserved'>return</strong> -1;
<a id='L1918' name='L1918'></a>1918         <em class='brace'>}</em>
<a id='L1919' name='L1919'></a>1919 
<a id='L1920' name='L1920'></a>1920         <a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a> = <a href='../Y/17383.html' title='Multiple used in 145 places.'>extension</a>-&gt;<a href='../D/32633.html' title='Multiple defined in 3 places.'>value</a>-&gt;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>;
<a id='L1921' name='L1921'></a>1921         <a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a> = <a href='../Y/17383.html' title='Multiple used in 145 places.'>extension</a>-&gt;<a href='../D/32633.html' title='Multiple defined in 3 places.'>value</a>-&gt;<a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>;
<a id='L1922' name='L1922'></a>1922         <strong class='reserved'>if</strong> (<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>-&gt;<a href='../Y/24198.html' title='Multiple used in 85 places.'>it</a>) <em class='brace'>{</em>
<a id='L1923' name='L1923'></a>1923                 <a href='../S/800.html#L1199' title='Defined at 1199 in ext/mysqlnd/mysqlnd_structs.h.'>names</a> = (<a href='../Y/2510.html' title='Multiple used in 4 places.'>GENERAL_NAMES</a>*) (ASN1_item_d2i(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, &amp;<a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a>, <a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>,
<a id='L1924' name='L1924'></a>1924                         ASN1_ITEM_ptr(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>-&gt;<a href='../Y/24198.html' title='Multiple used in 85 places.'>it</a>)));
<a id='L1925' name='L1925'></a>1925         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L1926' name='L1926'></a>1926                 <a href='../S/800.html#L1199' title='Defined at 1199 in ext/mysqlnd/mysqlnd_structs.h.'>names</a> = (<a href='../Y/2510.html' title='Multiple used in 4 places.'>GENERAL_NAMES</a>*) (<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>-&gt;d2i(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, &amp;<a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a>, <a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>));
<a id='L1927' name='L1927'></a>1927         <em class='brace'>}</em>
<a id='L1928' name='L1928'></a>1928         <strong class='reserved'>if</strong> (<a href='../S/800.html#L1199' title='Defined at 1199 in ext/mysqlnd/mysqlnd_structs.h.'>names</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1929' name='L1929'></a>1929                 <strong class='reserved'>return</strong> -1;
<a id='L1930' name='L1930'></a>1930         <em class='brace'>}</em>
<a id='L1931' name='L1931'></a>1931 
<a id='L1932' name='L1932'></a>1932         <a href='../Y/28824.html' title='Multiple used in 1143 places.'>num</a> = <a href='../Y/36264.html' title='Multiple used in 2 places.'>sk_GENERAL_NAME_num</a>(<a href='../S/800.html#L1199' title='Defined at 1199 in ext/mysqlnd/mysqlnd_structs.h.'>names</a>);
<a id='L1933' name='L1933'></a>1933         <strong class='reserved'>for</strong> (<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> = 0; <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> &lt; <a href='../Y/28824.html' title='Multiple used in 1143 places.'>num</a>; <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>++) <em class='brace'>{</em>
<a id='L1934' name='L1934'></a>1934                 <a href='../Y/2509.html' title='Multiple used in 2 places.'>GENERAL_NAME</a> *<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>;
<a id='L1935' name='L1935'></a>1935                 <a href='../Y/121.html' title='Multiple used in 3 places.'>ASN1_STRING</a> *<a href='../Y/12020.html' title='Multiple used in 21 places.'>as</a>;
<a id='L1936' name='L1936'></a>1936                 <a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a> = <a href='../Y/36266.html' title='Multiple used in 2 places.'>sk_GENERAL_NAME_value</a>(<a href='../S/800.html#L1199' title='Defined at 1199 in ext/mysqlnd/mysqlnd_structs.h.'>names</a>, <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>);
<a id='L1937' name='L1937'></a>1937                 <strong class='reserved'>switch</strong> (<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>-&gt;<a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>) <em class='brace'>{</em>
<a id='L1938' name='L1938'></a>1938                         <strong class='reserved'>case</strong> GEN_EMAIL:
<a id='L1939' name='L1939'></a>1939                                 <a href='../Y/235.html' title='Multiple used in 6 places.'>BIO_puts</a>(<a href='../Y/12669.html' title='Multiple used in 28 places.'>bio</a>, "email:");
<a id='L1940' name='L1940'></a>1940                                 <a href='../Y/12020.html' title='Multiple used in 21 places.'>as</a> = <a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>-&gt;<a href='../Y/14948.html' title='Multiple used in 1519 places.'>d</a>.rfc822Name;
<a id='L1941' name='L1941'></a>1941                                 <a href='../Y/238.html' title='Multiple used in 4 places.'>BIO_write</a>(<a href='../Y/12669.html' title='Multiple used in 28 places.'>bio</a>, <a href='../Y/122.html' title='Multiple used in 7 places.'>ASN1_STRING_data</a>(<a href='../Y/12020.html' title='Multiple used in 21 places.'>as</a>),
<a id='L1942' name='L1942'></a>1942                                         <a href='../Y/123.html' title='Multiple used in 9 places.'>ASN1_STRING_length</a>(<a href='../Y/12020.html' title='Multiple used in 21 places.'>as</a>));
<a id='L1943' name='L1943'></a>1943                                 <strong class='reserved'>break</strong>;
<a id='L1944' name='L1944'></a>1944                         <strong class='reserved'>case</strong> <a href='../Y/2518.html' title='Multiple used in 2 places.'>GEN_DNS</a>:
<a id='L1945' name='L1945'></a>1945                                 <a href='../Y/235.html' title='Multiple used in 6 places.'>BIO_puts</a>(<a href='../Y/12669.html' title='Multiple used in 28 places.'>bio</a>, "DNS:");
<a id='L1946' name='L1946'></a>1946                                 <a href='../Y/12020.html' title='Multiple used in 21 places.'>as</a> = <a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>-&gt;<a href='../Y/14948.html' title='Multiple used in 1519 places.'>d</a>.<a href='../Y/14959.html' title='Multiple used in 3 places.'>dNSName</a>;
<a id='L1947' name='L1947'></a>1947                                 <a href='../Y/238.html' title='Multiple used in 4 places.'>BIO_write</a>(<a href='../Y/12669.html' title='Multiple used in 28 places.'>bio</a>, <a href='../Y/122.html' title='Multiple used in 7 places.'>ASN1_STRING_data</a>(<a href='../Y/12020.html' title='Multiple used in 21 places.'>as</a>),
<a id='L1948' name='L1948'></a>1948                                         <a href='../Y/123.html' title='Multiple used in 9 places.'>ASN1_STRING_length</a>(<a href='../Y/12020.html' title='Multiple used in 21 places.'>as</a>));
<a id='L1949' name='L1949'></a>1949                                 <strong class='reserved'>break</strong>;
<a id='L1950' name='L1950'></a>1950                         <strong class='reserved'>case</strong> GEN_URI:
<a id='L1951' name='L1951'></a>1951                                 <a href='../Y/235.html' title='Multiple used in 6 places.'>BIO_puts</a>(<a href='../Y/12669.html' title='Multiple used in 28 places.'>bio</a>, "URI:");
<a id='L1952' name='L1952'></a>1952                                 <a href='../Y/12020.html' title='Multiple used in 21 places.'>as</a> = <a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>-&gt;<a href='../Y/14948.html' title='Multiple used in 1519 places.'>d</a>.uniformResourceIdentifier;
<a id='L1953' name='L1953'></a>1953                                 <a href='../Y/238.html' title='Multiple used in 4 places.'>BIO_write</a>(<a href='../Y/12669.html' title='Multiple used in 28 places.'>bio</a>, <a href='../Y/122.html' title='Multiple used in 7 places.'>ASN1_STRING_data</a>(<a href='../Y/12020.html' title='Multiple used in 21 places.'>as</a>),
<a id='L1954' name='L1954'></a>1954                                         <a href='../Y/123.html' title='Multiple used in 9 places.'>ASN1_STRING_length</a>(<a href='../Y/12020.html' title='Multiple used in 21 places.'>as</a>));
<a id='L1955' name='L1955'></a>1955                                 <strong class='reserved'>break</strong>;
<a id='L1956' name='L1956'></a>1956                         <strong class='reserved'>default</strong>:
<a id='L1957' name='L1957'></a>1957                                 <em class='comment'>/* use builtin print for GEN_OTHERNAME, GEN_X400,</em>
<a id='L1958' name='L1958'></a>1958 <em class='comment'>                                 * GEN_EDIPARTY, GEN_DIRNAME, GEN_IPADD and GEN_RID</em>
<a id='L1959' name='L1959'></a>1959 <em class='comment'>                                 */</em>
<a id='L1960' name='L1960'></a>1960                                 GENERAL_NAME_print(<a href='../Y/12669.html' title='Multiple used in 28 places.'>bio</a>, <a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>);
<a id='L1961' name='L1961'></a>1961                         <em class='brace'>}</em>
<a id='L1962' name='L1962'></a>1962                         <em class='comment'>/* trailing ', ' except for last element */</em>
<a id='L1963' name='L1963'></a>1963                         <strong class='reserved'>if</strong> (<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> &lt; (<a href='../Y/28824.html' title='Multiple used in 1143 places.'>num</a> - 1)) <em class='brace'>{</em>
<a id='L1964' name='L1964'></a>1964                                 <a href='../Y/235.html' title='Multiple used in 6 places.'>BIO_puts</a>(<a href='../Y/12669.html' title='Multiple used in 28 places.'>bio</a>, ", ");
<a id='L1965' name='L1965'></a>1965                         <em class='brace'>}</em>
<a id='L1966' name='L1966'></a>1966         <em class='brace'>}</em>
<a id='L1967' name='L1967'></a>1967         sk_GENERAL_NAME_pop_free(<a href='../S/800.html#L1199' title='Defined at 1199 in ext/mysqlnd/mysqlnd_structs.h.'>names</a>, GENERAL_NAME_free);
<a id='L1968' name='L1968'></a>1968 
<a id='L1969' name='L1969'></a>1969         <strong class='reserved'>return</strong> 0;
<a id='L1970' name='L1970'></a>1970 <em class='brace'>}</em>
<a id='L1971' name='L1971'></a>1971 
<a id='L1972' name='L1972'></a>1972 <em class='comment'>/* {{{ proto array openssl_x509_parse(mixed x509 [, bool shortnames=true])</em>
<a id='L1973' name='L1973'></a>1973 <em class='comment'>   Returns an array of the fields/values of the CERT */</em>
<a id='L1974' name='L1974'></a>1974 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29787.html' title='Multiple used in 3 places.'>openssl_x509_parse</a>)
<a id='L1975' name='L1975'></a>1975 <em class='brace'>{</em>
<a id='L1976' name='L1976'></a>1976         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>;
<a id='L1977' name='L1977'></a>1977         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1978' name='L1978'></a>1978         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L1979' name='L1979'></a>1979         <strong class='reserved'>int</strong> <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>, <a href='../Y/36143.html' title='Multiple used in 5 places.'>sig_nid</a>;
<a id='L1980' name='L1980'></a>1980         <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../Y/39914.html' title='Multiple used in 5 places.'>useshortnames</a> = 1;
<a id='L1981' name='L1981'></a>1981         <strong class='reserved'>char</strong> * <a href='../Y/38709.html' title='Multiple used in 45 places.'>tmpstr</a>;
<a id='L1982' name='L1982'></a>1982         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> <a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>;
<a id='L1983' name='L1983'></a>1983         <a href='../Y/7370.html' title='Multiple used in 2 places.'>X509_EXTENSION</a> *<a href='../Y/17383.html' title='Multiple used in 145 places.'>extension</a>;
<a id='L1984' name='L1984'></a>1984         <strong class='reserved'>char</strong> *<a href='../Y/17406.html' title='Multiple used in 23 places.'>extname</a>;
<a id='L1985' name='L1985'></a>1985         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> *<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>;
<a id='L1986' name='L1986'></a>1986         <a href='../Y/273.html' title='Multiple used in 8 places.'>BUF_MEM</a> *<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>;
<a id='L1987' name='L1987'></a>1987         <strong class='reserved'>char</strong> <a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>[256];
<a id='L1988' name='L1988'></a>1988 
<a id='L1989' name='L1989'></a>1989         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "z|b", &amp;<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, &amp;<a href='../Y/39914.html' title='Multiple used in 5 places.'>useshortnames</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L1990' name='L1990'></a>1990                 <strong class='reserved'>return</strong>;
<a id='L1991' name='L1991'></a>1991         <em class='brace'>}</em>
<a id='L1992' name='L1992'></a>1992         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, 0, &amp;<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>);
<a id='L1993' name='L1993'></a>1993         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L1994' name='L1994'></a>1994                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L1995' name='L1995'></a>1995         <em class='brace'>}</em>
<a id='L1996' name='L1996'></a>1996         <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>);
<a id='L1997' name='L1997'></a>1997 
<a id='L1998' name='L1998'></a>1998         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>-&gt;<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>) <em class='brace'>{</em>
<a id='L1999' name='L1999'></a>1999                 <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "name", <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>-&gt;<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>);
<a id='L2000' name='L2000'></a>2000         <em class='brace'>}</em>
<a id='L2001' name='L2001'></a>2001 <em class='comment'>/*      add_assoc_bool(return_value, "valid", cert-&gt;valid); */</em>
<a id='L2002' name='L2002'></a>2002 
<a id='L2003' name='L2003'></a>2003         <a href='../Y/8825.html' title='Multiple used in 4 places.'>add_assoc_name_entry</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "subject",           <a href='../Y/7454.html' title='Multiple used in 4 places.'>X509_get_subject_name</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>), <a href='../Y/39914.html' title='Multiple used in 5 places.'>useshortnames</a>);
<a id='L2004' name='L2004'></a>2004         <em class='comment'>/* hash as used in CA directories to lookup cert by subject name */</em>
<a id='L2005' name='L2005'></a>2005         <em class='brace'>{</em>
<a id='L2006' name='L2006'></a>2006                 <strong class='reserved'>char</strong> <a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>[32];
<a id='L2007' name='L2007'></a>2007                 <a href='../D/29935.html' title='Multiple defined in 5 places.'>snprintf</a>(<a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>, <strong class='reserved'>sizeof</strong>(<a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>), "%08lx", X509_subject_name_hash(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>));
<a id='L2008' name='L2008'></a>2008                 <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "hash", <a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>);
<a id='L2009' name='L2009'></a>2009         <em class='brace'>}</em>
<a id='L2010' name='L2010'></a>2010 
<a id='L2011' name='L2011'></a>2011         <a href='../Y/8825.html' title='Multiple used in 4 places.'>add_assoc_name_entry</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "issuer",            X509_get_issuer_name(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>), <a href='../Y/39914.html' title='Multiple used in 5 places.'>useshortnames</a>);
<a id='L2012' name='L2012'></a>2012         <a href='../S/1632.html#L400' title='Defined at 400 in Zend/zend_API.h.'>add_assoc_long</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "version",                         X509_get_version(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>));
<a id='L2013' name='L2013'></a>2013 
<a id='L2014' name='L2014'></a>2014         <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "serialNumber", i2s_ASN1_INTEGER(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../Y/7453.html' title='Multiple used in 2 places.'>X509_get_serialNumber</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>)));
<a id='L2015' name='L2015'></a>2015 
<a id='L2016' name='L2016'></a>2016         <a href='../S/851.html#L713' title='Defined at 713 in ext/openssl/openssl.c.'>add_assoc_asn1_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "validFrom",        <a href='../Y/7451.html' title='Multiple used in 3 places.'>X509_get_notBefore</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>));
<a id='L2017' name='L2017'></a>2017         <a href='../S/851.html#L713' title='Defined at 713 in ext/openssl/openssl.c.'>add_assoc_asn1_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "validTo",          <a href='../Y/7450.html' title='Multiple used in 3 places.'>X509_get_notAfter</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>));
<a id='L2018' name='L2018'></a>2018 
<a id='L2019' name='L2019'></a>2019         <a href='../S/1632.html#L400' title='Defined at 400 in Zend/zend_API.h.'>add_assoc_long</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "validFrom_time_t",        <a href='../S/851.html#L719' title='Defined at 719 in ext/openssl/openssl.c.'>asn1_time_to_time_t</a>(<a href='../Y/7451.html' title='Multiple used in 3 places.'>X509_get_notBefore</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>)));
<a id='L2020' name='L2020'></a>2020         <a href='../S/1632.html#L400' title='Defined at 400 in Zend/zend_API.h.'>add_assoc_long</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "validTo_time_t",          <a href='../S/851.html#L719' title='Defined at 719 in ext/openssl/openssl.c.'>asn1_time_to_time_t</a>(<a href='../Y/7450.html' title='Multiple used in 3 places.'>X509_get_notAfter</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>)));
<a id='L2021' name='L2021'></a>2021 
<a id='L2022' name='L2022'></a>2022         <a href='../Y/38709.html' title='Multiple used in 45 places.'>tmpstr</a> = (<strong class='reserved'>char</strong> *)X509_alias_get0(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L2023' name='L2023'></a>2023         <strong class='reserved'>if</strong> (<a href='../Y/38709.html' title='Multiple used in 45 places.'>tmpstr</a>) <em class='brace'>{</em>
<a id='L2024' name='L2024'></a>2024                 <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "alias", <a href='../Y/38709.html' title='Multiple used in 45 places.'>tmpstr</a>);
<a id='L2025' name='L2025'></a>2025         <em class='brace'>}</em>
<a id='L2026' name='L2026'></a>2026 
<a id='L2027' name='L2027'></a>2027         <a href='../Y/36143.html' title='Multiple used in 5 places.'>sig_nid</a> = <a href='../Y/4352.html' title='Multiple used in 4 places.'>OBJ_obj2nid</a>((<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>)-&gt;sig_alg-&gt;<a href='../Y/9058.html' title='Multiple used in 27 places.'>algorithm</a>);
<a id='L2028' name='L2028'></a>2028         <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "signatureTypeSN", (<strong class='reserved'>char</strong>*)<a href='../Y/4351.html' title='Multiple used in 4 places.'>OBJ_nid2sn</a>(<a href='../Y/36143.html' title='Multiple used in 5 places.'>sig_nid</a>));
<a id='L2029' name='L2029'></a>2029         <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "signatureTypeLN", (<strong class='reserved'>char</strong>*)<a href='../Y/4349.html' title='Multiple used in 2 places.'>OBJ_nid2ln</a>(<a href='../Y/36143.html' title='Multiple used in 5 places.'>sig_nid</a>));
<a id='L2030' name='L2030'></a>2030         <a href='../S/1632.html#L400' title='Defined at 400 in Zend/zend_API.h.'>add_assoc_long</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "signatureTypeNID", <a href='../Y/36143.html' title='Multiple used in 5 places.'>sig_nid</a>);
<a id='L2031' name='L2031'></a>2031         <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(&amp;<a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>);
<a id='L2032' name='L2032'></a>2032 
<a id='L2033' name='L2033'></a>2033         <em class='comment'>/* NOTE: the purposes are added as integer keys - the keys match up to the X509_PURPOSE_SSL_XXX defines</em>
<a id='L2034' name='L2034'></a>2034 <em class='comment'>           in x509v3.h */</em>
<a id='L2035' name='L2035'></a>2035         <strong class='reserved'>for</strong> (<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> = 0; <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> &lt; X509_PURPOSE_get_count(); <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>++) <em class='brace'>{</em>
<a id='L2036' name='L2036'></a>2036                 <strong class='reserved'>int</strong> <a href='../Y/22563.html' title='Multiple used in 1232 places.'>id</a>, <a href='../Y/33739.html' title='Multiple used in 5 places.'>purpset</a>;
<a id='L2037' name='L2037'></a>2037                 <strong class='reserved'>char</strong> * <a href='../Y/32927.html' title='Multiple used in 20 places.'>pname</a>;
<a id='L2038' name='L2038'></a>2038                 X509_PURPOSE * <a href='../Y/33737.html' title='Multiple used in 4 places.'>purp</a>;
<a id='L2039' name='L2039'></a>2039                 <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> <a href='../Y/37857.html' title='Multiple used in 6 places.'>subsub</a>;
<a id='L2040' name='L2040'></a>2040 
<a id='L2041' name='L2041'></a>2041                 <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(&amp;<a href='../Y/37857.html' title='Multiple used in 6 places.'>subsub</a>);
<a id='L2042' name='L2042'></a>2042 
<a id='L2043' name='L2043'></a>2043                 <a href='../Y/33737.html' title='Multiple used in 4 places.'>purp</a> = X509_PURPOSE_get0(<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>);
<a id='L2044' name='L2044'></a>2044                 <a href='../Y/22563.html' title='Multiple used in 1232 places.'>id</a> = X509_PURPOSE_get_id(<a href='../Y/33737.html' title='Multiple used in 4 places.'>purp</a>);
<a id='L2045' name='L2045'></a>2045 
<a id='L2046' name='L2046'></a>2046                 <a href='../Y/33739.html' title='Multiple used in 5 places.'>purpset</a> = <a href='../Y/7436.html' title='Multiple used in 2 places.'>X509_check_purpose</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../Y/22563.html' title='Multiple used in 1232 places.'>id</a>, 0);
<a id='L2047' name='L2047'></a>2047                 <a href='../S/1631.html#L1433' title='Defined at 1433 in Zend/zend_API.c.'>add_index_bool</a>(&amp;<a href='../Y/37857.html' title='Multiple used in 6 places.'>subsub</a>, 0, <a href='../Y/33739.html' title='Multiple used in 5 places.'>purpset</a>);
<a id='L2048' name='L2048'></a>2048 
<a id='L2049' name='L2049'></a>2049                 <a href='../Y/33739.html' title='Multiple used in 5 places.'>purpset</a> = <a href='../Y/7436.html' title='Multiple used in 2 places.'>X509_check_purpose</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../Y/22563.html' title='Multiple used in 1232 places.'>id</a>, 1);
<a id='L2050' name='L2050'></a>2050                 <a href='../S/1631.html#L1433' title='Defined at 1433 in Zend/zend_API.c.'>add_index_bool</a>(&amp;<a href='../Y/37857.html' title='Multiple used in 6 places.'>subsub</a>, 1, <a href='../Y/33739.html' title='Multiple used in 5 places.'>purpset</a>);
<a id='L2051' name='L2051'></a>2051 
<a id='L2052' name='L2052'></a>2052                 <a href='../Y/32927.html' title='Multiple used in 20 places.'>pname</a> = <a href='../Y/39914.html' title='Multiple used in 5 places.'>useshortnames</a> ? X509_PURPOSE_get0_sname(<a href='../Y/33737.html' title='Multiple used in 4 places.'>purp</a>) : X509_PURPOSE_get0_name(<a href='../Y/33737.html' title='Multiple used in 4 places.'>purp</a>);
<a id='L2053' name='L2053'></a>2053                 <a href='../S/1631.html#L1469' title='Defined at 1469 in Zend/zend_API.c.'>add_index_string</a>(&amp;<a href='../Y/37857.html' title='Multiple used in 6 places.'>subsub</a>, 2, <a href='../Y/32927.html' title='Multiple used in 20 places.'>pname</a>);
<a id='L2054' name='L2054'></a>2054 
<a id='L2055' name='L2055'></a>2055                 <em class='comment'>/* NOTE: if purpset &gt; 1 then it's a warning - we should mention it ? */</em>
<a id='L2056' name='L2056'></a>2056 
<a id='L2057' name='L2057'></a>2057                 <a href='../S/1631.html#L1487' title='Defined at 1487 in Zend/zend_API.c.'>add_index_zval</a>(&amp;<a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>, <a href='../Y/22563.html' title='Multiple used in 1232 places.'>id</a>, &amp;<a href='../Y/37857.html' title='Multiple used in 6 places.'>subsub</a>);
<a id='L2058' name='L2058'></a>2058         <em class='brace'>}</em>
<a id='L2059' name='L2059'></a>2059         <a href='../S/1632.html#L408' title='Defined at 408 in Zend/zend_API.h.'>add_assoc_zval</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "purposes", &amp;<a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>);
<a id='L2060' name='L2060'></a>2060 
<a id='L2061' name='L2061'></a>2061         <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(&amp;<a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>);
<a id='L2062' name='L2062'></a>2062 
<a id='L2063' name='L2063'></a>2063 
<a id='L2064' name='L2064'></a>2064         <strong class='reserved'>for</strong> (<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> = 0; <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> &lt; X509_get_ext_count(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>); <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>++) <em class='brace'>{</em>
<a id='L2065' name='L2065'></a>2065                 <strong class='reserved'>int</strong> <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>;
<a id='L2066' name='L2066'></a>2066                 <a href='../Y/17383.html' title='Multiple used in 145 places.'>extension</a> = X509_get_ext(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>);
<a id='L2067' name='L2067'></a>2067                 <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a> = <a href='../Y/4352.html' title='Multiple used in 4 places.'>OBJ_obj2nid</a>(<a href='../Y/7372.html' title='Multiple used in 3 places.'>X509_EXTENSION_get_object</a>(<a href='../Y/17383.html' title='Multiple used in 145 places.'>extension</a>));
<a id='L2068' name='L2068'></a>2068                 <strong class='reserved'>if</strong> (<a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a> != <a href='../Y/4236.html' title='Multiple used in 6 places.'>NID_undef</a>) <em class='brace'>{</em>
<a id='L2069' name='L2069'></a>2069                         <a href='../Y/17406.html' title='Multiple used in 23 places.'>extname</a> = (<strong class='reserved'>char</strong> *)<a href='../Y/4351.html' title='Multiple used in 4 places.'>OBJ_nid2sn</a>(<a href='../Y/4352.html' title='Multiple used in 4 places.'>OBJ_obj2nid</a>(<a href='../Y/7372.html' title='Multiple used in 3 places.'>X509_EXTENSION_get_object</a>(<a href='../Y/17383.html' title='Multiple used in 145 places.'>extension</a>)));
<a id='L2070' name='L2070'></a>2070                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2071' name='L2071'></a>2071                         <a href='../Y/4353.html' title='Multiple used in 2 places.'>OBJ_obj2txt</a>(<a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>, <strong class='reserved'>sizeof</strong>(<a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>)-1, <a href='../Y/7372.html' title='Multiple used in 3 places.'>X509_EXTENSION_get_object</a>(<a href='../Y/17383.html' title='Multiple used in 145 places.'>extension</a>), 1);
<a id='L2072' name='L2072'></a>2072                         <a href='../Y/17406.html' title='Multiple used in 23 places.'>extname</a> = <a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>;
<a id='L2073' name='L2073'></a>2073                 <em class='brace'>}</em>
<a id='L2074' name='L2074'></a>2074                 <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../Y/231.html' title='Multiple used in 12 places.'>BIO_new</a>(<a href='../Y/237.html' title='Multiple used in 12 places.'>BIO_s_mem</a>());
<a id='L2075' name='L2075'></a>2075                 <strong class='reserved'>if</strong> (<a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a> == <a href='../Y/4235.html' title='Multiple used in 2 places.'>NID_subject_alt_name</a>) <em class='brace'>{</em>
<a id='L2076' name='L2076'></a>2076                         <strong class='reserved'>if</strong> (<a href='../S/851.html#L1908' title='Defined at 1908 in ext/openssl/openssl.c.'>openssl_x509v3_subjectAltName</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../Y/17383.html' title='Multiple used in 145 places.'>extension</a>) == 0) <em class='brace'>{</em>
<a id='L2077' name='L2077'></a>2077                                 <a href='../Y/230.html' title='Multiple used in 9 places.'>BIO_get_mem_ptr</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, &amp;<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>);
<a id='L2078' name='L2078'></a>2078                                 <a href='../S/1632.html#L407' title='Defined at 407 in Zend/zend_API.h.'>add_assoc_stringl</a>(&amp;<a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>, <a href='../Y/17406.html' title='Multiple used in 23 places.'>extname</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>);
<a id='L2079' name='L2079'></a>2079                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2080' name='L2080'></a>2080                                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>);
<a id='L2081' name='L2081'></a>2081                                 <strong class='reserved'>if</strong> (<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) <em class='brace'>{</em>
<a id='L2082' name='L2082'></a>2082                                         <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L2083' name='L2083'></a>2083                                 <em class='brace'>}</em>
<a id='L2084' name='L2084'></a>2084                                 <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>);
<a id='L2085' name='L2085'></a>2085                                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L2086' name='L2086'></a>2086                         <em class='brace'>}</em>
<a id='L2087' name='L2087'></a>2087                 <em class='brace'>}</em>
<a id='L2088' name='L2088'></a>2088                 <strong class='reserved'>else</strong> <strong class='reserved'>if</strong> (X509V3_EXT_print(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../Y/17383.html' title='Multiple used in 145 places.'>extension</a>, 0, 0)) <em class='brace'>{</em>
<a id='L2089' name='L2089'></a>2089                         <a href='../Y/230.html' title='Multiple used in 9 places.'>BIO_get_mem_ptr</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, &amp;<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>);
<a id='L2090' name='L2090'></a>2090                         <a href='../S/1632.html#L407' title='Defined at 407 in Zend/zend_API.h.'>add_assoc_stringl</a>(&amp;<a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>, <a href='../Y/17406.html' title='Multiple used in 23 places.'>extname</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>);
<a id='L2091' name='L2091'></a>2091                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2092' name='L2092'></a>2092                         <a href='../S/851.html#L713' title='Defined at 713 in ext/openssl/openssl.c.'>add_assoc_asn1_string</a>(&amp;<a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>, <a href='../Y/17406.html' title='Multiple used in 23 places.'>extname</a>, X509_EXTENSION_get_data(<a href='../Y/17383.html' title='Multiple used in 145 places.'>extension</a>));
<a id='L2093' name='L2093'></a>2093                 <em class='brace'>}</em>
<a id='L2094' name='L2094'></a>2094                 <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>);
<a id='L2095' name='L2095'></a>2095         <em class='brace'>}</em>
<a id='L2096' name='L2096'></a>2096         <a href='../S/1632.html#L408' title='Defined at 408 in Zend/zend_API.h.'>add_assoc_zval</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "extensions", &amp;<a href='../Y/37812.html' title='Multiple used in 16 places.'>subitem</a>);
<a id='L2097' name='L2097'></a>2097 
<a id='L2098' name='L2098'></a>2098         <strong class='reserved'>if</strong> (<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) <em class='brace'>{</em>
<a id='L2099' name='L2099'></a>2099                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L2100' name='L2100'></a>2100         <em class='brace'>}</em>
<a id='L2101' name='L2101'></a>2101 <em class='brace'>}</em>
<a id='L2102' name='L2102'></a>2102 <em class='comment'>/* }}} */</em>
<a id='L2103' name='L2103'></a>2103 
<a id='L2104' name='L2104'></a>2104 <em class='comment'>/* {{{ load_all_certs_from_file */</em>
<a id='L2105' name='L2105'></a>2105 <strong class='reserved'>static</strong> <a href='../R/10333.html' title='Multiple referred from 17 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) * <a href='../Y/25249.html' title='Multiple used in 5 places.'>load_all_certs_from_file</a>(<strong class='reserved'>char</strong> *<a href='../Y/13485.html' title='Multiple used in 12 places.'>certfile</a>)
<a id='L2106' name='L2106'></a>2106 <em class='brace'>{</em>
<a id='L2107' name='L2107'></a>2107         <a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/7375.html' title='Multiple used in 2 places.'>X509_INFO</a>) *<a href='../Y/36261.html' title='Multiple used in 13 places.'>sk</a>=<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2108' name='L2108'></a>2108         <a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) *<a href='../Y/37146.html' title='Multiple used in 471 places.'>stack</a>=<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, *<a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a>=<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2109' name='L2109'></a>2109         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> *<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>=<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2110' name='L2110'></a>2110         <a href='../Y/7375.html' title='Multiple used in 2 places.'>X509_INFO</a> *<a href='../Y/41083.html' title='Multiple used in 18 places.'>xi</a>;
<a id='L2111' name='L2111'></a>2111 
<a id='L2112' name='L2112'></a>2112         <strong class='reserved'>if</strong>(!(<a href='../Y/37146.html' title='Multiple used in 471 places.'>stack</a> = <a href='../Y/36271.html' title='Multiple used in 3 places.'>sk_X509_new_null</a>())) <em class='brace'>{</em>
<a id='L2113' name='L2113'></a>2113                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L25' title='Defined at 25 in Zend/zend_errors.h.'>E_ERROR</a>, "memory allocation failure");
<a id='L2114' name='L2114'></a>2114                 <strong class='reserved'>goto</strong> <a href='../S/869.html#L1684' title='Defined at 1684 in ext/pcre/pcrelib/pcre_jit_compile.c.'>end</a>;
<a id='L2115' name='L2115'></a>2115         <em class='brace'>}</em>
<a id='L2116' name='L2116'></a>2116 
<a id='L2117' name='L2117'></a>2117         <strong class='reserved'>if</strong> (<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/13485.html' title='Multiple used in 12 places.'>certfile</a>)) <em class='brace'>{</em>
<a id='L2118' name='L2118'></a>2118                 <a href='../Y/36270.html' title='Multiple used in 8 places.'>sk_X509_free</a>(<a href='../Y/37146.html' title='Multiple used in 471 places.'>stack</a>);
<a id='L2119' name='L2119'></a>2119                 <strong class='reserved'>goto</strong> <a href='../S/869.html#L1684' title='Defined at 1684 in ext/pcre/pcrelib/pcre_jit_compile.c.'>end</a>;
<a id='L2120' name='L2120'></a>2120         <em class='brace'>}</em>
<a id='L2121' name='L2121'></a>2121 
<a id='L2122' name='L2122'></a>2122         <strong class='reserved'>if</strong>(!(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>=<a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/13485.html' title='Multiple used in 12 places.'>certfile</a>, "r"))) <em class='brace'>{</em>
<a id='L2123' name='L2123'></a>2123                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "error opening the file, %s", <a href='../Y/13485.html' title='Multiple used in 12 places.'>certfile</a>);
<a id='L2124' name='L2124'></a>2124                 <a href='../Y/36270.html' title='Multiple used in 8 places.'>sk_X509_free</a>(<a href='../Y/37146.html' title='Multiple used in 471 places.'>stack</a>);
<a id='L2125' name='L2125'></a>2125                 <strong class='reserved'>goto</strong> <a href='../S/869.html#L1684' title='Defined at 1684 in ext/pcre/pcrelib/pcre_jit_compile.c.'>end</a>;
<a id='L2126' name='L2126'></a>2126         <em class='brace'>}</em>
<a id='L2127' name='L2127'></a>2127 
<a id='L2128' name='L2128'></a>2128         <em class='comment'>/* This loads from a file, a stack of x509/crl/pkey sets */</em>
<a id='L2129' name='L2129'></a>2129         <strong class='reserved'>if</strong>(!(<a href='../Y/36261.html' title='Multiple used in 13 places.'>sk</a>=PEM_X509_INFO_read_bio(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>))) <em class='brace'>{</em>
<a id='L2130' name='L2130'></a>2130                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "error reading the file, %s", <a href='../Y/13485.html' title='Multiple used in 12 places.'>certfile</a>);
<a id='L2131' name='L2131'></a>2131                 <a href='../Y/36270.html' title='Multiple used in 8 places.'>sk_X509_free</a>(<a href='../Y/37146.html' title='Multiple used in 471 places.'>stack</a>);
<a id='L2132' name='L2132'></a>2132                 <strong class='reserved'>goto</strong> <a href='../S/869.html#L1684' title='Defined at 1684 in ext/pcre/pcrelib/pcre_jit_compile.c.'>end</a>;
<a id='L2133' name='L2133'></a>2133         <em class='brace'>}</em>
<a id='L2134' name='L2134'></a>2134 
<a id='L2135' name='L2135'></a>2135         <em class='comment'>/* scan over it and pull out the certs */</em>
<a id='L2136' name='L2136'></a>2136         <strong class='reserved'>while</strong> (sk_X509_INFO_num(<a href='../Y/36261.html' title='Multiple used in 13 places.'>sk</a>)) <em class='brace'>{</em>
<a id='L2137' name='L2137'></a>2137                 <a href='../Y/41083.html' title='Multiple used in 18 places.'>xi</a>=sk_X509_INFO_shift(<a href='../Y/36261.html' title='Multiple used in 13 places.'>sk</a>);
<a id='L2138' name='L2138'></a>2138                 <strong class='reserved'>if</strong> (<a href='../Y/41083.html' title='Multiple used in 18 places.'>xi</a>-&gt;<a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2139' name='L2139'></a>2139                         <a href='../Y/36275.html' title='Multiple used in 5 places.'>sk_X509_push</a>(<a href='../Y/37146.html' title='Multiple used in 471 places.'>stack</a>,<a href='../Y/41083.html' title='Multiple used in 18 places.'>xi</a>-&gt;<a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>);
<a id='L2140' name='L2140'></a>2140                         <a href='../Y/41083.html' title='Multiple used in 18 places.'>xi</a>-&gt;<a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>=<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2141' name='L2141'></a>2141                 <em class='brace'>}</em>
<a id='L2142' name='L2142'></a>2142                 X509_INFO_free(<a href='../Y/41083.html' title='Multiple used in 18 places.'>xi</a>);
<a id='L2143' name='L2143'></a>2143         <em class='brace'>}</em>
<a id='L2144' name='L2144'></a>2144         <strong class='reserved'>if</strong>(!<a href='../Y/36272.html' title='Multiple used in 4 places.'>sk_X509_num</a>(<a href='../Y/37146.html' title='Multiple used in 471 places.'>stack</a>)) <em class='brace'>{</em>
<a id='L2145' name='L2145'></a>2145                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "no certificates in file, %s", <a href='../Y/13485.html' title='Multiple used in 12 places.'>certfile</a>);
<a id='L2146' name='L2146'></a>2146                 <a href='../Y/36270.html' title='Multiple used in 8 places.'>sk_X509_free</a>(<a href='../Y/37146.html' title='Multiple used in 471 places.'>stack</a>);
<a id='L2147' name='L2147'></a>2147                 <strong class='reserved'>goto</strong> <a href='../S/869.html#L1684' title='Defined at 1684 in ext/pcre/pcrelib/pcre_jit_compile.c.'>end</a>;
<a id='L2148' name='L2148'></a>2148         <em class='brace'>}</em>
<a id='L2149' name='L2149'></a>2149         <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a>=<a href='../Y/37146.html' title='Multiple used in 471 places.'>stack</a>;
<a id='L2150' name='L2150'></a>2150 <a href='../S/869.html#L1684' title='Defined at 1684 in ext/pcre/pcrelib/pcre_jit_compile.c.'>end</a>:
<a id='L2151' name='L2151'></a>2151         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>);
<a id='L2152' name='L2152'></a>2152         sk_X509_INFO_free(<a href='../Y/36261.html' title='Multiple used in 13 places.'>sk</a>);
<a id='L2153' name='L2153'></a>2153 
<a id='L2154' name='L2154'></a>2154         <strong class='reserved'>return</strong> <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a>;
<a id='L2155' name='L2155'></a>2155 <em class='brace'>}</em>
<a id='L2156' name='L2156'></a>2156 <em class='comment'>/* }}} */</em>
<a id='L2157' name='L2157'></a>2157 
<a id='L2158' name='L2158'></a>2158 <em class='comment'>/* {{{ check_cert */</em>
<a id='L2159' name='L2159'></a>2159 <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../S/851.html#L2216' title='Referred from 2216 in ext/openssl/openssl.c.'>check_cert</a>(<a href='../Y/7417.html' title='Multiple used in 7 places.'>X509_STORE</a> *<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>, <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> *<a href='../Y/40872.html' title='Multiple used in 2430 places.'>x</a>, <a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) *<a href='../Y/39650.html' title='Multiple used in 8 places.'>untrustedchain</a>, <strong class='reserved'>int</strong> <a href='../Y/33738.html' title='Multiple used in 7 places.'>purpose</a>)
<a id='L2160' name='L2160'></a>2160 <em class='brace'>{</em>
<a id='L2161' name='L2161'></a>2161         <strong class='reserved'>int</strong> <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a>=0;
<a id='L2162' name='L2162'></a>2162         <a href='../Y/7418.html' title='Multiple used in 3 places.'>X509_STORE_CTX</a> *<a href='../Y/14648.html' title='Multiple used in 7 places.'>csc</a>;
<a id='L2163' name='L2163'></a>2163 
<a id='L2164' name='L2164'></a>2164         <a href='../Y/14648.html' title='Multiple used in 7 places.'>csc</a> = X509_STORE_CTX_new();
<a id='L2165' name='L2165'></a>2165         <strong class='reserved'>if</strong> (<a href='../Y/14648.html' title='Multiple used in 7 places.'>csc</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2166' name='L2166'></a>2166                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L25' title='Defined at 25 in Zend/zend_errors.h.'>E_ERROR</a>, "memory allocation failure");
<a id='L2167' name='L2167'></a>2167                 <strong class='reserved'>return</strong> 0;
<a id='L2168' name='L2168'></a>2168         <em class='brace'>}</em>
<a id='L2169' name='L2169'></a>2169         X509_STORE_CTX_init(<a href='../Y/14648.html' title='Multiple used in 7 places.'>csc</a>, <a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>, <a href='../Y/40872.html' title='Multiple used in 2430 places.'>x</a>, <a href='../Y/39650.html' title='Multiple used in 8 places.'>untrustedchain</a>);
<a id='L2170' name='L2170'></a>2170         <strong class='reserved'>if</strong>(<a href='../Y/33738.html' title='Multiple used in 7 places.'>purpose</a> &gt;= 0) <em class='brace'>{</em>
<a id='L2171' name='L2171'></a>2171                 X509_STORE_CTX_set_purpose(<a href='../Y/14648.html' title='Multiple used in 7 places.'>csc</a>, <a href='../Y/33738.html' title='Multiple used in 7 places.'>purpose</a>);
<a id='L2172' name='L2172'></a>2172         <em class='brace'>}</em>
<a id='L2173' name='L2173'></a>2173         <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a> = X509_verify_cert(<a href='../Y/14648.html' title='Multiple used in 7 places.'>csc</a>);
<a id='L2174' name='L2174'></a>2174         X509_STORE_CTX_free(<a href='../Y/14648.html' title='Multiple used in 7 places.'>csc</a>);
<a id='L2175' name='L2175'></a>2175 
<a id='L2176' name='L2176'></a>2176         <strong class='reserved'>return</strong> <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a>;
<a id='L2177' name='L2177'></a>2177 <em class='brace'>}</em>
<a id='L2178' name='L2178'></a>2178 <em class='comment'>/* }}} */</em>
<a id='L2179' name='L2179'></a>2179 
<a id='L2180' name='L2180'></a>2180 <em class='comment'>/* {{{ proto int openssl_x509_checkpurpose(mixed x509cert, int purpose, array cainfo [, string untrustedfile])</em>
<a id='L2181' name='L2181'></a>2181 <em class='comment'>   Checks the CERT to see if it can be used for the purpose in purpose. cainfo holds information about trusted CAs */</em>
<a id='L2182' name='L2182'></a>2182 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29782.html' title='Multiple used in 3 places.'>openssl_x509_checkpurpose</a>)
<a id='L2183' name='L2183'></a>2183 <em class='brace'>{</em>
<a id='L2184' name='L2184'></a>2184         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, * <a href='../Y/43632.html' title='Multiple used in 3 places.'>zcainfo</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2185' name='L2185'></a>2185         <a href='../Y/7417.html' title='Multiple used in 7 places.'>X509_STORE</a> * <a href='../Y/13213.html' title='Multiple used in 17 places.'>cainfo</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2186' name='L2186'></a>2186         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2187' name='L2187'></a>2187         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2188' name='L2188'></a>2188         <a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) * <a href='../Y/39650.html' title='Multiple used in 8 places.'>untrustedchain</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2189' name='L2189'></a>2189         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/33738.html' title='Multiple used in 7 places.'>purpose</a>;
<a id='L2190' name='L2190'></a>2190         <strong class='reserved'>char</strong> * <a href='../Y/39648.html' title='Multiple used in 4 places.'>untrusted</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2191' name='L2191'></a>2191         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/39649.html' title='Multiple used in 2 places.'>untrusted_len</a> = 0;
<a id='L2192' name='L2192'></a>2192         <strong class='reserved'>int</strong> <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a>;
<a id='L2193' name='L2193'></a>2193 
<a id='L2194' name='L2194'></a>2194         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "zl|a!s", &amp;<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, &amp;<a href='../Y/33738.html' title='Multiple used in 7 places.'>purpose</a>, &amp;<a href='../Y/43632.html' title='Multiple used in 3 places.'>zcainfo</a>, &amp;<a href='../Y/39648.html' title='Multiple used in 4 places.'>untrusted</a>, &amp;<a href='../Y/39649.html' title='Multiple used in 2 places.'>untrusted_len</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L2195' name='L2195'></a>2195                 <strong class='reserved'>return</strong>;
<a id='L2196' name='L2196'></a>2196         <em class='brace'>}</em>
<a id='L2197' name='L2197'></a>2197 
<a id='L2198' name='L2198'></a>2198         <a href='../S/1632.html#L613' title='Defined at 613 in Zend/zend_API.h.'>RETVAL_LONG</a>(-1);
<a id='L2199' name='L2199'></a>2199 
<a id='L2200' name='L2200'></a>2200         <strong class='reserved'>if</strong> (<a href='../Y/39648.html' title='Multiple used in 4 places.'>untrusted</a>) <em class='brace'>{</em>
<a id='L2201' name='L2201'></a>2201                 <a href='../Y/39650.html' title='Multiple used in 8 places.'>untrustedchain</a> = <a href='../Y/25249.html' title='Multiple used in 5 places.'>load_all_certs_from_file</a>(<a href='../Y/39648.html' title='Multiple used in 4 places.'>untrusted</a>);
<a id='L2202' name='L2202'></a>2202                 <strong class='reserved'>if</strong> (<a href='../Y/39650.html' title='Multiple used in 8 places.'>untrustedchain</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2203' name='L2203'></a>2203                         <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L2204' name='L2204'></a>2204                 <em class='brace'>}</em>
<a id='L2205' name='L2205'></a>2205         <em class='brace'>}</em>
<a id='L2206' name='L2206'></a>2206 
<a id='L2207' name='L2207'></a>2207         <a href='../Y/13213.html' title='Multiple used in 17 places.'>cainfo</a> = <a href='../S/851.html#L2240' title='Defined at 2240 in ext/openssl/openssl.c.'>setup_verify</a>(<a href='../Y/43632.html' title='Multiple used in 3 places.'>zcainfo</a>);
<a id='L2208' name='L2208'></a>2208         <strong class='reserved'>if</strong> (<a href='../Y/13213.html' title='Multiple used in 17 places.'>cainfo</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2209' name='L2209'></a>2209                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L2210' name='L2210'></a>2210         <em class='brace'>}</em>
<a id='L2211' name='L2211'></a>2211         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, 0, &amp;<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>);
<a id='L2212' name='L2212'></a>2212         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2213' name='L2213'></a>2213                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L2214' name='L2214'></a>2214         <em class='brace'>}</em>
<a id='L2215' name='L2215'></a>2215 
<a id='L2216' name='L2216'></a>2216         <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a> = <a href='../S/851.html#L2159' title='Defined at 2159 in ext/openssl/openssl.c.'>check_cert</a>(<a href='../Y/13213.html' title='Multiple used in 17 places.'>cainfo</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../Y/39650.html' title='Multiple used in 8 places.'>untrustedchain</a>, (<strong class='reserved'>int</strong>)<a href='../Y/33738.html' title='Multiple used in 7 places.'>purpose</a>);
<a id='L2217' name='L2217'></a>2217         <strong class='reserved'>if</strong> (<a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a> != 0 &amp;&amp; <a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a> != 1) <em class='brace'>{</em>
<a id='L2218' name='L2218'></a>2218                 <a href='../S/1632.html#L613' title='Defined at 613 in Zend/zend_API.h.'>RETVAL_LONG</a>(<a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a>);
<a id='L2219' name='L2219'></a>2219         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2220' name='L2220'></a>2220                 <a href='../S/1632.html#L611' title='Defined at 611 in Zend/zend_API.h.'>RETVAL_BOOL</a>(<a href='../Y/34775.html' title='Multiple used in 4028 places.'>ret</a>);
<a id='L2221' name='L2221'></a>2221         <em class='brace'>}</em>
<a id='L2222' name='L2222'></a>2222 
<a id='L2223' name='L2223'></a>2223 <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>:
<a id='L2224' name='L2224'></a>2224         <strong class='reserved'>if</strong> (<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) <em class='brace'>{</em>
<a id='L2225' name='L2225'></a>2225                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L2226' name='L2226'></a>2226         <em class='brace'>}</em>
<a id='L2227' name='L2227'></a>2227         <strong class='reserved'>if</strong> (<a href='../Y/13213.html' title='Multiple used in 17 places.'>cainfo</a>) <em class='brace'>{</em>
<a id='L2228' name='L2228'></a>2228                 <a href='../Y/7429.html' title='Multiple used in 2 places.'>X509_STORE_free</a>(<a href='../Y/13213.html' title='Multiple used in 17 places.'>cainfo</a>);
<a id='L2229' name='L2229'></a>2229         <em class='brace'>}</em>
<a id='L2230' name='L2230'></a>2230         <strong class='reserved'>if</strong> (<a href='../Y/39650.html' title='Multiple used in 8 places.'>untrustedchain</a>) <em class='brace'>{</em>
<a id='L2231' name='L2231'></a>2231                 <a href='../Y/36274.html' title='Multiple used in 3 places.'>sk_X509_pop_free</a>(<a href='../Y/39650.html' title='Multiple used in 8 places.'>untrustedchain</a>, <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>);
<a id='L2232' name='L2232'></a>2232         <em class='brace'>}</em>
<a id='L2233' name='L2233'></a>2233 <em class='brace'>}</em>
<a id='L2234' name='L2234'></a>2234 <em class='comment'>/* }}} */</em>
<a id='L2235' name='L2235'></a>2235 
<a id='L2236' name='L2236'></a>2236 <em class='comment'>/* {{{ setup_verify</em>
<a id='L2237' name='L2237'></a>2237 <em class='comment'> * calist is an array containing file and directory names.  create a</em>
<a id='L2238' name='L2238'></a>2238 <em class='comment'> * certificate store and add those certs to it for use in verification.</em>
<a id='L2239' name='L2239'></a>2239 <em class='comment'>*/</em>
<a id='L2240' name='L2240'></a>2240 <strong class='reserved'>static</strong> <a href='../Y/7417.html' title='Multiple used in 7 places.'>X509_STORE</a> * <a href='../R/26464.html' title='Multiple referred from 3 places.'>setup_verify</a>(<a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/13242.html' title='Multiple used in 4 places.'>calist</a>)
<a id='L2241' name='L2241'></a>2241 <em class='brace'>{</em>
<a id='L2242' name='L2242'></a>2242         <a href='../Y/7417.html' title='Multiple used in 7 places.'>X509_STORE</a> *<a href='../Y/37487.html' title='Multiple used in 18 places.'>store</a>;
<a id='L2243' name='L2243'></a>2243         X509_LOOKUP * <a href='../Y/15731.html' title='Multiple used in 7 places.'>dir_lookup</a>, * <a href='../Y/17847.html' title='Multiple used in 7 places.'>file_lookup</a>;
<a id='L2244' name='L2244'></a>2244         <strong class='reserved'>int</strong> <a href='../Y/28049.html' title='Multiple used in 3 places.'>ndirs</a> = 0, <a href='../Y/28522.html' title='Multiple used in 18 places.'>nfiles</a> = 0;
<a id='L2245' name='L2245'></a>2245         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>;
<a id='L2246' name='L2246'></a>2246         <a href='../D/34685.html' title='Multiple defined in 2 places.'>zend_stat_t</a> <a href='../Y/35419.html' title='Multiple used in 367 places.'>sb</a>;
<a id='L2247' name='L2247'></a>2247 
<a id='L2248' name='L2248'></a>2248         <a href='../Y/37487.html' title='Multiple used in 18 places.'>store</a> = X509_STORE_new();
<a id='L2249' name='L2249'></a>2249 
<a id='L2250' name='L2250'></a>2250         <strong class='reserved'>if</strong> (<a href='../Y/37487.html' title='Multiple used in 18 places.'>store</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2251' name='L2251'></a>2251                 <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2252' name='L2252'></a>2252         <em class='brace'>}</em>
<a id='L2253' name='L2253'></a>2253 
<a id='L2254' name='L2254'></a>2254         <strong class='reserved'>if</strong> (<a href='../Y/13242.html' title='Multiple used in 4 places.'>calist</a> &amp;&amp; (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/13242.html' title='Multiple used in 4 places.'>calist</a>) == <a href='../S/1731.html#L309' title='Defined at 309 in Zend/zend_types.h.'>IS_ARRAY</a>)) <em class='brace'>{</em>
<a id='L2255' name='L2255'></a>2255                 <a href='../S/1668.html#L774' title='Defined at 774 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_VAL</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/13242.html' title='Multiple used in 4 places.'>calist</a>), <a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>) <em class='brace'>{</em>
<a id='L2256' name='L2256'></a>2256                         <a href='../S/1707.html#L410' title='Defined at 410 in Zend/zend_operators.h.'>convert_to_string_ex</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>);
<a id='L2257' name='L2257'></a>2257 
<a id='L2258' name='L2258'></a>2258                         <strong class='reserved'>if</strong> (<a href='../D/14717.html' title='Multiple defined in 2 places.'>VCWD_STAT</a>(<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>), &amp;<a href='../Y/35419.html' title='Multiple used in 367 places.'>sb</a>) == -1) <em class='brace'>{</em>
<a id='L2259' name='L2259'></a>2259                                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "unable to stat %s", <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>));
<a id='L2260' name='L2260'></a>2260                                 <strong class='reserved'>continue</strong>;
<a id='L2261' name='L2261'></a>2261                         <em class='brace'>}</em>
<a id='L2262' name='L2262'></a>2262 
<a id='L2263' name='L2263'></a>2263                         <strong class='reserved'>if</strong> ((<a href='../Y/35419.html' title='Multiple used in 367 places.'>sb</a>.<a href='../Y/37102.html' title='Multiple used in 125 places.'>st_mode</a> &amp; <a href='../Y/6374.html' title='Multiple used in 22 places.'>S_IFREG</a>) == <a href='../Y/6374.html' title='Multiple used in 22 places.'>S_IFREG</a>) <em class='brace'>{</em>
<a id='L2264' name='L2264'></a>2264                                 <a href='../Y/17847.html' title='Multiple used in 7 places.'>file_lookup</a> = <a href='../Y/7428.html' title='Multiple used in 4 places.'>X509_STORE_add_lookup</a>(<a href='../Y/37487.html' title='Multiple used in 18 places.'>store</a>, <a href='../Y/7379.html' title='Multiple used in 2 places.'>X509_LOOKUP_file</a>());
<a id='L2265' name='L2265'></a>2265                                 <strong class='reserved'>if</strong> (<a href='../Y/17847.html' title='Multiple used in 7 places.'>file_lookup</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> || !<a href='../Y/7381.html' title='Multiple used in 2 places.'>X509_LOOKUP_load_file</a>(<a href='../Y/17847.html' title='Multiple used in 7 places.'>file_lookup</a>, <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>), <a href='../Y/7374.html' title='Multiple used in 2 places.'>X509_FILETYPE_PEM</a>)) <em class='brace'>{</em>
<a id='L2266' name='L2266'></a>2266                                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "error loading file %s", <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>));
<a id='L2267' name='L2267'></a>2267                                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2268' name='L2268'></a>2268                                         <a href='../Y/28522.html' title='Multiple used in 18 places.'>nfiles</a>++;
<a id='L2269' name='L2269'></a>2269                                 <em class='brace'>}</em>
<a id='L2270' name='L2270'></a>2270                                 <a href='../Y/17847.html' title='Multiple used in 7 places.'>file_lookup</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2271' name='L2271'></a>2271                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2272' name='L2272'></a>2272                                 <a href='../Y/15731.html' title='Multiple used in 7 places.'>dir_lookup</a> = <a href='../Y/7428.html' title='Multiple used in 4 places.'>X509_STORE_add_lookup</a>(<a href='../Y/37487.html' title='Multiple used in 18 places.'>store</a>, <a href='../Y/7380.html' title='Multiple used in 2 places.'>X509_LOOKUP_hash_dir</a>());
<a id='L2273' name='L2273'></a>2273                                 <strong class='reserved'>if</strong> (<a href='../Y/15731.html' title='Multiple used in 7 places.'>dir_lookup</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> || !<a href='../Y/7378.html' title='Multiple used in 2 places.'>X509_LOOKUP_add_dir</a>(<a href='../Y/15731.html' title='Multiple used in 7 places.'>dir_lookup</a>, <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>), <a href='../Y/7374.html' title='Multiple used in 2 places.'>X509_FILETYPE_PEM</a>)) <em class='brace'>{</em>
<a id='L2274' name='L2274'></a>2274                                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "error loading directory %s", <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>));
<a id='L2275' name='L2275'></a>2275                                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2276' name='L2276'></a>2276                                         <a href='../Y/28049.html' title='Multiple used in 3 places.'>ndirs</a>++;
<a id='L2277' name='L2277'></a>2277                                 <em class='brace'>}</em>
<a id='L2278' name='L2278'></a>2278                                 <a href='../Y/15731.html' title='Multiple used in 7 places.'>dir_lookup</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2279' name='L2279'></a>2279                         <em class='brace'>}</em>
<a id='L2280' name='L2280'></a>2280                 <em class='brace'>}</em> <a href='../S/1668.html#L766' title='Defined at 766 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_END</a>();
<a id='L2281' name='L2281'></a>2281         <em class='brace'>}</em>
<a id='L2282' name='L2282'></a>2282         <strong class='reserved'>if</strong> (<a href='../Y/28522.html' title='Multiple used in 18 places.'>nfiles</a> == 0) <em class='brace'>{</em>
<a id='L2283' name='L2283'></a>2283                 <a href='../Y/17847.html' title='Multiple used in 7 places.'>file_lookup</a> = <a href='../Y/7428.html' title='Multiple used in 4 places.'>X509_STORE_add_lookup</a>(<a href='../Y/37487.html' title='Multiple used in 18 places.'>store</a>, <a href='../Y/7379.html' title='Multiple used in 2 places.'>X509_LOOKUP_file</a>());
<a id='L2284' name='L2284'></a>2284                 <strong class='reserved'>if</strong> (<a href='../Y/17847.html' title='Multiple used in 7 places.'>file_lookup</a>) <em class='brace'>{</em>
<a id='L2285' name='L2285'></a>2285                         <a href='../Y/7381.html' title='Multiple used in 2 places.'>X509_LOOKUP_load_file</a>(<a href='../Y/17847.html' title='Multiple used in 7 places.'>file_lookup</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../Y/7373.html' title='Multiple used in 2 places.'>X509_FILETYPE_DEFAULT</a>);
<a id='L2286' name='L2286'></a>2286                 <em class='brace'>}</em>
<a id='L2287' name='L2287'></a>2287         <em class='brace'>}</em>
<a id='L2288' name='L2288'></a>2288         <strong class='reserved'>if</strong> (<a href='../Y/28049.html' title='Multiple used in 3 places.'>ndirs</a> == 0) <em class='brace'>{</em>
<a id='L2289' name='L2289'></a>2289                 <a href='../Y/15731.html' title='Multiple used in 7 places.'>dir_lookup</a> = <a href='../Y/7428.html' title='Multiple used in 4 places.'>X509_STORE_add_lookup</a>(<a href='../Y/37487.html' title='Multiple used in 18 places.'>store</a>, <a href='../Y/7380.html' title='Multiple used in 2 places.'>X509_LOOKUP_hash_dir</a>());
<a id='L2290' name='L2290'></a>2290                 <strong class='reserved'>if</strong> (<a href='../Y/15731.html' title='Multiple used in 7 places.'>dir_lookup</a>) <em class='brace'>{</em>
<a id='L2291' name='L2291'></a>2291                         <a href='../Y/7378.html' title='Multiple used in 2 places.'>X509_LOOKUP_add_dir</a>(<a href='../Y/15731.html' title='Multiple used in 7 places.'>dir_lookup</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../Y/7373.html' title='Multiple used in 2 places.'>X509_FILETYPE_DEFAULT</a>);
<a id='L2292' name='L2292'></a>2292                 <em class='brace'>}</em>
<a id='L2293' name='L2293'></a>2293         <em class='brace'>}</em>
<a id='L2294' name='L2294'></a>2294         <strong class='reserved'>return</strong> <a href='../Y/37487.html' title='Multiple used in 18 places.'>store</a>;
<a id='L2295' name='L2295'></a>2295 <em class='brace'>}</em>
<a id='L2296' name='L2296'></a>2296 <em class='comment'>/* }}} */</em>
<a id='L2297' name='L2297'></a>2297 
<a id='L2298' name='L2298'></a>2298 <em class='comment'>/* {{{ proto resource openssl_x509_read(mixed cert)</em>
<a id='L2299' name='L2299'></a>2299 <em class='comment'>   Reads X.509 certificates */</em>
<a id='L2300' name='L2300'></a>2300 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29788.html' title='Multiple used in 3 places.'>openssl_x509_read</a>)
<a id='L2301' name='L2301'></a>2301 <em class='brace'>{</em>
<a id='L2302' name='L2302'></a>2302         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>;
<a id='L2303' name='L2303'></a>2303         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> *<a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>;
<a id='L2304' name='L2304'></a>2304         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>;
<a id='L2305' name='L2305'></a>2305 
<a id='L2306' name='L2306'></a>2306         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "z", &amp;<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L2307' name='L2307'></a>2307                 <strong class='reserved'>return</strong>;
<a id='L2308' name='L2308'></a>2308         <em class='brace'>}</em>
<a id='L2309' name='L2309'></a>2309         <a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, 1, &amp;<a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>);
<a id='L2310' name='L2310'></a>2310         <a href='../S/1731.html#L685' title='Defined at 685 in Zend/zend_types.h.'>ZVAL_RES</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, <a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>);
<a id='L2311' name='L2311'></a>2311 
<a id='L2312' name='L2312'></a>2312         <strong class='reserved'>if</strong> (<a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2313' name='L2313'></a>2313                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "supplied parameter cannot be coerced into an X509 certificate!");
<a id='L2314' name='L2314'></a>2314                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L2315' name='L2315'></a>2315         <em class='brace'>}</em>
<a id='L2316' name='L2316'></a>2316 <em class='brace'>}</em>
<a id='L2317' name='L2317'></a>2317 <em class='comment'>/* }}} */</em>
<a id='L2318' name='L2318'></a>2318 
<a id='L2319' name='L2319'></a>2319 <em class='comment'>/* {{{ proto void openssl_x509_free(resource x509)</em>
<a id='L2320' name='L2320'></a>2320 <em class='comment'>   Frees X.509 certificates */</em>
<a id='L2321' name='L2321'></a>2321 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29786.html' title='Multiple used in 3 places.'>openssl_x509_free</a>)
<a id='L2322' name='L2322'></a>2322 <em class='brace'>{</em>
<a id='L2323' name='L2323'></a>2323         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>;
<a id='L2324' name='L2324'></a>2324         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> *<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>;
<a id='L2325' name='L2325'></a>2325 
<a id='L2326' name='L2326'></a>2326         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "r", &amp;<a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L2327' name='L2327'></a>2327                 <strong class='reserved'>return</strong>;
<a id='L2328' name='L2328'></a>2328         <em class='brace'>}</em>
<a id='L2329' name='L2329'></a>2329         <strong class='reserved'>if</strong> ((<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = (<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> *)<a href='../S/1690.html#L124' title='Defined at 124 in Zend/zend_list.c.'>zend_fetch_resource</a>(<a href='../S/1731.html#L552' title='Defined at 552 in Zend/zend_types.h.'>Z_RES_P</a>(<a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>), "OpenSSL X.509", <a href='../Y/24937.html' title='Multiple used in 9 places.'>le_x509</a>)) == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2330' name='L2330'></a>2330                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L2331' name='L2331'></a>2331         <em class='brace'>}</em>
<a id='L2332' name='L2332'></a>2332         <a href='../S/1690.html#L84' title='Defined at 84 in Zend/zend_list.c.'>zend_list_close</a>(<a href='../S/1731.html#L552' title='Defined at 552 in Zend/zend_types.h.'>Z_RES_P</a>(<a href='../Y/40886.html' title='Multiple used in 20 places.'>x509</a>));
<a id='L2333' name='L2333'></a>2333 <em class='brace'>}</em>
<a id='L2334' name='L2334'></a>2334 <em class='comment'>/* }}} */</em>
<a id='L2335' name='L2335'></a>2335 
<a id='L2336' name='L2336'></a>2336 <em class='comment'>/* }}} */</em>
<a id='L2337' name='L2337'></a>2337 
<a id='L2338' name='L2338'></a>2338 <em class='comment'>/* Pop all X509 from Stack and free them, free the stack afterwards */</em>
<a id='L2339' name='L2339'></a>2339 <strong class='reserved'>static</strong> <strong class='reserved'>void</strong> <a href='../R/24630.html' title='Multiple referred from 2 places.'>php_sk_X509_free</a>(<a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) * <a href='../Y/36261.html' title='Multiple used in 13 places.'>sk</a>) <em class='comment'>/* {{{ */</em>
<a id='L2340' name='L2340'></a>2340 <em class='brace'>{</em>
<a id='L2341' name='L2341'></a>2341         <strong class='reserved'>for</strong> (;;) <em class='brace'>{</em>
<a id='L2342' name='L2342'></a>2342                 <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>* <a href='../Y/40872.html' title='Multiple used in 2430 places.'>x</a> = <a href='../Y/36273.html' title='Multiple used in 2 places.'>sk_X509_pop</a>(<a href='../Y/36261.html' title='Multiple used in 13 places.'>sk</a>);
<a id='L2343' name='L2343'></a>2343                 <strong class='reserved'>if</strong> (!<a href='../Y/40872.html' title='Multiple used in 2430 places.'>x</a>) <strong class='reserved'>break</strong>;
<a id='L2344' name='L2344'></a>2344                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../Y/40872.html' title='Multiple used in 2430 places.'>x</a>);
<a id='L2345' name='L2345'></a>2345         <em class='brace'>}</em>
<a id='L2346' name='L2346'></a>2346         <a href='../Y/36270.html' title='Multiple used in 8 places.'>sk_X509_free</a>(<a href='../Y/36261.html' title='Multiple used in 13 places.'>sk</a>);
<a id='L2347' name='L2347'></a>2347 <em class='brace'>}</em>
<a id='L2348' name='L2348'></a>2348 <em class='comment'>/* }}} */</em>
<a id='L2349' name='L2349'></a>2349 
<a id='L2350' name='L2350'></a>2350 <strong class='reserved'>static</strong> <a href='../R/10333.html' title='Multiple referred from 17 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) * <a href='../Y/32020.html' title='Multiple used in 3 places.'>php_array_to_X509_sk</a>(<a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43637.html' title='Multiple used in 4 places.'>zcerts</a>) <em class='comment'>/* {{{ */</em>
<a id='L2351' name='L2351'></a>2351 <em class='brace'>{</em>
<a id='L2352' name='L2352'></a>2352         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43638.html' title='Multiple used in 10 places.'>zcertval</a>;
<a id='L2353' name='L2353'></a>2353         <a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) * <a href='../Y/36261.html' title='Multiple used in 13 places.'>sk</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2354' name='L2354'></a>2354         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>;
<a id='L2355' name='L2355'></a>2355         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>;
<a id='L2356' name='L2356'></a>2356 
<a id='L2357' name='L2357'></a>2357         <a href='../Y/36261.html' title='Multiple used in 13 places.'>sk</a> = <a href='../Y/36271.html' title='Multiple used in 3 places.'>sk_X509_new_null</a>();
<a id='L2358' name='L2358'></a>2358 
<a id='L2359' name='L2359'></a>2359         <em class='comment'>/* get certs */</em>
<a id='L2360' name='L2360'></a>2360         <strong class='reserved'>if</strong> (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/43637.html' title='Multiple used in 4 places.'>zcerts</a>) == <a href='../S/1731.html#L309' title='Defined at 309 in Zend/zend_types.h.'>IS_ARRAY</a>) <em class='brace'>{</em>
<a id='L2361' name='L2361'></a>2361                 <a href='../S/1668.html#L774' title='Defined at 774 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_VAL</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/43637.html' title='Multiple used in 4 places.'>zcerts</a>), <a href='../Y/43638.html' title='Multiple used in 10 places.'>zcertval</a>) <em class='brace'>{</em>
<a id='L2362' name='L2362'></a>2362                         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/43638.html' title='Multiple used in 10 places.'>zcertval</a>, 0, &amp;<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>);
<a id='L2363' name='L2363'></a>2363                         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2364' name='L2364'></a>2364                                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L2365' name='L2365'></a>2365                         <em class='brace'>}</em>
<a id='L2366' name='L2366'></a>2366 
<a id='L2367' name='L2367'></a>2367                         <strong class='reserved'>if</strong> (<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2368' name='L2368'></a>2368                                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../Y/7438.html' title='Multiple used in 5 places.'>X509_dup</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L2369' name='L2369'></a>2369 
<a id='L2370' name='L2370'></a>2370                                 <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2371' name='L2371'></a>2371                                         <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L2372' name='L2372'></a>2372                                 <em class='brace'>}</em>
<a id='L2373' name='L2373'></a>2373 
<a id='L2374' name='L2374'></a>2374                         <em class='brace'>}</em>
<a id='L2375' name='L2375'></a>2375                         <a href='../Y/36275.html' title='Multiple used in 5 places.'>sk_X509_push</a>(<a href='../Y/36261.html' title='Multiple used in 13 places.'>sk</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L2376' name='L2376'></a>2376                 <em class='brace'>}</em> <a href='../S/1668.html#L766' title='Defined at 766 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_END</a>();
<a id='L2377' name='L2377'></a>2377         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2378' name='L2378'></a>2378                 <em class='comment'>/* a single certificate */</em>
<a id='L2379' name='L2379'></a>2379                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/43637.html' title='Multiple used in 4 places.'>zcerts</a>, 0, &amp;<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>);
<a id='L2380' name='L2380'></a>2380 
<a id='L2381' name='L2381'></a>2381                 <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2382' name='L2382'></a>2382                         <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L2383' name='L2383'></a>2383                 <em class='brace'>}</em>
<a id='L2384' name='L2384'></a>2384 
<a id='L2385' name='L2385'></a>2385                 <strong class='reserved'>if</strong> (<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2386' name='L2386'></a>2386                         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../Y/7438.html' title='Multiple used in 5 places.'>X509_dup</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L2387' name='L2387'></a>2387                         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2388' name='L2388'></a>2388                                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L2389' name='L2389'></a>2389                         <em class='brace'>}</em>
<a id='L2390' name='L2390'></a>2390                 <em class='brace'>}</em>
<a id='L2391' name='L2391'></a>2391                 <a href='../Y/36275.html' title='Multiple used in 5 places.'>sk_X509_push</a>(<a href='../Y/36261.html' title='Multiple used in 13 places.'>sk</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L2392' name='L2392'></a>2392         <em class='brace'>}</em>
<a id='L2393' name='L2393'></a>2393 
<a id='L2394' name='L2394'></a>2394 <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>:
<a id='L2395' name='L2395'></a>2395         <strong class='reserved'>return</strong> <a href='../Y/36261.html' title='Multiple used in 13 places.'>sk</a>;
<a id='L2396' name='L2396'></a>2396 <em class='brace'>}</em>
<a id='L2397' name='L2397'></a>2397 <em class='comment'>/* }}} */</em>
<a id='L2398' name='L2398'></a>2398 
<a id='L2399' name='L2399'></a>2399 <em class='comment'>/* {{{ proto bool openssl_pkcs12_export_to_file(mixed x509, string filename, mixed priv_key, string pass[, array args])</em>
<a id='L2400' name='L2400'></a>2400 <em class='comment'>   Creates and exports a PKCS to file */</em>
<a id='L2401' name='L2401'></a>2401 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29754.html' title='Multiple used in 3 places.'>openssl_pkcs12_export_to_file</a>)
<a id='L2402' name='L2402'></a>2402 <em class='brace'>{</em>
<a id='L2403' name='L2403'></a>2403         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2404' name='L2404'></a>2404         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2405' name='L2405'></a>2405         <a href='../Y/5069.html' title='Multiple used in 4 places.'>PKCS12</a> * <a href='../Y/30250.html' title='Multiple used in 12 places.'>p12</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2406' name='L2406'></a>2406         <strong class='reserved'>char</strong> * <a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>;
<a id='L2407' name='L2407'></a>2407         <strong class='reserved'>char</strong> * <a href='../Y/18410.html' title='Multiple used in 6 places.'>friendly_name</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2408' name='L2408'></a>2408         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/17892.html' title='Multiple used in 356 places.'>filename_len</a>;
<a id='L2409' name='L2409'></a>2409         <strong class='reserved'>char</strong> * <a href='../S/279.html#L54' title='Defined at 54 in ext/hash/hash_tiger.c.'>pass</a>;
<a id='L2410' name='L2410'></a>2410         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/31242.html' title='Multiple used in 16 places.'>pass_len</a>;
<a id='L2411' name='L2411'></a>2411         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, *<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, *<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2412' name='L2412'></a>2412         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2413' name='L2413'></a>2413         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>, *<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>;
<a id='L2414' name='L2414'></a>2414         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>;
<a id='L2415' name='L2415'></a>2415         <a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) *<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>ca</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2416' name='L2416'></a>2416 
<a id='L2417' name='L2417'></a>2417         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "zpzs|a", &amp;<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, &amp;<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>, &amp;<a href='../Y/17892.html' title='Multiple used in 356 places.'>filename_len</a>, &amp;<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, &amp;<a href='../S/279.html#L54' title='Defined at 54 in ext/hash/hash_tiger.c.'>pass</a>, &amp;<a href='../Y/31242.html' title='Multiple used in 16 places.'>pass_len</a>, &amp;<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>)
<a id='L2418' name='L2418'></a>2418                 <strong class='reserved'>return</strong>;
<a id='L2419' name='L2419'></a>2419 
<a id='L2420' name='L2420'></a>2420         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L2421' name='L2421'></a>2421 
<a id='L2422' name='L2422'></a>2422         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, 0, &amp;<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>);
<a id='L2423' name='L2423'></a>2423         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2424' name='L2424'></a>2424                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "cannot get cert from parameter 1");
<a id='L2425' name='L2425'></a>2425                 <strong class='reserved'>return</strong>;
<a id='L2426' name='L2426'></a>2426         <em class='brace'>}</em>
<a id='L2427' name='L2427'></a>2427         <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, 0, "", 1, &amp;<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>);
<a id='L2428' name='L2428'></a>2428         <strong class='reserved'>if</strong> (<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2429' name='L2429'></a>2429                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "cannot get private key from parameter 3");
<a id='L2430' name='L2430'></a>2430                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L2431' name='L2431'></a>2431         <em class='brace'>}</em>
<a id='L2432' name='L2432'></a>2432         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> &amp;&amp; !<a href='../Y/7435.html' title='Multiple used in 4 places.'>X509_check_private_key</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>)) <em class='brace'>{</em>
<a id='L2433' name='L2433'></a>2433                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "private key does not correspond to cert");
<a id='L2434' name='L2434'></a>2434                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L2435' name='L2435'></a>2435         <em class='brace'>}</em>
<a id='L2436' name='L2436'></a>2436         <strong class='reserved'>if</strong> (<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>)) <em class='brace'>{</em>
<a id='L2437' name='L2437'></a>2437                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L2438' name='L2438'></a>2438         <em class='brace'>}</em>
<a id='L2439' name='L2439'></a>2439 
<a id='L2440' name='L2440'></a>2440         <em class='comment'>/* parse extra config from args array, promote this to an extra function */</em>
<a id='L2441' name='L2441'></a>2441         <strong class='reserved'>if</strong> (<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a> &amp;&amp; (<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a> = <a href='../S/1667.html#L1987' title='Defined at 1987 in Zend/zend_hash.c.'>zend_hash_str_find</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>), "friendly_name", <strong class='reserved'>sizeof</strong>("friendly_name")-1)) != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>) == <a href='../S/1731.html#L308' title='Defined at 308 in Zend/zend_types.h.'>IS_STRING</a>)
<a id='L2442' name='L2442'></a>2442                 <a href='../Y/18410.html' title='Multiple used in 6 places.'>friendly_name</a> = <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>);
<a id='L2443' name='L2443'></a>2443         <em class='comment'>/* certpbe (default RC2-40)</em>
<a id='L2444' name='L2444'></a>2444 <em class='comment'>           keypbe (default 3DES)</em>
<a id='L2445' name='L2445'></a>2445 <em class='comment'>           friendly_caname</em>
<a id='L2446' name='L2446'></a>2446 <em class='comment'>        */</em>
<a id='L2447' name='L2447'></a>2447 
<a id='L2448' name='L2448'></a>2448         <strong class='reserved'>if</strong> (<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a> &amp;&amp; (<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a> = <a href='../S/1667.html#L1987' title='Defined at 1987 in Zend/zend_hash.c.'>zend_hash_str_find</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>), "extracerts", <strong class='reserved'>sizeof</strong>("extracerts")-1)) != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>)
<a id='L2449' name='L2449'></a>2449                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>ca</a> = <a href='../Y/32020.html' title='Multiple used in 3 places.'>php_array_to_X509_sk</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>);
<a id='L2450' name='L2450'></a>2450         <em class='comment'>/* end parse extra config */</em>
<a id='L2451' name='L2451'></a>2451 
<a id='L2452' name='L2452'></a>2452         <em class='comment'>/*PKCS12 *PKCS12_create(char *pass, char *name, EVP_PKEY *pkey, X509 *cert, STACK_OF(X509) *ca,</em>
<a id='L2453' name='L2453'></a>2453 <em class='comment'>                                int nid_key, int nid_cert, int iter, int mac_iter, int keytype);*/</em>
<a id='L2454' name='L2454'></a>2454 
<a id='L2455' name='L2455'></a>2455         <a href='../Y/30250.html' title='Multiple used in 12 places.'>p12</a> = <a href='../Y/5070.html' title='Multiple used in 2 places.'>PKCS12_create</a>(<a href='../S/279.html#L54' title='Defined at 54 in ext/hash/hash_tiger.c.'>pass</a>, <a href='../Y/18410.html' title='Multiple used in 6 places.'>friendly_name</a>, <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>ca</a>, 0, 0, 0, 0, 0);
<a id='L2456' name='L2456'></a>2456 
<a id='L2457' name='L2457'></a>2457         <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>, "w");
<a id='L2458' name='L2458'></a>2458         <strong class='reserved'>if</strong> (<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>) <em class='brace'>{</em>
<a id='L2459' name='L2459'></a>2459 
<a id='L2460' name='L2460'></a>2460                 <a href='../Y/22046.html' title='Multiple used in 2 places.'>i2d_PKCS12_bio</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../Y/30250.html' title='Multiple used in 12 places.'>p12</a>);
<a id='L2461' name='L2461'></a>2461 
<a id='L2462' name='L2462'></a>2462                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L2463' name='L2463'></a>2463         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2464' name='L2464'></a>2464                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "error opening file %s", <a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>);
<a id='L2465' name='L2465'></a>2465         <em class='brace'>}</em>
<a id='L2466' name='L2466'></a>2466 
<a id='L2467' name='L2467'></a>2467         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>);
<a id='L2468' name='L2468'></a>2468         <a href='../Y/5071.html' title='Multiple used in 3 places.'>PKCS12_free</a>(<a href='../Y/30250.html' title='Multiple used in 12 places.'>p12</a>);
<a id='L2469' name='L2469'></a>2469         <a href='../S/851.html#L2339' title='Defined at 2339 in ext/openssl/openssl.c.'>php_sk_X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>ca</a>);
<a id='L2470' name='L2470'></a>2470 
<a id='L2471' name='L2471'></a>2471 <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>:
<a id='L2472' name='L2472'></a>2472 
<a id='L2473' name='L2473'></a>2473         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>) <em class='brace'>{</em>
<a id='L2474' name='L2474'></a>2474                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>);
<a id='L2475' name='L2475'></a>2475         <em class='brace'>}</em>
<a id='L2476' name='L2476'></a>2476         <strong class='reserved'>if</strong> (<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) <em class='brace'>{</em>
<a id='L2477' name='L2477'></a>2477                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L2478' name='L2478'></a>2478         <em class='brace'>}</em>
<a id='L2479' name='L2479'></a>2479 <em class='brace'>}</em>
<a id='L2480' name='L2480'></a>2480 <em class='comment'>/* }}} */</em>
<a id='L2481' name='L2481'></a>2481 
<a id='L2482' name='L2482'></a>2482 <em class='comment'>/* {{{ proto bool openssl_pkcs12_export(mixed x509, string &amp;out, mixed priv_key, string pass[, array args])</em>
<a id='L2483' name='L2483'></a>2483 <em class='comment'>   Creates and exports a PKCS12 to a var */</em>
<a id='L2484' name='L2484'></a>2484 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29753.html' title='Multiple used in 3 places.'>openssl_pkcs12_export</a>)
<a id='L2485' name='L2485'></a>2485 <em class='brace'>{</em>
<a id='L2486' name='L2486'></a>2486         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2487' name='L2487'></a>2487         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>;
<a id='L2488' name='L2488'></a>2488         <a href='../Y/5069.html' title='Multiple used in 4 places.'>PKCS12</a> * <a href='../Y/30250.html' title='Multiple used in 12 places.'>p12</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2489' name='L2489'></a>2489         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, *<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, *<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, *<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2490' name='L2490'></a>2490         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2491' name='L2491'></a>2491         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>, *<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>;
<a id='L2492' name='L2492'></a>2492         <strong class='reserved'>char</strong> * <a href='../S/279.html#L54' title='Defined at 54 in ext/hash/hash_tiger.c.'>pass</a>;
<a id='L2493' name='L2493'></a>2493         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/31242.html' title='Multiple used in 16 places.'>pass_len</a>;
<a id='L2494' name='L2494'></a>2494         <strong class='reserved'>char</strong> * <a href='../Y/18410.html' title='Multiple used in 6 places.'>friendly_name</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2495' name='L2495'></a>2495         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>;
<a id='L2496' name='L2496'></a>2496         <a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) *<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>ca</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2497' name='L2497'></a>2497 
<a id='L2498' name='L2498'></a>2498         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "zz/zs|a", &amp;<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, &amp;<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>, &amp;<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, &amp;<a href='../S/279.html#L54' title='Defined at 54 in ext/hash/hash_tiger.c.'>pass</a>, &amp;<a href='../Y/31242.html' title='Multiple used in 16 places.'>pass_len</a>, &amp;<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>)
<a id='L2499' name='L2499'></a>2499                 <strong class='reserved'>return</strong>;
<a id='L2500' name='L2500'></a>2500 
<a id='L2501' name='L2501'></a>2501         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L2502' name='L2502'></a>2502 
<a id='L2503' name='L2503'></a>2503         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, 0, &amp;<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>);
<a id='L2504' name='L2504'></a>2504         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2505' name='L2505'></a>2505                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "cannot get cert from parameter 1");
<a id='L2506' name='L2506'></a>2506                 <strong class='reserved'>return</strong>;
<a id='L2507' name='L2507'></a>2507         <em class='brace'>}</em>
<a id='L2508' name='L2508'></a>2508         <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, 0, "", 1, &amp;<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>);
<a id='L2509' name='L2509'></a>2509         <strong class='reserved'>if</strong> (<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2510' name='L2510'></a>2510                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "cannot get private key from parameter 3");
<a id='L2511' name='L2511'></a>2511                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L2512' name='L2512'></a>2512         <em class='brace'>}</em>
<a id='L2513' name='L2513'></a>2513         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> &amp;&amp; !<a href='../Y/7435.html' title='Multiple used in 4 places.'>X509_check_private_key</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>)) <em class='brace'>{</em>
<a id='L2514' name='L2514'></a>2514                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "private key does not correspond to cert");
<a id='L2515' name='L2515'></a>2515                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L2516' name='L2516'></a>2516         <em class='brace'>}</em>
<a id='L2517' name='L2517'></a>2517 
<a id='L2518' name='L2518'></a>2518         <em class='comment'>/* parse extra config from args array, promote this to an extra function */</em>
<a id='L2519' name='L2519'></a>2519         <strong class='reserved'>if</strong> (<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a> &amp;&amp; (<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a> = <a href='../S/1667.html#L1987' title='Defined at 1987 in Zend/zend_hash.c.'>zend_hash_str_find</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>), "friendly_name", <strong class='reserved'>sizeof</strong>("friendly_name")-1)) != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>) == <a href='../S/1731.html#L308' title='Defined at 308 in Zend/zend_types.h.'>IS_STRING</a>)
<a id='L2520' name='L2520'></a>2520                 <a href='../Y/18410.html' title='Multiple used in 6 places.'>friendly_name</a> = <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>);
<a id='L2521' name='L2521'></a>2521 
<a id='L2522' name='L2522'></a>2522         <strong class='reserved'>if</strong> (<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a> &amp;&amp; (<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a> = <a href='../S/1667.html#L1987' title='Defined at 1987 in Zend/zend_hash.c.'>zend_hash_str_find</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>), "extracerts", <strong class='reserved'>sizeof</strong>("extracerts")-1)) != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>)
<a id='L2523' name='L2523'></a>2523                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>ca</a> = <a href='../Y/32020.html' title='Multiple used in 3 places.'>php_array_to_X509_sk</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>);
<a id='L2524' name='L2524'></a>2524         <em class='comment'>/* end parse extra config */</em>
<a id='L2525' name='L2525'></a>2525 
<a id='L2526' name='L2526'></a>2526         <a href='../Y/30250.html' title='Multiple used in 12 places.'>p12</a> = <a href='../Y/5070.html' title='Multiple used in 2 places.'>PKCS12_create</a>(<a href='../S/279.html#L54' title='Defined at 54 in ext/hash/hash_tiger.c.'>pass</a>, <a href='../Y/18410.html' title='Multiple used in 6 places.'>friendly_name</a>, <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>ca</a>, 0, 0, 0, 0, 0);
<a id='L2527' name='L2527'></a>2527 
<a id='L2528' name='L2528'></a>2528         <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../Y/231.html' title='Multiple used in 12 places.'>BIO_new</a>(<a href='../Y/237.html' title='Multiple used in 12 places.'>BIO_s_mem</a>());
<a id='L2529' name='L2529'></a>2529         <strong class='reserved'>if</strong> (<a href='../Y/22046.html' title='Multiple used in 2 places.'>i2d_PKCS12_bio</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../Y/30250.html' title='Multiple used in 12 places.'>p12</a>)) <em class='brace'>{</em>
<a id='L2530' name='L2530'></a>2530                 <a href='../Y/273.html' title='Multiple used in 8 places.'>BUF_MEM</a> *<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>;
<a id='L2531' name='L2531'></a>2531 
<a id='L2532' name='L2532'></a>2532                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>);
<a id='L2533' name='L2533'></a>2533                 <a href='../Y/230.html' title='Multiple used in 9 places.'>BIO_get_mem_ptr</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, &amp;<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>);
<a id='L2534' name='L2534'></a>2534                 <a href='../S/1632.html#L568' title='Defined at 568 in Zend/zend_API.h.'>ZVAL_STRINGL</a>(<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>);
<a id='L2535' name='L2535'></a>2535 
<a id='L2536' name='L2536'></a>2536                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L2537' name='L2537'></a>2537         <em class='brace'>}</em>
<a id='L2538' name='L2538'></a>2538 
<a id='L2539' name='L2539'></a>2539         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>);
<a id='L2540' name='L2540'></a>2540         <a href='../Y/5071.html' title='Multiple used in 3 places.'>PKCS12_free</a>(<a href='../Y/30250.html' title='Multiple used in 12 places.'>p12</a>);
<a id='L2541' name='L2541'></a>2541         <a href='../S/851.html#L2339' title='Defined at 2339 in ext/openssl/openssl.c.'>php_sk_X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>ca</a>);
<a id='L2542' name='L2542'></a>2542 
<a id='L2543' name='L2543'></a>2543 <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>:
<a id='L2544' name='L2544'></a>2544 
<a id='L2545' name='L2545'></a>2545         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>) <em class='brace'>{</em>
<a id='L2546' name='L2546'></a>2546                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>);
<a id='L2547' name='L2547'></a>2547         <em class='brace'>}</em>
<a id='L2548' name='L2548'></a>2548         <strong class='reserved'>if</strong> (<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) <em class='brace'>{</em>
<a id='L2549' name='L2549'></a>2549                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L2550' name='L2550'></a>2550         <em class='brace'>}</em>
<a id='L2551' name='L2551'></a>2551 <em class='brace'>}</em>
<a id='L2552' name='L2552'></a>2552 <em class='comment'>/* }}} */</em>
<a id='L2553' name='L2553'></a>2553 
<a id='L2554' name='L2554'></a>2554 <em class='comment'>/* {{{ proto bool openssl_pkcs12_read(string PKCS12, array &amp;certs, string pass)</em>
<a id='L2555' name='L2555'></a>2555 <em class='comment'>   Parses a PKCS12 to an array */</em>
<a id='L2556' name='L2556'></a>2556 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29755.html' title='Multiple used in 3 places.'>openssl_pkcs12_read</a>)
<a id='L2557' name='L2557'></a>2557 <em class='brace'>{</em>
<a id='L2558' name='L2558'></a>2558         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../Y/43931.html' title='Multiple used in 5 places.'>zextracerts</a>, <a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, <a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>;
<a id='L2559' name='L2559'></a>2559         <strong class='reserved'>char</strong> *<a href='../S/279.html#L54' title='Defined at 54 in ext/hash/hash_tiger.c.'>pass</a>, *<a href='../Y/44070.html' title='Multiple used in 3 places.'>zp12</a>;
<a id='L2560' name='L2560'></a>2560         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/31242.html' title='Multiple used in 16 places.'>pass_len</a>, <a href='../Y/44071.html' title='Multiple used in 4 places.'>zp12_len</a>;
<a id='L2561' name='L2561'></a>2561         <a href='../Y/5069.html' title='Multiple used in 4 places.'>PKCS12</a> * <a href='../Y/30250.html' title='Multiple used in 12 places.'>p12</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2562' name='L2562'></a>2562         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2563' name='L2563'></a>2563         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2564' name='L2564'></a>2564         <a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>ca</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2565' name='L2565'></a>2565         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../Y/12671.html' title='Multiple used in 6 places.'>bio_in</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2566' name='L2566'></a>2566         <strong class='reserved'>int</strong> <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>;
<a id='L2567' name='L2567'></a>2567 
<a id='L2568' name='L2568'></a>2568         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "sz/s", &amp;<a href='../Y/44070.html' title='Multiple used in 3 places.'>zp12</a>, &amp;<a href='../Y/44071.html' title='Multiple used in 4 places.'>zp12_len</a>, &amp;<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>, &amp;<a href='../S/279.html#L54' title='Defined at 54 in ext/hash/hash_tiger.c.'>pass</a>, &amp;<a href='../Y/31242.html' title='Multiple used in 16 places.'>pass_len</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>)
<a id='L2569' name='L2569'></a>2569                 <strong class='reserved'>return</strong>;
<a id='L2570' name='L2570'></a>2570 
<a id='L2571' name='L2571'></a>2571         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L2572' name='L2572'></a>2572 
<a id='L2573' name='L2573'></a>2573         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/44071.html' title='Multiple used in 4 places.'>zp12_len</a>, pkcs12);
<a id='L2574' name='L2574'></a>2574 
<a id='L2575' name='L2575'></a>2575         <a href='../Y/12671.html' title='Multiple used in 6 places.'>bio_in</a> = <a href='../Y/231.html' title='Multiple used in 12 places.'>BIO_new</a>(<a href='../Y/237.html' title='Multiple used in 12 places.'>BIO_s_mem</a>());
<a id='L2576' name='L2576'></a>2576 
<a id='L2577' name='L2577'></a>2577         <strong class='reserved'>if</strong>(0 &gt;= <a href='../Y/238.html' title='Multiple used in 4 places.'>BIO_write</a>(<a href='../Y/12671.html' title='Multiple used in 6 places.'>bio_in</a>, <a href='../Y/44070.html' title='Multiple used in 3 places.'>zp12</a>, (<strong class='reserved'>int</strong>)<a href='../Y/44071.html' title='Multiple used in 4 places.'>zp12_len</a>))
<a id='L2578' name='L2578'></a>2578                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L2579' name='L2579'></a>2579 
<a id='L2580' name='L2580'></a>2580         <strong class='reserved'>if</strong>(d2i_PKCS12_bio(<a href='../Y/12671.html' title='Multiple used in 6 places.'>bio_in</a>, &amp;<a href='../Y/30250.html' title='Multiple used in 12 places.'>p12</a>)) <em class='brace'>{</em>
<a id='L2581' name='L2581'></a>2581                 <strong class='reserved'>if</strong>(PKCS12_parse(<a href='../Y/30250.html' title='Multiple used in 12 places.'>p12</a>, <a href='../S/279.html#L54' title='Defined at 54 in ext/hash/hash_tiger.c.'>pass</a>, &amp;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>, &amp;<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, &amp;<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>ca</a>)) <em class='brace'>{</em>
<a id='L2582' name='L2582'></a>2582                         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>;
<a id='L2583' name='L2583'></a>2583 
<a id='L2584' name='L2584'></a>2584                         <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>);
<a id='L2585' name='L2585'></a>2585                         <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>);
<a id='L2586' name='L2586'></a>2586 
<a id='L2587' name='L2587'></a>2587                         <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../Y/231.html' title='Multiple used in 12 places.'>BIO_new</a>(<a href='../Y/237.html' title='Multiple used in 12 places.'>BIO_s_mem</a>());
<a id='L2588' name='L2588'></a>2588                         <strong class='reserved'>if</strong> (<a href='../Y/4935.html' title='Multiple used in 5 places.'>PEM_write_bio_X509</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>)) <em class='brace'>{</em>
<a id='L2589' name='L2589'></a>2589                                 <a href='../Y/273.html' title='Multiple used in 8 places.'>BUF_MEM</a> *<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>;
<a id='L2590' name='L2590'></a>2590                                 <a href='../Y/230.html' title='Multiple used in 9 places.'>BIO_get_mem_ptr</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, &amp;<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>);
<a id='L2591' name='L2591'></a>2591                                 <a href='../S/1632.html#L568' title='Defined at 568 in Zend/zend_API.h.'>ZVAL_STRINGL</a>(&amp;<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>);
<a id='L2592' name='L2592'></a>2592                                 <a href='../S/1632.html#L408' title='Defined at 408 in Zend/zend_API.h.'>add_assoc_zval</a>(<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>, "cert", &amp;<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>);
<a id='L2593' name='L2593'></a>2593                         <em class='brace'>}</em>
<a id='L2594' name='L2594'></a>2594                         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>);
<a id='L2595' name='L2595'></a>2595 
<a id='L2596' name='L2596'></a>2596                         <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../Y/231.html' title='Multiple used in 12 places.'>BIO_new</a>(<a href='../Y/237.html' title='Multiple used in 12 places.'>BIO_s_mem</a>());
<a id='L2597' name='L2597'></a>2597                         <strong class='reserved'>if</strong> (<a href='../Y/4934.html' title='Multiple used in 3 places.'>PEM_write_bio_PrivateKey</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, 0, 0, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>)) <em class='brace'>{</em>
<a id='L2598' name='L2598'></a>2598                                 <a href='../Y/273.html' title='Multiple used in 8 places.'>BUF_MEM</a> *<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>;
<a id='L2599' name='L2599'></a>2599                                 <a href='../Y/230.html' title='Multiple used in 9 places.'>BIO_get_mem_ptr</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, &amp;<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>);
<a id='L2600' name='L2600'></a>2600                                 <a href='../S/1632.html#L568' title='Defined at 568 in Zend/zend_API.h.'>ZVAL_STRINGL</a>(&amp;<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>);
<a id='L2601' name='L2601'></a>2601                                 <a href='../S/1632.html#L408' title='Defined at 408 in Zend/zend_API.h.'>add_assoc_zval</a>(<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>, "pkey", &amp;<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>);
<a id='L2602' name='L2602'></a>2602                         <em class='brace'>}</em>
<a id='L2603' name='L2603'></a>2603                         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>);
<a id='L2604' name='L2604'></a>2604 
<a id='L2605' name='L2605'></a>2605                         <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(&amp;<a href='../Y/43931.html' title='Multiple used in 5 places.'>zextracerts</a>);
<a id='L2606' name='L2606'></a>2606 
<a id='L2607' name='L2607'></a>2607                         <strong class='reserved'>for</strong> (<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>=0;;<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>++) <em class='brace'>{</em>
<a id='L2608' name='L2608'></a>2608                                 <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> <a href='../Y/43930.html' title='Multiple used in 3 places.'>zextracert</a>;
<a id='L2609' name='L2609'></a>2609                                 <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>* <a href='../Y/8469.html' title='Multiple used in 4 places.'>aCA</a> = <a href='../Y/36273.html' title='Multiple used in 2 places.'>sk_X509_pop</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>ca</a>);
<a id='L2610' name='L2610'></a>2610                                 <strong class='reserved'>if</strong> (!<a href='../Y/8469.html' title='Multiple used in 4 places.'>aCA</a>) <strong class='reserved'>break</strong>;
<a id='L2611' name='L2611'></a>2611 
<a id='L2612' name='L2612'></a>2612                                 <em class='comment'>/* fix for bug 69882 */</em>
<a id='L2613' name='L2613'></a>2613                                 <em class='brace'>{</em>
<a id='L2614' name='L2614'></a>2614                                         <strong class='reserved'>int</strong> <a href='../Y/16980.html' title='Multiple used in 1388 places.'>err</a> = <a href='../Y/1856.html' title='Multiple used in 2 places.'>ERR_peek_error</a>();
<a id='L2615' name='L2615'></a>2615                                         <strong class='reserved'>if</strong> (<a href='../Y/16980.html' title='Multiple used in 1388 places.'>err</a> == <a href='../S/852.html#L35' title='Defined at 35 in ext/openssl/php_openssl.h.'>OPENSSL_ERROR_X509_PRIVATE_KEY_VALUES_MISMATCH</a>) <em class='brace'>{</em>
<a id='L2616' name='L2616'></a>2616                                                 <a href='../Y/1855.html' title='Multiple used in 6 places.'>ERR_get_error</a>();
<a id='L2617' name='L2617'></a>2617                                         <em class='brace'>}</em>
<a id='L2618' name='L2618'></a>2618                                 <em class='brace'>}</em>
<a id='L2619' name='L2619'></a>2619 
<a id='L2620' name='L2620'></a>2620                                 <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../Y/231.html' title='Multiple used in 12 places.'>BIO_new</a>(<a href='../Y/237.html' title='Multiple used in 12 places.'>BIO_s_mem</a>());
<a id='L2621' name='L2621'></a>2621                                 <strong class='reserved'>if</strong> (<a href='../Y/4935.html' title='Multiple used in 5 places.'>PEM_write_bio_X509</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../Y/8469.html' title='Multiple used in 4 places.'>aCA</a>)) <em class='brace'>{</em>
<a id='L2622' name='L2622'></a>2622                                         <a href='../Y/273.html' title='Multiple used in 8 places.'>BUF_MEM</a> *<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>;
<a id='L2623' name='L2623'></a>2623                                         <a href='../Y/230.html' title='Multiple used in 9 places.'>BIO_get_mem_ptr</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, &amp;<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>);
<a id='L2624' name='L2624'></a>2624                                         <a href='../S/1632.html#L568' title='Defined at 568 in Zend/zend_API.h.'>ZVAL_STRINGL</a>(&amp;<a href='../Y/43930.html' title='Multiple used in 3 places.'>zextracert</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>);
<a id='L2625' name='L2625'></a>2625                                         <a href='../S/1631.html#L1487' title='Defined at 1487 in Zend/zend_API.c.'>add_index_zval</a>(&amp;<a href='../Y/43931.html' title='Multiple used in 5 places.'>zextracerts</a>, <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>, &amp;<a href='../Y/43930.html' title='Multiple used in 3 places.'>zextracert</a>);
<a id='L2626' name='L2626'></a>2626 
<a id='L2627' name='L2627'></a>2627                                 <em class='brace'>}</em>
<a id='L2628' name='L2628'></a>2628                                 <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>);
<a id='L2629' name='L2629'></a>2629 
<a id='L2630' name='L2630'></a>2630                                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../Y/8469.html' title='Multiple used in 4 places.'>aCA</a>);
<a id='L2631' name='L2631'></a>2631                         <em class='brace'>}</em>
<a id='L2632' name='L2632'></a>2632                         <strong class='reserved'>if</strong>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>ca</a>) <em class='brace'>{</em>
<a id='L2633' name='L2633'></a>2633                                 <a href='../Y/36270.html' title='Multiple used in 8 places.'>sk_X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>ca</a>);
<a id='L2634' name='L2634'></a>2634                                 <a href='../S/1632.html#L408' title='Defined at 408 in Zend/zend_API.h.'>add_assoc_zval</a>(<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>, "extracerts", &amp;<a href='../Y/43931.html' title='Multiple used in 5 places.'>zextracerts</a>);
<a id='L2635' name='L2635'></a>2635                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2636' name='L2636'></a>2636                                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(&amp;<a href='../Y/43931.html' title='Multiple used in 5 places.'>zextracerts</a>);
<a id='L2637' name='L2637'></a>2637                         <em class='brace'>}</em>
<a id='L2638' name='L2638'></a>2638 
<a id='L2639' name='L2639'></a>2639                         <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L2640' name='L2640'></a>2640 
<a id='L2641' name='L2641'></a>2641                         <a href='../Y/5071.html' title='Multiple used in 3 places.'>PKCS12_free</a>(<a href='../Y/30250.html' title='Multiple used in 12 places.'>p12</a>);
<a id='L2642' name='L2642'></a>2642                 <em class='brace'>}</em>
<a id='L2643' name='L2643'></a>2643         <em class='brace'>}</em>
<a id='L2644' name='L2644'></a>2644 
<a id='L2645' name='L2645'></a>2645         <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>:
<a id='L2646' name='L2646'></a>2646         <strong class='reserved'>if</strong> (<a href='../Y/12671.html' title='Multiple used in 6 places.'>bio_in</a>) <em class='brace'>{</em>
<a id='L2647' name='L2647'></a>2647                 <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/12671.html' title='Multiple used in 6 places.'>bio_in</a>);
<a id='L2648' name='L2648'></a>2648         <em class='brace'>}</em>
<a id='L2649' name='L2649'></a>2649         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>) <em class='brace'>{</em>
<a id='L2650' name='L2650'></a>2650                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L2651' name='L2651'></a>2651         <em class='brace'>}</em>
<a id='L2652' name='L2652'></a>2652         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) <em class='brace'>{</em>
<a id='L2653' name='L2653'></a>2653                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L2654' name='L2654'></a>2654         <em class='brace'>}</em>
<a id='L2655' name='L2655'></a>2655 <em class='brace'>}</em>
<a id='L2656' name='L2656'></a>2656 <em class='comment'>/* }}} */</em>
<a id='L2657' name='L2657'></a>2657 
<a id='L2658' name='L2658'></a>2658 <em class='comment'>/* {{{ x509 CSR functions */</em>
<a id='L2659' name='L2659'></a>2659 
<a id='L2660' name='L2660'></a>2660 <em class='comment'>/* {{{ php_openssl_make_REQ */</em>
<a id='L2661' name='L2661'></a>2661 <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../S/851.html#L3111' title='Referred from 3111 in ext/openssl/openssl.c.'>php_openssl_make_REQ</a>(<strong class='reserved'>struct</strong> <a href='../S/851.html#L618' title='Defined at 618 in ext/openssl/openssl.c.'>php_x509_request</a> * <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>, <a href='../Y/7405.html' title='Multiple used in 12 places.'>X509_REQ</a> * <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>, <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/15850.html' title='Multiple used in 52 places.'>dn</a>, <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/12107.html' title='Multiple used in 26 places.'>attribs</a>)
<a id='L2662' name='L2662'></a>2662 <em class='brace'>{</em>
<a id='L2663' name='L2663'></a>2663         <a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/554.html' title='Multiple used in 7 places.'>CONF_VALUE</a>) * <a href='../Y/15854.html' title='Multiple used in 5 places.'>dn_sk</a>, *<a href='../Y/12104.html' title='Multiple used in 6 places.'>attr_sk</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2664' name='L2664'></a>2664         <strong class='reserved'>char</strong> * <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>, *<a href='../Y/15853.html' title='Multiple used in 4 places.'>dn_sect</a>, *<a href='../Y/12102.html' title='Multiple used in 4 places.'>attr_sect</a>;
<a id='L2665' name='L2665'></a>2665 
<a id='L2666' name='L2666'></a>2666         <a href='../Y/15853.html' title='Multiple used in 4 places.'>dn_sect</a> = <a href='../Y/558.html' title='Multiple used in 12 places.'>CONF_get_string</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/35586.html' title='Multiple used in 13 places.'>section_name</a>, "distinguished_name");
<a id='L2667' name='L2667'></a>2667         <strong class='reserved'>if</strong> (<a href='../Y/15853.html' title='Multiple used in 4 places.'>dn_sect</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2668' name='L2668'></a>2668                 <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L2669' name='L2669'></a>2669         <em class='brace'>}</em>
<a id='L2670' name='L2670'></a>2670         <a href='../Y/15854.html' title='Multiple used in 5 places.'>dn_sk</a> = <a href='../Y/557.html' title='Multiple used in 3 places.'>CONF_get_section</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../Y/15853.html' title='Multiple used in 4 places.'>dn_sect</a>);
<a id='L2671' name='L2671'></a>2671         <strong class='reserved'>if</strong> (<a href='../Y/15854.html' title='Multiple used in 5 places.'>dn_sk</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2672' name='L2672'></a>2672                 <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L2673' name='L2673'></a>2673         <em class='brace'>}</em>
<a id='L2674' name='L2674'></a>2674         <a href='../Y/12102.html' title='Multiple used in 4 places.'>attr_sect</a> = <a href='../Y/558.html' title='Multiple used in 12 places.'>CONF_get_string</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/35586.html' title='Multiple used in 13 places.'>section_name</a>, "attributes");
<a id='L2675' name='L2675'></a>2675         <strong class='reserved'>if</strong> (<a href='../Y/12102.html' title='Multiple used in 4 places.'>attr_sect</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2676' name='L2676'></a>2676                 <a href='../Y/12104.html' title='Multiple used in 6 places.'>attr_sk</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2677' name='L2677'></a>2677         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2678' name='L2678'></a>2678                 <a href='../Y/12104.html' title='Multiple used in 6 places.'>attr_sk</a> = <a href='../Y/557.html' title='Multiple used in 3 places.'>CONF_get_section</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../Y/12102.html' title='Multiple used in 4 places.'>attr_sect</a>);
<a id='L2679' name='L2679'></a>2679                 <strong class='reserved'>if</strong> (<a href='../Y/12104.html' title='Multiple used in 6 places.'>attr_sk</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2680' name='L2680'></a>2680                         <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L2681' name='L2681'></a>2681                 <em class='brace'>}</em>
<a id='L2682' name='L2682'></a>2682         <em class='brace'>}</em>
<a id='L2683' name='L2683'></a>2683         <em class='comment'>/* setup the version number: version 1 */</em>
<a id='L2684' name='L2684'></a>2684         <strong class='reserved'>if</strong> (X509_REQ_set_version(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>, 0L)) <em class='brace'>{</em>
<a id='L2685' name='L2685'></a>2685                 <strong class='reserved'>int</strong> <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>, <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>;
<a id='L2686' name='L2686'></a>2686                 <strong class='reserved'>char</strong> * <a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>;
<a id='L2687' name='L2687'></a>2687                 <a href='../Y/554.html' title='Multiple used in 7 places.'>CONF_VALUE</a> * <a href='../Y/40018.html' title='Multiple used in 3085 places.'>v</a>;
<a id='L2688' name='L2688'></a>2688                 <a href='../S/853.html#L50' title='Defined at 50 in ext/openssl/xp_ssl.c.'>X509_NAME</a> * <a href='../Y/37813.html' title='Multiple used in 7 places.'>subj</a>;
<a id='L2689' name='L2689'></a>2689                 <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>;
<a id='L2690' name='L2690'></a>2690                 <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> * <a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2691' name='L2691'></a>2691 
<a id='L2692' name='L2692'></a>2692                 <a href='../Y/37813.html' title='Multiple used in 7 places.'>subj</a> = <a href='../Y/7410.html' title='Multiple used in 3 places.'>X509_REQ_get_subject_name</a>(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>);
<a id='L2693' name='L2693'></a>2693                 <em class='comment'>/* apply values from the dn hash */</em>
<a id='L2694' name='L2694'></a>2694                 <a href='../S/1668.html#L804' title='Defined at 804 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_STR_KEY_VAL</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/15850.html' title='Multiple used in 52 places.'>dn</a>), <a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>, <a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>) <em class='brace'>{</em>
<a id='L2695' name='L2695'></a>2695                         <strong class='reserved'>if</strong> (<a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>) <em class='brace'>{</em>
<a id='L2696' name='L2696'></a>2696                                 <strong class='reserved'>int</strong> <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>;
<a id='L2697' name='L2697'></a>2697 
<a id='L2698' name='L2698'></a>2698                                 <a href='../S/1707.html#L410' title='Defined at 410 in Zend/zend_operators.h.'>convert_to_string_ex</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>);
<a id='L2699' name='L2699'></a>2699 
<a id='L2700' name='L2700'></a>2700                                 <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a> = <a href='../Y/4355.html' title='Multiple used in 4 places.'>OBJ_txt2nid</a>(<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>));
<a id='L2701' name='L2701'></a>2701                                 <strong class='reserved'>if</strong> (<a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a> != <a href='../Y/4236.html' title='Multiple used in 6 places.'>NID_undef</a>) <em class='brace'>{</em>
<a id='L2702' name='L2702'></a>2702                                         <strong class='reserved'>if</strong> (!<a href='../Y/7385.html' title='Multiple used in 2 places.'>X509_NAME_add_entry_by_NID</a>(<a href='../Y/37813.html' title='Multiple used in 7 places.'>subj</a>, <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>, <a href='../Y/4014.html' title='Multiple used in 4 places.'>MBSTRING_UTF8</a>,
<a id='L2703' name='L2703'></a>2703                                                                 (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>), -1, -1, 0))
<a id='L2704' name='L2704'></a>2704                                         <em class='brace'>{</em>
<a id='L2705' name='L2705'></a>2705                                                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>,
<a id='L2706' name='L2706'></a>2706                                                         "dn: add_entry_by_NID %d -&gt; %s (failed; check error"
<a id='L2707' name='L2707'></a>2707                                                         " queue and value of string_mask OpenSSL option "
<a id='L2708' name='L2708'></a>2708                                                         "if illegal characters are reported)",
<a id='L2709' name='L2709'></a>2709                                                         <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>, <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>));
<a id='L2710' name='L2710'></a>2710                                                 <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L2711' name='L2711'></a>2711                                         <em class='brace'>}</em>
<a id='L2712' name='L2712'></a>2712                                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2713' name='L2713'></a>2713                                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "dn: %s is not a recognized name", <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>));
<a id='L2714' name='L2714'></a>2714                                 <em class='brace'>}</em>
<a id='L2715' name='L2715'></a>2715                         <em class='brace'>}</em>
<a id='L2716' name='L2716'></a>2716                 <em class='brace'>}</em> <a href='../S/1668.html#L766' title='Defined at 766 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_END</a>();
<a id='L2717' name='L2717'></a>2717 
<a id='L2718' name='L2718'></a>2718                 <em class='comment'>/* Finally apply defaults from config file */</em>
<a id='L2719' name='L2719'></a>2719                 <strong class='reserved'>for</strong>(<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> = 0; <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> &lt; <a href='../Y/36262.html' title='Multiple used in 3 places.'>sk_CONF_VALUE_num</a>(<a href='../Y/15854.html' title='Multiple used in 5 places.'>dn_sk</a>); <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>++) <em class='brace'>{</em>
<a id='L2720' name='L2720'></a>2720                         <strong class='reserved'>int</strong> <a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a>;
<a id='L2721' name='L2721'></a>2721                         <strong class='reserved'>char</strong> <a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>[200 + 1]; <em class='comment'>/*200 + \0 !*/</em>
<a id='L2722' name='L2722'></a>2722 
<a id='L2723' name='L2723'></a>2723                         <a href='../Y/40018.html' title='Multiple used in 3085 places.'>v</a> = <a href='../Y/36263.html' title='Multiple used in 3 places.'>sk_CONF_VALUE_value</a>(<a href='../Y/15854.html' title='Multiple used in 5 places.'>dn_sk</a>, <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>);
<a id='L2724' name='L2724'></a>2724                         <a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a> = <a href='../Y/40018.html' title='Multiple used in 3085 places.'>v</a>-&gt;<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>;
<a id='L2725' name='L2725'></a>2725 
<a id='L2726' name='L2726'></a>2726                         <a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a> = (<strong class='reserved'>int</strong>)<a href='../S/868.html#L369' title='Defined at 369 in ext/pcre/pcrelib/pcre_internal.h.'>strlen</a>(<a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>);
<a id='L2727' name='L2727'></a>2727                         <strong class='reserved'>if</strong> (<a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a> &lt; <strong class='reserved'>sizeof</strong>("_default")) <em class='brace'>{</em>
<a id='L2728' name='L2728'></a>2728                                 <strong class='reserved'>continue</strong>;
<a id='L2729' name='L2729'></a>2729                         <em class='brace'>}</em>
<a id='L2730' name='L2730'></a>2730                         <a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a> -= <strong class='reserved'>sizeof</strong>("_default") - 1;
<a id='L2731' name='L2731'></a>2731                         <strong class='reserved'>if</strong> (<a href='../Y/37561.html' title='Multiple used in 563 places.'>strcmp</a>("_default", <a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a> + <a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a>) != 0) <em class='brace'>{</em>
<a id='L2732' name='L2732'></a>2732                                 <strong class='reserved'>continue</strong>;
<a id='L2733' name='L2733'></a>2733                         <em class='brace'>}</em>
<a id='L2734' name='L2734'></a>2734                         <strong class='reserved'>if</strong> (<a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a> &gt; 200) <em class='brace'>{</em>
<a id='L2735' name='L2735'></a>2735                                 <a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a> = 200;
<a id='L2736' name='L2736'></a>2736                         <em class='brace'>}</em>
<a id='L2737' name='L2737'></a>2737                         <a href='../D/24499.html' title='Multiple defined in 4 places.'>memcpy</a>(<a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>, <a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>, <a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a>);
<a id='L2738' name='L2738'></a>2738                         <a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>[<a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a>] = '\0';
<a id='L2739' name='L2739'></a>2739                         <a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a> = <a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>;
<a id='L2740' name='L2740'></a>2740 
<a id='L2741' name='L2741'></a>2741                         <em class='comment'>/* Skip past any leading X. X: X, etc to allow for multiple</em>
<a id='L2742' name='L2742'></a>2742 <em class='comment'>                         * instances */</em>
<a id='L2743' name='L2743'></a>2743                         <strong class='reserved'>for</strong> (<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> = <a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>; *<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>; <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>++) <em class='brace'>{</em>
<a id='L2744' name='L2744'></a>2744                                 <strong class='reserved'>if</strong> (*<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> == ':' || *<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> == ',' || *<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> == '.') <em class='brace'>{</em>
<a id='L2745' name='L2745'></a>2745                                         <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>++;
<a id='L2746' name='L2746'></a>2746                                         <strong class='reserved'>if</strong> (*<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>) <em class='brace'>{</em>
<a id='L2747' name='L2747'></a>2747                                                 <a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a> = <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>;
<a id='L2748' name='L2748'></a>2748                                         <em class='brace'>}</em>
<a id='L2749' name='L2749'></a>2749                                         <strong class='reserved'>break</strong>;
<a id='L2750' name='L2750'></a>2750                                 <em class='brace'>}</em>
<a id='L2751' name='L2751'></a>2751                         <em class='brace'>}</em>
<a id='L2752' name='L2752'></a>2752                         <em class='comment'>/* if it is already set, skip this */</em>
<a id='L2753' name='L2753'></a>2753                         <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a> = <a href='../Y/4355.html' title='Multiple used in 4 places.'>OBJ_txt2nid</a>(<a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>);
<a id='L2754' name='L2754'></a>2754                         <strong class='reserved'>if</strong> (<a href='../Y/7389.html' title='Multiple used in 2 places.'>X509_NAME_get_index_by_NID</a>(<a href='../Y/37813.html' title='Multiple used in 7 places.'>subj</a>, <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>, -1) &gt;= 0) <em class='brace'>{</em>
<a id='L2755' name='L2755'></a>2755                                 <strong class='reserved'>continue</strong>;
<a id='L2756' name='L2756'></a>2756                         <em class='brace'>}</em>
<a id='L2757' name='L2757'></a>2757                         <strong class='reserved'>if</strong> (!X509_NAME_add_entry_by_txt(<a href='../Y/37813.html' title='Multiple used in 7 places.'>subj</a>, <a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>, <a href='../Y/4014.html' title='Multiple used in 4 places.'>MBSTRING_UTF8</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../Y/40018.html' title='Multiple used in 3085 places.'>v</a>-&gt;<a href='../D/32633.html' title='Multiple defined in 3 places.'>value</a>, -1, -1, 0)) <em class='brace'>{</em>
<a id='L2758' name='L2758'></a>2758                                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "add_entry_by_txt %s -&gt; %s (failed)", <a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>, <a href='../Y/40018.html' title='Multiple used in 3085 places.'>v</a>-&gt;<a href='../D/32633.html' title='Multiple defined in 3 places.'>value</a>);
<a id='L2759' name='L2759'></a>2759                                 <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L2760' name='L2760'></a>2760                         <em class='brace'>}</em>
<a id='L2761' name='L2761'></a>2761                         <strong class='reserved'>if</strong> (!<a href='../Y/7387.html' title='Multiple used in 2 places.'>X509_NAME_entry_count</a>(<a href='../Y/37813.html' title='Multiple used in 7 places.'>subj</a>)) <em class='brace'>{</em>
<a id='L2762' name='L2762'></a>2762                                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "no objects specified in config file");
<a id='L2763' name='L2763'></a>2763                                 <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L2764' name='L2764'></a>2764                         <em class='brace'>}</em>
<a id='L2765' name='L2765'></a>2765                 <em class='brace'>}</em>
<a id='L2766' name='L2766'></a>2766                 <strong class='reserved'>if</strong> (<a href='../Y/12107.html' title='Multiple used in 26 places.'>attribs</a>) <em class='brace'>{</em>
<a id='L2767' name='L2767'></a>2767                         <a href='../S/1668.html#L804' title='Defined at 804 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_STR_KEY_VAL</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/12107.html' title='Multiple used in 26 places.'>attribs</a>), <a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>, <a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>) <em class='brace'>{</em>
<a id='L2768' name='L2768'></a>2768                                 <strong class='reserved'>int</strong> <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>;
<a id='L2769' name='L2769'></a>2769 
<a id='L2770' name='L2770'></a>2770                                 <a href='../S/1707.html#L410' title='Defined at 410 in Zend/zend_operators.h.'>convert_to_string_ex</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>);
<a id='L2771' name='L2771'></a>2771 
<a id='L2772' name='L2772'></a>2772                                 <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a> = <a href='../Y/4355.html' title='Multiple used in 4 places.'>OBJ_txt2nid</a>(<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>));
<a id='L2773' name='L2773'></a>2773                                 <strong class='reserved'>if</strong> (<a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a> != <a href='../Y/4236.html' title='Multiple used in 6 places.'>NID_undef</a>) <em class='brace'>{</em>
<a id='L2774' name='L2774'></a>2774                                         <strong class='reserved'>if</strong> (!<a href='../Y/7385.html' title='Multiple used in 2 places.'>X509_NAME_add_entry_by_NID</a>(<a href='../Y/37813.html' title='Multiple used in 7 places.'>subj</a>, <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>, <a href='../Y/4014.html' title='Multiple used in 4 places.'>MBSTRING_UTF8</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>), -1, -1, 0)) <em class='brace'>{</em>
<a id='L2775' name='L2775'></a>2775                                                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "attribs: add_entry_by_NID %d -&gt; %s (failed)", <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>, <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/24203.html' title='Multiple used in 141 places.'>item</a>));
<a id='L2776' name='L2776'></a>2776                                                 <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L2777' name='L2777'></a>2777                                         <em class='brace'>}</em>
<a id='L2778' name='L2778'></a>2778                                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2779' name='L2779'></a>2779                                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "dn: %s is not a recognized name", <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>));
<a id='L2780' name='L2780'></a>2780                                 <em class='brace'>}</em>
<a id='L2781' name='L2781'></a>2781                         <em class='brace'>}</em> <a href='../S/1668.html#L766' title='Defined at 766 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_END</a>();
<a id='L2782' name='L2782'></a>2782                         <strong class='reserved'>for</strong> (<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> = 0; <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> &lt; <a href='../Y/36262.html' title='Multiple used in 3 places.'>sk_CONF_VALUE_num</a>(<a href='../Y/12104.html' title='Multiple used in 6 places.'>attr_sk</a>); <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>++) <em class='brace'>{</em>
<a id='L2783' name='L2783'></a>2783                                 <a href='../Y/40018.html' title='Multiple used in 3085 places.'>v</a> = <a href='../Y/36263.html' title='Multiple used in 3 places.'>sk_CONF_VALUE_value</a>(<a href='../Y/12104.html' title='Multiple used in 6 places.'>attr_sk</a>, <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>);
<a id='L2784' name='L2784'></a>2784                                 <em class='comment'>/* if it is already set, skip this */</em>
<a id='L2785' name='L2785'></a>2785                                 <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a> = <a href='../Y/4355.html' title='Multiple used in 4 places.'>OBJ_txt2nid</a>(<a href='../Y/40018.html' title='Multiple used in 3085 places.'>v</a>-&gt;<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>);
<a id='L2786' name='L2786'></a>2786                                 <strong class='reserved'>if</strong> (X509_REQ_get_attr_by_NID(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>, <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>, -1) &gt;= 0) <em class='brace'>{</em>
<a id='L2787' name='L2787'></a>2787                                         <strong class='reserved'>continue</strong>;
<a id='L2788' name='L2788'></a>2788                                 <em class='brace'>}</em>
<a id='L2789' name='L2789'></a>2789                                 <strong class='reserved'>if</strong> (!X509_REQ_add1_attr_by_txt(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>, <a href='../Y/40018.html' title='Multiple used in 3085 places.'>v</a>-&gt;<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>, <a href='../Y/4014.html' title='Multiple used in 4 places.'>MBSTRING_UTF8</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../Y/40018.html' title='Multiple used in 3085 places.'>v</a>-&gt;<a href='../D/32633.html' title='Multiple defined in 3 places.'>value</a>, -1)) <em class='brace'>{</em>
<a id='L2790' name='L2790'></a>2790                                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>,
<a id='L2791' name='L2791'></a>2791                                                 "add1_attr_by_txt %s -&gt; %s (failed; check error queue "
<a id='L2792' name='L2792'></a>2792                                                 "and value of string_mask OpenSSL option if illegal "
<a id='L2793' name='L2793'></a>2793                                                 "characters are reported)",
<a id='L2794' name='L2794'></a>2794                                                 <a href='../Y/40018.html' title='Multiple used in 3085 places.'>v</a>-&gt;<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>, <a href='../Y/40018.html' title='Multiple used in 3085 places.'>v</a>-&gt;<a href='../D/32633.html' title='Multiple defined in 3 places.'>value</a>);
<a id='L2795' name='L2795'></a>2795                                         <strong class='reserved'>return</strong> <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>;
<a id='L2796' name='L2796'></a>2796                                 <em class='brace'>}</em>
<a id='L2797' name='L2797'></a>2797                         <em class='brace'>}</em>
<a id='L2798' name='L2798'></a>2798                 <em class='brace'>}</em>
<a id='L2799' name='L2799'></a>2799         <em class='brace'>}</em>
<a id='L2800' name='L2800'></a>2800 
<a id='L2801' name='L2801'></a>2801         X509_REQ_set_pubkey(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>);
<a id='L2802' name='L2802'></a>2802         <strong class='reserved'>return</strong> <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>;
<a id='L2803' name='L2803'></a>2803 <em class='brace'>}</em>
<a id='L2804' name='L2804'></a>2804 <em class='comment'>/* }}} */</em>
<a id='L2805' name='L2805'></a>2805 
<a id='L2806' name='L2806'></a>2806 <em class='comment'>/* {{{ php_openssl_csr_from_zval */</em>
<a id='L2807' name='L2807'></a>2807 <strong class='reserved'>static</strong> <a href='../Y/7405.html' title='Multiple used in 12 places.'>X509_REQ</a> * <a href='../R/24296.html' title='Multiple referred from 6 places.'>php_openssl_csr_from_zval</a>(<a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>, <strong class='reserved'>int</strong> <a href='../Y/25757.html' title='Multiple used in 8 places.'>makeresource</a>, <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> **<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a>)
<a id='L2808' name='L2808'></a>2808 <em class='brace'>{</em>
<a id='L2809' name='L2809'></a>2809         <a href='../Y/7405.html' title='Multiple used in 12 places.'>X509_REQ</a> * <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2810' name='L2810'></a>2810         <strong class='reserved'>char</strong> * <a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2811' name='L2811'></a>2811         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>;
<a id='L2812' name='L2812'></a>2812 
<a id='L2813' name='L2813'></a>2813         <strong class='reserved'>if</strong> (<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a>) <em class='brace'>{</em>
<a id='L2814' name='L2814'></a>2814                 *<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2815' name='L2815'></a>2815         <em class='brace'>}</em>
<a id='L2816' name='L2816'></a>2816         <strong class='reserved'>if</strong> (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) == <a href='../S/1731.html#L311' title='Defined at 311 in Zend/zend_types.h.'>IS_RESOURCE</a>) <em class='brace'>{</em>
<a id='L2817' name='L2817'></a>2817                 <strong class='reserved'>void</strong> * <a href='../Y/40693.html' title='Multiple used in 151 places.'>what</a>;
<a id='L2818' name='L2818'></a>2818                 <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a> = <a href='../S/1731.html#L552' title='Defined at 552 in Zend/zend_types.h.'>Z_RES_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>);
<a id='L2819' name='L2819'></a>2819 
<a id='L2820' name='L2820'></a>2820                 <a href='../Y/40693.html' title='Multiple used in 151 places.'>what</a> = <a href='../S/1690.html#L124' title='Defined at 124 in Zend/zend_list.c.'>zend_fetch_resource</a>(<a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>, "OpenSSL X.509 CSR", <a href='../Y/24875.html' title='Multiple used in 4 places.'>le_csr</a>);
<a id='L2821' name='L2821'></a>2821                 <strong class='reserved'>if</strong> (<a href='../Y/40693.html' title='Multiple used in 151 places.'>what</a>) <em class='brace'>{</em>
<a id='L2822' name='L2822'></a>2822                         <strong class='reserved'>if</strong> (<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a>) <em class='brace'>{</em>
<a id='L2823' name='L2823'></a>2823                                 *<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a> = <a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>;
<a id='L2824' name='L2824'></a>2824                                 <a href='../D/17793.html' title='Multiple defined in 3 places.'>Z_ADDREF_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>);
<a id='L2825' name='L2825'></a>2825                         <em class='brace'>}</em>
<a id='L2826' name='L2826'></a>2826                         <strong class='reserved'>return</strong> (<a href='../Y/7405.html' title='Multiple used in 12 places.'>X509_REQ</a>*)<a href='../Y/40693.html' title='Multiple used in 151 places.'>what</a>;
<a id='L2827' name='L2827'></a>2827                 <em class='brace'>}</em>
<a id='L2828' name='L2828'></a>2828                 <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2829' name='L2829'></a>2829         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong> (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) != <a href='../S/1731.html#L308' title='Defined at 308 in Zend/zend_types.h.'>IS_STRING</a>) <em class='brace'>{</em>
<a id='L2830' name='L2830'></a>2830                 <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2831' name='L2831'></a>2831         <em class='brace'>}</em>
<a id='L2832' name='L2832'></a>2832 
<a id='L2833' name='L2833'></a>2833         <strong class='reserved'>if</strong> (<a href='../S/1731.html#L519' title='Defined at 519 in Zend/zend_types.h.'>Z_STRLEN_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) &gt; 7 &amp;&amp; <a href='../S/868.html#L371' title='Defined at 371 in ext/pcre/pcrelib/pcre_internal.h.'>memcmp</a>(<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>), "file://", <strong class='reserved'>sizeof</strong>("file://") - 1) == 0) <em class='brace'>{</em>
<a id='L2834' name='L2834'></a>2834                 <a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a> = <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) + (<strong class='reserved'>sizeof</strong>("file://") - 1);
<a id='L2835' name='L2835'></a>2835         <em class='brace'>}</em>
<a id='L2836' name='L2836'></a>2836         <strong class='reserved'>if</strong> (<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>) <em class='brace'>{</em>
<a id='L2837' name='L2837'></a>2837                 <strong class='reserved'>if</strong> (<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>)) <em class='brace'>{</em>
<a id='L2838' name='L2838'></a>2838                         <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2839' name='L2839'></a>2839                 <em class='brace'>}</em>
<a id='L2840' name='L2840'></a>2840                 <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>, "r");
<a id='L2841' name='L2841'></a>2841         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2842' name='L2842'></a>2842                 <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> = <a href='../Y/233.html' title='Multiple used in 8 places.'>BIO_new_mem_buf</a>(<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>), (<strong class='reserved'>int</strong>)<a href='../S/1731.html#L519' title='Defined at 519 in Zend/zend_types.h.'>Z_STRLEN_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>));
<a id='L2843' name='L2843'></a>2843         <em class='brace'>}</em>
<a id='L2844' name='L2844'></a>2844         <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> = PEM_read_bio_X509_REQ(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>,<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>,<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L2845' name='L2845'></a>2845         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>);
<a id='L2846' name='L2846'></a>2846 
<a id='L2847' name='L2847'></a>2847         <strong class='reserved'>return</strong> <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>;
<a id='L2848' name='L2848'></a>2848 <em class='brace'>}</em>
<a id='L2849' name='L2849'></a>2849 <em class='comment'>/* }}} */</em>
<a id='L2850' name='L2850'></a>2850 
<a id='L2851' name='L2851'></a>2851 <em class='comment'>/* {{{ proto bool openssl_csr_export_to_file(resource csr, string outfilename [, bool notext=true])</em>
<a id='L2852' name='L2852'></a>2852 <em class='comment'>   Exports a CSR to file */</em>
<a id='L2853' name='L2853'></a>2853 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29733.html' title='Multiple used in 3 places.'>openssl_csr_export_to_file</a>)
<a id='L2854' name='L2854'></a>2854 <em class='brace'>{</em>
<a id='L2855' name='L2855'></a>2855         <a href='../Y/7405.html' title='Multiple used in 12 places.'>X509_REQ</a> * <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>;
<a id='L2856' name='L2856'></a>2856         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2857' name='L2857'></a>2857         <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a> = 1;
<a id='L2858' name='L2858'></a>2858         <strong class='reserved'>char</strong> * <a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2859' name='L2859'></a>2859         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/17892.html' title='Multiple used in 356 places.'>filename_len</a>;
<a id='L2860' name='L2860'></a>2860         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>;
<a id='L2861' name='L2861'></a>2861         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/14658.html' title='Multiple used in 13 places.'>csr_resource</a>;
<a id='L2862' name='L2862'></a>2862 
<a id='L2863' name='L2863'></a>2863         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "rp|b", &amp;<a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a>, &amp;<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>, &amp;<a href='../Y/17892.html' title='Multiple used in 356 places.'>filename_len</a>, &amp;<a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L2864' name='L2864'></a>2864                 <strong class='reserved'>return</strong>;
<a id='L2865' name='L2865'></a>2865         <em class='brace'>}</em>
<a id='L2866' name='L2866'></a>2866         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L2867' name='L2867'></a>2867 
<a id='L2868' name='L2868'></a>2868         <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> = <a href='../S/851.html#L2807' title='Defined at 2807 in ext/openssl/openssl.c.'>php_openssl_csr_from_zval</a>(<a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a>, 0, &amp;<a href='../Y/14658.html' title='Multiple used in 13 places.'>csr_resource</a>);
<a id='L2869' name='L2869'></a>2869         <strong class='reserved'>if</strong> (<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2870' name='L2870'></a>2870                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "cannot get CSR from parameter 1");
<a id='L2871' name='L2871'></a>2871                 <strong class='reserved'>return</strong>;
<a id='L2872' name='L2872'></a>2872         <em class='brace'>}</em>
<a id='L2873' name='L2873'></a>2873 
<a id='L2874' name='L2874'></a>2874         <strong class='reserved'>if</strong> (<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>)) <em class='brace'>{</em>
<a id='L2875' name='L2875'></a>2875                 <strong class='reserved'>return</strong>;
<a id='L2876' name='L2876'></a>2876         <em class='brace'>}</em>
<a id='L2877' name='L2877'></a>2877 
<a id='L2878' name='L2878'></a>2878         <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>, "w");
<a id='L2879' name='L2879'></a>2879         <strong class='reserved'>if</strong> (<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>) <em class='brace'>{</em>
<a id='L2880' name='L2880'></a>2880                 <strong class='reserved'>if</strong> (!<a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a>) <em class='brace'>{</em>
<a id='L2881' name='L2881'></a>2881                         <a href='../Y/7412.html' title='Multiple used in 2 places.'>X509_REQ_print</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>);
<a id='L2882' name='L2882'></a>2882                 <em class='brace'>}</em>
<a id='L2883' name='L2883'></a>2883                 <a href='../Y/4936.html' title='Multiple used in 2 places.'>PEM_write_bio_X509_REQ</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>);
<a id='L2884' name='L2884'></a>2884                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L2885' name='L2885'></a>2885         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L2886' name='L2886'></a>2886                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "error opening file %s", <a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>);
<a id='L2887' name='L2887'></a>2887         <em class='brace'>}</em>
<a id='L2888' name='L2888'></a>2888 
<a id='L2889' name='L2889'></a>2889         <strong class='reserved'>if</strong> (<a href='../Y/14658.html' title='Multiple used in 13 places.'>csr_resource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>) <em class='brace'>{</em>
<a id='L2890' name='L2890'></a>2890                 <a href='../Y/7407.html' title='Multiple used in 5 places.'>X509_REQ_free</a>(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>);
<a id='L2891' name='L2891'></a>2891         <em class='brace'>}</em>
<a id='L2892' name='L2892'></a>2892         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>);
<a id='L2893' name='L2893'></a>2893 <em class='brace'>}</em>
<a id='L2894' name='L2894'></a>2894 <em class='comment'>/* }}} */</em>
<a id='L2895' name='L2895'></a>2895 
<a id='L2896' name='L2896'></a>2896 <em class='comment'>/* {{{ proto bool openssl_csr_export(resource csr, string &amp;out [, bool notext=true])</em>
<a id='L2897' name='L2897'></a>2897 <em class='comment'>   Exports a CSR to file or a var */</em>
<a id='L2898' name='L2898'></a>2898 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29732.html' title='Multiple used in 3 places.'>openssl_csr_export</a>)
<a id='L2899' name='L2899'></a>2899 <em class='brace'>{</em>
<a id='L2900' name='L2900'></a>2900         <a href='../Y/7405.html' title='Multiple used in 12 places.'>X509_REQ</a> * <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>;
<a id='L2901' name='L2901'></a>2901         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, *<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>=<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2902' name='L2902'></a>2902         <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a> = 1;
<a id='L2903' name='L2903'></a>2903         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>;
<a id='L2904' name='L2904'></a>2904         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/14658.html' title='Multiple used in 13 places.'>csr_resource</a>;
<a id='L2905' name='L2905'></a>2905 
<a id='L2906' name='L2906'></a>2906         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "rz/|b", &amp;<a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a>, &amp;<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>, &amp;<a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L2907' name='L2907'></a>2907                 <strong class='reserved'>return</strong>;
<a id='L2908' name='L2908'></a>2908         <em class='brace'>}</em>
<a id='L2909' name='L2909'></a>2909 
<a id='L2910' name='L2910'></a>2910         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L2911' name='L2911'></a>2911 
<a id='L2912' name='L2912'></a>2912         <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> = <a href='../S/851.html#L2807' title='Defined at 2807 in ext/openssl/openssl.c.'>php_openssl_csr_from_zval</a>(<a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a>, 0, &amp;<a href='../Y/14658.html' title='Multiple used in 13 places.'>csr_resource</a>);
<a id='L2913' name='L2913'></a>2913         <strong class='reserved'>if</strong> (<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2914' name='L2914'></a>2914                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "cannot get CSR from parameter 1");
<a id='L2915' name='L2915'></a>2915                 <strong class='reserved'>return</strong>;
<a id='L2916' name='L2916'></a>2916         <em class='brace'>}</em>
<a id='L2917' name='L2917'></a>2917 
<a id='L2918' name='L2918'></a>2918         <em class='comment'>/* export to a var */</em>
<a id='L2919' name='L2919'></a>2919 
<a id='L2920' name='L2920'></a>2920         <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../Y/231.html' title='Multiple used in 12 places.'>BIO_new</a>(<a href='../Y/237.html' title='Multiple used in 12 places.'>BIO_s_mem</a>());
<a id='L2921' name='L2921'></a>2921         <strong class='reserved'>if</strong> (!<a href='../Y/28715.html' title='Multiple used in 16 places.'>notext</a>) <em class='brace'>{</em>
<a id='L2922' name='L2922'></a>2922                 <a href='../Y/7412.html' title='Multiple used in 2 places.'>X509_REQ_print</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>);
<a id='L2923' name='L2923'></a>2923         <em class='brace'>}</em>
<a id='L2924' name='L2924'></a>2924 
<a id='L2925' name='L2925'></a>2925         <strong class='reserved'>if</strong> (<a href='../Y/4936.html' title='Multiple used in 2 places.'>PEM_write_bio_X509_REQ</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>)) <em class='brace'>{</em>
<a id='L2926' name='L2926'></a>2926                 <a href='../Y/273.html' title='Multiple used in 8 places.'>BUF_MEM</a> *<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>;
<a id='L2927' name='L2927'></a>2927 
<a id='L2928' name='L2928'></a>2928                 <a href='../Y/230.html' title='Multiple used in 9 places.'>BIO_get_mem_ptr</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, &amp;<a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>);
<a id='L2929' name='L2929'></a>2929                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>);
<a id='L2930' name='L2930'></a>2930                 <a href='../S/1632.html#L568' title='Defined at 568 in Zend/zend_API.h.'>ZVAL_STRINGL</a>(<a href='../Y/44068.html' title='Multiple used in 25 places.'>zout</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, <a href='../Y/12670.html' title='Multiple used in 26 places.'>bio_buf</a>-&gt;<a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>);
<a id='L2931' name='L2931'></a>2931 
<a id='L2932' name='L2932'></a>2932                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L2933' name='L2933'></a>2933         <em class='brace'>}</em>
<a id='L2934' name='L2934'></a>2934 
<a id='L2935' name='L2935'></a>2935         <strong class='reserved'>if</strong> (<a href='../Y/14658.html' title='Multiple used in 13 places.'>csr_resource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>) <em class='brace'>{</em>
<a id='L2936' name='L2936'></a>2936                 <a href='../Y/7407.html' title='Multiple used in 5 places.'>X509_REQ_free</a>(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>);
<a id='L2937' name='L2937'></a>2937         <em class='brace'>}</em>
<a id='L2938' name='L2938'></a>2938         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>);
<a id='L2939' name='L2939'></a>2939 <em class='brace'>}</em>
<a id='L2940' name='L2940'></a>2940 <em class='comment'>/* }}} */</em>
<a id='L2941' name='L2941'></a>2941 
<a id='L2942' name='L2942'></a>2942 <em class='comment'>/* {{{ proto resource openssl_csr_sign(mixed csr, mixed x509, mixed priv_key, long days [, array config_args [, long serial]])</em>
<a id='L2943' name='L2943'></a>2943 <em class='comment'>   Signs a cert with another CERT */</em>
<a id='L2944' name='L2944'></a>2944 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29737.html' title='Multiple used in 3 places.'>openssl_csr_sign</a>)
<a id='L2945' name='L2945'></a>2945 <em class='brace'>{</em>
<a id='L2946' name='L2946'></a>2946         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, *<a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a>, *<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, *<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2947' name='L2947'></a>2947         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/28861.html' title='Multiple used in 3 places.'>num_days</a>;
<a id='L2948' name='L2948'></a>2948         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/35723.html' title='Multiple used in 4 places.'>serial</a> = <a href='../D/17864.html' title='Multiple defined in 2 places.'>Z_L</a>(0);
<a id='L2949' name='L2949'></a>2949         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, *<a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2950' name='L2950'></a>2950         <a href='../Y/7405.html' title='Multiple used in 12 places.'>X509_REQ</a> * <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>;
<a id='L2951' name='L2951'></a>2951         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, *<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2952' name='L2952'></a>2952         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/14658.html' title='Multiple used in 13 places.'>csr_resource</a>, *<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, *<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L2953' name='L2953'></a>2953         <strong class='reserved'>int</strong> <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>;
<a id='L2954' name='L2954'></a>2954         <strong class='reserved'>struct</strong> <a href='../S/851.html#L618' title='Defined at 618 in ext/openssl/openssl.c.'>php_x509_request</a> <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>;
<a id='L2955' name='L2955'></a>2955 
<a id='L2956' name='L2956'></a>2956         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "zz!zl|a!l", &amp;<a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a>, &amp;<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, &amp;<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, &amp;<a href='../Y/28861.html' title='Multiple used in 3 places.'>num_days</a>, &amp;<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>, &amp;<a href='../Y/35723.html' title='Multiple used in 4 places.'>serial</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>)
<a id='L2957' name='L2957'></a>2957                 <strong class='reserved'>return</strong>;
<a id='L2958' name='L2958'></a>2958 
<a id='L2959' name='L2959'></a>2959         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L2960' name='L2960'></a>2960         <a href='../S/851.html#L859' title='Defined at 859 in ext/openssl/openssl.c.'>PHP_SSL_REQ_INIT</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>);
<a id='L2961' name='L2961'></a>2961 
<a id='L2962' name='L2962'></a>2962         <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> = <a href='../S/851.html#L2807' title='Defined at 2807 in ext/openssl/openssl.c.'>php_openssl_csr_from_zval</a>(<a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a>, 0, &amp;<a href='../Y/14658.html' title='Multiple used in 13 places.'>csr_resource</a>);
<a id='L2963' name='L2963'></a>2963         <strong class='reserved'>if</strong> (<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2964' name='L2964'></a>2964                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "cannot get CSR from parameter 1");
<a id='L2965' name='L2965'></a>2965                 <strong class='reserved'>return</strong>;
<a id='L2966' name='L2966'></a>2966         <em class='brace'>}</em>
<a id='L2967' name='L2967'></a>2967         <strong class='reserved'>if</strong> (<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>) <em class='brace'>{</em>
<a id='L2968' name='L2968'></a>2968                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, 0, &amp;<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>);
<a id='L2969' name='L2969'></a>2969                 <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2970' name='L2970'></a>2970                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "cannot get cert from parameter 2");
<a id='L2971' name='L2971'></a>2971                         <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L2972' name='L2972'></a>2972                 <em class='brace'>}</em>
<a id='L2973' name='L2973'></a>2973         <em class='brace'>}</em>
<a id='L2974' name='L2974'></a>2974         <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, 0, "", 1, &amp;<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>);
<a id='L2975' name='L2975'></a>2975         <strong class='reserved'>if</strong> (<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2976' name='L2976'></a>2976                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "cannot get private key from parameter 3");
<a id='L2977' name='L2977'></a>2977                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L2978' name='L2978'></a>2978         <em class='brace'>}</em>
<a id='L2979' name='L2979'></a>2979         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> &amp;&amp; !<a href='../Y/7435.html' title='Multiple used in 4 places.'>X509_check_private_key</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>)) <em class='brace'>{</em>
<a id='L2980' name='L2980'></a>2980                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "private key does not correspond to signing cert");
<a id='L2981' name='L2981'></a>2981                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L2982' name='L2982'></a>2982         <em class='brace'>}</em>
<a id='L2983' name='L2983'></a>2983 
<a id='L2984' name='L2984'></a>2984         <strong class='reserved'>if</strong> (<a href='../S/851.html#L861' title='Defined at 861 in ext/openssl/openssl.c.'>PHP_SSL_REQ_PARSE</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>, <a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L2985' name='L2985'></a>2985                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L2986' name='L2986'></a>2986         <em class='brace'>}</em>
<a id='L2987' name='L2987'></a>2987         <em class='comment'>/* Check that the request matches the signature */</em>
<a id='L2988' name='L2988'></a>2988         <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = <a href='../Y/7409.html' title='Multiple used in 2 places.'>X509_REQ_get_pubkey</a>(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>);
<a id='L2989' name='L2989'></a>2989         <strong class='reserved'>if</strong> (<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L2990' name='L2990'></a>2990                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "error unpacking public key");
<a id='L2991' name='L2991'></a>2991                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L2992' name='L2992'></a>2992         <em class='brace'>}</em>
<a id='L2993' name='L2993'></a>2993         <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> = X509_REQ_verify(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>);
<a id='L2994' name='L2994'></a>2994 
<a id='L2995' name='L2995'></a>2995         <strong class='reserved'>if</strong> (<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> &lt; 0) <em class='brace'>{</em>
<a id='L2996' name='L2996'></a>2996                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Signature verification problems");
<a id='L2997' name='L2997'></a>2997                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L2998' name='L2998'></a>2998         <em class='brace'>}</em>
<a id='L2999' name='L2999'></a>2999         <strong class='reserved'>else</strong> <strong class='reserved'>if</strong> (<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> == 0) <em class='brace'>{</em>
<a id='L3000' name='L3000'></a>3000                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Signature did not match the certificate request");
<a id='L3001' name='L3001'></a>3001                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L3002' name='L3002'></a>3002         <em class='brace'>}</em>
<a id='L3003' name='L3003'></a>3003 
<a id='L3004' name='L3004'></a>3004         <em class='comment'>/* Now we can get on with it */</em>
<a id='L3005' name='L3005'></a>3005 
<a id='L3006' name='L3006'></a>3006         <a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a> = X509_new();
<a id='L3007' name='L3007'></a>3007         <strong class='reserved'>if</strong> (<a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3008' name='L3008'></a>3008                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "No memory");
<a id='L3009' name='L3009'></a>3009                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L3010' name='L3010'></a>3010         <em class='brace'>}</em>
<a id='L3011' name='L3011'></a>3011         <em class='comment'>/* Version 3 cert */</em>
<a id='L3012' name='L3012'></a>3012         <strong class='reserved'>if</strong> (!X509_set_version(<a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>, 2))
<a id='L3013' name='L3013'></a>3013                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L3014' name='L3014'></a>3014 
<a id='L3015' name='L3015'></a>3015 
<a id='L3016' name='L3016'></a>3016         ASN1_INTEGER_set(<a href='../Y/7453.html' title='Multiple used in 2 places.'>X509_get_serialNumber</a>(<a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>), (<strong class='reserved'>long</strong>)<a href='../Y/35723.html' title='Multiple used in 4 places.'>serial</a>);
<a id='L3017' name='L3017'></a>3017 
<a id='L3018' name='L3018'></a>3018         X509_set_subject_name(<a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>, <a href='../Y/7410.html' title='Multiple used in 3 places.'>X509_REQ_get_subject_name</a>(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>));
<a id='L3019' name='L3019'></a>3019 
<a id='L3020' name='L3020'></a>3020         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3021' name='L3021'></a>3021                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>;
<a id='L3022' name='L3022'></a>3022         <em class='brace'>}</em>
<a id='L3023' name='L3023'></a>3023         <strong class='reserved'>if</strong> (!X509_set_issuer_name(<a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>, <a href='../Y/7454.html' title='Multiple used in 4 places.'>X509_get_subject_name</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>))) <em class='brace'>{</em>
<a id='L3024' name='L3024'></a>3024                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L3025' name='L3025'></a>3025         <em class='brace'>}</em>
<a id='L3026' name='L3026'></a>3026         <a href='../Y/7456.html' title='Multiple used in 2 places.'>X509_gmtime_adj</a>(<a href='../Y/7451.html' title='Multiple used in 3 places.'>X509_get_notBefore</a>(<a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>), 0);
<a id='L3027' name='L3027'></a>3027         <a href='../Y/7456.html' title='Multiple used in 2 places.'>X509_gmtime_adj</a>(<a href='../Y/7450.html' title='Multiple used in 3 places.'>X509_get_notAfter</a>(<a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>), 60*60*24*(<strong class='reserved'>long</strong>)<a href='../Y/28861.html' title='Multiple used in 3 places.'>num_days</a>);
<a id='L3028' name='L3028'></a>3028         <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> = X509_set_pubkey(<a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>);
<a id='L3029' name='L3029'></a>3029         <strong class='reserved'>if</strong> (!<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>) <em class='brace'>{</em>
<a id='L3030' name='L3030'></a>3030                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L3031' name='L3031'></a>3031         <em class='brace'>}</em>
<a id='L3032' name='L3032'></a>3032         <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/17394.html' title='Multiple used in 5 places.'>extensions_section</a>) <em class='brace'>{</em>
<a id='L3033' name='L3033'></a>3033                 <a href='../Y/7360.html' title='Multiple used in 3 places.'>X509V3_CTX</a> <a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>;
<a id='L3034' name='L3034'></a>3034 
<a id='L3035' name='L3035'></a>3035                 <a href='../Y/7367.html' title='Multiple used in 2 places.'>X509V3_set_ctx</a>(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>, <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, 0);
<a id='L3036' name='L3036'></a>3036                 <a href='../Y/7366.html' title='Multiple used in 3 places.'>X509V3_set_conf_lhash</a>(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>);
<a id='L3037' name='L3037'></a>3037                 <strong class='reserved'>if</strong> (!<a href='../Y/7363.html' title='Multiple used in 2 places.'>X509V3_EXT_add_conf</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, &amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/17394.html' title='Multiple used in 5 places.'>extensions_section</a>, <a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>)) <em class='brace'>{</em>
<a id='L3038' name='L3038'></a>3038                         <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L3039' name='L3039'></a>3039                 <em class='brace'>}</em>
<a id='L3040' name='L3040'></a>3040         <em class='brace'>}</em>
<a id='L3041' name='L3041'></a>3041 
<a id='L3042' name='L3042'></a>3042         <em class='comment'>/* Now sign it */</em>
<a id='L3043' name='L3043'></a>3043         <strong class='reserved'>if</strong> (!X509_sign(<a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>, <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/15696.html' title='Multiple used in 282 places.'>digest</a>)) <em class='brace'>{</em>
<a id='L3044' name='L3044'></a>3044                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "failed to sign it");
<a id='L3045' name='L3045'></a>3045                 <strong class='reserved'>goto</strong> <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>;
<a id='L3046' name='L3046'></a>3046         <em class='brace'>}</em>
<a id='L3047' name='L3047'></a>3047 
<a id='L3048' name='L3048'></a>3048         <em class='comment'>/* Succeeded; lets return the cert */</em>
<a id='L3049' name='L3049'></a>3049         <a href='../S/1731.html#L685' title='Defined at 685 in Zend/zend_types.h.'>ZVAL_RES</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, <a href='../S/1690.html#L94' title='Defined at 94 in Zend/zend_list.c.'>zend_register_resource</a>(<a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>, <a href='../Y/24937.html' title='Multiple used in 9 places.'>le_x509</a>));
<a id='L3050' name='L3050'></a>3050         <a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3051' name='L3051'></a>3051 
<a id='L3052' name='L3052'></a>3052 <a href='../Y/13799.html' title='Multiple used in 125 places.'>cleanup</a>:
<a id='L3053' name='L3053'></a>3053 
<a id='L3054' name='L3054'></a>3054         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>) <em class='brace'>{</em>
<a id='L3055' name='L3055'></a>3055                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3056' name='L3056'></a>3056         <em class='brace'>}</em>
<a id='L3057' name='L3057'></a>3057         <a href='../S/851.html#L860' title='Defined at 860 in ext/openssl/openssl.c.'>PHP_SSL_REQ_DISPOSE</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>);
<a id='L3058' name='L3058'></a>3058 
<a id='L3059' name='L3059'></a>3059         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>) <em class='brace'>{</em>
<a id='L3060' name='L3060'></a>3060                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>);
<a id='L3061' name='L3061'></a>3061         <em class='brace'>}</em>
<a id='L3062' name='L3062'></a>3062         <strong class='reserved'>if</strong> (<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>) <em class='brace'>{</em>
<a id='L3063' name='L3063'></a>3063                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>);
<a id='L3064' name='L3064'></a>3064         <em class='brace'>}</em>
<a id='L3065' name='L3065'></a>3065         <strong class='reserved'>if</strong> (<a href='../Y/14658.html' title='Multiple used in 13 places.'>csr_resource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>) <em class='brace'>{</em>
<a id='L3066' name='L3066'></a>3066                 <a href='../Y/7407.html' title='Multiple used in 5 places.'>X509_REQ_free</a>(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>);
<a id='L3067' name='L3067'></a>3067         <em class='brace'>}</em>
<a id='L3068' name='L3068'></a>3068         <strong class='reserved'>if</strong> (<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a> &amp;&amp; <a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) <em class='brace'>{</em>
<a id='L3069' name='L3069'></a>3069                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L3070' name='L3070'></a>3070         <em class='brace'>}</em>
<a id='L3071' name='L3071'></a>3071         <strong class='reserved'>if</strong> (<a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>) <em class='brace'>{</em>
<a id='L3072' name='L3072'></a>3072                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../Y/28213.html' title='Multiple used in 19 places.'>new_cert</a>);
<a id='L3073' name='L3073'></a>3073         <em class='brace'>}</em>
<a id='L3074' name='L3074'></a>3074 <em class='brace'>}</em>
<a id='L3075' name='L3075'></a>3075 <em class='comment'>/* }}} */</em>
<a id='L3076' name='L3076'></a>3076 
<a id='L3077' name='L3077'></a>3077 <em class='comment'>/* {{{ proto bool openssl_csr_new(array dn, resource &amp;privkey [, array configargs [, array extraattribs]])</em>
<a id='L3078' name='L3078'></a>3078 <em class='comment'>   Generates a privkey and CSR */</em>
<a id='L3079' name='L3079'></a>3079 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29736.html' title='Multiple used in 3 places.'>openssl_csr_new</a>)
<a id='L3080' name='L3080'></a>3080 <em class='brace'>{</em>
<a id='L3081' name='L3081'></a>3081         <strong class='reserved'>struct</strong> <a href='../S/851.html#L618' title='Defined at 618 in ext/openssl/openssl.c.'>php_x509_request</a> <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>;
<a id='L3082' name='L3082'></a>3082         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, * <a href='../Y/15850.html' title='Multiple used in 52 places.'>dn</a>, *<a href='../Y/12107.html' title='Multiple used in 26 places.'>attribs</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3083' name='L3083'></a>3083         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/30132.html' title='Multiple used in 6 places.'>out_pkey</a>;
<a id='L3084' name='L3084'></a>3084         <a href='../Y/7405.html' title='Multiple used in 12 places.'>X509_REQ</a> * <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3085' name='L3085'></a>3085         <strong class='reserved'>int</strong> <a href='../Y/40669.html' title='Multiple used in 4 places.'>we_made_the_key</a> = 1;
<a id='L3086' name='L3086'></a>3086         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/24467.html' title='Multiple used in 9 places.'>key_resource</a>;
<a id='L3087' name='L3087'></a>3087 
<a id='L3088' name='L3088'></a>3088         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "az/|a!a!", &amp;<a href='../Y/15850.html' title='Multiple used in 52 places.'>dn</a>, &amp;<a href='../Y/30132.html' title='Multiple used in 6 places.'>out_pkey</a>, &amp;<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>, &amp;<a href='../Y/12107.html' title='Multiple used in 26 places.'>attribs</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L3089' name='L3089'></a>3089                 <strong class='reserved'>return</strong>;
<a id='L3090' name='L3090'></a>3090         <em class='brace'>}</em>
<a id='L3091' name='L3091'></a>3091         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L3092' name='L3092'></a>3092 
<a id='L3093' name='L3093'></a>3093         <a href='../S/851.html#L859' title='Defined at 859 in ext/openssl/openssl.c.'>PHP_SSL_REQ_INIT</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>);
<a id='L3094' name='L3094'></a>3094 
<a id='L3095' name='L3095'></a>3095         <strong class='reserved'>if</strong> (<a href='../S/851.html#L861' title='Defined at 861 in ext/openssl/openssl.c.'>PHP_SSL_REQ_PARSE</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>, <a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>) == <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>) <em class='brace'>{</em>
<a id='L3096' name='L3096'></a>3096                 <em class='comment'>/* Generate or use a private key */</em>
<a id='L3097' name='L3097'></a>3097                 <strong class='reserved'>if</strong> (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/30132.html' title='Multiple used in 6 places.'>out_pkey</a>) != <a href='../D/4069.html' title='Multiple defined in 2 places.'>IS_NULL</a>) <em class='brace'>{</em>
<a id='L3098' name='L3098'></a>3098                         <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../Y/30132.html' title='Multiple used in 6 places.'>out_pkey</a>, 0, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, 0, &amp;<a href='../Y/24467.html' title='Multiple used in 9 places.'>key_resource</a>);
<a id='L3099' name='L3099'></a>3099                         <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3100' name='L3100'></a>3100                                 <a href='../Y/40669.html' title='Multiple used in 4 places.'>we_made_the_key</a> = 0;
<a id='L3101' name='L3101'></a>3101                         <em class='brace'>}</em>
<a id='L3102' name='L3102'></a>3102                 <em class='brace'>}</em>
<a id='L3103' name='L3103'></a>3103                 <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3104' name='L3104'></a>3104                         <a href='../S/851.html#L3387' title='Defined at 3387 in ext/openssl/openssl.c.'>php_openssl_generate_private_key</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>);
<a id='L3105' name='L3105'></a>3105                 <em class='brace'>}</em>
<a id='L3106' name='L3106'></a>3106                 <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3107' name='L3107'></a>3107                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unable to generate a private key");
<a id='L3108' name='L3108'></a>3108                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3109' name='L3109'></a>3109                         <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> = X509_REQ_new();
<a id='L3110' name='L3110'></a>3110                         <strong class='reserved'>if</strong> (<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>) <em class='brace'>{</em>
<a id='L3111' name='L3111'></a>3111                                 <strong class='reserved'>if</strong> (<a href='../S/851.html#L2661' title='Defined at 2661 in ext/openssl/openssl.c.'>php_openssl_make_REQ</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>, <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>, <a href='../Y/15850.html' title='Multiple used in 52 places.'>dn</a>, <a href='../Y/12107.html' title='Multiple used in 26 places.'>attribs</a>) == <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>) <em class='brace'>{</em>
<a id='L3112' name='L3112'></a>3112                                         <a href='../Y/7360.html' title='Multiple used in 3 places.'>X509V3_CTX</a> <a href='../Y/17364.html' title='Multiple used in 4 places.'>ext_ctx</a>;
<a id='L3113' name='L3113'></a>3113 
<a id='L3114' name='L3114'></a>3114                                         <a href='../Y/7367.html' title='Multiple used in 2 places.'>X509V3_set_ctx</a>(&amp;<a href='../Y/17364.html' title='Multiple used in 4 places.'>ext_ctx</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, 0);
<a id='L3115' name='L3115'></a>3115                                         <a href='../Y/7366.html' title='Multiple used in 3 places.'>X509V3_set_conf_lhash</a>(&amp;<a href='../Y/17364.html' title='Multiple used in 4 places.'>ext_ctx</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>);
<a id='L3116' name='L3116'></a>3116 
<a id='L3117' name='L3117'></a>3117                                         <em class='comment'>/* Add extensions */</em>
<a id='L3118' name='L3118'></a>3118                                         <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/34572.html' title='Multiple used in 6 places.'>request_extensions_section</a> &amp;&amp; !X509V3_EXT_REQ_add_conf(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>,
<a id='L3119' name='L3119'></a>3119                                                                 &amp;<a href='../Y/17364.html' title='Multiple used in 4 places.'>ext_ctx</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/34572.html' title='Multiple used in 6 places.'>request_extensions_section</a>, <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>))
<a id='L3120' name='L3120'></a>3120                                         <em class='brace'>{</em>
<a id='L3121' name='L3121'></a>3121                                                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Error loading extension section %s", <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/34572.html' title='Multiple used in 6 places.'>request_extensions_section</a>);
<a id='L3122' name='L3122'></a>3122                                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3123' name='L3123'></a>3123                                                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L3124' name='L3124'></a>3124 
<a id='L3125' name='L3125'></a>3125                                                 <strong class='reserved'>if</strong> (X509_REQ_sign(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/15696.html' title='Multiple used in 282 places.'>digest</a>)) <em class='brace'>{</em>
<a id='L3126' name='L3126'></a>3126                                                         <a href='../S/1731.html#L685' title='Defined at 685 in Zend/zend_types.h.'>ZVAL_RES</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, <a href='../S/1690.html#L94' title='Defined at 94 in Zend/zend_list.c.'>zend_register_resource</a>(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>, <a href='../Y/24875.html' title='Multiple used in 4 places.'>le_csr</a>));
<a id='L3127' name='L3127'></a>3127                                                         <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3128' name='L3128'></a>3128                                                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3129' name='L3129'></a>3129                                                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Error signing request");
<a id='L3130' name='L3130'></a>3130                                                 <em class='brace'>}</em>
<a id='L3131' name='L3131'></a>3131 
<a id='L3132' name='L3132'></a>3132                                                 <strong class='reserved'>if</strong> (<a href='../Y/40669.html' title='Multiple used in 4 places.'>we_made_the_key</a>) <em class='brace'>{</em>
<a id='L3133' name='L3133'></a>3133                                                         <em class='comment'>/* and a resource for the private key */</em>
<a id='L3134' name='L3134'></a>3134                                                         <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/30132.html' title='Multiple used in 6 places.'>out_pkey</a>);
<a id='L3135' name='L3135'></a>3135                                                         <a href='../S/1731.html#L685' title='Defined at 685 in Zend/zend_types.h.'>ZVAL_RES</a>(<a href='../Y/30132.html' title='Multiple used in 6 places.'>out_pkey</a>, <a href='../S/1690.html#L94' title='Defined at 94 in Zend/zend_list.c.'>zend_register_resource</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>, <a href='../Y/24897.html' title='Multiple used in 14 places.'>le_key</a>));
<a id='L3136' name='L3136'></a>3136                                                         <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>; <em class='comment'>/* make sure the cleanup code doesn't zap it! */</em>
<a id='L3137' name='L3137'></a>3137                                                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong> (<a href='../Y/24467.html' title='Multiple used in 9 places.'>key_resource</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3138' name='L3138'></a>3138                                                         <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>; <em class='comment'>/* make sure the cleanup code doesn't zap it! */</em>
<a id='L3139' name='L3139'></a>3139                                                 <em class='brace'>}</em>
<a id='L3140' name='L3140'></a>3140                                         <em class='brace'>}</em>
<a id='L3141' name='L3141'></a>3141                                 <em class='brace'>}</em>
<a id='L3142' name='L3142'></a>3142                                 <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3143' name='L3143'></a>3143                                         <strong class='reserved'>if</strong> (!<a href='../Y/40669.html' title='Multiple used in 4 places.'>we_made_the_key</a>) <em class='brace'>{</em>
<a id='L3144' name='L3144'></a>3144                                                 <em class='comment'>/* if we have not made the key we are not supposed to zap it by calling dispose! */</em>
<a id='L3145' name='L3145'></a>3145                                                 <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3146' name='L3146'></a>3146                                         <em class='brace'>}</em>
<a id='L3147' name='L3147'></a>3147                                 <em class='brace'>}</em>
<a id='L3148' name='L3148'></a>3148                         <em class='brace'>}</em>
<a id='L3149' name='L3149'></a>3149                 <em class='brace'>}</em>
<a id='L3150' name='L3150'></a>3150         <em class='brace'>}</em>
<a id='L3151' name='L3151'></a>3151         <strong class='reserved'>if</strong> (<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>) <em class='brace'>{</em>
<a id='L3152' name='L3152'></a>3152                 <a href='../Y/7407.html' title='Multiple used in 5 places.'>X509_REQ_free</a>(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>);
<a id='L3153' name='L3153'></a>3153         <em class='brace'>}</em>
<a id='L3154' name='L3154'></a>3154         <a href='../S/851.html#L860' title='Defined at 860 in ext/openssl/openssl.c.'>PHP_SSL_REQ_DISPOSE</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>);
<a id='L3155' name='L3155'></a>3155 <em class='brace'>}</em>
<a id='L3156' name='L3156'></a>3156 <em class='comment'>/* }}} */</em>
<a id='L3157' name='L3157'></a>3157 
<a id='L3158' name='L3158'></a>3158 <em class='comment'>/* {{{ proto mixed openssl_csr_get_subject(mixed csr)</em>
<a id='L3159' name='L3159'></a>3159 <em class='comment'>   Returns the subject of a CERT or FALSE on error */</em>
<a id='L3160' name='L3160'></a>3160 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29735.html' title='Multiple used in 3 places.'>openssl_csr_get_subject</a>)
<a id='L3161' name='L3161'></a>3161 <em class='brace'>{</em>
<a id='L3162' name='L3162'></a>3162         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a>;
<a id='L3163' name='L3163'></a>3163         <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../Y/39817.html' title='Multiple used in 5 places.'>use_shortnames</a> = 1;
<a id='L3164' name='L3164'></a>3164         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/14658.html' title='Multiple used in 13 places.'>csr_resource</a>;
<a id='L3165' name='L3165'></a>3165         <a href='../S/853.html#L50' title='Defined at 50 in ext/openssl/xp_ssl.c.'>X509_NAME</a> * <a href='../Y/37815.html' title='Multiple used in 206 places.'>subject</a>;
<a id='L3166' name='L3166'></a>3166         <a href='../Y/7405.html' title='Multiple used in 12 places.'>X509_REQ</a> * <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>;
<a id='L3167' name='L3167'></a>3167 
<a id='L3168' name='L3168'></a>3168         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "z|b", &amp;<a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a>, &amp;<a href='../Y/39817.html' title='Multiple used in 5 places.'>use_shortnames</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L3169' name='L3169'></a>3169                 <strong class='reserved'>return</strong>;
<a id='L3170' name='L3170'></a>3170         <em class='brace'>}</em>
<a id='L3171' name='L3171'></a>3171 
<a id='L3172' name='L3172'></a>3172         <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> = <a href='../S/851.html#L2807' title='Defined at 2807 in ext/openssl/openssl.c.'>php_openssl_csr_from_zval</a>(<a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a>, 0, &amp;<a href='../Y/14658.html' title='Multiple used in 13 places.'>csr_resource</a>);
<a id='L3173' name='L3173'></a>3173 
<a id='L3174' name='L3174'></a>3174         <strong class='reserved'>if</strong> (<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3175' name='L3175'></a>3175                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L3176' name='L3176'></a>3176         <em class='brace'>}</em>
<a id='L3177' name='L3177'></a>3177 
<a id='L3178' name='L3178'></a>3178         <a href='../Y/37815.html' title='Multiple used in 206 places.'>subject</a> = <a href='../Y/7410.html' title='Multiple used in 3 places.'>X509_REQ_get_subject_name</a>(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>);
<a id='L3179' name='L3179'></a>3179 
<a id='L3180' name='L3180'></a>3180         <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>);
<a id='L3181' name='L3181'></a>3181         <a href='../Y/8825.html' title='Multiple used in 4 places.'>add_assoc_name_entry</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../Y/37815.html' title='Multiple used in 206 places.'>subject</a>, <a href='../Y/39817.html' title='Multiple used in 5 places.'>use_shortnames</a>);
<a id='L3182' name='L3182'></a>3182         <strong class='reserved'>return</strong>;
<a id='L3183' name='L3183'></a>3183 <em class='brace'>}</em>
<a id='L3184' name='L3184'></a>3184 <em class='comment'>/* }}} */</em>
<a id='L3185' name='L3185'></a>3185 
<a id='L3186' name='L3186'></a>3186 <em class='comment'>/* {{{ proto mixed openssl_csr_get_public_key(mixed csr)</em>
<a id='L3187' name='L3187'></a>3187 <em class='comment'>        Returns the subject of a CERT or FALSE on error */</em>
<a id='L3188' name='L3188'></a>3188 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29734.html' title='Multiple used in 3 places.'>openssl_csr_get_public_key</a>)
<a id='L3189' name='L3189'></a>3189 <em class='brace'>{</em>
<a id='L3190' name='L3190'></a>3190         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a>;
<a id='L3191' name='L3191'></a>3191         <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../Y/39817.html' title='Multiple used in 5 places.'>use_shortnames</a> = 1;
<a id='L3192' name='L3192'></a>3192         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/14658.html' title='Multiple used in 13 places.'>csr_resource</a>;
<a id='L3193' name='L3193'></a>3193 
<a id='L3194' name='L3194'></a>3194         <a href='../Y/7405.html' title='Multiple used in 12 places.'>X509_REQ</a> * <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>;
<a id='L3195' name='L3195'></a>3195         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/38874.html' title='Multiple used in 3 places.'>tpubkey</a>;
<a id='L3196' name='L3196'></a>3196 
<a id='L3197' name='L3197'></a>3197         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "z|b", &amp;<a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a>, &amp;<a href='../Y/39817.html' title='Multiple used in 5 places.'>use_shortnames</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L3198' name='L3198'></a>3198                 <strong class='reserved'>return</strong>;
<a id='L3199' name='L3199'></a>3199         <em class='brace'>}</em>
<a id='L3200' name='L3200'></a>3200 
<a id='L3201' name='L3201'></a>3201         <a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> = <a href='../S/851.html#L2807' title='Defined at 2807 in ext/openssl/openssl.c.'>php_openssl_csr_from_zval</a>(<a href='../Y/43650.html' title='Multiple used in 15 places.'>zcsr</a>, 0, &amp;<a href='../Y/14658.html' title='Multiple used in 13 places.'>csr_resource</a>);
<a id='L3202' name='L3202'></a>3202 
<a id='L3203' name='L3203'></a>3203         <strong class='reserved'>if</strong> (<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3204' name='L3204'></a>3204                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L3205' name='L3205'></a>3205         <em class='brace'>}</em>
<a id='L3206' name='L3206'></a>3206 
<a id='L3207' name='L3207'></a>3207         <a href='../Y/38874.html' title='Multiple used in 3 places.'>tpubkey</a>=<a href='../Y/7409.html' title='Multiple used in 2 places.'>X509_REQ_get_pubkey</a>(<a href='../Y/14657.html' title='Multiple used in 90 places.'>csr</a>);
<a id='L3208' name='L3208'></a>3208         <a href='../S/1632.html#L640' title='Defined at 640 in Zend/zend_API.h.'>RETURN_RES</a>(<a href='../S/1690.html#L94' title='Defined at 94 in Zend/zend_list.c.'>zend_register_resource</a>(<a href='../Y/38874.html' title='Multiple used in 3 places.'>tpubkey</a>, <a href='../Y/24897.html' title='Multiple used in 14 places.'>le_key</a>));
<a id='L3209' name='L3209'></a>3209 <em class='brace'>}</em>
<a id='L3210' name='L3210'></a>3210 <em class='comment'>/* }}} */</em>
<a id='L3211' name='L3211'></a>3211 
<a id='L3212' name='L3212'></a>3212 <em class='comment'>/* }}} */</em>
<a id='L3213' name='L3213'></a>3213 
<a id='L3214' name='L3214'></a>3214 <em class='comment'>/* {{{ EVP Public/Private key functions */</em>
<a id='L3215' name='L3215'></a>3215 
<a id='L3216' name='L3216'></a>3216 <em class='comment'>/* {{{ php_openssl_evp_from_zval</em>
<a id='L3217' name='L3217'></a>3217 <em class='comment'>   Given a zval, coerce it into a EVP_PKEY object.</em>
<a id='L3218' name='L3218'></a>3218 <em class='comment'>        It can be:</em>
<a id='L3219' name='L3219'></a>3219 <em class='comment'>                1. private key resource from openssl_get_privatekey()</em>
<a id='L3220' name='L3220'></a>3220 <em class='comment'>                2. X509 resource -&gt; public key will be extracted from it</em>
<a id='L3221' name='L3221'></a>3221 <em class='comment'>                3. if it starts with file:// interpreted as path to key file</em>
<a id='L3222' name='L3222'></a>3222 <em class='comment'>                4. interpreted as the data from the cert/key file and interpreted in same way as openssl_get_privatekey()</em>
<a id='L3223' name='L3223'></a>3223 <em class='comment'>                5. an array(0 =&gt; [items 2..4], 1 =&gt; passphrase)</em>
<a id='L3224' name='L3224'></a>3224 <em class='comment'>                6. if val is a string (possibly starting with file:///) and it is not an X509 certificate, then interpret as public key</em>
<a id='L3225' name='L3225'></a>3225 <em class='comment'>        NOTE: If you are requesting a private key but have not specified a passphrase, you should use an</em>
<a id='L3226' name='L3226'></a>3226 <em class='comment'>        empty string rather than NULL for the passphrase - NULL causes a passphrase prompt to be emitted in</em>
<a id='L3227' name='L3227'></a>3227 <em class='comment'>        the Apache error log!</em>
<a id='L3228' name='L3228'></a>3228 <em class='comment'>*/</em>
<a id='L3229' name='L3229'></a>3229 <strong class='reserved'>static</strong> <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../R/24299.html' title='Multiple referred from 21 places.'>php_openssl_evp_from_zval</a>(<a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>, <strong class='reserved'>int</strong> <a href='../Y/33729.html' title='Multiple used in 21 places.'>public_key</a>, <strong class='reserved'>char</strong> * <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>, <strong class='reserved'>int</strong> <a href='../Y/25757.html' title='Multiple used in 8 places.'>makeresource</a>, <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> **<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a>)
<a id='L3230' name='L3230'></a>3230 <em class='brace'>{</em>
<a id='L3231' name='L3231'></a>3231         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3232' name='L3232'></a>3232         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3233' name='L3233'></a>3233         <strong class='reserved'>int</strong> <a href='../Y/18342.html' title='Multiple used in 4 places.'>free_cert</a> = 0;
<a id='L3234' name='L3234'></a>3234         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/13480.html' title='Multiple used in 3 places.'>cert_res</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3235' name='L3235'></a>3235         <strong class='reserved'>char</strong> * <a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3236' name='L3236'></a>3236         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> <a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>;
<a id='L3237' name='L3237'></a>3237 
<a id='L3238' name='L3238'></a>3238         <a href='../S/1731.html#L591' title='Defined at 591 in Zend/zend_types.h.'>ZVAL_NULL</a>(&amp;<a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>);
<a id='L3239' name='L3239'></a>3239 
<a id='L3240' name='L3240'></a>3240 <em class='sharp'>#define</em> <a href='../R/11932.html' title='Multiple referred from 9 places.'>TMP_CLEAN</a> \
<a id='L3241' name='L3241'></a>3241         <strong class='reserved'>if</strong> (<a href='../S/1731.html#L336' title='Defined at 336 in Zend/zend_types.h.'>Z_TYPE</a>(<a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>) == <a href='../S/1731.html#L308' title='Defined at 308 in Zend/zend_types.h.'>IS_STRING</a>) <em class='brace'>{</em>\
<a id='L3242' name='L3242'></a>3242                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(&amp;<a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>); \
<a id='L3243' name='L3243'></a>3243         <em class='brace'>}</em> \
<a id='L3244' name='L3244'></a>3244         <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3245' name='L3245'></a>3245 
<a id='L3246' name='L3246'></a>3246         <strong class='reserved'>if</strong> (<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a>) <em class='brace'>{</em>
<a id='L3247' name='L3247'></a>3247                 *<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3248' name='L3248'></a>3248         <em class='brace'>}</em>
<a id='L3249' name='L3249'></a>3249         <strong class='reserved'>if</strong> (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) == <a href='../S/1731.html#L309' title='Defined at 309 in Zend/zend_types.h.'>IS_ARRAY</a>) <em class='brace'>{</em>
<a id='L3250' name='L3250'></a>3250                 <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/44074.html' title='Multiple used in 5 places.'>zphrase</a>;
<a id='L3251' name='L3251'></a>3251 
<a id='L3252' name='L3252'></a>3252                 <em class='comment'>/* get passphrase */</em>
<a id='L3253' name='L3253'></a>3253 
<a id='L3254' name='L3254'></a>3254                 <strong class='reserved'>if</strong> ((<a href='../Y/44074.html' title='Multiple used in 5 places.'>zphrase</a> = <a href='../S/1667.html#L2021' title='Defined at 2021 in Zend/zend_hash.c.'>zend_hash_index_find</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>), 1)) == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3255' name='L3255'></a>3255                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "key array must be of the form array(0 =&gt; key, 1 =&gt; phrase)");
<a id='L3256' name='L3256'></a>3256                         <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3257' name='L3257'></a>3257                 <em class='brace'>}</em>
<a id='L3258' name='L3258'></a>3258 
<a id='L3259' name='L3259'></a>3259                 <strong class='reserved'>if</strong> (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/44074.html' title='Multiple used in 5 places.'>zphrase</a>) == <a href='../S/1731.html#L308' title='Defined at 308 in Zend/zend_types.h.'>IS_STRING</a>) <em class='brace'>{</em>
<a id='L3260' name='L3260'></a>3260                         <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a> = <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/44074.html' title='Multiple used in 5 places.'>zphrase</a>);
<a id='L3261' name='L3261'></a>3261                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3262' name='L3262'></a>3262                         <a href='../S/1731.html#L857' title='Defined at 857 in Zend/zend_types.h.'>ZVAL_COPY</a>(&amp;<a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>, <a href='../Y/44074.html' title='Multiple used in 5 places.'>zphrase</a>);
<a id='L3263' name='L3263'></a>3263                         <a href='../S/1707.html#L274' title='Defined at 274 in Zend/zend_operators.h.'>convert_to_string</a>(&amp;<a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>);
<a id='L3264' name='L3264'></a>3264                         <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a> = <a href='../S/1731.html#L515' title='Defined at 515 in Zend/zend_types.h.'>Z_STRVAL</a>(<a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>);
<a id='L3265' name='L3265'></a>3265                 <em class='brace'>}</em>
<a id='L3266' name='L3266'></a>3266 
<a id='L3267' name='L3267'></a>3267                 <em class='comment'>/* now set val to be the key param and continue */</em>
<a id='L3268' name='L3268'></a>3268                 <strong class='reserved'>if</strong> ((<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a> = <a href='../S/1667.html#L2021' title='Defined at 2021 in Zend/zend_hash.c.'>zend_hash_index_find</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>), 0)) == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3269' name='L3269'></a>3269                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "key array must be of the form array(0 =&gt; key, 1 =&gt; phrase)");
<a id='L3270' name='L3270'></a>3270                         <a href='../S/851.html#L3240' title='Defined at 3240 in ext/openssl/openssl.c.'>TMP_CLEAN</a>;
<a id='L3271' name='L3271'></a>3271                 <em class='brace'>}</em>
<a id='L3272' name='L3272'></a>3272         <em class='brace'>}</em>
<a id='L3273' name='L3273'></a>3273 
<a id='L3274' name='L3274'></a>3274         <strong class='reserved'>if</strong> (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) == <a href='../S/1731.html#L311' title='Defined at 311 in Zend/zend_types.h.'>IS_RESOURCE</a>) <em class='brace'>{</em>
<a id='L3275' name='L3275'></a>3275                 <strong class='reserved'>void</strong> * <a href='../Y/40693.html' title='Multiple used in 151 places.'>what</a>;
<a id='L3276' name='L3276'></a>3276                 <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> * <a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a> = <a href='../S/1731.html#L552' title='Defined at 552 in Zend/zend_types.h.'>Z_RES_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>);
<a id='L3277' name='L3277'></a>3277 
<a id='L3278' name='L3278'></a>3278                 <a href='../Y/40693.html' title='Multiple used in 151 places.'>what</a> = <a href='../S/1690.html#L103' title='Defined at 103 in Zend/zend_list.c.'>zend_fetch_resource2</a>(<a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>, "OpenSSL X.509/key", <a href='../Y/24937.html' title='Multiple used in 9 places.'>le_x509</a>, <a href='../Y/24897.html' title='Multiple used in 14 places.'>le_key</a>);
<a id='L3279' name='L3279'></a>3279                 <strong class='reserved'>if</strong> (!<a href='../Y/40693.html' title='Multiple used in 151 places.'>what</a>) <em class='brace'>{</em>
<a id='L3280' name='L3280'></a>3280                         <a href='../S/851.html#L3240' title='Defined at 3240 in ext/openssl/openssl.c.'>TMP_CLEAN</a>;
<a id='L3281' name='L3281'></a>3281                 <em class='brace'>}</em>
<a id='L3282' name='L3282'></a>3282                 <strong class='reserved'>if</strong> (<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a>) <em class='brace'>{</em>
<a id='L3283' name='L3283'></a>3283                         *<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a> = <a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>;
<a id='L3284' name='L3284'></a>3284                         <a href='../D/17793.html' title='Multiple defined in 3 places.'>Z_ADDREF_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>);
<a id='L3285' name='L3285'></a>3285                 <em class='brace'>}</em>
<a id='L3286' name='L3286'></a>3286                 <strong class='reserved'>if</strong> (<a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>-&gt;<a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a> == <a href='../Y/24937.html' title='Multiple used in 9 places.'>le_x509</a>) <em class='brace'>{</em>
<a id='L3287' name='L3287'></a>3287                         <em class='comment'>/* extract key from cert, depending on public_key param */</em>
<a id='L3288' name='L3288'></a>3288                         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = (<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>*)<a href='../Y/40693.html' title='Multiple used in 151 places.'>what</a>;
<a id='L3289' name='L3289'></a>3289                         <a href='../Y/18342.html' title='Multiple used in 4 places.'>free_cert</a> = 0;
<a id='L3290' name='L3290'></a>3290                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong> (<a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>-&gt;<a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a> == <a href='../Y/24897.html' title='Multiple used in 14 places.'>le_key</a>) <em class='brace'>{</em>
<a id='L3291' name='L3291'></a>3291                         <strong class='reserved'>int</strong> <a href='../Y/23889.html' title='Multiple used in 4 places.'>is_priv</a>;
<a id='L3292' name='L3292'></a>3292 
<a id='L3293' name='L3293'></a>3293                         <a href='../Y/23889.html' title='Multiple used in 4 places.'>is_priv</a> = <a href='../S/851.html#L3492' title='Defined at 3492 in ext/openssl/openssl.c.'>php_openssl_is_private_key</a>((<a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a>*)<a href='../Y/40693.html' title='Multiple used in 151 places.'>what</a>);
<a id='L3294' name='L3294'></a>3294 
<a id='L3295' name='L3295'></a>3295                         <em class='comment'>/* check whether it is actually a private key if requested */</em>
<a id='L3296' name='L3296'></a>3296                         <strong class='reserved'>if</strong> (!<a href='../Y/33729.html' title='Multiple used in 21 places.'>public_key</a> &amp;&amp; !<a href='../Y/23889.html' title='Multiple used in 4 places.'>is_priv</a>) <em class='brace'>{</em>
<a id='L3297' name='L3297'></a>3297                                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "supplied key param is a public key");
<a id='L3298' name='L3298'></a>3298                                 <a href='../S/851.html#L3240' title='Defined at 3240 in ext/openssl/openssl.c.'>TMP_CLEAN</a>;
<a id='L3299' name='L3299'></a>3299                         <em class='brace'>}</em>
<a id='L3300' name='L3300'></a>3300 
<a id='L3301' name='L3301'></a>3301                         <strong class='reserved'>if</strong> (<a href='../Y/33729.html' title='Multiple used in 21 places.'>public_key</a> &amp;&amp; <a href='../Y/23889.html' title='Multiple used in 4 places.'>is_priv</a>) <em class='brace'>{</em>
<a id='L3302' name='L3302'></a>3302                                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Don't know how to get public key from this private key");
<a id='L3303' name='L3303'></a>3303                                 <a href='../S/851.html#L3240' title='Defined at 3240 in ext/openssl/openssl.c.'>TMP_CLEAN</a>;
<a id='L3304' name='L3304'></a>3304                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3305' name='L3305'></a>3305                                 <strong class='reserved'>if</strong> (<a href='../S/1731.html#L336' title='Defined at 336 in Zend/zend_types.h.'>Z_TYPE</a>(<a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>) == <a href='../S/1731.html#L308' title='Defined at 308 in Zend/zend_types.h.'>IS_STRING</a>) <em class='brace'>{</em>
<a id='L3306' name='L3306'></a>3306                                         <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(&amp;<a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>);
<a id='L3307' name='L3307'></a>3307                                 <em class='brace'>}</em>
<a id='L3308' name='L3308'></a>3308                                 <em class='comment'>/* got the key - return it */</em>
<a id='L3309' name='L3309'></a>3309                                 <strong class='reserved'>return</strong> (<a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a>*)<a href='../Y/40693.html' title='Multiple used in 151 places.'>what</a>;
<a id='L3310' name='L3310'></a>3310                         <em class='brace'>}</em>
<a id='L3311' name='L3311'></a>3311                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3312' name='L3312'></a>3312                         <em class='comment'>/* other types could be used here - eg: file pointers and read in the data from them */</em>
<a id='L3313' name='L3313'></a>3313                         <a href='../S/851.html#L3240' title='Defined at 3240 in ext/openssl/openssl.c.'>TMP_CLEAN</a>;
<a id='L3314' name='L3314'></a>3314                 <em class='brace'>}</em>
<a id='L3315' name='L3315'></a>3315         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3316' name='L3316'></a>3316                 <em class='comment'>/* force it to be a string and check if it refers to a file */</em>
<a id='L3317' name='L3317'></a>3317                 <em class='comment'>/* passing non string values leaks, object uses toString, it returns NULL</em>
<a id='L3318' name='L3318'></a>3318 <em class='comment'>                 * See bug38255.phpt</em>
<a id='L3319' name='L3319'></a>3319 <em class='comment'>                 */</em>
<a id='L3320' name='L3320'></a>3320                 <strong class='reserved'>if</strong> (!(<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) == <a href='../S/1731.html#L308' title='Defined at 308 in Zend/zend_types.h.'>IS_STRING</a> || <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) == <a href='../S/1731.html#L310' title='Defined at 310 in Zend/zend_types.h.'>IS_OBJECT</a>)) <em class='brace'>{</em>
<a id='L3321' name='L3321'></a>3321                         <a href='../S/851.html#L3240' title='Defined at 3240 in ext/openssl/openssl.c.'>TMP_CLEAN</a>;
<a id='L3322' name='L3322'></a>3322                 <em class='brace'>}</em>
<a id='L3323' name='L3323'></a>3323                 <a href='../S/1707.html#L410' title='Defined at 410 in Zend/zend_operators.h.'>convert_to_string_ex</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>);
<a id='L3324' name='L3324'></a>3324 
<a id='L3325' name='L3325'></a>3325                 <strong class='reserved'>if</strong> (<a href='../S/1731.html#L519' title='Defined at 519 in Zend/zend_types.h.'>Z_STRLEN_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) &gt; 7 &amp;&amp; <a href='../S/868.html#L371' title='Defined at 371 in ext/pcre/pcrelib/pcre_internal.h.'>memcmp</a>(<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>), "file://", <strong class='reserved'>sizeof</strong>("file://") - 1) == 0) <em class='brace'>{</em>
<a id='L3326' name='L3326'></a>3326                         <a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a> = <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) + (<strong class='reserved'>sizeof</strong>("file://") - 1);
<a id='L3327' name='L3327'></a>3327                 <em class='brace'>}</em>
<a id='L3328' name='L3328'></a>3328                 <em class='comment'>/* it's an X509 file/cert of some kind, and we need to extract the data from that */</em>
<a id='L3329' name='L3329'></a>3329                 <strong class='reserved'>if</strong> (<a href='../Y/33729.html' title='Multiple used in 21 places.'>public_key</a>) <em class='brace'>{</em>
<a id='L3330' name='L3330'></a>3330                         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>, 0, &amp;<a href='../Y/13480.html' title='Multiple used in 3 places.'>cert_res</a>);
<a id='L3331' name='L3331'></a>3331                         <a href='../Y/18342.html' title='Multiple used in 4 places.'>free_cert</a> = (<a href='../Y/13480.html' title='Multiple used in 3 places.'>cert_res</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3332' name='L3332'></a>3332                         <em class='comment'>/* actual extraction done later */</em>
<a id='L3333' name='L3333'></a>3333                         <strong class='reserved'>if</strong> (!<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) <em class='brace'>{</em>
<a id='L3334' name='L3334'></a>3334                                 <em class='comment'>/* not a X509 certificate, try to retrieve public key */</em>
<a id='L3335' name='L3335'></a>3335                                 <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a>* <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>;
<a id='L3336' name='L3336'></a>3336                                 <strong class='reserved'>if</strong> (<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>) <em class='brace'>{</em>
<a id='L3337' name='L3337'></a>3337                                         <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>, "r");
<a id='L3338' name='L3338'></a>3338                                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3339' name='L3339'></a>3339                                         <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> = <a href='../Y/233.html' title='Multiple used in 8 places.'>BIO_new_mem_buf</a>(<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>), (<strong class='reserved'>int</strong>)<a href='../S/1731.html#L519' title='Defined at 519 in Zend/zend_types.h.'>Z_STRLEN_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>));
<a id='L3340' name='L3340'></a>3340                                 <em class='brace'>}</em>
<a id='L3341' name='L3341'></a>3341                                 <strong class='reserved'>if</strong> (<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3342' name='L3342'></a>3342                                         <a href='../S/851.html#L3240' title='Defined at 3240 in ext/openssl/openssl.c.'>TMP_CLEAN</a>;
<a id='L3343' name='L3343'></a>3343                                 <em class='brace'>}</em>
<a id='L3344' name='L3344'></a>3344                                 <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = <a href='../Y/4927.html' title='Multiple used in 2 places.'>PEM_read_bio_PUBKEY</a>(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>,<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3345' name='L3345'></a>3345                                 <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>);
<a id='L3346' name='L3346'></a>3346                         <em class='brace'>}</em>
<a id='L3347' name='L3347'></a>3347                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3348' name='L3348'></a>3348                         <em class='comment'>/* we want the private key */</em>
<a id='L3349' name='L3349'></a>3349                         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> *<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>;
<a id='L3350' name='L3350'></a>3350 
<a id='L3351' name='L3351'></a>3351                         <strong class='reserved'>if</strong> (<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>) <em class='brace'>{</em>
<a id='L3352' name='L3352'></a>3352                                 <strong class='reserved'>if</strong> (<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>)) <em class='brace'>{</em>
<a id='L3353' name='L3353'></a>3353                                         <a href='../S/851.html#L3240' title='Defined at 3240 in ext/openssl/openssl.c.'>TMP_CLEAN</a>;
<a id='L3354' name='L3354'></a>3354                                 <em class='brace'>}</em>
<a id='L3355' name='L3355'></a>3355                                 <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>, "r");
<a id='L3356' name='L3356'></a>3356                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3357' name='L3357'></a>3357                                 <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> = <a href='../Y/233.html' title='Multiple used in 8 places.'>BIO_new_mem_buf</a>(<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>), (<strong class='reserved'>int</strong>)<a href='../S/1731.html#L519' title='Defined at 519 in Zend/zend_types.h.'>Z_STRLEN_P</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>));
<a id='L3358' name='L3358'></a>3358                         <em class='brace'>}</em>
<a id='L3359' name='L3359'></a>3359 
<a id='L3360' name='L3360'></a>3360                         <strong class='reserved'>if</strong> (<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3361' name='L3361'></a>3361                                 <a href='../S/851.html#L3240' title='Defined at 3240 in ext/openssl/openssl.c.'>TMP_CLEAN</a>;
<a id='L3362' name='L3362'></a>3362                         <em class='brace'>}</em>
<a id='L3363' name='L3363'></a>3363                         <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = <a href='../Y/4928.html' title='Multiple used in 2 places.'>PEM_read_bio_PrivateKey</a>(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>,<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>);
<a id='L3364' name='L3364'></a>3364                         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>);
<a id='L3365' name='L3365'></a>3365                 <em class='brace'>}</em>
<a id='L3366' name='L3366'></a>3366         <em class='brace'>}</em>
<a id='L3367' name='L3367'></a>3367 
<a id='L3368' name='L3368'></a>3368         <strong class='reserved'>if</strong> (<a href='../Y/33729.html' title='Multiple used in 21 places.'>public_key</a> &amp;&amp; <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> &amp;&amp; <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3369' name='L3369'></a>3369                 <em class='comment'>/* extract public key from X509 cert */</em>
<a id='L3370' name='L3370'></a>3370                 <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = (<a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *) <a href='../Y/7452.html' title='Multiple used in 2 places.'>X509_get_pubkey</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L3371' name='L3371'></a>3371         <em class='brace'>}</em>
<a id='L3372' name='L3372'></a>3372 
<a id='L3373' name='L3373'></a>3373         <strong class='reserved'>if</strong> (<a href='../Y/18342.html' title='Multiple used in 4 places.'>free_cert</a> &amp;&amp; <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) <em class='brace'>{</em>
<a id='L3374' name='L3374'></a>3374                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L3375' name='L3375'></a>3375         <em class='brace'>}</em>
<a id='L3376' name='L3376'></a>3376         <strong class='reserved'>if</strong> (<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> &amp;&amp; <a href='../Y/25757.html' title='Multiple used in 8 places.'>makeresource</a> &amp;&amp; <a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a>) <em class='brace'>{</em>
<a id='L3377' name='L3377'></a>3377                 *<a href='../Y/34682.html' title='Multiple used in 22 places.'>resourceval</a> = <a href='../S/1690.html#L94' title='Defined at 94 in Zend/zend_list.c.'>zend_register_resource</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, <a href='../Y/24897.html' title='Multiple used in 14 places.'>le_key</a>);
<a id='L3378' name='L3378'></a>3378         <em class='brace'>}</em>
<a id='L3379' name='L3379'></a>3379         <strong class='reserved'>if</strong> (<a href='../S/1731.html#L336' title='Defined at 336 in Zend/zend_types.h.'>Z_TYPE</a>(<a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>) == <a href='../S/1731.html#L308' title='Defined at 308 in Zend/zend_types.h.'>IS_STRING</a>) <em class='brace'>{</em>
<a id='L3380' name='L3380'></a>3380                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(&amp;<a href='../Y/38586.html' title='Multiple used in 3516 places.'>tmp</a>);
<a id='L3381' name='L3381'></a>3381         <em class='brace'>}</em>
<a id='L3382' name='L3382'></a>3382         <strong class='reserved'>return</strong> <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>;
<a id='L3383' name='L3383'></a>3383 <em class='brace'>}</em>
<a id='L3384' name='L3384'></a>3384 <em class='comment'>/* }}} */</em>
<a id='L3385' name='L3385'></a>3385 
<a id='L3386' name='L3386'></a>3386 <em class='comment'>/* {{{ php_openssl_generate_private_key */</em>
<a id='L3387' name='L3387'></a>3387 <strong class='reserved'>static</strong> <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../R/24300.html' title='Multiple referred from 3 places.'>php_openssl_generate_private_key</a>(<strong class='reserved'>struct</strong> <a href='../S/851.html#L618' title='Defined at 618 in ext/openssl/openssl.c.'>php_x509_request</a> * <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>)
<a id='L3388' name='L3388'></a>3388 <em class='brace'>{</em>
<a id='L3389' name='L3389'></a>3389         <strong class='reserved'>char</strong> * <a href='../Y/33970.html' title='Multiple used in 4 places.'>randfile</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3390' name='L3390'></a>3390         <strong class='reserved'>int</strong> <a href='../Y/16510.html' title='Multiple used in 8 places.'>egdsocket</a>, <a href='../Y/35613.html' title='Multiple used in 12 places.'>seeded</a>;
<a id='L3391' name='L3391'></a>3391         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../Y/34852.html' title='Multiple used in 10 places.'>return_val</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3392' name='L3392'></a>3392 
<a id='L3393' name='L3393'></a>3393         <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33386.html' title='Multiple used in 10 places.'>priv_key_bits</a> &lt; <a href='../S/851.html#L67' title='Defined at 67 in ext/openssl/openssl.c.'>MIN_KEY_LENGTH</a>) <em class='brace'>{</em>
<a id='L3394' name='L3394'></a>3394                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "private key length is too short; it needs to be at least %d bits, not %d",
<a id='L3395' name='L3395'></a>3395                                 <a href='../S/851.html#L67' title='Defined at 67 in ext/openssl/openssl.c.'>MIN_KEY_LENGTH</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33386.html' title='Multiple used in 10 places.'>priv_key_bits</a>);
<a id='L3396' name='L3396'></a>3396                 <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3397' name='L3397'></a>3397         <em class='brace'>}</em>
<a id='L3398' name='L3398'></a>3398 
<a id='L3399' name='L3399'></a>3399         <a href='../Y/33970.html' title='Multiple used in 4 places.'>randfile</a> = <a href='../Y/558.html' title='Multiple used in 12 places.'>CONF_get_string</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/34549.html' title='Multiple used in 28 places.'>req_config</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/35586.html' title='Multiple used in 13 places.'>section_name</a>, "RANDFILE");
<a id='L3400' name='L3400'></a>3400         <a href='../S/851.html#L1009' title='Defined at 1009 in ext/openssl/openssl.c.'>php_openssl_load_rand_file</a>(<a href='../Y/33970.html' title='Multiple used in 4 places.'>randfile</a>, &amp;<a href='../Y/16510.html' title='Multiple used in 8 places.'>egdsocket</a>, &amp;<a href='../Y/35613.html' title='Multiple used in 12 places.'>seeded</a>);
<a id='L3401' name='L3401'></a>3401 
<a id='L3402' name='L3402'></a>3402         <strong class='reserved'>if</strong> ((<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> = <a href='../Y/2143.html' title='Multiple used in 4 places.'>EVP_PKEY_new</a>()) != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3403' name='L3403'></a>3403                 <strong class='reserved'>switch</strong>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33389.html' title='Multiple used in 3 places.'>priv_key_type</a>) <em class='brace'>{</em>
<a id='L3404' name='L3404'></a>3404                         <strong class='reserved'>case</strong> <a href='../S/851.html#L95' title='Defined at 95 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_RSA</a>:
<a id='L3405' name='L3405'></a>3405                                 <em class='brace'>{</em>
<a id='L3406' name='L3406'></a>3406                                         <a href='../Y/5394.html' title='Multiple used in 9 places.'>RSA</a>* <a href='../Y/35073.html' title='Multiple used in 5 places.'>rsaparam</a>;
<a id='L3407' name='L3407'></a>3407 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &lt; 0x10002000L
<a id='L3408' name='L3408'></a>3408                                         <em class='comment'>/* OpenSSL 1.0.2 deprecates RSA_generate_key */</em>
<a id='L3409' name='L3409'></a>3409                                         <a href='../Y/35073.html' title='Multiple used in 5 places.'>rsaparam</a> = (<a href='../Y/5394.html' title='Multiple used in 9 places.'>RSA</a>*)RSA_generate_key(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33386.html' title='Multiple used in 10 places.'>priv_key_bits</a>, <a href='../Y/5395.html' title='Multiple used in 3 places.'>RSA_F4</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3410' name='L3410'></a>3410 <em class='sharp'>#else</em>
<a id='L3411' name='L3411'></a>3411                                         <em class='brace'>{</em>
<a id='L3412' name='L3412'></a>3412                                                 <a href='../Y/217.html' title='Multiple used in 3 places.'>BIGNUM</a> *<a href='../Y/12794.html' title='Multiple used in 5 places.'>bne</a> = (<a href='../Y/217.html' title='Multiple used in 3 places.'>BIGNUM</a> *)<a href='../Y/252.html' title='Multiple used in 2 places.'>BN_new</a>();
<a id='L3413' name='L3413'></a>3413                                                 <strong class='reserved'>if</strong> (<a href='../Y/254.html' title='Multiple used in 2 places.'>BN_set_word</a>(<a href='../Y/12794.html' title='Multiple used in 5 places.'>bne</a>, <a href='../Y/5395.html' title='Multiple used in 3 places.'>RSA_F4</a>) != 1) <em class='brace'>{</em>
<a id='L3414' name='L3414'></a>3414                                                         <a href='../Y/251.html' title='Multiple used in 4 places.'>BN_free</a>(<a href='../Y/12794.html' title='Multiple used in 5 places.'>bne</a>);
<a id='L3415' name='L3415'></a>3415                                                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "failed setting exponent");
<a id='L3416' name='L3416'></a>3416                                                         <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3417' name='L3417'></a>3417                                                 <em class='brace'>}</em>
<a id='L3418' name='L3418'></a>3418                                                 <a href='../Y/35073.html' title='Multiple used in 5 places.'>rsaparam</a> = <a href='../Y/5403.html' title='Multiple used in 3 places.'>RSA_new</a>();
<a id='L3419' name='L3419'></a>3419                                                 <a href='../Y/5402.html' title='Multiple used in 2 places.'>RSA_generate_key_ex</a>(<a href='../Y/35073.html' title='Multiple used in 5 places.'>rsaparam</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33386.html' title='Multiple used in 10 places.'>priv_key_bits</a>, <a href='../Y/12794.html' title='Multiple used in 5 places.'>bne</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3420' name='L3420'></a>3420                                                 <a href='../Y/251.html' title='Multiple used in 4 places.'>BN_free</a>(<a href='../Y/12794.html' title='Multiple used in 5 places.'>bne</a>);
<a id='L3421' name='L3421'></a>3421                                         <em class='brace'>}</em>
<a id='L3422' name='L3422'></a>3422 <em class='sharp'>#endif</em>
<a id='L3423' name='L3423'></a>3423                                         <strong class='reserved'>if</strong> (<a href='../Y/35073.html' title='Multiple used in 5 places.'>rsaparam</a> &amp;&amp; <a href='../Y/2138.html' title='Multiple used in 2 places.'>EVP_PKEY_assign_RSA</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>, <a href='../Y/35073.html' title='Multiple used in 5 places.'>rsaparam</a>)) <em class='brace'>{</em>
<a id='L3424' name='L3424'></a>3424                                                 <a href='../Y/34852.html' title='Multiple used in 10 places.'>return_val</a> = <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>;
<a id='L3425' name='L3425'></a>3425                                         <em class='brace'>}</em>
<a id='L3426' name='L3426'></a>3426                                 <em class='brace'>}</em>
<a id='L3427' name='L3427'></a>3427                                 <strong class='reserved'>break</strong>;
<a id='L3428' name='L3428'></a>3428 <em class='sharp'>#if</em> !<strong class='reserved'>defined</strong>(<a href='../Y/4267.html' title='Multiple used in 3 places.'>NO_DSA</a>)
<a id='L3429' name='L3429'></a>3429                         <strong class='reserved'>case</strong> <a href='../S/851.html#L96' title='Defined at 96 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_DSA</a>:
<a id='L3430' name='L3430'></a>3430                                 <em class='brace'>{</em>
<a id='L3431' name='L3431'></a>3431                                         <a href='../Y/1534.html' title='Multiple used in 2 places.'>DSA</a> *<a href='../Y/16202.html' title='Multiple used in 8 places.'>dsaparam</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3432' name='L3432'></a>3432 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &lt; 0x10002000L
<a id='L3433' name='L3433'></a>3433                                         <a href='../Y/16202.html' title='Multiple used in 8 places.'>dsaparam</a> = DSA_generate_parameters(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33386.html' title='Multiple used in 10 places.'>priv_key_bits</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, 0, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3434' name='L3434'></a>3434 <em class='sharp'>#else</em>
<a id='L3435' name='L3435'></a>3435                                         DSA_generate_parameters_ex(<a href='../Y/16202.html' title='Multiple used in 8 places.'>dsaparam</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33386.html' title='Multiple used in 10 places.'>priv_key_bits</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, 0, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3436' name='L3436'></a>3436 <em class='sharp'>#endif</em>
<a id='L3437' name='L3437'></a>3437                                         <strong class='reserved'>if</strong> (<a href='../Y/16202.html' title='Multiple used in 8 places.'>dsaparam</a>) <em class='brace'>{</em>
<a id='L3438' name='L3438'></a>3438                                                 DSA_set_method(<a href='../Y/16202.html' title='Multiple used in 8 places.'>dsaparam</a>, DSA_get_default_method());
<a id='L3439' name='L3439'></a>3439                                                 <strong class='reserved'>if</strong> (<a href='../Y/1536.html' title='Multiple used in 2 places.'>DSA_generate_key</a>(<a href='../Y/16202.html' title='Multiple used in 8 places.'>dsaparam</a>)) <em class='brace'>{</em>
<a id='L3440' name='L3440'></a>3440                                                         <strong class='reserved'>if</strong> (<a href='../Y/2137.html' title='Multiple used in 2 places.'>EVP_PKEY_assign_DSA</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>, <a href='../Y/16202.html' title='Multiple used in 8 places.'>dsaparam</a>)) <em class='brace'>{</em>
<a id='L3441' name='L3441'></a>3441                                                                 <a href='../Y/34852.html' title='Multiple used in 10 places.'>return_val</a> = <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>;
<a id='L3442' name='L3442'></a>3442                                                         <em class='brace'>}</em>
<a id='L3443' name='L3443'></a>3443                                                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3444' name='L3444'></a>3444                                                         <a href='../Y/1535.html' title='Multiple used in 2 places.'>DSA_free</a>(<a href='../Y/16202.html' title='Multiple used in 8 places.'>dsaparam</a>);
<a id='L3445' name='L3445'></a>3445                                                 <em class='brace'>}</em>
<a id='L3446' name='L3446'></a>3446                                         <em class='brace'>}</em>
<a id='L3447' name='L3447'></a>3447                                 <em class='brace'>}</em>
<a id='L3448' name='L3448'></a>3448                                 <strong class='reserved'>break</strong>;
<a id='L3449' name='L3449'></a>3449 <em class='sharp'>#endif</em>
<a id='L3450' name='L3450'></a>3450 <em class='sharp'>#if</em> !<strong class='reserved'>defined</strong>(<a href='../Y/4266.html' title='Multiple used in 2 places.'>NO_DH</a>)
<a id='L3451' name='L3451'></a>3451                         <strong class='reserved'>case</strong> <a href='../S/851.html#L97' title='Defined at 97 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_DH</a>:
<a id='L3452' name='L3452'></a>3452                                 <em class='brace'>{</em>
<a id='L3453' name='L3453'></a>3453                                         <strong class='reserved'>int</strong> <a href='../Y/13997.html' title='Multiple used in 10 places.'>codes</a> = 0;
<a id='L3454' name='L3454'></a>3454                                         <a href='../Y/1449.html' title='Multiple used in 9 places.'>DH</a> *<a href='../Y/15671.html' title='Multiple used in 8 places.'>dhparam</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3455' name='L3455'></a>3455 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &lt; 0x10002000L
<a id='L3456' name='L3456'></a>3456                                         <a href='../Y/15671.html' title='Multiple used in 8 places.'>dhparam</a> = DH_generate_parameters(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33386.html' title='Multiple used in 10 places.'>priv_key_bits</a>, 2, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3457' name='L3457'></a>3457 <em class='sharp'>#else</em>
<a id='L3458' name='L3458'></a>3458                                         DH_generate_parameters_ex(<a href='../Y/15671.html' title='Multiple used in 8 places.'>dhparam</a>, <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33386.html' title='Multiple used in 10 places.'>priv_key_bits</a>, 2, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3459' name='L3459'></a>3459 <em class='sharp'>#endif</em>
<a id='L3460' name='L3460'></a>3460                                         <strong class='reserved'>if</strong> (<a href='../Y/15671.html' title='Multiple used in 8 places.'>dhparam</a>) <em class='brace'>{</em>
<a id='L3461' name='L3461'></a>3461                                                 DH_set_method(<a href='../Y/15671.html' title='Multiple used in 8 places.'>dhparam</a>, DH_get_default_method());
<a id='L3462' name='L3462'></a>3462                                                 <strong class='reserved'>if</strong> (DH_check(<a href='../Y/15671.html' title='Multiple used in 8 places.'>dhparam</a>, &amp;<a href='../Y/13997.html' title='Multiple used in 10 places.'>codes</a>) &amp;&amp; <a href='../Y/13997.html' title='Multiple used in 10 places.'>codes</a> == 0 &amp;&amp; <a href='../Y/1453.html' title='Multiple used in 2 places.'>DH_generate_key</a>(<a href='../Y/15671.html' title='Multiple used in 8 places.'>dhparam</a>)) <em class='brace'>{</em>
<a id='L3463' name='L3463'></a>3463                                                         <strong class='reserved'>if</strong> (<a href='../Y/2136.html' title='Multiple used in 2 places.'>EVP_PKEY_assign_DH</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>, <a href='../Y/15671.html' title='Multiple used in 8 places.'>dhparam</a>)) <em class='brace'>{</em>
<a id='L3464' name='L3464'></a>3464                                                                 <a href='../Y/34852.html' title='Multiple used in 10 places.'>return_val</a> = <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>;
<a id='L3465' name='L3465'></a>3465                                                         <em class='brace'>}</em>
<a id='L3466' name='L3466'></a>3466                                                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3467' name='L3467'></a>3467                                                         <a href='../Y/1452.html' title='Multiple used in 4 places.'>DH_free</a>(<a href='../Y/15671.html' title='Multiple used in 8 places.'>dhparam</a>);
<a id='L3468' name='L3468'></a>3468                                                 <em class='brace'>}</em>
<a id='L3469' name='L3469'></a>3469                                         <em class='brace'>}</em>
<a id='L3470' name='L3470'></a>3470                                 <em class='brace'>}</em>
<a id='L3471' name='L3471'></a>3471                                 <strong class='reserved'>break</strong>;
<a id='L3472' name='L3472'></a>3472 <em class='sharp'>#endif</em>
<a id='L3473' name='L3473'></a>3473                         <strong class='reserved'>default</strong>:
<a id='L3474' name='L3474'></a>3474                                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unsupported private key type");
<a id='L3475' name='L3475'></a>3475                 <em class='brace'>}</em>
<a id='L3476' name='L3476'></a>3476         <em class='brace'>}</em>
<a id='L3477' name='L3477'></a>3477 
<a id='L3478' name='L3478'></a>3478         <a href='../S/851.html#L1038' title='Defined at 1038 in ext/openssl/openssl.c.'>php_openssl_write_rand_file</a>(<a href='../Y/33970.html' title='Multiple used in 4 places.'>randfile</a>, <a href='../Y/16510.html' title='Multiple used in 8 places.'>egdsocket</a>, <a href='../Y/35613.html' title='Multiple used in 12 places.'>seeded</a>);
<a id='L3479' name='L3479'></a>3479 
<a id='L3480' name='L3480'></a>3480         <strong class='reserved'>if</strong> (<a href='../Y/34852.html' title='Multiple used in 10 places.'>return_val</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3481' name='L3481'></a>3481                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>);
<a id='L3482' name='L3482'></a>3482                 <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3483' name='L3483'></a>3483                 <strong class='reserved'>return</strong> <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3484' name='L3484'></a>3484         <em class='brace'>}</em>
<a id='L3485' name='L3485'></a>3485 
<a id='L3486' name='L3486'></a>3486         <strong class='reserved'>return</strong> <a href='../Y/34852.html' title='Multiple used in 10 places.'>return_val</a>;
<a id='L3487' name='L3487'></a>3487 <em class='brace'>}</em>
<a id='L3488' name='L3488'></a>3488 <em class='comment'>/* }}} */</em>
<a id='L3489' name='L3489'></a>3489 
<a id='L3490' name='L3490'></a>3490 <em class='comment'>/* {{{ php_openssl_is_private_key</em>
<a id='L3491' name='L3491'></a>3491 <em class='comment'>        Check whether the supplied key is a private key by checking if the secret prime factors are set */</em>
<a id='L3492' name='L3492'></a>3492 <strong class='reserved'>static</strong> <strong class='reserved'>int</strong> <a href='../R/24307.html' title='Multiple referred from 2 places.'>php_openssl_is_private_key</a>(<a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a>* <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>)
<a id='L3493' name='L3493'></a>3493 <em class='brace'>{</em>
<a id='L3494' name='L3494'></a>3494         <a href='../S/1378.html#L85' title='Defined at 85 in main/php.h.'>assert</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3495' name='L3495'></a>3495 
<a id='L3496' name='L3496'></a>3496         <strong class='reserved'>switch</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>) <em class='brace'>{</em>
<a id='L3497' name='L3497'></a>3497 <em class='sharp'>#ifndef</em> NO_RSA
<a id='L3498' name='L3498'></a>3498                 <strong class='reserved'>case</strong> <a href='../Y/2134.html' title='Multiple used in 6 places.'>EVP_PKEY_RSA</a>:
<a id='L3499' name='L3499'></a>3499                 <strong class='reserved'>case</strong> <a href='../Y/2135.html' title='Multiple used in 6 places.'>EVP_PKEY_RSA2</a>:
<a id='L3500' name='L3500'></a>3500                         <a href='../S/1378.html#L85' title='Defined at 85 in main/php.h.'>assert</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3501' name='L3501'></a>3501                         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; (<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> == <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>-&gt;<a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a> || <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> == <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>-&gt;<a href='../Y/33830.html' title='Multiple used in 943 places.'>q</a>)) <em class='brace'>{</em>
<a id='L3502' name='L3502'></a>3502                                 <strong class='reserved'>return</strong> 0;
<a id='L3503' name='L3503'></a>3503                         <em class='brace'>}</em>
<a id='L3504' name='L3504'></a>3504                         <strong class='reserved'>break</strong>;
<a id='L3505' name='L3505'></a>3505 <em class='sharp'>#endif</em>
<a id='L3506' name='L3506'></a>3506 <em class='sharp'>#ifndef</em> <a href='../Y/4267.html' title='Multiple used in 3 places.'>NO_DSA</a>
<a id='L3507' name='L3507'></a>3507                 <strong class='reserved'>case</strong> <a href='../Y/2128.html' title='Multiple used in 2 places.'>EVP_PKEY_DSA</a>:
<a id='L3508' name='L3508'></a>3508                 <strong class='reserved'>case</strong> EVP_PKEY_DSA1:
<a id='L3509' name='L3509'></a>3509                 <strong class='reserved'>case</strong> <a href='../Y/2130.html' title='Multiple used in 2 places.'>EVP_PKEY_DSA2</a>:
<a id='L3510' name='L3510'></a>3510                 <strong class='reserved'>case</strong> <a href='../Y/2131.html' title='Multiple used in 2 places.'>EVP_PKEY_DSA3</a>:
<a id='L3511' name='L3511'></a>3511                 <strong class='reserved'>case</strong> <a href='../Y/2132.html' title='Multiple used in 2 places.'>EVP_PKEY_DSA4</a>:
<a id='L3512' name='L3512'></a>3512                         <a href='../S/1378.html#L85' title='Defined at 85 in main/php.h.'>assert</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3513' name='L3513'></a>3513 
<a id='L3514' name='L3514'></a>3514                         <strong class='reserved'>if</strong> (<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> == <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>-&gt;<a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a> || <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> == <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>-&gt;<a href='../Y/33830.html' title='Multiple used in 943 places.'>q</a> || <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> == <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>)<em class='brace'>{</em>
<a id='L3515' name='L3515'></a>3515                                 <strong class='reserved'>return</strong> 0;
<a id='L3516' name='L3516'></a>3516                         <em class='brace'>}</em>
<a id='L3517' name='L3517'></a>3517                         <strong class='reserved'>break</strong>;
<a id='L3518' name='L3518'></a>3518 <em class='sharp'>#endif</em>
<a id='L3519' name='L3519'></a>3519 <em class='sharp'>#ifndef</em> <a href='../Y/4266.html' title='Multiple used in 2 places.'>NO_DH</a>
<a id='L3520' name='L3520'></a>3520                 <strong class='reserved'>case</strong> <a href='../Y/2127.html' title='Multiple used in 3 places.'>EVP_PKEY_DH</a>:
<a id='L3521' name='L3521'></a>3521                         <a href='../S/1378.html#L85' title='Defined at 85 in main/php.h.'>assert</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3522' name='L3522'></a>3522 
<a id='L3523' name='L3523'></a>3523                         <strong class='reserved'>if</strong> (<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> == <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>-&gt;<a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a> || <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> == <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>) <em class='brace'>{</em>
<a id='L3524' name='L3524'></a>3524                                 <strong class='reserved'>return</strong> 0;
<a id='L3525' name='L3525'></a>3525                         <em class='brace'>}</em>
<a id='L3526' name='L3526'></a>3526                         <strong class='reserved'>break</strong>;
<a id='L3527' name='L3527'></a>3527 <em class='sharp'>#endif</em>
<a id='L3528' name='L3528'></a>3528 <em class='sharp'>#ifdef</em> <a href='../S/851.html#L86' title='Defined at 86 in ext/openssl/openssl.c.'>HAVE_EVP_PKEY_EC</a>
<a id='L3529' name='L3529'></a>3529                 <strong class='reserved'>case</strong> <a href='../Y/2133.html' title='Multiple used in 5 places.'>EVP_PKEY_EC</a>:
<a id='L3530' name='L3530'></a>3530                         <a href='../S/1378.html#L85' title='Defined at 85 in main/php.h.'>assert</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/16472.html' title='Multiple used in 32 places.'>ec</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3531' name='L3531'></a>3531 
<a id='L3532' name='L3532'></a>3532                         <strong class='reserved'>if</strong> ( <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> == EC_KEY_get0_private_key(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/16472.html' title='Multiple used in 32 places.'>ec</a>)) <em class='brace'>{</em>
<a id='L3533' name='L3533'></a>3533                                 <strong class='reserved'>return</strong> 0;
<a id='L3534' name='L3534'></a>3534                         <em class='brace'>}</em>
<a id='L3535' name='L3535'></a>3535                         <strong class='reserved'>break</strong>;
<a id='L3536' name='L3536'></a>3536 <em class='sharp'>#endif</em>
<a id='L3537' name='L3537'></a>3537                 <strong class='reserved'>default</strong>:
<a id='L3538' name='L3538'></a>3538                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "key type not supported in this PHP build!");
<a id='L3539' name='L3539'></a>3539                         <strong class='reserved'>break</strong>;
<a id='L3540' name='L3540'></a>3540         <em class='brace'>}</em>
<a id='L3541' name='L3541'></a>3541         <strong class='reserved'>return</strong> 1;
<a id='L3542' name='L3542'></a>3542 <em class='brace'>}</em>
<a id='L3543' name='L3543'></a>3543 <em class='comment'>/* }}} */</em>
<a id='L3544' name='L3544'></a>3544 
<a id='L3545' name='L3545'></a>3545 <em class='sharp'>#define</em> <a href='../R/5568.html' title='Multiple referred from 17 places.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/8384.html' title='Multiple used in 15 places.'>_type</a>, <a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>) <strong class='reserved'>do</strong> <em class='brace'>{</em>                                                  \
<a id='L3546' name='L3546'></a>3546                 <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/8384.html' title='Multiple used in 15 places.'>_type</a>-&gt;<a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>                                                  \
<a id='L3547' name='L3547'></a>3547                         <strong class='reserved'>int</strong> <a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a> = BN_num_bytes(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/8384.html' title='Multiple used in 15 places.'>_type</a>-&gt;<a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>);                        \
<a id='L3548' name='L3548'></a>3548                         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(<a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a>, 0);                           \
<a id='L3549' name='L3549'></a>3549                         BN_bn2bin(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/8384.html' title='Multiple used in 15 places.'>_type</a>-&gt;<a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>));      \
<a id='L3550' name='L3550'></a>3550                         <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>)[<a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a>] = 0;                                                                         \
<a id='L3551' name='L3551'></a>3551                         <a href='../S/1632.html#L405' title='Defined at 405 in Zend/zend_API.h.'>add_assoc_str</a>(&amp;<a href='../Y/8384.html' title='Multiple used in 15 places.'>_type</a>, #<a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>, <a href='../Y/37491.html' title='Multiple used in 4206 places.'>str</a>);                                                     \
<a id='L3552' name='L3552'></a>3552                 <em class='brace'>}</em>                                                                                                                               \
<a id='L3553' name='L3553'></a>3553         <em class='brace'>}</em> <strong class='reserved'>while</strong> (0)
<a id='L3554' name='L3554'></a>3554 
<a id='L3555' name='L3555'></a>3555 <em class='sharp'>#define</em> <a href='../R/5569.html' title='Multiple referred from 17 places.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1054.html#L8603' title='Defined at 8603 in ext/sqlite3/libsqlite/sqlite3.c.'>_ht</a>, <a href='../Y/8384.html' title='Multiple used in 15 places.'>_type</a>, <a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>) <strong class='reserved'>do</strong> <em class='brace'>{</em>                                             \
<a id='L3556' name='L3556'></a>3556                 <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../Y/12792.html' title='Multiple used in 20 places.'>bn</a>;                                                                                                               \
<a id='L3557' name='L3557'></a>3557                 <strong class='reserved'>if</strong> ((<a href='../Y/12792.html' title='Multiple used in 20 places.'>bn</a> = <a href='../S/1667.html#L1987' title='Defined at 1987 in Zend/zend_hash.c.'>zend_hash_str_find</a>(<a href='../S/1054.html#L8603' title='Defined at 8603 in ext/sqlite3/libsqlite/sqlite3.c.'>_ht</a>, #<a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>, <strong class='reserved'>sizeof</strong>(#<a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a>)-1)) != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; \
<a id='L3558' name='L3558'></a>3558                                 <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/12792.html' title='Multiple used in 20 places.'>bn</a>) == <a href='../S/1731.html#L308' title='Defined at 308 in Zend/zend_types.h.'>IS_STRING</a>) <em class='brace'>{</em>                                                    \
<a id='L3559' name='L3559'></a>3559                         <a href='../Y/8384.html' title='Multiple used in 15 places.'>_type</a>-&gt;<a href='../Y/8252.html' title='Multiple used in 22 places.'>_name</a> = <a href='../Y/249.html' title='Multiple used in 2 places.'>BN_bin2bn</a>(                                                                       \
<a id='L3560' name='L3560'></a>3560                                 (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/12792.html' title='Multiple used in 20 places.'>bn</a>),                                                 \
<a id='L3561' name='L3561'></a>3561                                 (<strong class='reserved'>int</strong>)<a href='../S/1731.html#L519' title='Defined at 519 in Zend/zend_types.h.'>Z_STRLEN_P</a>(<a href='../Y/12792.html' title='Multiple used in 20 places.'>bn</a>), <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);                                                                     \
<a id='L3562' name='L3562'></a>3562             <em class='brace'>}</em>                                                               \
<a id='L3563' name='L3563'></a>3563         <em class='brace'>}</em> <strong class='reserved'>while</strong> (0);
<a id='L3564' name='L3564'></a>3564 
<a id='L3565' name='L3565'></a>3565 
<a id='L3566' name='L3566'></a>3566 <em class='comment'>/* {{{ proto resource openssl_pkey_new([array configargs])</em>
<a id='L3567' name='L3567'></a>3567 <em class='comment'>   Generates a new private key */</em>
<a id='L3568' name='L3568'></a>3568 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29766.html' title='Multiple used in 3 places.'>openssl_pkey_new</a>)
<a id='L3569' name='L3569'></a>3569 <em class='brace'>{</em>
<a id='L3570' name='L3570'></a>3570         <strong class='reserved'>struct</strong> <a href='../S/851.html#L618' title='Defined at 618 in ext/openssl/openssl.c.'>php_x509_request</a> <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>;
<a id='L3571' name='L3571'></a>3571         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3572' name='L3572'></a>3572         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>;
<a id='L3573' name='L3573'></a>3573 
<a id='L3574' name='L3574'></a>3574         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "|a!", &amp;<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L3575' name='L3575'></a>3575                 <strong class='reserved'>return</strong>;
<a id='L3576' name='L3576'></a>3576         <em class='brace'>}</em>
<a id='L3577' name='L3577'></a>3577         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L3578' name='L3578'></a>3578 
<a id='L3579' name='L3579'></a>3579         <strong class='reserved'>if</strong> (<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a> &amp;&amp; <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>) == <a href='../S/1731.html#L309' title='Defined at 309 in Zend/zend_types.h.'>IS_ARRAY</a>) <em class='brace'>{</em>
<a id='L3580' name='L3580'></a>3580                 <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>;
<a id='L3581' name='L3581'></a>3581 
<a id='L3582' name='L3582'></a>3582                 <strong class='reserved'>if</strong> ((<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a> = <a href='../S/1667.html#L1987' title='Defined at 1987 in Zend/zend_hash.c.'>zend_hash_str_find</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>), "rsa", <strong class='reserved'>sizeof</strong>("rsa")-1)) != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp;
<a id='L3583' name='L3583'></a>3583                         <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>) == <a href='../S/1731.html#L309' title='Defined at 309 in Zend/zend_types.h.'>IS_ARRAY</a>) <em class='brace'>{</em>
<a id='L3584' name='L3584'></a>3584                         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../Y/2143.html' title='Multiple used in 4 places.'>EVP_PKEY_new</a>();
<a id='L3585' name='L3585'></a>3585                         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>) <em class='brace'>{</em>
<a id='L3586' name='L3586'></a>3586                                 <a href='../Y/5394.html' title='Multiple used in 9 places.'>RSA</a> *<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a> = <a href='../Y/5403.html' title='Multiple used in 3 places.'>RSA_new</a>();
<a id='L3587' name='L3587'></a>3587                                 <strong class='reserved'>if</strong> (<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>) <em class='brace'>{</em>
<a id='L3588' name='L3588'></a>3588                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../D/25111.html' title='Multiple defined in 3 places.'>n</a>);
<a id='L3589' name='L3589'></a>3589                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../Y/16391.html' title='Multiple used in 1069 places.'>e</a>);
<a id='L3590' name='L3590'></a>3590                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../Y/14948.html' title='Multiple used in 1519 places.'>d</a>);
<a id='L3591' name='L3591'></a>3591                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a>);
<a id='L3592' name='L3592'></a>3592                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../Y/33830.html' title='Multiple used in 943 places.'>q</a>);
<a id='L3593' name='L3593'></a>3593                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../Y/15848.html' title='Multiple used in 2 places.'>dmp1</a>);
<a id='L3594' name='L3594'></a>3594                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../Y/15849.html' title='Multiple used in 2 places.'>dmq1</a>);
<a id='L3595' name='L3595'></a>3595                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../Y/23596.html' title='Multiple used in 2 places.'>iqmp</a>);
<a id='L3596' name='L3596'></a>3596                                         <strong class='reserved'>if</strong> (<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>-&gt;<a href='../D/25111.html' title='Multiple defined in 3 places.'>n</a> &amp;&amp; <a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>-&gt;<a href='../Y/14948.html' title='Multiple used in 1519 places.'>d</a>) <em class='brace'>{</em>
<a id='L3597' name='L3597'></a>3597                                                 <strong class='reserved'>if</strong> (<a href='../Y/2138.html' title='Multiple used in 2 places.'>EVP_PKEY_assign_RSA</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>, <a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>)) <em class='brace'>{</em>
<a id='L3598' name='L3598'></a>3598                                                         <a href='../S/1632.html#L640' title='Defined at 640 in Zend/zend_API.h.'>RETURN_RES</a>(<a href='../S/1690.html#L94' title='Defined at 94 in Zend/zend_list.c.'>zend_register_resource</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>, <a href='../Y/24897.html' title='Multiple used in 14 places.'>le_key</a>));
<a id='L3599' name='L3599'></a>3599                                                 <em class='brace'>}</em>
<a id='L3600' name='L3600'></a>3600                                         <em class='brace'>}</em>
<a id='L3601' name='L3601'></a>3601                                         <a href='../Y/5400.html' title='Multiple used in 2 places.'>RSA_free</a>(<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>);
<a id='L3602' name='L3602'></a>3602                                 <em class='brace'>}</em>
<a id='L3603' name='L3603'></a>3603                                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L3604' name='L3604'></a>3604                         <em class='brace'>}</em>
<a id='L3605' name='L3605'></a>3605                         <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L3606' name='L3606'></a>3606                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong> ((<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a> = <a href='../S/1667.html#L1987' title='Defined at 1987 in Zend/zend_hash.c.'>zend_hash_str_find</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>), "dsa", <strong class='reserved'>sizeof</strong>("dsa") - 1)) != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp;
<a id='L3607' name='L3607'></a>3607                         <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>) == <a href='../S/1731.html#L309' title='Defined at 309 in Zend/zend_types.h.'>IS_ARRAY</a>) <em class='brace'>{</em>
<a id='L3608' name='L3608'></a>3608                         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../Y/2143.html' title='Multiple used in 4 places.'>EVP_PKEY_new</a>();
<a id='L3609' name='L3609'></a>3609                         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>) <em class='brace'>{</em>
<a id='L3610' name='L3610'></a>3610                                 <a href='../Y/1534.html' title='Multiple used in 2 places.'>DSA</a> *<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a> = DSA_new();
<a id='L3611' name='L3611'></a>3611                                 <strong class='reserved'>if</strong> (<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>) <em class='brace'>{</em>
<a id='L3612' name='L3612'></a>3612                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>, <a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a>);
<a id='L3613' name='L3613'></a>3613                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>, <a href='../Y/33830.html' title='Multiple used in 943 places.'>q</a>);
<a id='L3614' name='L3614'></a>3614                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>, <a href='../Y/18804.html' title='Multiple used in 242 places.'>g</a>);
<a id='L3615' name='L3615'></a>3615                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>, <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>);
<a id='L3616' name='L3616'></a>3616                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>, <a href='../Y/33720.html' title='Multiple used in 8 places.'>pub_key</a>);
<a id='L3617' name='L3617'></a>3617                                         <strong class='reserved'>if</strong> (<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>-&gt;<a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a> &amp;&amp; <a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>-&gt;<a href='../Y/33830.html' title='Multiple used in 943 places.'>q</a> &amp;&amp; <a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>-&gt;<a href='../Y/18804.html' title='Multiple used in 242 places.'>g</a>) <em class='brace'>{</em>
<a id='L3618' name='L3618'></a>3618                                                 <strong class='reserved'>if</strong> (!<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>-&gt;<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> &amp;&amp; !<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>-&gt;<a href='../Y/33720.html' title='Multiple used in 8 places.'>pub_key</a>) <em class='brace'>{</em>
<a id='L3619' name='L3619'></a>3619                                                         <a href='../Y/1536.html' title='Multiple used in 2 places.'>DSA_generate_key</a>(<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>);
<a id='L3620' name='L3620'></a>3620                                                 <em class='brace'>}</em>
<a id='L3621' name='L3621'></a>3621                                                 <strong class='reserved'>if</strong> (<a href='../Y/2137.html' title='Multiple used in 2 places.'>EVP_PKEY_assign_DSA</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>, <a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>)) <em class='brace'>{</em>
<a id='L3622' name='L3622'></a>3622                                                         <a href='../S/1632.html#L640' title='Defined at 640 in Zend/zend_API.h.'>RETURN_RES</a>(<a href='../S/1690.html#L94' title='Defined at 94 in Zend/zend_list.c.'>zend_register_resource</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>, <a href='../Y/24897.html' title='Multiple used in 14 places.'>le_key</a>));
<a id='L3623' name='L3623'></a>3623                                                 <em class='brace'>}</em>
<a id='L3624' name='L3624'></a>3624                                         <em class='brace'>}</em>
<a id='L3625' name='L3625'></a>3625                                         <a href='../Y/1535.html' title='Multiple used in 2 places.'>DSA_free</a>(<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>);
<a id='L3626' name='L3626'></a>3626                                 <em class='brace'>}</em>
<a id='L3627' name='L3627'></a>3627                                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L3628' name='L3628'></a>3628                         <em class='brace'>}</em>
<a id='L3629' name='L3629'></a>3629                         <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L3630' name='L3630'></a>3630                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong> ((<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a> = <a href='../S/1667.html#L1987' title='Defined at 1987 in Zend/zend_hash.c.'>zend_hash_str_find</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>), "dh", <strong class='reserved'>sizeof</strong>("dh") - 1)) != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp;
<a id='L3631' name='L3631'></a>3631                         <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>) == <a href='../S/1731.html#L309' title='Defined at 309 in Zend/zend_types.h.'>IS_ARRAY</a>) <em class='brace'>{</em>
<a id='L3632' name='L3632'></a>3632                         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../Y/2143.html' title='Multiple used in 4 places.'>EVP_PKEY_new</a>();
<a id='L3633' name='L3633'></a>3633                         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>) <em class='brace'>{</em>
<a id='L3634' name='L3634'></a>3634                                 <a href='../Y/1449.html' title='Multiple used in 9 places.'>DH</a> *<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a> = DH_new();
<a id='L3635' name='L3635'></a>3635                                 <strong class='reserved'>if</strong> (<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>) <em class='brace'>{</em>
<a id='L3636' name='L3636'></a>3636                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>, <a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a>);
<a id='L3637' name='L3637'></a>3637                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>, <a href='../Y/18804.html' title='Multiple used in 242 places.'>g</a>);
<a id='L3638' name='L3638'></a>3638                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>, <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>);
<a id='L3639' name='L3639'></a>3639                                         <a href='../S/851.html#L3555' title='Defined at 3555 in ext/openssl/openssl.c.'>OPENSSL_PKEY_SET_BN</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>, <a href='../Y/33720.html' title='Multiple used in 8 places.'>pub_key</a>);
<a id='L3640' name='L3640'></a>3640                                         <strong class='reserved'>if</strong> (<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>-&gt;<a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a> &amp;&amp; <a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>-&gt;<a href='../Y/18804.html' title='Multiple used in 242 places.'>g</a> &amp;&amp;
<a id='L3641' name='L3641'></a>3641                                                         (<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>-&gt;<a href='../Y/33720.html' title='Multiple used in 8 places.'>pub_key</a> || <a href='../Y/1453.html' title='Multiple used in 2 places.'>DH_generate_key</a>(<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>)) &amp;&amp;
<a id='L3642' name='L3642'></a>3642                                                         <a href='../Y/2136.html' title='Multiple used in 2 places.'>EVP_PKEY_assign_DH</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>, <a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>)) <em class='brace'>{</em>
<a id='L3643' name='L3643'></a>3643                                                 <a href='../S/1731.html#L848' title='Defined at 848 in Zend/zend_types.h.'>ZVAL_COPY_VALUE</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, <a href='../S/1690.html#L34' title='Defined at 34 in Zend/zend_list.c.'>zend_list_insert</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>, <a href='../Y/24897.html' title='Multiple used in 14 places.'>le_key</a>));
<a id='L3644' name='L3644'></a>3644                                                 <strong class='reserved'>return</strong>;
<a id='L3645' name='L3645'></a>3645                                         <em class='brace'>}</em>
<a id='L3646' name='L3646'></a>3646                                         <a href='../Y/1452.html' title='Multiple used in 4 places.'>DH_free</a>(<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>);
<a id='L3647' name='L3647'></a>3647                                 <em class='brace'>}</em>
<a id='L3648' name='L3648'></a>3648                                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L3649' name='L3649'></a>3649                         <em class='brace'>}</em>
<a id='L3650' name='L3650'></a>3650                         <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L3651' name='L3651'></a>3651                 <em class='brace'>}</em>
<a id='L3652' name='L3652'></a>3652         <em class='brace'>}</em>
<a id='L3653' name='L3653'></a>3653 
<a id='L3654' name='L3654'></a>3654         <a href='../S/851.html#L859' title='Defined at 859 in ext/openssl/openssl.c.'>PHP_SSL_REQ_INIT</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>);
<a id='L3655' name='L3655'></a>3655 
<a id='L3656' name='L3656'></a>3656         <strong class='reserved'>if</strong> (<a href='../S/851.html#L861' title='Defined at 861 in ext/openssl/openssl.c.'>PHP_SSL_REQ_PARSE</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>, <a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>) == <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>)
<a id='L3657' name='L3657'></a>3657         <em class='brace'>{</em>
<a id='L3658' name='L3658'></a>3658                 <strong class='reserved'>if</strong> (<a href='../S/851.html#L3387' title='Defined at 3387 in ext/openssl/openssl.c.'>php_openssl_generate_private_key</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>)) <em class='brace'>{</em>
<a id='L3659' name='L3659'></a>3659                         <em class='comment'>/* pass back a key resource */</em>
<a id='L3660' name='L3660'></a>3660                         <a href='../S/1632.html#L622' title='Defined at 622 in Zend/zend_API.h.'>RETVAL_RES</a>(<a href='../S/1690.html#L94' title='Defined at 94 in Zend/zend_list.c.'>zend_register_resource</a>(<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>, <a href='../Y/24897.html' title='Multiple used in 14 places.'>le_key</a>));
<a id='L3661' name='L3661'></a>3661                         <em class='comment'>/* make sure the cleanup code doesn't zap it! */</em>
<a id='L3662' name='L3662'></a>3662                         <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3663' name='L3663'></a>3663                 <em class='brace'>}</em>
<a id='L3664' name='L3664'></a>3664         <em class='brace'>}</em>
<a id='L3665' name='L3665'></a>3665         <a href='../S/851.html#L860' title='Defined at 860 in ext/openssl/openssl.c.'>PHP_SSL_REQ_DISPOSE</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>);
<a id='L3666' name='L3666'></a>3666 <em class='brace'>}</em>
<a id='L3667' name='L3667'></a>3667 <em class='comment'>/* }}} */</em>
<a id='L3668' name='L3668'></a>3668 
<a id='L3669' name='L3669'></a>3669 <em class='comment'>/* {{{ proto bool openssl_pkey_export_to_file(mixed key, string outfilename [, string passphrase, array config_args)</em>
<a id='L3670' name='L3670'></a>3670 <em class='comment'>   Gets an exportable representation of a key into a file */</em>
<a id='L3671' name='L3671'></a>3671 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29761.html' title='Multiple used in 3 places.'>openssl_pkey_export_to_file</a>)
<a id='L3672' name='L3672'></a>3672 <em class='brace'>{</em>
<a id='L3673' name='L3673'></a>3673         <strong class='reserved'>struct</strong> <a href='../S/851.html#L618' title='Defined at 618 in ext/openssl/openssl.c.'>php_x509_request</a> <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>;
<a id='L3674' name='L3674'></a>3674         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, * <a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3675' name='L3675'></a>3675         <strong class='reserved'>char</strong> * <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3676' name='L3676'></a>3676         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/31253.html' title='Multiple used in 12 places.'>passphrase_len</a> = 0;
<a id='L3677' name='L3677'></a>3677         <strong class='reserved'>char</strong> * <a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3678' name='L3678'></a>3678         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/17892.html' title='Multiple used in 356 places.'>filename_len</a> = 0;
<a id='L3679' name='L3679'></a>3679         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/24467.html' title='Multiple used in 9 places.'>key_resource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3680' name='L3680'></a>3680         <strong class='reserved'>int</strong> <a href='../Y/31619.html' title='Multiple used in 8 places.'>pem_write</a> = 0;
<a id='L3681' name='L3681'></a>3681         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>;
<a id='L3682' name='L3682'></a>3682         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3683' name='L3683'></a>3683         <strong class='reserved'>const</strong> <a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>;
<a id='L3684' name='L3684'></a>3684 
<a id='L3685' name='L3685'></a>3685         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "zp|s!a!", &amp;<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, &amp;<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>, &amp;<a href='../Y/17892.html' title='Multiple used in 356 places.'>filename_len</a>, &amp;<a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>, &amp;<a href='../Y/31253.html' title='Multiple used in 12 places.'>passphrase_len</a>, &amp;<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L3686' name='L3686'></a>3686                 <strong class='reserved'>return</strong>;
<a id='L3687' name='L3687'></a>3687         <em class='brace'>}</em>
<a id='L3688' name='L3688'></a>3688         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L3689' name='L3689'></a>3689 
<a id='L3690' name='L3690'></a>3690         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/31253.html' title='Multiple used in 12 places.'>passphrase_len</a>, <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>);
<a id='L3691' name='L3691'></a>3691 
<a id='L3692' name='L3692'></a>3692         <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, 0, <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>, 0, &amp;<a href='../Y/24467.html' title='Multiple used in 9 places.'>key_resource</a>);
<a id='L3693' name='L3693'></a>3693 
<a id='L3694' name='L3694'></a>3694         <strong class='reserved'>if</strong> (<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3695' name='L3695'></a>3695                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "cannot get key from parameter 1");
<a id='L3696' name='L3696'></a>3696                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L3697' name='L3697'></a>3697         <em class='brace'>}</em>
<a id='L3698' name='L3698'></a>3698 
<a id='L3699' name='L3699'></a>3699         <strong class='reserved'>if</strong> (<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>)) <em class='brace'>{</em>
<a id='L3700' name='L3700'></a>3700                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L3701' name='L3701'></a>3701         <em class='brace'>}</em>
<a id='L3702' name='L3702'></a>3702 
<a id='L3703' name='L3703'></a>3703         <a href='../S/851.html#L859' title='Defined at 859 in ext/openssl/openssl.c.'>PHP_SSL_REQ_INIT</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>);
<a id='L3704' name='L3704'></a>3704 
<a id='L3705' name='L3705'></a>3705         <strong class='reserved'>if</strong> (<a href='../S/851.html#L861' title='Defined at 861 in ext/openssl/openssl.c.'>PHP_SSL_REQ_PARSE</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>, <a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>) == <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>) <em class='brace'>{</em>
<a id='L3706' name='L3706'></a>3706                 <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>, "w");
<a id='L3707' name='L3707'></a>3707 
<a id='L3708' name='L3708'></a>3708                 <strong class='reserved'>if</strong> (<a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a> &amp;&amp; <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33387.html' title='Multiple used in 7 places.'>priv_key_encrypt</a>) <em class='brace'>{</em>
<a id='L3709' name='L3709'></a>3709                         <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33388.html' title='Multiple used in 7 places.'>priv_key_encrypt_cipher</a>) <em class='brace'>{</em>
<a id='L3710' name='L3710'></a>3710                                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> = <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33388.html' title='Multiple used in 7 places.'>priv_key_encrypt_cipher</a>;
<a id='L3711' name='L3711'></a>3711                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3712' name='L3712'></a>3712                                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> = (<a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a> *) <a href='../Y/2160.html' title='Multiple used in 3 places.'>EVP_des_ede3_cbc</a>();
<a id='L3713' name='L3713'></a>3713                         <em class='brace'>}</em>
<a id='L3714' name='L3714'></a>3714                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3715' name='L3715'></a>3715                         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3716' name='L3716'></a>3716                 <em class='brace'>}</em>
<a id='L3717' name='L3717'></a>3717 
<a id='L3718' name='L3718'></a>3718                 <strong class='reserved'>switch</strong> (<a href='../Y/2145.html' title='Multiple used in 4 places.'>EVP_PKEY_type</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>-&gt;<a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>)) <em class='brace'>{</em>
<a id='L3719' name='L3719'></a>3719 <em class='sharp'>#ifdef</em> <a href='../S/851.html#L86' title='Defined at 86 in ext/openssl/openssl.c.'>HAVE_EVP_PKEY_EC</a>
<a id='L3720' name='L3720'></a>3720                         <strong class='reserved'>case</strong> <a href='../Y/2133.html' title='Multiple used in 5 places.'>EVP_PKEY_EC</a>:
<a id='L3721' name='L3721'></a>3721                                 <a href='../Y/31619.html' title='Multiple used in 8 places.'>pem_write</a> = <a href='../Y/4932.html' title='Multiple used in 2 places.'>PEM_write_bio_ECPrivateKey</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../Y/2142.html' title='Multiple used in 3 places.'>EVP_PKEY_get1_EC_KEY</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>), <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>, (<strong class='reserved'>int</strong>)<a href='../Y/31253.html' title='Multiple used in 12 places.'>passphrase_len</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3722' name='L3722'></a>3722                                 <strong class='reserved'>break</strong>;
<a id='L3723' name='L3723'></a>3723 <em class='sharp'>#endif</em>
<a id='L3724' name='L3724'></a>3724                         <strong class='reserved'>default</strong>:
<a id='L3725' name='L3725'></a>3725                                 <a href='../Y/31619.html' title='Multiple used in 8 places.'>pem_write</a> = <a href='../Y/4934.html' title='Multiple used in 3 places.'>PEM_write_bio_PrivateKey</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>, (<strong class='reserved'>int</strong>)<a href='../Y/31253.html' title='Multiple used in 12 places.'>passphrase_len</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3726' name='L3726'></a>3726                                 <strong class='reserved'>break</strong>;
<a id='L3727' name='L3727'></a>3727                 <em class='brace'>}</em>
<a id='L3728' name='L3728'></a>3728 
<a id='L3729' name='L3729'></a>3729                 <strong class='reserved'>if</strong> (<a href='../Y/31619.html' title='Multiple used in 8 places.'>pem_write</a>) <em class='brace'>{</em>
<a id='L3730' name='L3730'></a>3730                         <em class='comment'>/* Success!</em>
<a id='L3731' name='L3731'></a>3731 <em class='comment'>                         * If returning the output as a string, do so now */</em>
<a id='L3732' name='L3732'></a>3732                         <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L3733' name='L3733'></a>3733                 <em class='brace'>}</em>
<a id='L3734' name='L3734'></a>3734         <em class='brace'>}</em>
<a id='L3735' name='L3735'></a>3735         <a href='../S/851.html#L860' title='Defined at 860 in ext/openssl/openssl.c.'>PHP_SSL_REQ_DISPOSE</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>);
<a id='L3736' name='L3736'></a>3736 
<a id='L3737' name='L3737'></a>3737         <strong class='reserved'>if</strong> (<a href='../Y/24467.html' title='Multiple used in 9 places.'>key_resource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>) <em class='brace'>{</em>
<a id='L3738' name='L3738'></a>3738                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>);
<a id='L3739' name='L3739'></a>3739         <em class='brace'>}</em>
<a id='L3740' name='L3740'></a>3740         <strong class='reserved'>if</strong> (<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>) <em class='brace'>{</em>
<a id='L3741' name='L3741'></a>3741                 <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>);
<a id='L3742' name='L3742'></a>3742         <em class='brace'>}</em>
<a id='L3743' name='L3743'></a>3743 <em class='brace'>}</em>
<a id='L3744' name='L3744'></a>3744 <em class='comment'>/* }}} */</em>
<a id='L3745' name='L3745'></a>3745 
<a id='L3746' name='L3746'></a>3746 <em class='comment'>/* {{{ proto bool openssl_pkey_export(mixed key, &amp;mixed out [, string passphrase [, array config_args]])</em>
<a id='L3747' name='L3747'></a>3747 <em class='comment'>   Gets an exportable representation of a key into a string or file */</em>
<a id='L3748' name='L3748'></a>3748 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29760.html' title='Multiple used in 3 places.'>openssl_pkey_export</a>)
<a id='L3749' name='L3749'></a>3749 <em class='brace'>{</em>
<a id='L3750' name='L3750'></a>3750         <strong class='reserved'>struct</strong> <a href='../S/851.html#L618' title='Defined at 618 in ext/openssl/openssl.c.'>php_x509_request</a> <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>;
<a id='L3751' name='L3751'></a>3751         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, * <a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, *<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>;
<a id='L3752' name='L3752'></a>3752         <strong class='reserved'>char</strong> * <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>; <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/31253.html' title='Multiple used in 12 places.'>passphrase_len</a> = 0;
<a id='L3753' name='L3753'></a>3753         <strong class='reserved'>int</strong> <a href='../Y/31619.html' title='Multiple used in 8 places.'>pem_write</a> = 0;
<a id='L3754' name='L3754'></a>3754         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/24467.html' title='Multiple used in 9 places.'>key_resource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3755' name='L3755'></a>3755         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>;
<a id='L3756' name='L3756'></a>3756         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3757' name='L3757'></a>3757         <strong class='reserved'>const</strong> <a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>;
<a id='L3758' name='L3758'></a>3758 
<a id='L3759' name='L3759'></a>3759         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "zz/|s!a!", &amp;<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, &amp;<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>, &amp;<a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>, &amp;<a href='../Y/31253.html' title='Multiple used in 12 places.'>passphrase_len</a>, &amp;<a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L3760' name='L3760'></a>3760                 <strong class='reserved'>return</strong>;
<a id='L3761' name='L3761'></a>3761         <em class='brace'>}</em>
<a id='L3762' name='L3762'></a>3762         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L3763' name='L3763'></a>3763 
<a id='L3764' name='L3764'></a>3764         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/31253.html' title='Multiple used in 12 places.'>passphrase_len</a>, <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>);
<a id='L3765' name='L3765'></a>3765 
<a id='L3766' name='L3766'></a>3766         <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../Y/44075.html' title='Multiple used in 21 places.'>zpkey</a>, 0, <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>, 0, &amp;<a href='../Y/24467.html' title='Multiple used in 9 places.'>key_resource</a>);
<a id='L3767' name='L3767'></a>3767 
<a id='L3768' name='L3768'></a>3768         <strong class='reserved'>if</strong> (<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3769' name='L3769'></a>3769                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "cannot get key from parameter 1");
<a id='L3770' name='L3770'></a>3770                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L3771' name='L3771'></a>3771         <em class='brace'>}</em>
<a id='L3772' name='L3772'></a>3772 
<a id='L3773' name='L3773'></a>3773         <a href='../S/851.html#L859' title='Defined at 859 in ext/openssl/openssl.c.'>PHP_SSL_REQ_INIT</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>);
<a id='L3774' name='L3774'></a>3774 
<a id='L3775' name='L3775'></a>3775         <strong class='reserved'>if</strong> (<a href='../S/851.html#L861' title='Defined at 861 in ext/openssl/openssl.c.'>PHP_SSL_REQ_PARSE</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>, <a href='../Y/11895.html' title='Multiple used in 1378 places.'>args</a>) == <a href='../D/12761.html' title='Multiple defined in 2 places.'>SUCCESS</a>) <em class='brace'>{</em>
<a id='L3776' name='L3776'></a>3776                 <a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a> = <a href='../Y/231.html' title='Multiple used in 12 places.'>BIO_new</a>(<a href='../Y/237.html' title='Multiple used in 12 places.'>BIO_s_mem</a>());
<a id='L3777' name='L3777'></a>3777 
<a id='L3778' name='L3778'></a>3778                 <strong class='reserved'>if</strong> (<a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a> &amp;&amp; <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33387.html' title='Multiple used in 7 places.'>priv_key_encrypt</a>) <em class='brace'>{</em>
<a id='L3779' name='L3779'></a>3779                         <strong class='reserved'>if</strong> (<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33388.html' title='Multiple used in 7 places.'>priv_key_encrypt_cipher</a>) <em class='brace'>{</em>
<a id='L3780' name='L3780'></a>3780                                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> = <a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>.<a href='../Y/33388.html' title='Multiple used in 7 places.'>priv_key_encrypt_cipher</a>;
<a id='L3781' name='L3781'></a>3781                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3782' name='L3782'></a>3782                                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> = (<a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a> *) <a href='../Y/2160.html' title='Multiple used in 3 places.'>EVP_des_ede3_cbc</a>();
<a id='L3783' name='L3783'></a>3783                         <em class='brace'>}</em>
<a id='L3784' name='L3784'></a>3784                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L3785' name='L3785'></a>3785                         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L3786' name='L3786'></a>3786                 <em class='brace'>}</em>
<a id='L3787' name='L3787'></a>3787 
<a id='L3788' name='L3788'></a>3788                 <strong class='reserved'>switch</strong> (<a href='../Y/2145.html' title='Multiple used in 4 places.'>EVP_PKEY_type</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>-&gt;<a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>)) <em class='brace'>{</em>
<a id='L3789' name='L3789'></a>3789 <em class='sharp'>#ifdef</em> <a href='../S/851.html#L86' title='Defined at 86 in ext/openssl/openssl.c.'>HAVE_EVP_PKEY_EC</a>
<a id='L3790' name='L3790'></a>3790                         <strong class='reserved'>case</strong> <a href='../Y/2133.html' title='Multiple used in 5 places.'>EVP_PKEY_EC</a>:
<a id='L3791' name='L3791'></a>3791                                 <a href='../Y/31619.html' title='Multiple used in 8 places.'>pem_write</a> = <a href='../Y/4932.html' title='Multiple used in 2 places.'>PEM_write_bio_ECPrivateKey</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../Y/2142.html' title='Multiple used in 3 places.'>EVP_PKEY_get1_EC_KEY</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>), <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>, (<strong class='reserved'>int</strong>)<a href='../Y/31253.html' title='Multiple used in 12 places.'>passphrase_len</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3792' name='L3792'></a>3792                                 <strong class='reserved'>break</strong>;
<a id='L3793' name='L3793'></a>3793 <em class='sharp'>#endif</em>
<a id='L3794' name='L3794'></a>3794                         <strong class='reserved'>default</strong>:
<a id='L3795' name='L3795'></a>3795                                 <a href='../Y/31619.html' title='Multiple used in 8 places.'>pem_write</a> = <a href='../Y/4934.html' title='Multiple used in 3 places.'>PEM_write_bio_PrivateKey</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>, (<strong class='reserved'>int</strong>)<a href='../Y/31253.html' title='Multiple used in 12 places.'>passphrase_len</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L3796' name='L3796'></a>3796                                 <strong class='reserved'>break</strong>;
<a id='L3797' name='L3797'></a>3797                 <em class='brace'>}</em>
<a id='L3798' name='L3798'></a>3798 
<a id='L3799' name='L3799'></a>3799                 <strong class='reserved'>if</strong> (<a href='../Y/31619.html' title='Multiple used in 8 places.'>pem_write</a>) <em class='brace'>{</em>
<a id='L3800' name='L3800'></a>3800                         <em class='comment'>/* Success!</em>
<a id='L3801' name='L3801'></a>3801 <em class='comment'>                         * If returning the output as a string, do so now */</em>
<a id='L3802' name='L3802'></a>3802 
<a id='L3803' name='L3803'></a>3803                         <strong class='reserved'>char</strong> * <a href='../Y/12673.html' title='Multiple used in 3 places.'>bio_mem_ptr</a>;
<a id='L3804' name='L3804'></a>3804                         <strong class='reserved'>long</strong> <a href='../Y/12672.html' title='Multiple used in 3 places.'>bio_mem_len</a>;
<a id='L3805' name='L3805'></a>3805                         <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L3806' name='L3806'></a>3806 
<a id='L3807' name='L3807'></a>3807                         <a href='../Y/12672.html' title='Multiple used in 3 places.'>bio_mem_len</a> = <a href='../Y/229.html' title='Multiple used in 2 places.'>BIO_get_mem_data</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>, &amp;<a href='../Y/12673.html' title='Multiple used in 3 places.'>bio_mem_ptr</a>);
<a id='L3808' name='L3808'></a>3808                         <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>);
<a id='L3809' name='L3809'></a>3809                         <a href='../S/1632.html#L568' title='Defined at 568 in Zend/zend_API.h.'>ZVAL_STRINGL</a>(<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>, <a href='../Y/12673.html' title='Multiple used in 3 places.'>bio_mem_ptr</a>, <a href='../Y/12672.html' title='Multiple used in 3 places.'>bio_mem_len</a>);
<a id='L3810' name='L3810'></a>3810                 <em class='brace'>}</em>
<a id='L3811' name='L3811'></a>3811         <em class='brace'>}</em>
<a id='L3812' name='L3812'></a>3812         <a href='../S/851.html#L860' title='Defined at 860 in ext/openssl/openssl.c.'>PHP_SSL_REQ_DISPOSE</a>(&amp;<a href='../Y/34541.html' title='Multiple used in 401 places.'>req</a>);
<a id='L3813' name='L3813'></a>3813 
<a id='L3814' name='L3814'></a>3814         <strong class='reserved'>if</strong> (<a href='../Y/24467.html' title='Multiple used in 9 places.'>key_resource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>) <em class='brace'>{</em>
<a id='L3815' name='L3815'></a>3815                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>);
<a id='L3816' name='L3816'></a>3816         <em class='brace'>}</em>
<a id='L3817' name='L3817'></a>3817         <strong class='reserved'>if</strong> (<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>) <em class='brace'>{</em>
<a id='L3818' name='L3818'></a>3818                 <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/12674.html' title='Multiple used in 68 places.'>bio_out</a>);
<a id='L3819' name='L3819'></a>3819         <em class='brace'>}</em>
<a id='L3820' name='L3820'></a>3820 <em class='brace'>}</em>
<a id='L3821' name='L3821'></a>3821 <em class='comment'>/* }}} */</em>
<a id='L3822' name='L3822'></a>3822 
<a id='L3823' name='L3823'></a>3823 <em class='comment'>/* {{{ proto int openssl_pkey_get_public(mixed cert)</em>
<a id='L3824' name='L3824'></a>3824 <em class='comment'>   Gets public key from X.509 certificate */</em>
<a id='L3825' name='L3825'></a>3825 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29765.html' title='Multiple used in 4 places.'>openssl_pkey_get_public</a>)
<a id='L3826' name='L3826'></a>3826 <em class='brace'>{</em>
<a id='L3827' name='L3827'></a>3827         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>;
<a id='L3828' name='L3828'></a>3828         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>;
<a id='L3829' name='L3829'></a>3829         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>;
<a id='L3830' name='L3830'></a>3830 
<a id='L3831' name='L3831'></a>3831         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "z", &amp;<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L3832' name='L3832'></a>3832                 <strong class='reserved'>return</strong>;
<a id='L3833' name='L3833'></a>3833         <em class='brace'>}</em>
<a id='L3834' name='L3834'></a>3834         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, 1, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, 1, &amp;<a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>);
<a id='L3835' name='L3835'></a>3835         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3836' name='L3836'></a>3836                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L3837' name='L3837'></a>3837         <em class='brace'>}</em>
<a id='L3838' name='L3838'></a>3838         <a href='../S/1731.html#L685' title='Defined at 685 in Zend/zend_types.h.'>ZVAL_RES</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, <a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>);
<a id='L3839' name='L3839'></a>3839         <a href='../D/17793.html' title='Multiple defined in 3 places.'>Z_ADDREF_P</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>);
<a id='L3840' name='L3840'></a>3840 <em class='brace'>}</em>
<a id='L3841' name='L3841'></a>3841 <em class='comment'>/* }}} */</em>
<a id='L3842' name='L3842'></a>3842 
<a id='L3843' name='L3843'></a>3843 <em class='comment'>/* {{{ proto void openssl_pkey_free(int key)</em>
<a id='L3844' name='L3844'></a>3844 <em class='comment'>   Frees a key */</em>
<a id='L3845' name='L3845'></a>3845 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29762.html' title='Multiple used in 4 places.'>openssl_pkey_free</a>)
<a id='L3846' name='L3846'></a>3846 <em class='brace'>{</em>
<a id='L3847' name='L3847'></a>3847         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>;
<a id='L3848' name='L3848'></a>3848         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>;
<a id='L3849' name='L3849'></a>3849 
<a id='L3850' name='L3850'></a>3850         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "r", &amp;<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L3851' name='L3851'></a>3851                 <strong class='reserved'>return</strong>;
<a id='L3852' name='L3852'></a>3852         <em class='brace'>}</em>
<a id='L3853' name='L3853'></a>3853         <strong class='reserved'>if</strong> ((<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = (<a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *)<a href='../S/1690.html#L124' title='Defined at 124 in Zend/zend_list.c.'>zend_fetch_resource</a>(<a href='../S/1731.html#L552' title='Defined at 552 in Zend/zend_types.h.'>Z_RES_P</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>), "OpenSSL key", <a href='../Y/24897.html' title='Multiple used in 14 places.'>le_key</a>)) == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3854' name='L3854'></a>3854                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L3855' name='L3855'></a>3855         <em class='brace'>}</em>
<a id='L3856' name='L3856'></a>3856         <a href='../S/1690.html#L84' title='Defined at 84 in Zend/zend_list.c.'>zend_list_close</a>(<a href='../S/1731.html#L552' title='Defined at 552 in Zend/zend_types.h.'>Z_RES_P</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>));
<a id='L3857' name='L3857'></a>3857 <em class='brace'>}</em>
<a id='L3858' name='L3858'></a>3858 <em class='comment'>/* }}} */</em>
<a id='L3859' name='L3859'></a>3859 
<a id='L3860' name='L3860'></a>3860 <em class='comment'>/* {{{ proto int openssl_pkey_get_private(string key [, string passphrase])</em>
<a id='L3861' name='L3861'></a>3861 <em class='comment'>   Gets private keys */</em>
<a id='L3862' name='L3862'></a>3862 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29764.html' title='Multiple used in 4 places.'>openssl_pkey_get_private</a>)
<a id='L3863' name='L3863'></a>3863 <em class='brace'>{</em>
<a id='L3864' name='L3864'></a>3864         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>;
<a id='L3865' name='L3865'></a>3865         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>;
<a id='L3866' name='L3866'></a>3866         <strong class='reserved'>char</strong> * <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a> = "";
<a id='L3867' name='L3867'></a>3867         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/31253.html' title='Multiple used in 12 places.'>passphrase_len</a> = <strong class='reserved'>sizeof</strong>("")-1;
<a id='L3868' name='L3868'></a>3868         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>;
<a id='L3869' name='L3869'></a>3869 
<a id='L3870' name='L3870'></a>3870         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "z|s", &amp;<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, &amp;<a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>, &amp;<a href='../Y/31253.html' title='Multiple used in 12 places.'>passphrase_len</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L3871' name='L3871'></a>3871                 <strong class='reserved'>return</strong>;
<a id='L3872' name='L3872'></a>3872         <em class='brace'>}</em>
<a id='L3873' name='L3873'></a>3873         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, 0, <a href='../Y/31252.html' title='Multiple used in 28 places.'>passphrase</a>, 1, &amp;<a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>);
<a id='L3874' name='L3874'></a>3874 
<a id='L3875' name='L3875'></a>3875         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3876' name='L3876'></a>3876                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L3877' name='L3877'></a>3877         <em class='brace'>}</em>
<a id='L3878' name='L3878'></a>3878         <a href='../S/1731.html#L685' title='Defined at 685 in Zend/zend_types.h.'>ZVAL_RES</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, <a href='../Y/34609.html' title='Multiple used in 1498 places.'>res</a>);
<a id='L3879' name='L3879'></a>3879         <a href='../D/17793.html' title='Multiple defined in 3 places.'>Z_ADDREF_P</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>);
<a id='L3880' name='L3880'></a>3880 <em class='brace'>}</em>
<a id='L3881' name='L3881'></a>3881 
<a id='L3882' name='L3882'></a>3882 <em class='comment'>/* }}} */</em>
<a id='L3883' name='L3883'></a>3883 
<a id='L3884' name='L3884'></a>3884 <em class='comment'>/* {{{ proto resource openssl_pkey_get_details(resource key)</em>
<a id='L3885' name='L3885'></a>3885 <em class='comment'>        returns an array with the key details (bits, pkey, type)*/</em>
<a id='L3886' name='L3886'></a>3886 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29763.html' title='Multiple used in 3 places.'>openssl_pkey_get_details</a>)
<a id='L3887' name='L3887'></a>3887 <em class='brace'>{</em>
<a id='L3888' name='L3888'></a>3888         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>;
<a id='L3889' name='L3889'></a>3889         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>;
<a id='L3890' name='L3890'></a>3890         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> *<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>;
<a id='L3891' name='L3891'></a>3891         <strong class='reserved'>unsigned</strong> <strong class='reserved'>int</strong> <a href='../Y/31344.html' title='Multiple used in 3 places.'>pbio_len</a>;
<a id='L3892' name='L3892'></a>3892         <strong class='reserved'>char</strong> *<a href='../Y/31343.html' title='Multiple used in 3 places.'>pbio</a>;
<a id='L3893' name='L3893'></a>3893         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/24527.html' title='Multiple used in 7 places.'>ktype</a>;
<a id='L3894' name='L3894'></a>3894 
<a id='L3895' name='L3895'></a>3895         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "r", &amp;<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L3896' name='L3896'></a>3896                 <strong class='reserved'>return</strong>;
<a id='L3897' name='L3897'></a>3897         <em class='brace'>}</em>
<a id='L3898' name='L3898'></a>3898         <strong class='reserved'>if</strong> ((<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = (<a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *)<a href='../S/1690.html#L124' title='Defined at 124 in Zend/zend_list.c.'>zend_fetch_resource</a>(<a href='../S/1731.html#L552' title='Defined at 552 in Zend/zend_types.h.'>Z_RES_P</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>), "OpenSSL key", <a href='../Y/24897.html' title='Multiple used in 14 places.'>le_key</a>)) == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3899' name='L3899'></a>3899                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L3900' name='L3900'></a>3900         <em class='brace'>}</em>
<a id='L3901' name='L3901'></a>3901         <a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a> = <a href='../Y/231.html' title='Multiple used in 12 places.'>BIO_new</a>(<a href='../Y/237.html' title='Multiple used in 12 places.'>BIO_s_mem</a>());
<a id='L3902' name='L3902'></a>3902         <a href='../Y/4933.html' title='Multiple used in 2 places.'>PEM_write_bio_PUBKEY</a>(<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>, <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L3903' name='L3903'></a>3903         <a href='../Y/31344.html' title='Multiple used in 3 places.'>pbio_len</a> = <a href='../Y/229.html' title='Multiple used in 2 places.'>BIO_get_mem_data</a>(<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>, &amp;<a href='../Y/31343.html' title='Multiple used in 3 places.'>pbio</a>);
<a id='L3904' name='L3904'></a>3904 
<a id='L3905' name='L3905'></a>3905         <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>);
<a id='L3906' name='L3906'></a>3906         <a href='../S/1632.html#L400' title='Defined at 400 in Zend/zend_API.h.'>add_assoc_long</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "bits", EVP_PKEY_bits(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>));
<a id='L3907' name='L3907'></a>3907         <a href='../S/1632.html#L407' title='Defined at 407 in Zend/zend_API.h.'>add_assoc_stringl</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "key", <a href='../Y/31343.html' title='Multiple used in 3 places.'>pbio</a>, <a href='../Y/31344.html' title='Multiple used in 3 places.'>pbio_len</a>);
<a id='L3908' name='L3908'></a>3908         <em class='comment'>/*TODO: Use the real values once the openssl constants are used</em>
<a id='L3909' name='L3909'></a>3909 <em class='comment'>         * See the enum at the top of this file</em>
<a id='L3910' name='L3910'></a>3910 <em class='comment'>         */</em>
<a id='L3911' name='L3911'></a>3911         <strong class='reserved'>switch</strong> (<a href='../Y/2145.html' title='Multiple used in 4 places.'>EVP_PKEY_type</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>)) <em class='brace'>{</em>
<a id='L3912' name='L3912'></a>3912                 <strong class='reserved'>case</strong> <a href='../Y/2134.html' title='Multiple used in 6 places.'>EVP_PKEY_RSA</a>:
<a id='L3913' name='L3913'></a>3913                 <strong class='reserved'>case</strong> <a href='../Y/2135.html' title='Multiple used in 6 places.'>EVP_PKEY_RSA2</a>:
<a id='L3914' name='L3914'></a>3914                         <a href='../Y/24527.html' title='Multiple used in 7 places.'>ktype</a> = <a href='../S/851.html#L95' title='Defined at 95 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_RSA</a>;
<a id='L3915' name='L3915'></a>3915 
<a id='L3916' name='L3916'></a>3916                         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3917' name='L3917'></a>3917                                 <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> <a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>;
<a id='L3918' name='L3918'></a>3918 
<a id='L3919' name='L3919'></a>3919                                 <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(&amp;<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>);
<a id='L3920' name='L3920'></a>3920                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../D/25111.html' title='Multiple defined in 3 places.'>n</a>);
<a id='L3921' name='L3921'></a>3921                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../Y/16391.html' title='Multiple used in 1069 places.'>e</a>);
<a id='L3922' name='L3922'></a>3922                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../Y/14948.html' title='Multiple used in 1519 places.'>d</a>);
<a id='L3923' name='L3923'></a>3923                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a>);
<a id='L3924' name='L3924'></a>3924                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../Y/33830.html' title='Multiple used in 943 places.'>q</a>);
<a id='L3925' name='L3925'></a>3925                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../Y/15848.html' title='Multiple used in 2 places.'>dmp1</a>);
<a id='L3926' name='L3926'></a>3926                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../Y/15849.html' title='Multiple used in 2 places.'>dmq1</a>);
<a id='L3927' name='L3927'></a>3927                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>, <a href='../Y/23596.html' title='Multiple used in 2 places.'>iqmp</a>);
<a id='L3928' name='L3928'></a>3928                                 <a href='../S/1632.html#L408' title='Defined at 408 in Zend/zend_API.h.'>add_assoc_zval</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "rsa", &amp;<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>);
<a id='L3929' name='L3929'></a>3929                         <em class='brace'>}</em>
<a id='L3930' name='L3930'></a>3930 
<a id='L3931' name='L3931'></a>3931                         <strong class='reserved'>break</strong>;
<a id='L3932' name='L3932'></a>3932                 <strong class='reserved'>case</strong> <a href='../Y/2128.html' title='Multiple used in 2 places.'>EVP_PKEY_DSA</a>:
<a id='L3933' name='L3933'></a>3933                 <strong class='reserved'>case</strong> <a href='../Y/2130.html' title='Multiple used in 2 places.'>EVP_PKEY_DSA2</a>:
<a id='L3934' name='L3934'></a>3934                 <strong class='reserved'>case</strong> <a href='../Y/2131.html' title='Multiple used in 2 places.'>EVP_PKEY_DSA3</a>:
<a id='L3935' name='L3935'></a>3935                 <strong class='reserved'>case</strong> <a href='../Y/2132.html' title='Multiple used in 2 places.'>EVP_PKEY_DSA4</a>:
<a id='L3936' name='L3936'></a>3936                         <a href='../Y/24527.html' title='Multiple used in 7 places.'>ktype</a> = <a href='../S/851.html#L96' title='Defined at 96 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_DSA</a>;
<a id='L3937' name='L3937'></a>3937 
<a id='L3938' name='L3938'></a>3938                         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3939' name='L3939'></a>3939                                 <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> <a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>;
<a id='L3940' name='L3940'></a>3940 
<a id='L3941' name='L3941'></a>3941                                 <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(&amp;<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>);
<a id='L3942' name='L3942'></a>3942                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>, <a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a>);
<a id='L3943' name='L3943'></a>3943                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>, <a href='../Y/33830.html' title='Multiple used in 943 places.'>q</a>);
<a id='L3944' name='L3944'></a>3944                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>, <a href='../Y/18804.html' title='Multiple used in 242 places.'>g</a>);
<a id='L3945' name='L3945'></a>3945                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>, <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>);
<a id='L3946' name='L3946'></a>3946                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>, <a href='../Y/33720.html' title='Multiple used in 8 places.'>pub_key</a>);
<a id='L3947' name='L3947'></a>3947                                 <a href='../S/1632.html#L408' title='Defined at 408 in Zend/zend_API.h.'>add_assoc_zval</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "dsa", &amp;<a href='../Y/16201.html' title='Multiple used in 23 places.'>dsa</a>);
<a id='L3948' name='L3948'></a>3948                         <em class='brace'>}</em>
<a id='L3949' name='L3949'></a>3949                         <strong class='reserved'>break</strong>;
<a id='L3950' name='L3950'></a>3950                 <strong class='reserved'>case</strong> <a href='../Y/2127.html' title='Multiple used in 3 places.'>EVP_PKEY_DH</a>:
<a id='L3951' name='L3951'></a>3951 
<a id='L3952' name='L3952'></a>3952                         <a href='../Y/24527.html' title='Multiple used in 7 places.'>ktype</a> = <a href='../S/851.html#L97' title='Defined at 97 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_DH</a>;
<a id='L3953' name='L3953'></a>3953 
<a id='L3954' name='L3954'></a>3954                         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3955' name='L3955'></a>3955                                 <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> <a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>;
<a id='L3956' name='L3956'></a>3956 
<a id='L3957' name='L3957'></a>3957                                 <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(&amp;<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>);
<a id='L3958' name='L3958'></a>3958                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>, <a href='../Y/30244.html' title='Multiple used in 13181 places.'>p</a>);
<a id='L3959' name='L3959'></a>3959                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>, <a href='../Y/18804.html' title='Multiple used in 242 places.'>g</a>);
<a id='L3960' name='L3960'></a>3960                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>, <a href='../Y/33385.html' title='Multiple used in 56 places.'>priv_key</a>);
<a id='L3961' name='L3961'></a>3961                                 <a href='../S/851.html#L3545' title='Defined at 3545 in ext/openssl/openssl.c.'>OPENSSL_PKEY_GET_BN</a>(<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>, <a href='../Y/33720.html' title='Multiple used in 8 places.'>pub_key</a>);
<a id='L3962' name='L3962'></a>3962                                 <a href='../S/1632.html#L408' title='Defined at 408 in Zend/zend_API.h.'>add_assoc_zval</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "dh", &amp;<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>);
<a id='L3963' name='L3963'></a>3963                         <em class='brace'>}</em>
<a id='L3964' name='L3964'></a>3964 
<a id='L3965' name='L3965'></a>3965                         <strong class='reserved'>break</strong>;
<a id='L3966' name='L3966'></a>3966 <em class='sharp'>#ifdef</em> <a href='../S/851.html#L86' title='Defined at 86 in ext/openssl/openssl.c.'>HAVE_EVP_PKEY_EC</a>
<a id='L3967' name='L3967'></a>3967                 <strong class='reserved'>case</strong> <a href='../Y/2133.html' title='Multiple used in 5 places.'>EVP_PKEY_EC</a>:
<a id='L3968' name='L3968'></a>3968                         <a href='../Y/24527.html' title='Multiple used in 7 places.'>ktype</a> = <a href='../S/851.html#L100' title='Defined at 100 in ext/openssl/openssl.c.'>OPENSSL_KEYTYPE_EC</a>;
<a id='L3969' name='L3969'></a>3969                         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/16472.html' title='Multiple used in 32 places.'>ec</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3970' name='L3970'></a>3970                                 <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> <a href='../Y/16472.html' title='Multiple used in 32 places.'>ec</a>;
<a id='L3971' name='L3971'></a>3971                                 <strong class='reserved'>const</strong> EC_GROUP *<a href='../Y/16473.html' title='Multiple used in 3 places.'>ec_group</a>;
<a id='L3972' name='L3972'></a>3972                                 <strong class='reserved'>int</strong> <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>;
<a id='L3973' name='L3973'></a>3973                                 <strong class='reserved'>char</strong> *<a href='../Y/14633.html' title='Multiple used in 4 places.'>crv_sn</a>;
<a id='L3974' name='L3974'></a>3974                                 <a href='../Y/119.html' title='Multiple used in 2 places.'>ASN1_OBJECT</a> *<a href='../Y/29030.html' title='Multiple used in 1907 places.'>obj</a>;
<a id='L3975' name='L3975'></a>3975                                 <em class='comment'>// openssl recommends a buffer length of 80</em>
<a id='L3976' name='L3976'></a>3976                                 <strong class='reserved'>char</strong> <a href='../Y/29358.html' title='Multiple used in 3 places.'>oir_buf</a>[80];
<a id='L3977' name='L3977'></a>3977 
<a id='L3978' name='L3978'></a>3978                                 <a href='../Y/16473.html' title='Multiple used in 3 places.'>ec_group</a> = EC_KEY_get0_group(<a href='../Y/2142.html' title='Multiple used in 3 places.'>EVP_PKEY_get1_EC_KEY</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>));
<a id='L3979' name='L3979'></a>3979 
<a id='L3980' name='L3980'></a>3980                                 <em class='comment'>// Curve nid (numerical identifier) used for ASN1 mapping</em>
<a id='L3981' name='L3981'></a>3981                                 <a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a> = EC_GROUP_get_curve_name(<a href='../Y/16473.html' title='Multiple used in 3 places.'>ec_group</a>);
<a id='L3982' name='L3982'></a>3982                                 <strong class='reserved'>if</strong> (<a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a> == <a href='../Y/4236.html' title='Multiple used in 6 places.'>NID_undef</a>) <em class='brace'>{</em>
<a id='L3983' name='L3983'></a>3983                                         <strong class='reserved'>break</strong>;
<a id='L3984' name='L3984'></a>3984                                 <em class='brace'>}</em>
<a id='L3985' name='L3985'></a>3985                                 <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(&amp;<a href='../Y/16472.html' title='Multiple used in 32 places.'>ec</a>);
<a id='L3986' name='L3986'></a>3986 
<a id='L3987' name='L3987'></a>3987                                 <em class='comment'>// Short object name</em>
<a id='L3988' name='L3988'></a>3988                                 <a href='../Y/14633.html' title='Multiple used in 4 places.'>crv_sn</a> = (<strong class='reserved'>char</strong>*) <a href='../Y/4351.html' title='Multiple used in 4 places.'>OBJ_nid2sn</a>(<a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>);
<a id='L3989' name='L3989'></a>3989                                 <strong class='reserved'>if</strong> (<a href='../Y/14633.html' title='Multiple used in 4 places.'>crv_sn</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3990' name='L3990'></a>3990                                         <a href='../S/1632.html#L406' title='Defined at 406 in Zend/zend_API.h.'>add_assoc_string</a>(&amp;<a href='../Y/16472.html' title='Multiple used in 32 places.'>ec</a>, "curve_name", <a href='../Y/14633.html' title='Multiple used in 4 places.'>crv_sn</a>);
<a id='L3991' name='L3991'></a>3991                                 <em class='brace'>}</em>
<a id='L3992' name='L3992'></a>3992 
<a id='L3993' name='L3993'></a>3993                                 <a href='../Y/29030.html' title='Multiple used in 1907 places.'>obj</a> = OBJ_nid2obj(<a href='../Y/28540.html' title='Multiple used in 28 places.'>nid</a>);
<a id='L3994' name='L3994'></a>3994                                 <strong class='reserved'>if</strong> (<a href='../Y/29030.html' title='Multiple used in 1907 places.'>obj</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L3995' name='L3995'></a>3995                                         <strong class='reserved'>int</strong> <a href='../Y/29359.html' title='Multiple used in 2 places.'>oir_len</a> = <a href='../Y/4353.html' title='Multiple used in 2 places.'>OBJ_obj2txt</a>(<a href='../Y/29358.html' title='Multiple used in 3 places.'>oir_buf</a>, <strong class='reserved'>sizeof</strong>(<a href='../Y/29358.html' title='Multiple used in 3 places.'>oir_buf</a>), <a href='../Y/29030.html' title='Multiple used in 1907 places.'>obj</a>, 1);
<a id='L3996' name='L3996'></a>3996                                         <a href='../S/1632.html#L407' title='Defined at 407 in Zend/zend_API.h.'>add_assoc_stringl</a>(&amp;<a href='../Y/16472.html' title='Multiple used in 32 places.'>ec</a>, "curve_oid", (<strong class='reserved'>char</strong>*)<a href='../Y/29358.html' title='Multiple used in 3 places.'>oir_buf</a>, <a href='../Y/29359.html' title='Multiple used in 2 places.'>oir_len</a>);
<a id='L3997' name='L3997'></a>3997                                         ASN1_OBJECT_free(<a href='../Y/29030.html' title='Multiple used in 1907 places.'>obj</a>);
<a id='L3998' name='L3998'></a>3998                                 <em class='brace'>}</em>
<a id='L3999' name='L3999'></a>3999 
<a id='L4000' name='L4000'></a>4000                                 <a href='../S/1632.html#L408' title='Defined at 408 in Zend/zend_API.h.'>add_assoc_zval</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "ec", &amp;<a href='../Y/16472.html' title='Multiple used in 32 places.'>ec</a>);
<a id='L4001' name='L4001'></a>4001                         <em class='brace'>}</em>
<a id='L4002' name='L4002'></a>4002                         <strong class='reserved'>break</strong>;
<a id='L4003' name='L4003'></a>4003 <em class='sharp'>#endif</em>
<a id='L4004' name='L4004'></a>4004                 <strong class='reserved'>default</strong>:
<a id='L4005' name='L4005'></a>4005                         <a href='../Y/24527.html' title='Multiple used in 7 places.'>ktype</a> = -1;
<a id='L4006' name='L4006'></a>4006                         <strong class='reserved'>break</strong>;
<a id='L4007' name='L4007'></a>4007         <em class='brace'>}</em>
<a id='L4008' name='L4008'></a>4008         <a href='../S/1632.html#L400' title='Defined at 400 in Zend/zend_API.h.'>add_assoc_long</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>, "type", <a href='../Y/24527.html' title='Multiple used in 7 places.'>ktype</a>);
<a id='L4009' name='L4009'></a>4009 
<a id='L4010' name='L4010'></a>4010         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>);
<a id='L4011' name='L4011'></a>4011 <em class='brace'>}</em>
<a id='L4012' name='L4012'></a>4012 <em class='comment'>/* }}} */</em>
<a id='L4013' name='L4013'></a>4013 
<a id='L4014' name='L4014'></a>4014 <em class='comment'>/* }}} */</em>
<a id='L4015' name='L4015'></a>4015 
<a id='L4016' name='L4016'></a>4016 <em class='sharp'>#if</em> <a href='../Y/4658.html' title='Multiple used in 32 places.'>OPENSSL_VERSION_NUMBER</a> &gt;= 0x10000000L
<a id='L4017' name='L4017'></a>4017 
<a id='L4018' name='L4018'></a>4018 <em class='comment'>/* {{{ proto string openssl_pbkdf2(string password, string salt, long key_length, long iterations [, string digest_method = "sha1"])</em>
<a id='L4019' name='L4019'></a>4019 <em class='comment'>   Generates a PKCS5 v2 PBKDF2 string, defaults to sha1 */</em>
<a id='L4020' name='L4020'></a>4020 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29752.html' title='Multiple used in 3 places.'>openssl_pbkdf2</a>)
<a id='L4021' name='L4021'></a>4021 <em class='brace'>{</em>
<a id='L4022' name='L4022'></a>4022         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/24457.html' title='Multiple used in 81 places.'>key_length</a> = 0, <a href='../Y/24222.html' title='Multiple used in 11 places.'>iterations</a> = 0;
<a id='L4023' name='L4023'></a>4023         <strong class='reserved'>char</strong> *<a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>;
<a id='L4024' name='L4024'></a>4024         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>;
<a id='L4025' name='L4025'></a>4025         <strong class='reserved'>char</strong> *<a href='../Y/35287.html' title='Multiple used in 131 places.'>salt</a>;
<a id='L4026' name='L4026'></a>4026         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/35291.html' title='Multiple used in 64 places.'>salt_len</a>;
<a id='L4027' name='L4027'></a>4027         <strong class='reserved'>char</strong> *<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>;
<a id='L4028' name='L4028'></a>4028         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a> = 0;
<a id='L4029' name='L4029'></a>4029         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/30110.html' title='Multiple used in 23 places.'>out_buffer</a>;
<a id='L4030' name='L4030'></a>4030 
<a id='L4031' name='L4031'></a>4031         <strong class='reserved'>const</strong> <a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *<a href='../Y/15696.html' title='Multiple used in 282 places.'>digest</a>;
<a id='L4032' name='L4032'></a>4032 
<a id='L4033' name='L4033'></a>4033         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "ssll|s",
<a id='L4034' name='L4034'></a>4034                                 &amp;<a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>, &amp;<a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>,
<a id='L4035' name='L4035'></a>4035                                 &amp;<a href='../Y/35287.html' title='Multiple used in 131 places.'>salt</a>, &amp;<a href='../Y/35291.html' title='Multiple used in 64 places.'>salt_len</a>,
<a id='L4036' name='L4036'></a>4036                                 &amp;<a href='../Y/24457.html' title='Multiple used in 81 places.'>key_length</a>, &amp;<a href='../Y/24222.html' title='Multiple used in 11 places.'>iterations</a>,
<a id='L4037' name='L4037'></a>4037                                 &amp;<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>, &amp;<a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L4038' name='L4038'></a>4038                 <strong class='reserved'>return</strong>;
<a id='L4039' name='L4039'></a>4039         <em class='brace'>}</em>
<a id='L4040' name='L4040'></a>4040 
<a id='L4041' name='L4041'></a>4041         <strong class='reserved'>if</strong> (<a href='../Y/24457.html' title='Multiple used in 81 places.'>key_length</a> &lt;= 0) <em class='brace'>{</em>
<a id='L4042' name='L4042'></a>4042                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4043' name='L4043'></a>4043         <em class='brace'>}</em>
<a id='L4044' name='L4044'></a>4044 
<a id='L4045' name='L4045'></a>4045         <strong class='reserved'>if</strong> (<a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>) <em class='brace'>{</em>
<a id='L4046' name='L4046'></a>4046                 <a href='../Y/15696.html' title='Multiple used in 282 places.'>digest</a> = <a href='../Y/2163.html' title='Multiple used in 6 places.'>EVP_get_digestbyname</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>);
<a id='L4047' name='L4047'></a>4047         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L4048' name='L4048'></a>4048                 <a href='../Y/15696.html' title='Multiple used in 282 places.'>digest</a> = <a href='../Y/2172.html' title='Multiple used in 5 places.'>EVP_sha1</a>();
<a id='L4049' name='L4049'></a>4049         <em class='brace'>}</em>
<a id='L4050' name='L4050'></a>4050 
<a id='L4051' name='L4051'></a>4051         <strong class='reserved'>if</strong> (!<a href='../Y/15696.html' title='Multiple used in 282 places.'>digest</a>) <em class='brace'>{</em>
<a id='L4052' name='L4052'></a>4052                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown signature algorithm");
<a id='L4053' name='L4053'></a>4053                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4054' name='L4054'></a>4054         <em class='brace'>}</em>
<a id='L4055' name='L4055'></a>4055 
<a id='L4056' name='L4056'></a>4056         <a href='../S/851.html#L555' title='Defined at 555 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_LONG_TO_INT</a>(<a href='../Y/24457.html' title='Multiple used in 81 places.'>key_length</a>, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>);
<a id='L4057' name='L4057'></a>4057         <a href='../S/851.html#L555' title='Defined at 555 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_LONG_TO_INT</a>(<a href='../Y/24222.html' title='Multiple used in 11 places.'>iterations</a>, <a href='../Y/24222.html' title='Multiple used in 11 places.'>iterations</a>);
<a id='L4058' name='L4058'></a>4058         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>, <a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>);
<a id='L4059' name='L4059'></a>4059         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/35291.html' title='Multiple used in 64 places.'>salt_len</a>, <a href='../Y/35287.html' title='Multiple used in 131 places.'>salt</a>);
<a id='L4060' name='L4060'></a>4060 
<a id='L4061' name='L4061'></a>4061         <a href='../Y/30110.html' title='Multiple used in 23 places.'>out_buffer</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(<a href='../Y/24457.html' title='Multiple used in 81 places.'>key_length</a>, 0);
<a id='L4062' name='L4062'></a>4062 
<a id='L4063' name='L4063'></a>4063         <strong class='reserved'>if</strong> (PKCS5_PBKDF2_HMAC(<a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>, (<strong class='reserved'>int</strong>)<a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../Y/35287.html' title='Multiple used in 131 places.'>salt</a>, (<strong class='reserved'>int</strong>)<a href='../Y/35291.html' title='Multiple used in 64 places.'>salt_len</a>, (<strong class='reserved'>int</strong>)<a href='../Y/24222.html' title='Multiple used in 11 places.'>iterations</a>, <a href='../Y/15696.html' title='Multiple used in 282 places.'>digest</a>, (<strong class='reserved'>int</strong>)<a href='../Y/24457.html' title='Multiple used in 81 places.'>key_length</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/30110.html' title='Multiple used in 23 places.'>out_buffer</a>)) == 1) <em class='brace'>{</em>
<a id='L4064' name='L4064'></a>4064                 <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/30110.html' title='Multiple used in 23 places.'>out_buffer</a>)[<a href='../Y/24457.html' title='Multiple used in 81 places.'>key_length</a>] = 0;
<a id='L4065' name='L4065'></a>4065                 <a href='../S/1632.html#L635' title='Defined at 635 in Zend/zend_API.h.'>RETURN_NEW_STR</a>(<a href='../Y/30110.html' title='Multiple used in 23 places.'>out_buffer</a>);
<a id='L4066' name='L4066'></a>4066         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L4067' name='L4067'></a>4067                 <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../Y/30110.html' title='Multiple used in 23 places.'>out_buffer</a>);
<a id='L4068' name='L4068'></a>4068                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4069' name='L4069'></a>4069         <em class='brace'>}</em>
<a id='L4070' name='L4070'></a>4070 <em class='brace'>}</em>
<a id='L4071' name='L4071'></a>4071 <em class='comment'>/* }}} */</em>
<a id='L4072' name='L4072'></a>4072 
<a id='L4073' name='L4073'></a>4073 <em class='sharp'>#endif</em>
<a id='L4074' name='L4074'></a>4074 
<a id='L4075' name='L4075'></a>4075 <em class='comment'>/* {{{ PKCS7 S/MIME functions */</em>
<a id='L4076' name='L4076'></a>4076 
<a id='L4077' name='L4077'></a>4077 <em class='comment'>/* {{{ proto bool openssl_pkcs7_verify(string filename, long flags [, string signerscerts [, array cainfo [, string extracerts [, string content]]]])</em>
<a id='L4078' name='L4078'></a>4078 <em class='comment'>   Verifys that the data block is intact, the signer is who they say they are, and returns the CERTs of the signers */</em>
<a id='L4079' name='L4079'></a>4079 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29759.html' title='Multiple used in 3 places.'>openssl_pkcs7_verify</a>)
<a id='L4080' name='L4080'></a>4080 <em class='brace'>{</em>
<a id='L4081' name='L4081'></a>4081         <a href='../Y/7417.html' title='Multiple used in 7 places.'>X509_STORE</a> * <a href='../Y/37487.html' title='Multiple used in 18 places.'>store</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4082' name='L4082'></a>4082         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/13213.html' title='Multiple used in 17 places.'>cainfo</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4083' name='L4083'></a>4083         <a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) *<a href='../Y/36177.html' title='Multiple used in 5 places.'>signers</a>= <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4084' name='L4084'></a>4084         <a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) *<a href='../Y/30089.html' title='Multiple used in 11 places.'>others</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4085' name='L4085'></a>4085         <a href='../Y/5074.html' title='Multiple used in 4 places.'>PKCS7</a> * <a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4086' name='L4086'></a>4086         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, * <a href='../Y/15036.html' title='Multiple used in 7 places.'>datain</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, * <a href='../Y/15039.html' title='Multiple used in 5 places.'>dataout</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4087' name='L4087'></a>4087         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a> = 0;
<a id='L4088' name='L4088'></a>4088         <strong class='reserved'>char</strong> * <a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>;
<a id='L4089' name='L4089'></a>4089         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/17892.html' title='Multiple used in 356 places.'>filename_len</a>;
<a id='L4090' name='L4090'></a>4090         <strong class='reserved'>char</strong> * <a href='../Y/17424.html' title='Multiple used in 5 places.'>extracerts</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4091' name='L4091'></a>4091         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/17425.html' title='Multiple used in 2 places.'>extracerts_len</a> = 0;
<a id='L4092' name='L4092'></a>4092         <strong class='reserved'>char</strong> * <a href='../Y/36179.html' title='Multiple used in 6 places.'>signersfilename</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4093' name='L4093'></a>4093         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/36180.html' title='Multiple used in 2 places.'>signersfilename_len</a> = 0;
<a id='L4094' name='L4094'></a>4094         <strong class='reserved'>char</strong> * <a href='../Y/15034.html' title='Multiple used in 5 places.'>datafilename</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4095' name='L4095'></a>4095         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/15035.html' title='Multiple used in 2 places.'>datafilename_len</a> = 0;
<a id='L4096' name='L4096'></a>4096 
<a id='L4097' name='L4097'></a>4097         <a href='../S/1632.html#L613' title='Defined at 613 in Zend/zend_API.h.'>RETVAL_LONG</a>(-1);
<a id='L4098' name='L4098'></a>4098 
<a id='L4099' name='L4099'></a>4099         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "pl|papp", &amp;<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>, &amp;<a href='../Y/17892.html' title='Multiple used in 356 places.'>filename_len</a>,
<a id='L4100' name='L4100'></a>4100                                 &amp;<a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a>, &amp;<a href='../Y/36179.html' title='Multiple used in 6 places.'>signersfilename</a>, &amp;<a href='../Y/36180.html' title='Multiple used in 2 places.'>signersfilename_len</a>, &amp;<a href='../Y/13213.html' title='Multiple used in 17 places.'>cainfo</a>,
<a id='L4101' name='L4101'></a>4101                                 &amp;<a href='../Y/17424.html' title='Multiple used in 5 places.'>extracerts</a>, &amp;<a href='../Y/17425.html' title='Multiple used in 2 places.'>extracerts_len</a>, &amp;<a href='../Y/15034.html' title='Multiple used in 5 places.'>datafilename</a>, &amp;<a href='../Y/15035.html' title='Multiple used in 2 places.'>datafilename_len</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L4102' name='L4102'></a>4102                 <strong class='reserved'>return</strong>;
<a id='L4103' name='L4103'></a>4103         <em class='brace'>}</em>
<a id='L4104' name='L4104'></a>4104 
<a id='L4105' name='L4105'></a>4105         <strong class='reserved'>if</strong> (<a href='../Y/17424.html' title='Multiple used in 5 places.'>extracerts</a>) <em class='brace'>{</em>
<a id='L4106' name='L4106'></a>4106                 <a href='../Y/30089.html' title='Multiple used in 11 places.'>others</a> = <a href='../Y/25249.html' title='Multiple used in 5 places.'>load_all_certs_from_file</a>(<a href='../Y/17424.html' title='Multiple used in 5 places.'>extracerts</a>);
<a id='L4107' name='L4107'></a>4107                 <strong class='reserved'>if</strong> (<a href='../Y/30089.html' title='Multiple used in 11 places.'>others</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4108' name='L4108'></a>4108                         <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4109' name='L4109'></a>4109                 <em class='brace'>}</em>
<a id='L4110' name='L4110'></a>4110         <em class='brace'>}</em>
<a id='L4111' name='L4111'></a>4111 
<a id='L4112' name='L4112'></a>4112         <a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a> = <a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a> &amp; ~<a href='../Y/5076.html' title='Multiple used in 4 places.'>PKCS7_DETACHED</a>;
<a id='L4113' name='L4113'></a>4113 
<a id='L4114' name='L4114'></a>4114         <a href='../Y/37487.html' title='Multiple used in 18 places.'>store</a> = <a href='../S/851.html#L2240' title='Defined at 2240 in ext/openssl/openssl.c.'>setup_verify</a>(<a href='../Y/13213.html' title='Multiple used in 17 places.'>cainfo</a>);
<a id='L4115' name='L4115'></a>4115 
<a id='L4116' name='L4116'></a>4116         <strong class='reserved'>if</strong> (!<a href='../Y/37487.html' title='Multiple used in 18 places.'>store</a>) <em class='brace'>{</em>
<a id='L4117' name='L4117'></a>4117                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4118' name='L4118'></a>4118         <em class='brace'>}</em>
<a id='L4119' name='L4119'></a>4119         <strong class='reserved'>if</strong> (<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>)) <em class='brace'>{</em>
<a id='L4120' name='L4120'></a>4120                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4121' name='L4121'></a>4121         <em class='brace'>}</em>
<a id='L4122' name='L4122'></a>4122 
<a id='L4123' name='L4123'></a>4123         <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/17890.html' title='Multiple used in 1490 places.'>filename</a>, (<a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a> &amp; <a href='../Y/5075.html' title='Multiple used in 2 places.'>PKCS7_BINARY</a>) ? "rb" : "r");
<a id='L4124' name='L4124'></a>4124         <strong class='reserved'>if</strong> (<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4125' name='L4125'></a>4125                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4126' name='L4126'></a>4126         <em class='brace'>}</em>
<a id='L4127' name='L4127'></a>4127         <a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a> = <a href='../Y/5676.html' title='Multiple used in 2 places.'>SMIME_read_PKCS7</a>(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>, &amp;<a href='../Y/15036.html' title='Multiple used in 7 places.'>datain</a>);
<a id='L4128' name='L4128'></a>4128         <strong class='reserved'>if</strong> (<a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4129' name='L4129'></a>4129 <em class='sharp'>#if</em> <a href='../S/851.html#L83' title='Defined at 83 in ext/openssl/openssl.c.'>DEBUG_SMIME</a>
<a id='L4130' name='L4130'></a>4130                 <a href='../Y/43855.html' title='Multiple used in 38 places.'>zend_printf</a>("SMIME_read_PKCS7 failed\n");
<a id='L4131' name='L4131'></a>4131 <em class='sharp'>#endif</em>
<a id='L4132' name='L4132'></a>4132                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4133' name='L4133'></a>4133         <em class='brace'>}</em>
<a id='L4134' name='L4134'></a>4134 
<a id='L4135' name='L4135'></a>4135         <strong class='reserved'>if</strong> (<a href='../Y/15034.html' title='Multiple used in 5 places.'>datafilename</a>) <em class='brace'>{</em>
<a id='L4136' name='L4136'></a>4136 
<a id='L4137' name='L4137'></a>4137                 <strong class='reserved'>if</strong> (<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/15034.html' title='Multiple used in 5 places.'>datafilename</a>)) <em class='brace'>{</em>
<a id='L4138' name='L4138'></a>4138                         <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4139' name='L4139'></a>4139                 <em class='brace'>}</em>
<a id='L4140' name='L4140'></a>4140 
<a id='L4141' name='L4141'></a>4141                 <a href='../Y/15039.html' title='Multiple used in 5 places.'>dataout</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/15034.html' title='Multiple used in 5 places.'>datafilename</a>, "w");
<a id='L4142' name='L4142'></a>4142                 <strong class='reserved'>if</strong> (<a href='../Y/15039.html' title='Multiple used in 5 places.'>dataout</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4143' name='L4143'></a>4143                         <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4144' name='L4144'></a>4144                 <em class='brace'>}</em>
<a id='L4145' name='L4145'></a>4145         <em class='brace'>}</em>
<a id='L4146' name='L4146'></a>4146 <em class='sharp'>#if</em> <a href='../S/851.html#L83' title='Defined at 83 in ext/openssl/openssl.c.'>DEBUG_SMIME</a>
<a id='L4147' name='L4147'></a>4147         <a href='../Y/43855.html' title='Multiple used in 38 places.'>zend_printf</a>("Calling PKCS7 verify\n");
<a id='L4148' name='L4148'></a>4148 <em class='sharp'>#endif</em>
<a id='L4149' name='L4149'></a>4149 
<a id='L4150' name='L4150'></a>4150         <strong class='reserved'>if</strong> (PKCS7_verify(<a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a>, <a href='../Y/30089.html' title='Multiple used in 11 places.'>others</a>, <a href='../Y/37487.html' title='Multiple used in 18 places.'>store</a>, <a href='../Y/15036.html' title='Multiple used in 7 places.'>datain</a>, <a href='../Y/15039.html' title='Multiple used in 5 places.'>dataout</a>, (<strong class='reserved'>int</strong>)<a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a>)) <em class='brace'>{</em>
<a id='L4151' name='L4151'></a>4151 
<a id='L4152' name='L4152'></a>4152                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L4153' name='L4153'></a>4153 
<a id='L4154' name='L4154'></a>4154                 <strong class='reserved'>if</strong> (<a href='../Y/36179.html' title='Multiple used in 6 places.'>signersfilename</a>) <em class='brace'>{</em>
<a id='L4155' name='L4155'></a>4155                         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> *<a href='../Y/13491.html' title='Multiple used in 5 places.'>certout</a>;
<a id='L4156' name='L4156'></a>4156 
<a id='L4157' name='L4157'></a>4157                         <strong class='reserved'>if</strong> (<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/36179.html' title='Multiple used in 6 places.'>signersfilename</a>)) <em class='brace'>{</em>
<a id='L4158' name='L4158'></a>4158                                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4159' name='L4159'></a>4159                         <em class='brace'>}</em>
<a id='L4160' name='L4160'></a>4160 
<a id='L4161' name='L4161'></a>4161                         <a href='../Y/13491.html' title='Multiple used in 5 places.'>certout</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/36179.html' title='Multiple used in 6 places.'>signersfilename</a>, "w");
<a id='L4162' name='L4162'></a>4162                         <strong class='reserved'>if</strong> (<a href='../Y/13491.html' title='Multiple used in 5 places.'>certout</a>) <em class='brace'>{</em>
<a id='L4163' name='L4163'></a>4163                                 <strong class='reserved'>int</strong> <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>;
<a id='L4164' name='L4164'></a>4164                                 <a href='../Y/36177.html' title='Multiple used in 5 places.'>signers</a> = PKCS7_get0_signers(<a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, (<strong class='reserved'>int</strong>)<a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a>);
<a id='L4165' name='L4165'></a>4165 
<a id='L4166' name='L4166'></a>4166                                 <strong class='reserved'>for</strong>(<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> = 0; <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> &lt; <a href='../Y/36272.html' title='Multiple used in 4 places.'>sk_X509_num</a>(<a href='../Y/36177.html' title='Multiple used in 5 places.'>signers</a>); <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>++) <em class='brace'>{</em>
<a id='L4167' name='L4167'></a>4167                                         <a href='../Y/4935.html' title='Multiple used in 5 places.'>PEM_write_bio_X509</a>(<a href='../Y/13491.html' title='Multiple used in 5 places.'>certout</a>, <a href='../Y/36276.html' title='Multiple used in 2 places.'>sk_X509_value</a>(<a href='../Y/36177.html' title='Multiple used in 5 places.'>signers</a>, <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>));
<a id='L4168' name='L4168'></a>4168                                 <em class='brace'>}</em>
<a id='L4169' name='L4169'></a>4169                                 <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/13491.html' title='Multiple used in 5 places.'>certout</a>);
<a id='L4170' name='L4170'></a>4170                                 <a href='../Y/36270.html' title='Multiple used in 8 places.'>sk_X509_free</a>(<a href='../Y/36177.html' title='Multiple used in 5 places.'>signers</a>);
<a id='L4171' name='L4171'></a>4171                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L4172' name='L4172'></a>4172                                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "signature OK, but cannot open %s for writing", <a href='../Y/36179.html' title='Multiple used in 6 places.'>signersfilename</a>);
<a id='L4173' name='L4173'></a>4173                                 <a href='../S/1632.html#L613' title='Defined at 613 in Zend/zend_API.h.'>RETVAL_LONG</a>(-1);
<a id='L4174' name='L4174'></a>4174                         <em class='brace'>}</em>
<a id='L4175' name='L4175'></a>4175                 <em class='brace'>}</em>
<a id='L4176' name='L4176'></a>4176                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4177' name='L4177'></a>4177         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L4178' name='L4178'></a>4178                 <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L4179' name='L4179'></a>4179         <em class='brace'>}</em>
<a id='L4180' name='L4180'></a>4180 <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>:
<a id='L4181' name='L4181'></a>4181         <a href='../Y/7429.html' title='Multiple used in 2 places.'>X509_STORE_free</a>(<a href='../Y/37487.html' title='Multiple used in 18 places.'>store</a>);
<a id='L4182' name='L4182'></a>4182         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/15036.html' title='Multiple used in 7 places.'>datain</a>);
<a id='L4183' name='L4183'></a>4183         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>);
<a id='L4184' name='L4184'></a>4184         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/15039.html' title='Multiple used in 5 places.'>dataout</a>);
<a id='L4185' name='L4185'></a>4185         <a href='../Y/5086.html' title='Multiple used in 4 places.'>PKCS7_free</a>(<a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a>);
<a id='L4186' name='L4186'></a>4186         <a href='../Y/36270.html' title='Multiple used in 8 places.'>sk_X509_free</a>(<a href='../Y/30089.html' title='Multiple used in 11 places.'>others</a>);
<a id='L4187' name='L4187'></a>4187 <em class='brace'>}</em>
<a id='L4188' name='L4188'></a>4188 <em class='comment'>/* }}} */</em>
<a id='L4189' name='L4189'></a>4189 
<a id='L4190' name='L4190'></a>4190 <em class='comment'>/* {{{ proto bool openssl_pkcs7_encrypt(string infile, string outfile, mixed recipcerts, array headers [, long flags [, long cipher]])</em>
<a id='L4191' name='L4191'></a>4191 <em class='comment'>   Encrypts the message in the file named infile with the certificates in recipcerts and output the result to the file named outfile */</em>
<a id='L4192' name='L4192'></a>4192 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29757.html' title='Multiple used in 3 places.'>openssl_pkcs7_encrypt</a>)
<a id='L4193' name='L4193'></a>4193 <em class='brace'>{</em>
<a id='L4194' name='L4194'></a>4194         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/44087.html' title='Multiple used in 5 places.'>zrecipcerts</a>, * <a href='../Y/43952.html' title='Multiple used in 8 places.'>zheaders</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4195' name='L4195'></a>4195         <a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) * <a href='../Y/34172.html' title='Multiple used in 8 places.'>recipcerts</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4196' name='L4196'></a>4196         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, * <a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4197' name='L4197'></a>4197         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a> = 0;
<a id='L4198' name='L4198'></a>4198         <a href='../Y/5074.html' title='Multiple used in 4 places.'>PKCS7</a> * <a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4199' name='L4199'></a>4199         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43638.html' title='Multiple used in 10 places.'>zcertval</a>;
<a id='L4200' name='L4200'></a>4200         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>;
<a id='L4201' name='L4201'></a>4201         <strong class='reserved'>const</strong> <a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a> *<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4202' name='L4202'></a>4202         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/13717.html' title='Multiple used in 3 places.'>cipherid</a> = <a href='../S/851.html#L114' title='Defined at 114 in ext/openssl/openssl.c.'>PHP_OPENSSL_CIPHER_DEFAULT</a>;
<a id='L4203' name='L4203'></a>4203         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> * <a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>;
<a id='L4204' name='L4204'></a>4204         <strong class='reserved'>char</strong> * <a href='../Y/23139.html' title='Multiple used in 14 places.'>infilename</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4205' name='L4205'></a>4205         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/23140.html' title='Multiple used in 6 places.'>infilename_len</a>;
<a id='L4206' name='L4206'></a>4206         <strong class='reserved'>char</strong> * <a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4207' name='L4207'></a>4207         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/30159.html' title='Multiple used in 6 places.'>outfilename_len</a>;
<a id='L4208' name='L4208'></a>4208 
<a id='L4209' name='L4209'></a>4209         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L4210' name='L4210'></a>4210 
<a id='L4211' name='L4211'></a>4211         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "ppza!|ll", &amp;<a href='../Y/23139.html' title='Multiple used in 14 places.'>infilename</a>, &amp;<a href='../Y/23140.html' title='Multiple used in 6 places.'>infilename_len</a>,
<a id='L4212' name='L4212'></a>4212                                 &amp;<a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>, &amp;<a href='../Y/30159.html' title='Multiple used in 6 places.'>outfilename_len</a>, &amp;<a href='../Y/44087.html' title='Multiple used in 5 places.'>zrecipcerts</a>, &amp;<a href='../Y/43952.html' title='Multiple used in 8 places.'>zheaders</a>, &amp;<a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a>, &amp;<a href='../Y/13717.html' title='Multiple used in 3 places.'>cipherid</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>)
<a id='L4213' name='L4213'></a>4213                 <strong class='reserved'>return</strong>;
<a id='L4214' name='L4214'></a>4214 
<a id='L4215' name='L4215'></a>4215 
<a id='L4216' name='L4216'></a>4216         <strong class='reserved'>if</strong> (<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/23139.html' title='Multiple used in 14 places.'>infilename</a>) || <a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>)) <em class='brace'>{</em>
<a id='L4217' name='L4217'></a>4217                 <strong class='reserved'>return</strong>;
<a id='L4218' name='L4218'></a>4218         <em class='brace'>}</em>
<a id='L4219' name='L4219'></a>4219 
<a id='L4220' name='L4220'></a>4220         <a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/23139.html' title='Multiple used in 14 places.'>infilename</a>, "r");
<a id='L4221' name='L4221'></a>4221         <strong class='reserved'>if</strong> (<a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4222' name='L4222'></a>4222                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4223' name='L4223'></a>4223         <em class='brace'>}</em>
<a id='L4224' name='L4224'></a>4224 
<a id='L4225' name='L4225'></a>4225         <a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>, "w");
<a id='L4226' name='L4226'></a>4226         <strong class='reserved'>if</strong> (<a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4227' name='L4227'></a>4227                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4228' name='L4228'></a>4228         <em class='brace'>}</em>
<a id='L4229' name='L4229'></a>4229 
<a id='L4230' name='L4230'></a>4230         <a href='../Y/34172.html' title='Multiple used in 8 places.'>recipcerts</a> = <a href='../Y/36271.html' title='Multiple used in 3 places.'>sk_X509_new_null</a>();
<a id='L4231' name='L4231'></a>4231 
<a id='L4232' name='L4232'></a>4232         <em class='comment'>/* get certs */</em>
<a id='L4233' name='L4233'></a>4233         <strong class='reserved'>if</strong> (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/44087.html' title='Multiple used in 5 places.'>zrecipcerts</a>) == <a href='../S/1731.html#L309' title='Defined at 309 in Zend/zend_types.h.'>IS_ARRAY</a>) <em class='brace'>{</em>
<a id='L4234' name='L4234'></a>4234                 <a href='../S/1668.html#L774' title='Defined at 774 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_VAL</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/44087.html' title='Multiple used in 5 places.'>zrecipcerts</a>), <a href='../Y/43638.html' title='Multiple used in 10 places.'>zcertval</a>) <em class='brace'>{</em>
<a id='L4235' name='L4235'></a>4235                         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>;
<a id='L4236' name='L4236'></a>4236 
<a id='L4237' name='L4237'></a>4237                         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/43638.html' title='Multiple used in 10 places.'>zcertval</a>, 0, &amp;<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>);
<a id='L4238' name='L4238'></a>4238                         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4239' name='L4239'></a>4239                                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4240' name='L4240'></a>4240                         <em class='brace'>}</em>
<a id='L4241' name='L4241'></a>4241 
<a id='L4242' name='L4242'></a>4242                         <strong class='reserved'>if</strong> (<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4243' name='L4243'></a>4243                                 <em class='comment'>/* we shouldn't free this particular cert, as it is a resource.</em>
<a id='L4244' name='L4244'></a>4244 <em class='comment'>                                        make a copy and push that on the stack instead */</em>
<a id='L4245' name='L4245'></a>4245                                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../Y/7438.html' title='Multiple used in 5 places.'>X509_dup</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L4246' name='L4246'></a>4246                                 <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4247' name='L4247'></a>4247                                         <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4248' name='L4248'></a>4248                                 <em class='brace'>}</em>
<a id='L4249' name='L4249'></a>4249                         <em class='brace'>}</em>
<a id='L4250' name='L4250'></a>4250                         <a href='../Y/36275.html' title='Multiple used in 5 places.'>sk_X509_push</a>(<a href='../Y/34172.html' title='Multiple used in 8 places.'>recipcerts</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L4251' name='L4251'></a>4251                 <em class='brace'>}</em> <a href='../S/1668.html#L766' title='Defined at 766 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_END</a>();
<a id='L4252' name='L4252'></a>4252         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L4253' name='L4253'></a>4253                 <em class='comment'>/* a single certificate */</em>
<a id='L4254' name='L4254'></a>4254                 <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>;
<a id='L4255' name='L4255'></a>4255 
<a id='L4256' name='L4256'></a>4256                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/44087.html' title='Multiple used in 5 places.'>zrecipcerts</a>, 0, &amp;<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>);
<a id='L4257' name='L4257'></a>4257                 <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4258' name='L4258'></a>4258                         <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4259' name='L4259'></a>4259                 <em class='brace'>}</em>
<a id='L4260' name='L4260'></a>4260 
<a id='L4261' name='L4261'></a>4261                 <strong class='reserved'>if</strong> (<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4262' name='L4262'></a>4262                         <em class='comment'>/* we shouldn't free this particular cert, as it is a resource.</em>
<a id='L4263' name='L4263'></a>4263 <em class='comment'>                                make a copy and push that on the stack instead */</em>
<a id='L4264' name='L4264'></a>4264                         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../Y/7438.html' title='Multiple used in 5 places.'>X509_dup</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L4265' name='L4265'></a>4265                         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4266' name='L4266'></a>4266                                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4267' name='L4267'></a>4267                         <em class='brace'>}</em>
<a id='L4268' name='L4268'></a>4268                 <em class='brace'>}</em>
<a id='L4269' name='L4269'></a>4269                 <a href='../Y/36275.html' title='Multiple used in 5 places.'>sk_X509_push</a>(<a href='../Y/34172.html' title='Multiple used in 8 places.'>recipcerts</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L4270' name='L4270'></a>4270         <em class='brace'>}</em>
<a id='L4271' name='L4271'></a>4271 
<a id='L4272' name='L4272'></a>4272         <em class='comment'>/* sanity check the cipher */</em>
<a id='L4273' name='L4273'></a>4273         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> = <a href='../S/851.html#L1105' title='Defined at 1105 in ext/openssl/openssl.c.'>php_openssl_get_evp_cipher_from_algo</a>(<a href='../Y/13717.html' title='Multiple used in 3 places.'>cipherid</a>);
<a id='L4274' name='L4274'></a>4274         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4275' name='L4275'></a>4275                 <em class='comment'>/* shouldn't happen */</em>
<a id='L4276' name='L4276'></a>4276                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Failed to get cipher");
<a id='L4277' name='L4277'></a>4277                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4278' name='L4278'></a>4278         <em class='brace'>}</em>
<a id='L4279' name='L4279'></a>4279 
<a id='L4280' name='L4280'></a>4280         <a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a> = PKCS7_encrypt(<a href='../Y/34172.html' title='Multiple used in 8 places.'>recipcerts</a>, <a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a>, (<a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a>*)<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>, (<strong class='reserved'>int</strong>)<a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a>);
<a id='L4281' name='L4281'></a>4281 
<a id='L4282' name='L4282'></a>4282         <strong class='reserved'>if</strong> (<a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4283' name='L4283'></a>4283                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4284' name='L4284'></a>4284         <em class='brace'>}</em>
<a id='L4285' name='L4285'></a>4285 
<a id='L4286' name='L4286'></a>4286         <em class='comment'>/* tack on extra headers */</em>
<a id='L4287' name='L4287'></a>4287         <strong class='reserved'>if</strong> (<a href='../Y/43952.html' title='Multiple used in 8 places.'>zheaders</a>) <em class='brace'>{</em>
<a id='L4288' name='L4288'></a>4288                 <a href='../S/1668.html#L804' title='Defined at 804 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_STR_KEY_VAL</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/43952.html' title='Multiple used in 8 places.'>zheaders</a>), <a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>, <a href='../Y/43638.html' title='Multiple used in 10 places.'>zcertval</a>) <em class='brace'>{</em>
<a id='L4289' name='L4289'></a>4289                         <a href='../S/1707.html#L410' title='Defined at 410 in Zend/zend_operators.h.'>convert_to_string_ex</a>(<a href='../Y/43638.html' title='Multiple used in 10 places.'>zcertval</a>);
<a id='L4290' name='L4290'></a>4290 
<a id='L4291' name='L4291'></a>4291                         <strong class='reserved'>if</strong> (<a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>) <em class='brace'>{</em>
<a id='L4292' name='L4292'></a>4292                                 <a href='../Y/234.html' title='Multiple used in 4 places.'>BIO_printf</a>(<a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a>, "%s: %s\n", <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>), <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/43638.html' title='Multiple used in 10 places.'>zcertval</a>));
<a id='L4293' name='L4293'></a>4293                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L4294' name='L4294'></a>4294                                 <a href='../Y/234.html' title='Multiple used in 4 places.'>BIO_printf</a>(<a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a>, "%s\n", <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/43638.html' title='Multiple used in 10 places.'>zcertval</a>));
<a id='L4295' name='L4295'></a>4295                         <em class='brace'>}</em>
<a id='L4296' name='L4296'></a>4296                 <em class='brace'>}</em> <a href='../S/1668.html#L766' title='Defined at 766 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_END</a>();
<a id='L4297' name='L4297'></a>4297         <em class='brace'>}</em>
<a id='L4298' name='L4298'></a>4298 
<a id='L4299' name='L4299'></a>4299         (<strong class='reserved'>void</strong>)<a href='../Y/236.html' title='Multiple used in 2 places.'>BIO_reset</a>(<a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a>);
<a id='L4300' name='L4300'></a>4300 
<a id='L4301' name='L4301'></a>4301         <em class='comment'>/* write the encrypted data */</em>
<a id='L4302' name='L4302'></a>4302         <a href='../Y/5677.html' title='Multiple used in 2 places.'>SMIME_write_PKCS7</a>(<a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a>, <a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a>, <a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a>, (<strong class='reserved'>int</strong>)<a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a>);
<a id='L4303' name='L4303'></a>4303 
<a id='L4304' name='L4304'></a>4304         <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L4305' name='L4305'></a>4305 
<a id='L4306' name='L4306'></a>4306 <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>:
<a id='L4307' name='L4307'></a>4307         <a href='../Y/5086.html' title='Multiple used in 4 places.'>PKCS7_free</a>(<a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a>);
<a id='L4308' name='L4308'></a>4308         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a>);
<a id='L4309' name='L4309'></a>4309         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a>);
<a id='L4310' name='L4310'></a>4310         <strong class='reserved'>if</strong> (<a href='../Y/34172.html' title='Multiple used in 8 places.'>recipcerts</a>) <em class='brace'>{</em>
<a id='L4311' name='L4311'></a>4311                 <a href='../Y/36274.html' title='Multiple used in 3 places.'>sk_X509_pop_free</a>(<a href='../Y/34172.html' title='Multiple used in 8 places.'>recipcerts</a>, <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>);
<a id='L4312' name='L4312'></a>4312         <em class='brace'>}</em>
<a id='L4313' name='L4313'></a>4313 <em class='brace'>}</em>
<a id='L4314' name='L4314'></a>4314 <em class='comment'>/* }}} */</em>
<a id='L4315' name='L4315'></a>4315 
<a id='L4316' name='L4316'></a>4316 <em class='comment'>/* {{{ proto bool openssl_pkcs7_sign(string infile, string outfile, mixed signcert, mixed signkey, array headers [, long flags [, string extracertsfilename]])</em>
<a id='L4317' name='L4317'></a>4317 <em class='comment'>   Signs the MIME message in the file named infile with signcert/signkey and output the result to file name outfile. headers lists plain text headers to exclude from the signed portion of the message, and should include to, from and subject as a minimum */</em>
<a id='L4318' name='L4318'></a>4318 
<a id='L4319' name='L4319'></a>4319 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29758.html' title='Multiple used in 3 places.'>openssl_pkcs7_sign</a>)
<a id='L4320' name='L4320'></a>4320 <em class='brace'>{</em>
<a id='L4321' name='L4321'></a>4321         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, * <a href='../Y/44079.html' title='Multiple used in 3 places.'>zprivkey</a>, * <a href='../Y/43952.html' title='Multiple used in 8 places.'>zheaders</a>;
<a id='L4322' name='L4322'></a>4322         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/22037.html' title='Multiple used in 343 places.'>hval</a>;
<a id='L4323' name='L4323'></a>4323         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4324' name='L4324'></a>4324         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../Y/33407.html' title='Multiple used in 12 places.'>privkey</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4325' name='L4325'></a>4325         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a> = <a href='../Y/5076.html' title='Multiple used in 4 places.'>PKCS7_DETACHED</a>;
<a id='L4326' name='L4326'></a>4326         <a href='../Y/5074.html' title='Multiple used in 4 places.'>PKCS7</a> * <a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4327' name='L4327'></a>4327         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, * <a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4328' name='L4328'></a>4328         <a href='../D/11959.html' title='Multiple defined in 3 places.'>STACK_OF</a>(<a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a>) *<a href='../Y/30089.html' title='Multiple used in 11 places.'>others</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4329' name='L4329'></a>4329         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, *<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4330' name='L4330'></a>4330         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> * <a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>;
<a id='L4331' name='L4331'></a>4331         <strong class='reserved'>char</strong> * <a href='../Y/23139.html' title='Multiple used in 14 places.'>infilename</a>;
<a id='L4332' name='L4332'></a>4332         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/23140.html' title='Multiple used in 6 places.'>infilename_len</a>;
<a id='L4333' name='L4333'></a>4333         <strong class='reserved'>char</strong> * <a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>;
<a id='L4334' name='L4334'></a>4334         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/30159.html' title='Multiple used in 6 places.'>outfilename_len</a>;
<a id='L4335' name='L4335'></a>4335         <strong class='reserved'>char</strong> * <a href='../Y/17426.html' title='Multiple used in 5 places.'>extracertsfilename</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4336' name='L4336'></a>4336         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/17427.html' title='Multiple used in 2 places.'>extracertsfilename_len</a>;
<a id='L4337' name='L4337'></a>4337 
<a id='L4338' name='L4338'></a>4338         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "ppzza!|lp!",
<a id='L4339' name='L4339'></a>4339                                 &amp;<a href='../Y/23139.html' title='Multiple used in 14 places.'>infilename</a>, &amp;<a href='../Y/23140.html' title='Multiple used in 6 places.'>infilename_len</a>, &amp;<a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>, &amp;<a href='../Y/30159.html' title='Multiple used in 6 places.'>outfilename_len</a>,
<a id='L4340' name='L4340'></a>4340                                 &amp;<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, &amp;<a href='../Y/44079.html' title='Multiple used in 3 places.'>zprivkey</a>, &amp;<a href='../Y/43952.html' title='Multiple used in 8 places.'>zheaders</a>, &amp;<a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a>, &amp;<a href='../Y/17426.html' title='Multiple used in 5 places.'>extracertsfilename</a>,
<a id='L4341' name='L4341'></a>4341                                 &amp;<a href='../Y/17427.html' title='Multiple used in 2 places.'>extracertsfilename_len</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L4342' name='L4342'></a>4342                 <strong class='reserved'>return</strong>;
<a id='L4343' name='L4343'></a>4343         <em class='brace'>}</em>
<a id='L4344' name='L4344'></a>4344 
<a id='L4345' name='L4345'></a>4345         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L4346' name='L4346'></a>4346 
<a id='L4347' name='L4347'></a>4347         <strong class='reserved'>if</strong> (<a href='../Y/17426.html' title='Multiple used in 5 places.'>extracertsfilename</a>) <em class='brace'>{</em>
<a id='L4348' name='L4348'></a>4348                 <a href='../Y/30089.html' title='Multiple used in 11 places.'>others</a> = <a href='../Y/25249.html' title='Multiple used in 5 places.'>load_all_certs_from_file</a>(<a href='../Y/17426.html' title='Multiple used in 5 places.'>extracertsfilename</a>);
<a id='L4349' name='L4349'></a>4349                 <strong class='reserved'>if</strong> (<a href='../Y/30089.html' title='Multiple used in 11 places.'>others</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4350' name='L4350'></a>4350                         <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4351' name='L4351'></a>4351                 <em class='brace'>}</em>
<a id='L4352' name='L4352'></a>4352         <em class='brace'>}</em>
<a id='L4353' name='L4353'></a>4353 
<a id='L4354' name='L4354'></a>4354         <a href='../Y/33407.html' title='Multiple used in 12 places.'>privkey</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../Y/44079.html' title='Multiple used in 3 places.'>zprivkey</a>, 0, "", 0, &amp;<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>);
<a id='L4355' name='L4355'></a>4355         <strong class='reserved'>if</strong> (<a href='../Y/33407.html' title='Multiple used in 12 places.'>privkey</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4356' name='L4356'></a>4356                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "error getting private key");
<a id='L4357' name='L4357'></a>4357                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4358' name='L4358'></a>4358         <em class='brace'>}</em>
<a id='L4359' name='L4359'></a>4359 
<a id='L4360' name='L4360'></a>4360         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/43636.html' title='Multiple used in 41 places.'>zcert</a>, 0, &amp;<a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a>);
<a id='L4361' name='L4361'></a>4361         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4362' name='L4362'></a>4362                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "error getting cert");
<a id='L4363' name='L4363'></a>4363                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4364' name='L4364'></a>4364         <em class='brace'>}</em>
<a id='L4365' name='L4365'></a>4365 
<a id='L4366' name='L4366'></a>4366         <strong class='reserved'>if</strong> (<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/23139.html' title='Multiple used in 14 places.'>infilename</a>) || <a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>)) <em class='brace'>{</em>
<a id='L4367' name='L4367'></a>4367                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4368' name='L4368'></a>4368         <em class='brace'>}</em>
<a id='L4369' name='L4369'></a>4369 
<a id='L4370' name='L4370'></a>4370         <a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/23139.html' title='Multiple used in 14 places.'>infilename</a>, "r");
<a id='L4371' name='L4371'></a>4371         <strong class='reserved'>if</strong> (<a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4372' name='L4372'></a>4372                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "error opening input file %s!", <a href='../Y/23139.html' title='Multiple used in 14 places.'>infilename</a>);
<a id='L4373' name='L4373'></a>4373                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4374' name='L4374'></a>4374         <em class='brace'>}</em>
<a id='L4375' name='L4375'></a>4375 
<a id='L4376' name='L4376'></a>4376         <a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>, "w");
<a id='L4377' name='L4377'></a>4377         <strong class='reserved'>if</strong> (<a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4378' name='L4378'></a>4378                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "error opening output file %s!", <a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>);
<a id='L4379' name='L4379'></a>4379                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4380' name='L4380'></a>4380         <em class='brace'>}</em>
<a id='L4381' name='L4381'></a>4381 
<a id='L4382' name='L4382'></a>4382         <a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a> = PKCS7_sign(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../Y/33407.html' title='Multiple used in 12 places.'>privkey</a>, <a href='../Y/30089.html' title='Multiple used in 11 places.'>others</a>, <a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a>, (<strong class='reserved'>int</strong>)<a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a>);
<a id='L4383' name='L4383'></a>4383         <strong class='reserved'>if</strong> (<a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4384' name='L4384'></a>4384                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "error creating PKCS7 structure!");
<a id='L4385' name='L4385'></a>4385                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4386' name='L4386'></a>4386         <em class='brace'>}</em>
<a id='L4387' name='L4387'></a>4387 
<a id='L4388' name='L4388'></a>4388         (<strong class='reserved'>void</strong>)<a href='../Y/236.html' title='Multiple used in 2 places.'>BIO_reset</a>(<a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a>);
<a id='L4389' name='L4389'></a>4389 
<a id='L4390' name='L4390'></a>4390         <em class='comment'>/* tack on extra headers */</em>
<a id='L4391' name='L4391'></a>4391         <strong class='reserved'>if</strong> (<a href='../Y/43952.html' title='Multiple used in 8 places.'>zheaders</a>) <em class='brace'>{</em>
<a id='L4392' name='L4392'></a>4392                 <a href='../S/1668.html#L804' title='Defined at 804 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_STR_KEY_VAL</a>(<a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/43952.html' title='Multiple used in 8 places.'>zheaders</a>), <a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>, <a href='../Y/22037.html' title='Multiple used in 343 places.'>hval</a>) <em class='brace'>{</em>
<a id='L4393' name='L4393'></a>4393                         <a href='../S/1707.html#L410' title='Defined at 410 in Zend/zend_operators.h.'>convert_to_string_ex</a>(<a href='../Y/22037.html' title='Multiple used in 343 places.'>hval</a>);
<a id='L4394' name='L4394'></a>4394 
<a id='L4395' name='L4395'></a>4395                         <strong class='reserved'>if</strong> (<a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>) <em class='brace'>{</em>
<a id='L4396' name='L4396'></a>4396                                 <a href='../Y/234.html' title='Multiple used in 4 places.'>BIO_printf</a>(<a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a>, "%s: %s\n", <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/37672.html' title='Multiple used in 19 places.'>strindex</a>), <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/22037.html' title='Multiple used in 343 places.'>hval</a>));
<a id='L4397' name='L4397'></a>4397                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L4398' name='L4398'></a>4398                                 <a href='../Y/234.html' title='Multiple used in 4 places.'>BIO_printf</a>(<a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a>, "%s\n", <a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/22037.html' title='Multiple used in 343 places.'>hval</a>));
<a id='L4399' name='L4399'></a>4399                         <em class='brace'>}</em>
<a id='L4400' name='L4400'></a>4400                 <em class='brace'>}</em> <a href='../S/1668.html#L766' title='Defined at 766 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_END</a>();
<a id='L4401' name='L4401'></a>4401         <em class='brace'>}</em>
<a id='L4402' name='L4402'></a>4402         <em class='comment'>/* write the signed data */</em>
<a id='L4403' name='L4403'></a>4403         <a href='../Y/5677.html' title='Multiple used in 2 places.'>SMIME_write_PKCS7</a>(<a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a>, <a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a>, <a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a>, (<strong class='reserved'>int</strong>)<a href='../D/21907.html' title='Multiple defined in 17 places.'>flags</a>);
<a id='L4404' name='L4404'></a>4404 
<a id='L4405' name='L4405'></a>4405         <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L4406' name='L4406'></a>4406 
<a id='L4407' name='L4407'></a>4407 <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>:
<a id='L4408' name='L4408'></a>4408         <a href='../Y/5086.html' title='Multiple used in 4 places.'>PKCS7_free</a>(<a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a>);
<a id='L4409' name='L4409'></a>4409         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../S/800.html#L933' title='Defined at 933 in ext/mysqlnd/mysqlnd_structs.h.'>infile</a>);
<a id='L4410' name='L4410'></a>4410         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/30157.html' title='Multiple used in 34 places.'>outfile</a>);
<a id='L4411' name='L4411'></a>4411         <strong class='reserved'>if</strong> (<a href='../Y/30089.html' title='Multiple used in 11 places.'>others</a>) <em class='brace'>{</em>
<a id='L4412' name='L4412'></a>4412                 <a href='../Y/36274.html' title='Multiple used in 3 places.'>sk_X509_pop_free</a>(<a href='../Y/30089.html' title='Multiple used in 11 places.'>others</a>, <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>);
<a id='L4413' name='L4413'></a>4413         <em class='brace'>}</em>
<a id='L4414' name='L4414'></a>4414         <strong class='reserved'>if</strong> (<a href='../Y/33407.html' title='Multiple used in 12 places.'>privkey</a> &amp;&amp; <a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4415' name='L4415'></a>4415                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/33407.html' title='Multiple used in 12 places.'>privkey</a>);
<a id='L4416' name='L4416'></a>4416         <em class='brace'>}</em>
<a id='L4417' name='L4417'></a>4417         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> &amp;&amp; <a href='../Y/13492.html' title='Multiple used in 42 places.'>certresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4418' name='L4418'></a>4418                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L4419' name='L4419'></a>4419         <em class='brace'>}</em>
<a id='L4420' name='L4420'></a>4420 <em class='brace'>}</em>
<a id='L4421' name='L4421'></a>4421 <em class='comment'>/* }}} */</em>
<a id='L4422' name='L4422'></a>4422 
<a id='L4423' name='L4423'></a>4423 <em class='comment'>/* {{{ proto bool openssl_pkcs7_decrypt(string infilename, string outfilename, mixed recipcert [, mixed recipkey])</em>
<a id='L4424' name='L4424'></a>4424 <em class='comment'>   Decrypts the S/MIME message in the file name infilename and output the results to the file name outfilename.  recipcert is a CERT for one of the recipients. recipkey specifies the private key matching recipcert, if recipcert does not include the key */</em>
<a id='L4425' name='L4425'></a>4425 
<a id='L4426' name='L4426'></a>4426 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29756.html' title='Multiple used in 3 places.'>openssl_pkcs7_decrypt</a>)
<a id='L4427' name='L4427'></a>4427 <em class='brace'>{</em>
<a id='L4428' name='L4428'></a>4428         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> * <a href='../Y/34171.html' title='Multiple used in 5 places.'>recipcert</a>, * <a href='../Y/34173.html' title='Multiple used in 4 places.'>recipkey</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4429' name='L4429'></a>4429         <a href='../Y/7359.html' title='Multiple used in 56 places.'>X509</a> * <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4430' name='L4430'></a>4430         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> * <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4431' name='L4431'></a>4431         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/13493.html' title='Multiple used in 3 places.'>certresval</a>, *<a href='../Y/24489.html' title='Multiple used in 3 places.'>keyresval</a>;
<a id='L4432' name='L4432'></a>4432         <a href='../Y/226.html' title='Multiple used in 32 places.'>BIO</a> * <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, * <a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, * <a href='../Y/15036.html' title='Multiple used in 7 places.'>datain</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4433' name='L4433'></a>4433         <a href='../Y/5074.html' title='Multiple used in 4 places.'>PKCS7</a> * <a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4434' name='L4434'></a>4434         <strong class='reserved'>char</strong> * <a href='../Y/23139.html' title='Multiple used in 14 places.'>infilename</a>;
<a id='L4435' name='L4435'></a>4435         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/23140.html' title='Multiple used in 6 places.'>infilename_len</a>;
<a id='L4436' name='L4436'></a>4436         <strong class='reserved'>char</strong> * <a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>;
<a id='L4437' name='L4437'></a>4437         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/30159.html' title='Multiple used in 6 places.'>outfilename_len</a>;
<a id='L4438' name='L4438'></a>4438 
<a id='L4439' name='L4439'></a>4439         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "ppz|z", &amp;<a href='../Y/23139.html' title='Multiple used in 14 places.'>infilename</a>, &amp;<a href='../Y/23140.html' title='Multiple used in 6 places.'>infilename_len</a>,
<a id='L4440' name='L4440'></a>4440                                 &amp;<a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>, &amp;<a href='../Y/30159.html' title='Multiple used in 6 places.'>outfilename_len</a>, &amp;<a href='../Y/34171.html' title='Multiple used in 5 places.'>recipcert</a>, &amp;<a href='../Y/34173.html' title='Multiple used in 4 places.'>recipkey</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L4441' name='L4441'></a>4441                 <strong class='reserved'>return</strong>;
<a id='L4442' name='L4442'></a>4442         <em class='brace'>}</em>
<a id='L4443' name='L4443'></a>4443 
<a id='L4444' name='L4444'></a>4444         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L4445' name='L4445'></a>4445 
<a id='L4446' name='L4446'></a>4446         <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> = <a href='../S/851.html#L1381' title='Defined at 1381 in ext/openssl/openssl.c.'>php_openssl_x509_from_zval</a>(<a href='../Y/34171.html' title='Multiple used in 5 places.'>recipcert</a>, 0, &amp;<a href='../Y/13493.html' title='Multiple used in 3 places.'>certresval</a>);
<a id='L4447' name='L4447'></a>4447         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4448' name='L4448'></a>4448                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "unable to coerce parameter 3 to x509 cert");
<a id='L4449' name='L4449'></a>4449                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4450' name='L4450'></a>4450         <em class='brace'>}</em>
<a id='L4451' name='L4451'></a>4451 
<a id='L4452' name='L4452'></a>4452         <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../Y/34173.html' title='Multiple used in 4 places.'>recipkey</a> ? <a href='../Y/34173.html' title='Multiple used in 4 places.'>recipkey</a> : <a href='../Y/34171.html' title='Multiple used in 5 places.'>recipcert</a>, 0, "", 0, &amp;<a href='../Y/24489.html' title='Multiple used in 3 places.'>keyresval</a>);
<a id='L4453' name='L4453'></a>4453         <strong class='reserved'>if</strong> (<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4454' name='L4454'></a>4454                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "unable to get private key");
<a id='L4455' name='L4455'></a>4455                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4456' name='L4456'></a>4456         <em class='brace'>}</em>
<a id='L4457' name='L4457'></a>4457 
<a id='L4458' name='L4458'></a>4458         <strong class='reserved'>if</strong> (<a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/23139.html' title='Multiple used in 14 places.'>infilename</a>) || <a href='../S/851.html#L594' title='Defined at 594 in ext/openssl/openssl.c.'>php_openssl_open_base_dir_chk</a>(<a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>)) <em class='brace'>{</em>
<a id='L4459' name='L4459'></a>4459                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4460' name='L4460'></a>4460         <em class='brace'>}</em>
<a id='L4461' name='L4461'></a>4461 
<a id='L4462' name='L4462'></a>4462         <a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/23139.html' title='Multiple used in 14 places.'>infilename</a>, "r");
<a id='L4463' name='L4463'></a>4463         <strong class='reserved'>if</strong> (<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4464' name='L4464'></a>4464                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4465' name='L4465'></a>4465         <em class='brace'>}</em>
<a id='L4466' name='L4466'></a>4466         <a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a> = <a href='../Y/232.html' title='Multiple used in 20 places.'>BIO_new_file</a>(<a href='../Y/30158.html' title='Multiple used in 17 places.'>outfilename</a>, "w");
<a id='L4467' name='L4467'></a>4467         <strong class='reserved'>if</strong> (<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4468' name='L4468'></a>4468                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4469' name='L4469'></a>4469         <em class='brace'>}</em>
<a id='L4470' name='L4470'></a>4470 
<a id='L4471' name='L4471'></a>4471         <a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a> = <a href='../Y/5676.html' title='Multiple used in 2 places.'>SMIME_read_PKCS7</a>(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>, &amp;<a href='../Y/15036.html' title='Multiple used in 7 places.'>datain</a>);
<a id='L4472' name='L4472'></a>4472 
<a id='L4473' name='L4473'></a>4473         <strong class='reserved'>if</strong> (<a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4474' name='L4474'></a>4474                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4475' name='L4475'></a>4475         <em class='brace'>}</em>
<a id='L4476' name='L4476'></a>4476         <strong class='reserved'>if</strong> (PKCS7_decrypt(<a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a>, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>, <a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>, <a href='../Y/5076.html' title='Multiple used in 4 places.'>PKCS7_DETACHED</a>)) <em class='brace'>{</em>
<a id='L4477' name='L4477'></a>4477                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L4478' name='L4478'></a>4478         <em class='brace'>}</em>
<a id='L4479' name='L4479'></a>4479 <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>:
<a id='L4480' name='L4480'></a>4480         <a href='../Y/5086.html' title='Multiple used in 4 places.'>PKCS7_free</a>(<a href='../Y/30259.html' title='Multiple used in 21 places.'>p7</a>);
<a id='L4481' name='L4481'></a>4481         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/15036.html' title='Multiple used in 7 places.'>datain</a>);
<a id='L4482' name='L4482'></a>4482         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../Y/22971.html' title='Multiple used in 902 places.'>in</a>);
<a id='L4483' name='L4483'></a>4483         <a href='../Y/227.html' title='Multiple used in 40 places.'>BIO_free</a>(<a href='../S/170.html#L386' title='Defined at 386 in ext/fileinfo/libmagic/file.h.'>out</a>);
<a id='L4484' name='L4484'></a>4484         <strong class='reserved'>if</strong> (<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a> &amp;&amp; <a href='../Y/13493.html' title='Multiple used in 3 places.'>certresval</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4485' name='L4485'></a>4485                 <a href='../Y/7439.html' title='Multiple used in 22 places.'>X509_free</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cert</a>);
<a id='L4486' name='L4486'></a>4486         <em class='brace'>}</em>
<a id='L4487' name='L4487'></a>4487         <strong class='reserved'>if</strong> (<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> &amp;&amp; <a href='../Y/24489.html' title='Multiple used in 3 places.'>keyresval</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4488' name='L4488'></a>4488                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>);
<a id='L4489' name='L4489'></a>4489         <em class='brace'>}</em>
<a id='L4490' name='L4490'></a>4490 <em class='brace'>}</em>
<a id='L4491' name='L4491'></a>4491 <em class='comment'>/* }}} */</em>
<a id='L4492' name='L4492'></a>4492 
<a id='L4493' name='L4493'></a>4493 <em class='comment'>/* }}} */</em>
<a id='L4494' name='L4494'></a>4494 
<a id='L4495' name='L4495'></a>4495 <em class='comment'>/* {{{ proto bool openssl_private_encrypt(string data, string &amp;crypted, mixed key [, int padding])</em>
<a id='L4496' name='L4496'></a>4496 <em class='comment'>   Encrypts data with private key */</em>
<a id='L4497' name='L4497'></a>4497 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29768.html' title='Multiple used in 3 places.'>openssl_private_encrypt</a>)
<a id='L4498' name='L4498'></a>4498 <em class='brace'>{</em>
<a id='L4499' name='L4499'></a>4499         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, *<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>;
<a id='L4500' name='L4500'></a>4500         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>;
<a id='L4501' name='L4501'></a>4501         <strong class='reserved'>int</strong> <a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>;
<a id='L4502' name='L4502'></a>4502         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4503' name='L4503'></a>4503         <strong class='reserved'>int</strong> <a href='../Y/37863.html' title='Multiple used in 17 places.'>successful</a> = 0;
<a id='L4504' name='L4504'></a>4504         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4505' name='L4505'></a>4505         <strong class='reserved'>char</strong> * <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>;
<a id='L4506' name='L4506'></a>4506         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>;
<a id='L4507' name='L4507'></a>4507         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a> = <a href='../Y/5398.html' title='Multiple used in 5 places.'>RSA_PKCS1_PADDING</a>;
<a id='L4508' name='L4508'></a>4508 
<a id='L4509' name='L4509'></a>4509         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "sz/z|l", &amp;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, &amp;<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, &amp;<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>, &amp;<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, &amp;<a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L4510' name='L4510'></a>4510                 <strong class='reserved'>return</strong>;
<a id='L4511' name='L4511'></a>4511         <em class='brace'>}</em>
<a id='L4512' name='L4512'></a>4512         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L4513' name='L4513'></a>4513 
<a id='L4514' name='L4514'></a>4514         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, 0, "", 0, &amp;<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>);
<a id='L4515' name='L4515'></a>4515 
<a id='L4516' name='L4516'></a>4516         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4517' name='L4517'></a>4517                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "key param is not a valid private key");
<a id='L4518' name='L4518'></a>4518                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4519' name='L4519'></a>4519         <em class='brace'>}</em>
<a id='L4520' name='L4520'></a>4520 
<a id='L4521' name='L4521'></a>4521         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>);
<a id='L4522' name='L4522'></a>4522 
<a id='L4523' name='L4523'></a>4523         <a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a> = <a href='../Y/2144.html' title='Multiple used in 7 places.'>EVP_PKEY_size</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L4524' name='L4524'></a>4524         <a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(<a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>, 0);
<a id='L4525' name='L4525'></a>4525 
<a id='L4526' name='L4526'></a>4526         <strong class='reserved'>switch</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>) <em class='brace'>{</em>
<a id='L4527' name='L4527'></a>4527                 <strong class='reserved'>case</strong> <a href='../Y/2134.html' title='Multiple used in 6 places.'>EVP_PKEY_RSA</a>:
<a id='L4528' name='L4528'></a>4528                 <strong class='reserved'>case</strong> <a href='../Y/2135.html' title='Multiple used in 6 places.'>EVP_PKEY_RSA2</a>:
<a id='L4529' name='L4529'></a>4529                         <a href='../Y/37863.html' title='Multiple used in 17 places.'>successful</a> = (RSA_private_encrypt((<strong class='reserved'>int</strong>)<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>,
<a id='L4530' name='L4530'></a>4530                                                 (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>,
<a id='L4531' name='L4531'></a>4531                                                 (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>),
<a id='L4532' name='L4532'></a>4532                                                 <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>,
<a id='L4533' name='L4533'></a>4533                                                 (<strong class='reserved'>int</strong>)<a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a>) == <a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>);
<a id='L4534' name='L4534'></a>4534                         <strong class='reserved'>break</strong>;
<a id='L4535' name='L4535'></a>4535                 <strong class='reserved'>default</strong>:
<a id='L4536' name='L4536'></a>4536                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "key type not supported in this PHP build!");
<a id='L4537' name='L4537'></a>4537         <em class='brace'>}</em>
<a id='L4538' name='L4538'></a>4538 
<a id='L4539' name='L4539'></a>4539         <strong class='reserved'>if</strong> (<a href='../Y/37863.html' title='Multiple used in 17 places.'>successful</a>) <em class='brace'>{</em>
<a id='L4540' name='L4540'></a>4540                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>);
<a id='L4541' name='L4541'></a>4541                 <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>)[<a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>] = '\0';
<a id='L4542' name='L4542'></a>4542                 <a href='../S/1731.html#L637' title='Defined at 637 in Zend/zend_types.h.'>ZVAL_NEW_STR</a>(<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>, <a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>);
<a id='L4543' name='L4543'></a>4543                 <a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4544' name='L4544'></a>4544                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L4545' name='L4545'></a>4545         <em class='brace'>}</em>
<a id='L4546' name='L4546'></a>4546         <strong class='reserved'>if</strong> (<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>) <em class='brace'>{</em>
<a id='L4547' name='L4547'></a>4547                 <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>);
<a id='L4548' name='L4548'></a>4548         <em class='brace'>}</em>
<a id='L4549' name='L4549'></a>4549         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4550' name='L4550'></a>4550                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L4551' name='L4551'></a>4551         <em class='brace'>}</em>
<a id='L4552' name='L4552'></a>4552 <em class='brace'>}</em>
<a id='L4553' name='L4553'></a>4553 <em class='comment'>/* }}} */</em>
<a id='L4554' name='L4554'></a>4554 
<a id='L4555' name='L4555'></a>4555 <em class='comment'>/* {{{ proto bool openssl_private_decrypt(string data, string &amp;decrypted, mixed key [, int padding])</em>
<a id='L4556' name='L4556'></a>4556 <em class='comment'>   Decrypts data with private key */</em>
<a id='L4557' name='L4557'></a>4557 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29767.html' title='Multiple used in 3 places.'>openssl_private_decrypt</a>)
<a id='L4558' name='L4558'></a>4558 <em class='brace'>{</em>
<a id='L4559' name='L4559'></a>4559         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, *<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>;
<a id='L4560' name='L4560'></a>4560         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>;
<a id='L4561' name='L4561'></a>4561         <strong class='reserved'>int</strong> <a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>;
<a id='L4562' name='L4562'></a>4562         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4563' name='L4563'></a>4563         <strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *<a href='../Y/14643.html' title='Multiple used in 10 places.'>crypttemp</a>;
<a id='L4564' name='L4564'></a>4564         <strong class='reserved'>int</strong> <a href='../Y/37863.html' title='Multiple used in 17 places.'>successful</a> = 0;
<a id='L4565' name='L4565'></a>4565         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a> = <a href='../Y/5398.html' title='Multiple used in 5 places.'>RSA_PKCS1_PADDING</a>;
<a id='L4566' name='L4566'></a>4566         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4567' name='L4567'></a>4567         <strong class='reserved'>char</strong> * <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>;
<a id='L4568' name='L4568'></a>4568         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>;
<a id='L4569' name='L4569'></a>4569 
<a id='L4570' name='L4570'></a>4570         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "sz/z|l", &amp;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, &amp;<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, &amp;<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>, &amp;<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, &amp;<a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L4571' name='L4571'></a>4571                 <strong class='reserved'>return</strong>;
<a id='L4572' name='L4572'></a>4572         <em class='brace'>}</em>
<a id='L4573' name='L4573'></a>4573         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L4574' name='L4574'></a>4574 
<a id='L4575' name='L4575'></a>4575         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, 0, "", 0, &amp;<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>);
<a id='L4576' name='L4576'></a>4576         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4577' name='L4577'></a>4577                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "key parameter is not a valid private key");
<a id='L4578' name='L4578'></a>4578                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4579' name='L4579'></a>4579         <em class='brace'>}</em>
<a id='L4580' name='L4580'></a>4580 
<a id='L4581' name='L4581'></a>4581         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>);
<a id='L4582' name='L4582'></a>4582 
<a id='L4583' name='L4583'></a>4583         <a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a> = <a href='../Y/2144.html' title='Multiple used in 7 places.'>EVP_PKEY_size</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L4584' name='L4584'></a>4584         <a href='../Y/14643.html' title='Multiple used in 10 places.'>crypttemp</a> = <a href='../D/21334.html' title='Multiple defined in 2 places.'>emalloc</a>(<a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a> + 1);
<a id='L4585' name='L4585'></a>4585 
<a id='L4586' name='L4586'></a>4586         <strong class='reserved'>switch</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>) <em class='brace'>{</em>
<a id='L4587' name='L4587'></a>4587                 <strong class='reserved'>case</strong> <a href='../Y/2134.html' title='Multiple used in 6 places.'>EVP_PKEY_RSA</a>:
<a id='L4588' name='L4588'></a>4588                 <strong class='reserved'>case</strong> <a href='../Y/2135.html' title='Multiple used in 6 places.'>EVP_PKEY_RSA2</a>:
<a id='L4589' name='L4589'></a>4589                         <a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a> = RSA_private_decrypt((<strong class='reserved'>int</strong>)<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>,
<a id='L4590' name='L4590'></a>4590                                         (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>,
<a id='L4591' name='L4591'></a>4591                                         <a href='../Y/14643.html' title='Multiple used in 10 places.'>crypttemp</a>,
<a id='L4592' name='L4592'></a>4592                                         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>,
<a id='L4593' name='L4593'></a>4593                                         (<strong class='reserved'>int</strong>)<a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a>);
<a id='L4594' name='L4594'></a>4594                         <strong class='reserved'>if</strong> (<a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a> != -1) <em class='brace'>{</em>
<a id='L4595' name='L4595'></a>4595                                 <a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(<a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>, 0);
<a id='L4596' name='L4596'></a>4596                                 <a href='../D/24499.html' title='Multiple defined in 4 places.'>memcpy</a>(<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>), <a href='../Y/14643.html' title='Multiple used in 10 places.'>crypttemp</a>, <a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>);
<a id='L4597' name='L4597'></a>4597                                 <a href='../Y/37863.html' title='Multiple used in 17 places.'>successful</a> = 1;
<a id='L4598' name='L4598'></a>4598                         <em class='brace'>}</em>
<a id='L4599' name='L4599'></a>4599                         <strong class='reserved'>break</strong>;
<a id='L4600' name='L4600'></a>4600                 <strong class='reserved'>default</strong>:
<a id='L4601' name='L4601'></a>4601                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "key type not supported in this PHP build!");
<a id='L4602' name='L4602'></a>4602         <em class='brace'>}</em>
<a id='L4603' name='L4603'></a>4603 
<a id='L4604' name='L4604'></a>4604         <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/14643.html' title='Multiple used in 10 places.'>crypttemp</a>);
<a id='L4605' name='L4605'></a>4605 
<a id='L4606' name='L4606'></a>4606         <strong class='reserved'>if</strong> (<a href='../Y/37863.html' title='Multiple used in 17 places.'>successful</a>) <em class='brace'>{</em>
<a id='L4607' name='L4607'></a>4607                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>);
<a id='L4608' name='L4608'></a>4608                 <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>)[<a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>] = '\0';
<a id='L4609' name='L4609'></a>4609                 <a href='../S/1731.html#L637' title='Defined at 637 in Zend/zend_types.h.'>ZVAL_NEW_STR</a>(<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>, <a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>);
<a id='L4610' name='L4610'></a>4610                 <a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4611' name='L4611'></a>4611                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L4612' name='L4612'></a>4612         <em class='brace'>}</em>
<a id='L4613' name='L4613'></a>4613 
<a id='L4614' name='L4614'></a>4614         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4615' name='L4615'></a>4615                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L4616' name='L4616'></a>4616         <em class='brace'>}</em>
<a id='L4617' name='L4617'></a>4617         <strong class='reserved'>if</strong> (<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>) <em class='brace'>{</em>
<a id='L4618' name='L4618'></a>4618                 <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>);
<a id='L4619' name='L4619'></a>4619         <em class='brace'>}</em>
<a id='L4620' name='L4620'></a>4620 <em class='brace'>}</em>
<a id='L4621' name='L4621'></a>4621 <em class='comment'>/* }}} */</em>
<a id='L4622' name='L4622'></a>4622 
<a id='L4623' name='L4623'></a>4623 <em class='comment'>/* {{{ proto bool openssl_public_encrypt(string data, string &amp;crypted, mixed key [, int padding])</em>
<a id='L4624' name='L4624'></a>4624 <em class='comment'>   Encrypts data with public key */</em>
<a id='L4625' name='L4625'></a>4625 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29772.html' title='Multiple used in 3 places.'>openssl_public_encrypt</a>)
<a id='L4626' name='L4626'></a>4626 <em class='brace'>{</em>
<a id='L4627' name='L4627'></a>4627         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, *<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>;
<a id='L4628' name='L4628'></a>4628         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>;
<a id='L4629' name='L4629'></a>4629         <strong class='reserved'>int</strong> <a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>;
<a id='L4630' name='L4630'></a>4630         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>;
<a id='L4631' name='L4631'></a>4631         <strong class='reserved'>int</strong> <a href='../Y/37863.html' title='Multiple used in 17 places.'>successful</a> = 0;
<a id='L4632' name='L4632'></a>4632         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4633' name='L4633'></a>4633         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a> = <a href='../Y/5398.html' title='Multiple used in 5 places.'>RSA_PKCS1_PADDING</a>;
<a id='L4634' name='L4634'></a>4634         <strong class='reserved'>char</strong> * <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>;
<a id='L4635' name='L4635'></a>4635         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>;
<a id='L4636' name='L4636'></a>4636 
<a id='L4637' name='L4637'></a>4637         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "sz/z|l", &amp;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, &amp;<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, &amp;<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>, &amp;<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, &amp;<a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>)
<a id='L4638' name='L4638'></a>4638                 <strong class='reserved'>return</strong>;
<a id='L4639' name='L4639'></a>4639         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L4640' name='L4640'></a>4640 
<a id='L4641' name='L4641'></a>4641         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, 1, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, 0, &amp;<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>);
<a id='L4642' name='L4642'></a>4642         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4643' name='L4643'></a>4643                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "key parameter is not a valid public key");
<a id='L4644' name='L4644'></a>4644                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4645' name='L4645'></a>4645         <em class='brace'>}</em>
<a id='L4646' name='L4646'></a>4646 
<a id='L4647' name='L4647'></a>4647         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>);
<a id='L4648' name='L4648'></a>4648 
<a id='L4649' name='L4649'></a>4649         <a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a> = <a href='../Y/2144.html' title='Multiple used in 7 places.'>EVP_PKEY_size</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L4650' name='L4650'></a>4650         <a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(<a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>, 0);
<a id='L4651' name='L4651'></a>4651 
<a id='L4652' name='L4652'></a>4652         <strong class='reserved'>switch</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>) <em class='brace'>{</em>
<a id='L4653' name='L4653'></a>4653                 <strong class='reserved'>case</strong> <a href='../Y/2134.html' title='Multiple used in 6 places.'>EVP_PKEY_RSA</a>:
<a id='L4654' name='L4654'></a>4654                 <strong class='reserved'>case</strong> <a href='../Y/2135.html' title='Multiple used in 6 places.'>EVP_PKEY_RSA2</a>:
<a id='L4655' name='L4655'></a>4655                         <a href='../Y/37863.html' title='Multiple used in 17 places.'>successful</a> = (<a href='../Y/5407.html' title='Multiple used in 2 places.'>RSA_public_encrypt</a>((<strong class='reserved'>int</strong>)<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>,
<a id='L4656' name='L4656'></a>4656                                                 (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>,
<a id='L4657' name='L4657'></a>4657                                                 (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>),
<a id='L4658' name='L4658'></a>4658                                                 <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>,
<a id='L4659' name='L4659'></a>4659                                                 (<strong class='reserved'>int</strong>)<a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a>) == <a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>);
<a id='L4660' name='L4660'></a>4660                         <strong class='reserved'>break</strong>;
<a id='L4661' name='L4661'></a>4661                 <strong class='reserved'>default</strong>:
<a id='L4662' name='L4662'></a>4662                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "key type not supported in this PHP build!");
<a id='L4663' name='L4663'></a>4663 
<a id='L4664' name='L4664'></a>4664         <em class='brace'>}</em>
<a id='L4665' name='L4665'></a>4665 
<a id='L4666' name='L4666'></a>4666         <strong class='reserved'>if</strong> (<a href='../Y/37863.html' title='Multiple used in 17 places.'>successful</a>) <em class='brace'>{</em>
<a id='L4667' name='L4667'></a>4667                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>);
<a id='L4668' name='L4668'></a>4668                 <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>)[<a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>] = '\0';
<a id='L4669' name='L4669'></a>4669                 <a href='../S/1731.html#L637' title='Defined at 637 in Zend/zend_types.h.'>ZVAL_NEW_STR</a>(<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>, <a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>);
<a id='L4670' name='L4670'></a>4670                 <a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4671' name='L4671'></a>4671                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L4672' name='L4672'></a>4672         <em class='brace'>}</em>
<a id='L4673' name='L4673'></a>4673         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4674' name='L4674'></a>4674                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L4675' name='L4675'></a>4675         <em class='brace'>}</em>
<a id='L4676' name='L4676'></a>4676         <strong class='reserved'>if</strong> (<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>) <em class='brace'>{</em>
<a id='L4677' name='L4677'></a>4677                 <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>);
<a id='L4678' name='L4678'></a>4678         <em class='brace'>}</em>
<a id='L4679' name='L4679'></a>4679 <em class='brace'>}</em>
<a id='L4680' name='L4680'></a>4680 <em class='comment'>/* }}} */</em>
<a id='L4681' name='L4681'></a>4681 
<a id='L4682' name='L4682'></a>4682 <em class='comment'>/* {{{ proto bool openssl_public_decrypt(string data, string &amp;crypted, resource key [, int padding])</em>
<a id='L4683' name='L4683'></a>4683 <em class='comment'>   Decrypts data with public key */</em>
<a id='L4684' name='L4684'></a>4684 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29771.html' title='Multiple used in 3 places.'>openssl_public_decrypt</a>)
<a id='L4685' name='L4685'></a>4685 <em class='brace'>{</em>
<a id='L4686' name='L4686'></a>4686         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, *<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>;
<a id='L4687' name='L4687'></a>4687         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>;
<a id='L4688' name='L4688'></a>4688         <strong class='reserved'>int</strong> <a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>;
<a id='L4689' name='L4689'></a>4689         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4690' name='L4690'></a>4690         <strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *<a href='../Y/14643.html' title='Multiple used in 10 places.'>crypttemp</a>;
<a id='L4691' name='L4691'></a>4691         <strong class='reserved'>int</strong> <a href='../Y/37863.html' title='Multiple used in 17 places.'>successful</a> = 0;
<a id='L4692' name='L4692'></a>4692         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4693' name='L4693'></a>4693         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a> = <a href='../Y/5398.html' title='Multiple used in 5 places.'>RSA_PKCS1_PADDING</a>;
<a id='L4694' name='L4694'></a>4694         <strong class='reserved'>char</strong> * <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>;
<a id='L4695' name='L4695'></a>4695         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>;
<a id='L4696' name='L4696'></a>4696 
<a id='L4697' name='L4697'></a>4697         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "sz/z|l", &amp;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, &amp;<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, &amp;<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>, &amp;<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, &amp;<a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L4698' name='L4698'></a>4698                 <strong class='reserved'>return</strong>;
<a id='L4699' name='L4699'></a>4699         <em class='brace'>}</em>
<a id='L4700' name='L4700'></a>4700         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L4701' name='L4701'></a>4701 
<a id='L4702' name='L4702'></a>4702         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, 1, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, 0, &amp;<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>);
<a id='L4703' name='L4703'></a>4703         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4704' name='L4704'></a>4704                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "key parameter is not a valid public key");
<a id='L4705' name='L4705'></a>4705                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4706' name='L4706'></a>4706         <em class='brace'>}</em>
<a id='L4707' name='L4707'></a>4707 
<a id='L4708' name='L4708'></a>4708         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>);
<a id='L4709' name='L4709'></a>4709 
<a id='L4710' name='L4710'></a>4710         <a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a> = <a href='../Y/2144.html' title='Multiple used in 7 places.'>EVP_PKEY_size</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L4711' name='L4711'></a>4711         <a href='../Y/14643.html' title='Multiple used in 10 places.'>crypttemp</a> = <a href='../D/21334.html' title='Multiple defined in 2 places.'>emalloc</a>(<a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a> + 1);
<a id='L4712' name='L4712'></a>4712 
<a id='L4713' name='L4713'></a>4713         <strong class='reserved'>switch</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>) <em class='brace'>{</em>
<a id='L4714' name='L4714'></a>4714                 <strong class='reserved'>case</strong> <a href='../Y/2134.html' title='Multiple used in 6 places.'>EVP_PKEY_RSA</a>:
<a id='L4715' name='L4715'></a>4715                 <strong class='reserved'>case</strong> <a href='../Y/2135.html' title='Multiple used in 6 places.'>EVP_PKEY_RSA2</a>:
<a id='L4716' name='L4716'></a>4716                         <a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a> = RSA_public_decrypt((<strong class='reserved'>int</strong>)<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>,
<a id='L4717' name='L4717'></a>4717                                         (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>,
<a id='L4718' name='L4718'></a>4718                                         <a href='../Y/14643.html' title='Multiple used in 10 places.'>crypttemp</a>,
<a id='L4719' name='L4719'></a>4719                                         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/35071.html' title='Multiple used in 31 places.'>rsa</a>,
<a id='L4720' name='L4720'></a>4720                                         (<strong class='reserved'>int</strong>)<a href='../Y/31091.html' title='Multiple used in 68 places.'>padding</a>);
<a id='L4721' name='L4721'></a>4721                         <strong class='reserved'>if</strong> (<a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a> != -1) <em class='brace'>{</em>
<a id='L4722' name='L4722'></a>4722                                 <a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(<a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>, 0);
<a id='L4723' name='L4723'></a>4723                                 <a href='../D/24499.html' title='Multiple defined in 4 places.'>memcpy</a>(<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>), <a href='../Y/14643.html' title='Multiple used in 10 places.'>crypttemp</a>, <a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>);
<a id='L4724' name='L4724'></a>4724                                 <a href='../Y/37863.html' title='Multiple used in 17 places.'>successful</a> = 1;
<a id='L4725' name='L4725'></a>4725                         <em class='brace'>}</em>
<a id='L4726' name='L4726'></a>4726                         <strong class='reserved'>break</strong>;
<a id='L4727' name='L4727'></a>4727 
<a id='L4728' name='L4728'></a>4728                 <strong class='reserved'>default</strong>:
<a id='L4729' name='L4729'></a>4729                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "key type not supported in this PHP build!");
<a id='L4730' name='L4730'></a>4730 
<a id='L4731' name='L4731'></a>4731         <em class='brace'>}</em>
<a id='L4732' name='L4732'></a>4732 
<a id='L4733' name='L4733'></a>4733         <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/14643.html' title='Multiple used in 10 places.'>crypttemp</a>);
<a id='L4734' name='L4734'></a>4734 
<a id='L4735' name='L4735'></a>4735         <strong class='reserved'>if</strong> (<a href='../Y/37863.html' title='Multiple used in 17 places.'>successful</a>) <em class='brace'>{</em>
<a id='L4736' name='L4736'></a>4736                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>);
<a id='L4737' name='L4737'></a>4737                 <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>)[<a href='../Y/14639.html' title='Multiple used in 26 places.'>cryptedlen</a>] = '\0';
<a id='L4738' name='L4738'></a>4738                 <a href='../S/1731.html#L637' title='Defined at 637 in Zend/zend_types.h.'>ZVAL_NEW_STR</a>(<a href='../Y/14637.html' title='Multiple used in 20 places.'>crypted</a>, <a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>);
<a id='L4739' name='L4739'></a>4739                 <a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4740' name='L4740'></a>4740                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L4741' name='L4741'></a>4741         <em class='brace'>}</em>
<a id='L4742' name='L4742'></a>4742 
<a id='L4743' name='L4743'></a>4743         <strong class='reserved'>if</strong> (<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>) <em class='brace'>{</em>
<a id='L4744' name='L4744'></a>4744                 <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../Y/14638.html' title='Multiple used in 32 places.'>cryptedbuf</a>);
<a id='L4745' name='L4745'></a>4745         <em class='brace'>}</em>
<a id='L4746' name='L4746'></a>4746         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4747' name='L4747'></a>4747                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L4748' name='L4748'></a>4748         <em class='brace'>}</em>
<a id='L4749' name='L4749'></a>4749 <em class='brace'>}</em>
<a id='L4750' name='L4750'></a>4750 <em class='comment'>/* }}} */</em>
<a id='L4751' name='L4751'></a>4751 
<a id='L4752' name='L4752'></a>4752 <em class='comment'>/* {{{ proto mixed openssl_error_string(void)</em>
<a id='L4753' name='L4753'></a>4753 <em class='comment'>   Returns a description of the last error, and alters the index of the error messages. Returns false when the are no more messages */</em>
<a id='L4754' name='L4754'></a>4754 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29742.html' title='Multiple used in 3 places.'>openssl_error_string</a>)
<a id='L4755' name='L4755'></a>4755 <em class='brace'>{</em>
<a id='L4756' name='L4756'></a>4756         <strong class='reserved'>char</strong> <a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>[512];
<a id='L4757' name='L4757'></a>4757         <strong class='reserved'>unsigned</strong> <strong class='reserved'>long</strong> <a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>;
<a id='L4758' name='L4758'></a>4758 
<a id='L4759' name='L4759'></a>4759         <strong class='reserved'>if</strong> (<a href='../D/34452.html' title='Multiple defined in 2 places.'>zend_parse_parameters_none</a>() == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L4760' name='L4760'></a>4760                 <strong class='reserved'>return</strong>;
<a id='L4761' name='L4761'></a>4761         <em class='brace'>}</em>
<a id='L4762' name='L4762'></a>4762 
<a id='L4763' name='L4763'></a>4763         <a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a> = <a href='../Y/1855.html' title='Multiple used in 6 places.'>ERR_get_error</a>();
<a id='L4764' name='L4764'></a>4764         <strong class='reserved'>if</strong> (<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>) <em class='brace'>{</em>
<a id='L4765' name='L4765'></a>4765                 <a href='../S/1632.html#L637' title='Defined at 637 in Zend/zend_API.h.'>RETURN_STRING</a>(<a href='../Y/1852.html' title='Multiple used in 2 places.'>ERR_error_string</a>(<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>, <a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>));
<a id='L4766' name='L4766'></a>4766         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L4767' name='L4767'></a>4767                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4768' name='L4768'></a>4768         <em class='brace'>}</em>
<a id='L4769' name='L4769'></a>4769 <em class='brace'>}</em>
<a id='L4770' name='L4770'></a>4770 <em class='comment'>/* }}} */</em>
<a id='L4771' name='L4771'></a>4771 
<a id='L4772' name='L4772'></a>4772 <em class='comment'>/* {{{ proto bool openssl_sign(string data, &amp;string signature, mixed key[, mixed method])</em>
<a id='L4773' name='L4773'></a>4773 <em class='comment'>   Signs data */</em>
<a id='L4774' name='L4774'></a>4774 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29775.html' title='Multiple used in 3 places.'>openssl_sign</a>)
<a id='L4775' name='L4775'></a>4775 <em class='brace'>{</em>
<a id='L4776' name='L4776'></a>4776         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, *<a href='../Y/36171.html' title='Multiple used in 91 places.'>signature</a>;
<a id='L4777' name='L4777'></a>4777         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>;
<a id='L4778' name='L4778'></a>4778         <strong class='reserved'>unsigned</strong> <strong class='reserved'>int</strong> <a href='../Y/36164.html' title='Multiple used in 22 places.'>siglen</a>;
<a id='L4779' name='L4779'></a>4779         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a>;
<a id='L4780' name='L4780'></a>4780         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4781' name='L4781'></a>4781         <strong class='reserved'>char</strong> * <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>;
<a id='L4782' name='L4782'></a>4782         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>;
<a id='L4783' name='L4783'></a>4783         <a href='../Y/2118.html' title='Multiple used in 5 places.'>EVP_MD_CTX</a> <a href='../Y/26415.html' title='Multiple used in 26 places.'>md_ctx</a>;
<a id='L4784' name='L4784'></a>4784         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4785' name='L4785'></a>4785         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/36172.html' title='Multiple used in 6 places.'>signature_algo</a> = <a href='../S/851.html#L69' title='Defined at 69 in ext/openssl/openssl.c.'>OPENSSL_ALGO_SHA1</a>;
<a id='L4786' name='L4786'></a>4786         <strong class='reserved'>const</strong> <a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *<a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>;
<a id='L4787' name='L4787'></a>4787 
<a id='L4788' name='L4788'></a>4788         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "sz/z|z", &amp;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, &amp;<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, &amp;<a href='../Y/36171.html' title='Multiple used in 91 places.'>signature</a>, &amp;<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, &amp;<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L4789' name='L4789'></a>4789                 <strong class='reserved'>return</strong>;
<a id='L4790' name='L4790'></a>4790         <em class='brace'>}</em>
<a id='L4791' name='L4791'></a>4791         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, 0, "", 0, &amp;<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>);
<a id='L4792' name='L4792'></a>4792         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4793' name='L4793'></a>4793                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "supplied key param cannot be coerced into a private key");
<a id='L4794' name='L4794'></a>4794                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4795' name='L4795'></a>4795         <em class='brace'>}</em>
<a id='L4796' name='L4796'></a>4796 
<a id='L4797' name='L4797'></a>4797         <strong class='reserved'>if</strong> (<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> || <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>) == <a href='../S/1731.html#L306' title='Defined at 306 in Zend/zend_types.h.'>IS_LONG</a>) <em class='brace'>{</em>
<a id='L4798' name='L4798'></a>4798                 <strong class='reserved'>if</strong> (<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4799' name='L4799'></a>4799                         <a href='../Y/36172.html' title='Multiple used in 6 places.'>signature_algo</a> = <a href='../S/1731.html#L507' title='Defined at 507 in Zend/zend_types.h.'>Z_LVAL_P</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>);
<a id='L4800' name='L4800'></a>4800                 <em class='brace'>}</em>
<a id='L4801' name='L4801'></a>4801                 <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = <a href='../S/851.html#L1059' title='Defined at 1059 in ext/openssl/openssl.c.'>php_openssl_get_evp_md_from_algo</a>(<a href='../Y/36172.html' title='Multiple used in 6 places.'>signature_algo</a>);
<a id='L4802' name='L4802'></a>4802         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong> (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>) == <a href='../S/1731.html#L308' title='Defined at 308 in Zend/zend_types.h.'>IS_STRING</a>) <em class='brace'>{</em>
<a id='L4803' name='L4803'></a>4803                 <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = <a href='../Y/2163.html' title='Multiple used in 6 places.'>EVP_get_digestbyname</a>(<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>));
<a id='L4804' name='L4804'></a>4804         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L4805' name='L4805'></a>4805                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown signature algorithm.");
<a id='L4806' name='L4806'></a>4806                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4807' name='L4807'></a>4807         <em class='brace'>}</em>
<a id='L4808' name='L4808'></a>4808         <strong class='reserved'>if</strong> (!<a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>) <em class='brace'>{</em>
<a id='L4809' name='L4809'></a>4809                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown signature algorithm.");
<a id='L4810' name='L4810'></a>4810                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4811' name='L4811'></a>4811         <em class='brace'>}</em>
<a id='L4812' name='L4812'></a>4812 
<a id='L4813' name='L4813'></a>4813         <a href='../Y/36164.html' title='Multiple used in 22 places.'>siglen</a> = <a href='../Y/2144.html' title='Multiple used in 7 places.'>EVP_PKEY_size</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L4814' name='L4814'></a>4814         <a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(<a href='../Y/36164.html' title='Multiple used in 22 places.'>siglen</a>, 0);
<a id='L4815' name='L4815'></a>4815 
<a id='L4816' name='L4816'></a>4816         <a href='../Y/2150.html' title='Multiple used in 2 places.'>EVP_SignInit</a>(&amp;<a href='../Y/26415.html' title='Multiple used in 26 places.'>md_ctx</a>, <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>);
<a id='L4817' name='L4817'></a>4817         <a href='../Y/2151.html' title='Multiple used in 2 places.'>EVP_SignUpdate</a>(&amp;<a href='../Y/26415.html' title='Multiple used in 26 places.'>md_ctx</a>, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>);
<a id='L4818' name='L4818'></a>4818         <strong class='reserved'>if</strong> (<a href='../Y/2149.html' title='Multiple used in 2 places.'>EVP_SignFinal</a> (&amp;<a href='../Y/26415.html' title='Multiple used in 26 places.'>md_ctx</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a>), &amp;<a href='../Y/36164.html' title='Multiple used in 22 places.'>siglen</a>, <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>)) <em class='brace'>{</em>
<a id='L4819' name='L4819'></a>4819                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/36171.html' title='Multiple used in 91 places.'>signature</a>);
<a id='L4820' name='L4820'></a>4820                 <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a>)[<a href='../Y/36164.html' title='Multiple used in 22 places.'>siglen</a>] = '\0';
<a id='L4821' name='L4821'></a>4821                 <a href='../S/1725.html#L41' title='Defined at 41 in Zend/zend_string.h.'>ZSTR_LEN</a>(<a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a>) = <a href='../Y/36164.html' title='Multiple used in 22 places.'>siglen</a>;
<a id='L4822' name='L4822'></a>4822                 <a href='../S/1731.html#L637' title='Defined at 637 in Zend/zend_types.h.'>ZVAL_NEW_STR</a>(<a href='../Y/36171.html' title='Multiple used in 91 places.'>signature</a>, <a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a>);
<a id='L4823' name='L4823'></a>4823                 <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L4824' name='L4824'></a>4824         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L4825' name='L4825'></a>4825                 <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a>);
<a id='L4826' name='L4826'></a>4826                 <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L4827' name='L4827'></a>4827         <em class='brace'>}</em>
<a id='L4828' name='L4828'></a>4828         <a href='../Y/2119.html' title='Multiple used in 4 places.'>EVP_MD_CTX_cleanup</a>(&amp;<a href='../Y/26415.html' title='Multiple used in 26 places.'>md_ctx</a>);
<a id='L4829' name='L4829'></a>4829         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4830' name='L4830'></a>4830                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L4831' name='L4831'></a>4831         <em class='brace'>}</em>
<a id='L4832' name='L4832'></a>4832 <em class='brace'>}</em>
<a id='L4833' name='L4833'></a>4833 <em class='comment'>/* }}} */</em>
<a id='L4834' name='L4834'></a>4834 
<a id='L4835' name='L4835'></a>4835 <em class='comment'>/* {{{ proto int openssl_verify(string data, string signature, mixed key[, mixed method])</em>
<a id='L4836' name='L4836'></a>4836 <em class='comment'>   Verifys data */</em>
<a id='L4837' name='L4837'></a>4837 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29780.html' title='Multiple used in 3 places.'>openssl_verify</a>)
<a id='L4838' name='L4838'></a>4838 <em class='brace'>{</em>
<a id='L4839' name='L4839'></a>4839         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>;
<a id='L4840' name='L4840'></a>4840         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>;
<a id='L4841' name='L4841'></a>4841         <strong class='reserved'>int</strong> <a href='../Y/16980.html' title='Multiple used in 1388 places.'>err</a>;
<a id='L4842' name='L4842'></a>4842         <a href='../Y/2118.html' title='Multiple used in 5 places.'>EVP_MD_CTX</a> <a href='../Y/26415.html' title='Multiple used in 26 places.'>md_ctx</a>;
<a id='L4843' name='L4843'></a>4843         <strong class='reserved'>const</strong> <a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *<a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>;
<a id='L4844' name='L4844'></a>4844         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4845' name='L4845'></a>4845         <strong class='reserved'>char</strong> * <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>;
<a id='L4846' name='L4846'></a>4846         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>;
<a id='L4847' name='L4847'></a>4847         <strong class='reserved'>char</strong> * <a href='../Y/36171.html' title='Multiple used in 91 places.'>signature</a>;
<a id='L4848' name='L4848'></a>4848         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/36173.html' title='Multiple used in 21 places.'>signature_len</a>;
<a id='L4849' name='L4849'></a>4849         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4850' name='L4850'></a>4850         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/36172.html' title='Multiple used in 6 places.'>signature_algo</a> = <a href='../S/851.html#L69' title='Defined at 69 in ext/openssl/openssl.c.'>OPENSSL_ALGO_SHA1</a>;
<a id='L4851' name='L4851'></a>4851 
<a id='L4852' name='L4852'></a>4852         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "ssz|z", &amp;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, &amp;<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, &amp;<a href='../Y/36171.html' title='Multiple used in 91 places.'>signature</a>, &amp;<a href='../Y/36173.html' title='Multiple used in 21 places.'>signature_len</a>, &amp;<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, &amp;<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L4853' name='L4853'></a>4853                 <strong class='reserved'>return</strong>;
<a id='L4854' name='L4854'></a>4854         <em class='brace'>}</em>
<a id='L4855' name='L4855'></a>4855 
<a id='L4856' name='L4856'></a>4856         <a href='../S/851.html#L552' title='Defined at 552 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_UINT</a>(<a href='../Y/36173.html' title='Multiple used in 21 places.'>signature_len</a>, <a href='../Y/36171.html' title='Multiple used in 91 places.'>signature</a>);
<a id='L4857' name='L4857'></a>4857 
<a id='L4858' name='L4858'></a>4858         <strong class='reserved'>if</strong> (<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> || <a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>) == <a href='../S/1731.html#L306' title='Defined at 306 in Zend/zend_types.h.'>IS_LONG</a>) <em class='brace'>{</em>
<a id='L4859' name='L4859'></a>4859                 <strong class='reserved'>if</strong> (<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a> != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4860' name='L4860'></a>4860                         <a href='../Y/36172.html' title='Multiple used in 6 places.'>signature_algo</a> = <a href='../S/1731.html#L507' title='Defined at 507 in Zend/zend_types.h.'>Z_LVAL_P</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>);
<a id='L4861' name='L4861'></a>4861                 <em class='brace'>}</em>
<a id='L4862' name='L4862'></a>4862                 <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = <a href='../S/851.html#L1059' title='Defined at 1059 in ext/openssl/openssl.c.'>php_openssl_get_evp_md_from_algo</a>(<a href='../Y/36172.html' title='Multiple used in 6 places.'>signature_algo</a>);
<a id='L4863' name='L4863'></a>4863         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong> (<a href='../S/1731.html#L337' title='Defined at 337 in Zend/zend_types.h.'>Z_TYPE_P</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>) == <a href='../S/1731.html#L308' title='Defined at 308 in Zend/zend_types.h.'>IS_STRING</a>) <em class='brace'>{</em>
<a id='L4864' name='L4864'></a>4864                 <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = <a href='../Y/2163.html' title='Multiple used in 6 places.'>EVP_get_digestbyname</a>(<a href='../S/1731.html#L516' title='Defined at 516 in Zend/zend_types.h.'>Z_STRVAL_P</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>));
<a id='L4865' name='L4865'></a>4865         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L4866' name='L4866'></a>4866                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown signature algorithm.");
<a id='L4867' name='L4867'></a>4867                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4868' name='L4868'></a>4868         <em class='brace'>}</em>
<a id='L4869' name='L4869'></a>4869         <strong class='reserved'>if</strong> (!<a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>) <em class='brace'>{</em>
<a id='L4870' name='L4870'></a>4870                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown signature algorithm.");
<a id='L4871' name='L4871'></a>4871                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4872' name='L4872'></a>4872         <em class='brace'>}</em>
<a id='L4873' name='L4873'></a>4873 
<a id='L4874' name='L4874'></a>4874         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, 1, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, 0, &amp;<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>);
<a id='L4875' name='L4875'></a>4875         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4876' name='L4876'></a>4876                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "supplied key param cannot be coerced into a public key");
<a id='L4877' name='L4877'></a>4877                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4878' name='L4878'></a>4878         <em class='brace'>}</em>
<a id='L4879' name='L4879'></a>4879 
<a id='L4880' name='L4880'></a>4880         <a href='../Y/2153.html' title='Multiple used in 2 places.'>EVP_VerifyInit</a> (&amp;<a href='../Y/26415.html' title='Multiple used in 26 places.'>md_ctx</a>, <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>);
<a id='L4881' name='L4881'></a>4881         <a href='../Y/2154.html' title='Multiple used in 2 places.'>EVP_VerifyUpdate</a> (&amp;<a href='../Y/26415.html' title='Multiple used in 26 places.'>md_ctx</a>, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>);
<a id='L4882' name='L4882'></a>4882         <a href='../Y/16980.html' title='Multiple used in 1388 places.'>err</a> = <a href='../Y/2152.html' title='Multiple used in 2 places.'>EVP_VerifyFinal</a>(&amp;<a href='../Y/26415.html' title='Multiple used in 26 places.'>md_ctx</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../Y/36171.html' title='Multiple used in 91 places.'>signature</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>int</strong>)<a href='../Y/36173.html' title='Multiple used in 21 places.'>signature_len</a>, <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L4883' name='L4883'></a>4883         <a href='../Y/2119.html' title='Multiple used in 4 places.'>EVP_MD_CTX_cleanup</a>(&amp;<a href='../Y/26415.html' title='Multiple used in 26 places.'>md_ctx</a>);
<a id='L4884' name='L4884'></a>4884 
<a id='L4885' name='L4885'></a>4885         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4886' name='L4886'></a>4886                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L4887' name='L4887'></a>4887         <em class='brace'>}</em>
<a id='L4888' name='L4888'></a>4888         <a href='../S/1632.html#L631' title='Defined at 631 in Zend/zend_API.h.'>RETURN_LONG</a>(<a href='../Y/16980.html' title='Multiple used in 1388 places.'>err</a>);
<a id='L4889' name='L4889'></a>4889 <em class='brace'>}</em>
<a id='L4890' name='L4890'></a>4890 <em class='comment'>/* }}} */</em>
<a id='L4891' name='L4891'></a>4891 
<a id='L4892' name='L4892'></a>4892 <em class='comment'>/* {{{ proto int openssl_seal(string data, &amp;string sealdata, &amp;array ekeys, array pubkeys)</em>
<a id='L4893' name='L4893'></a>4893 <em class='comment'>   Seals data */</em>
<a id='L4894' name='L4894'></a>4894 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29774.html' title='Multiple used in 3 places.'>openssl_seal</a>)
<a id='L4895' name='L4895'></a>4895 <em class='brace'>{</em>
<a id='L4896' name='L4896'></a>4896         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../Y/33726.html' title='Multiple used in 4 places.'>pubkeys</a>, *<a href='../Y/33725.html' title='Multiple used in 15 places.'>pubkey</a>, *<a href='../Y/35545.html' title='Multiple used in 5 places.'>sealdata</a>, *<a href='../Y/16518.html' title='Multiple used in 6 places.'>ekeys</a>, *<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4897' name='L4897'></a>4897         <a href='../S/1731.html#L174' title='Defined at 174 in Zend/zend_types.h.'>HashTable</a> *<a href='../Y/33727.html' title='Multiple used in 4 places.'>pubkeysht</a>;
<a id='L4898' name='L4898'></a>4898         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> **<a href='../Y/32833.html' title='Multiple used in 10 places.'>pkeys</a>;
<a id='L4899' name='L4899'></a>4899         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> ** <a href='../Y/24468.html' title='Multiple used in 6 places.'>key_resources</a>; <em class='comment'>/* so we know what to cleanup */</em>
<a id='L4900' name='L4900'></a>4900         <strong class='reserved'>int</strong> <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>, <a href='../Y/24984.html' title='Multiple used in 67 places.'>len1</a>, <a href='../Y/24985.html' title='Multiple used in 107 places.'>len2</a>, *<a href='../Y/16520.html' title='Multiple used in 6 places.'>eksl</a>, <a href='../Y/28547.html' title='Multiple used in 13 places.'>nkeys</a>, <a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a>;
<a id='L4901' name='L4901'></a>4901         <strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> <a href='../Y/24242.html' title='Multiple used in 8 places.'>iv_buf</a>[EVP_MAX_IV_LENGTH + 1], *<a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, **<a href='../Y/16519.html' title='Multiple used in 12 places.'>eks</a>;
<a id='L4902' name='L4902'></a>4902         <strong class='reserved'>char</strong> * <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>;
<a id='L4903' name='L4903'></a>4903         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>;
<a id='L4904' name='L4904'></a>4904         <strong class='reserved'>char</strong> *<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a> =<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4905' name='L4905'></a>4905         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a> = 0;
<a id='L4906' name='L4906'></a>4906         <strong class='reserved'>const</strong> <a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a> *<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>;
<a id='L4907' name='L4907'></a>4907         <a href='../Y/2096.html' title='Multiple used in 4 places.'>EVP_CIPHER_CTX</a> <a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>;
<a id='L4908' name='L4908'></a>4908 
<a id='L4909' name='L4909'></a>4909         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "sz/z/a/|sz/", &amp;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, &amp;<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>,
<a id='L4910' name='L4910'></a>4910                                 &amp;<a href='../Y/35545.html' title='Multiple used in 5 places.'>sealdata</a>, &amp;<a href='../Y/16518.html' title='Multiple used in 6 places.'>ekeys</a>, &amp;<a href='../Y/33726.html' title='Multiple used in 4 places.'>pubkeys</a>, &amp;<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>, &amp;<a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>, &amp;<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L4911' name='L4911'></a>4911                 <strong class='reserved'>return</strong>;
<a id='L4912' name='L4912'></a>4912         <em class='brace'>}</em>
<a id='L4913' name='L4913'></a>4913         <a href='../Y/33727.html' title='Multiple used in 4 places.'>pubkeysht</a> = <a href='../S/1731.html#L528' title='Defined at 528 in Zend/zend_types.h.'>Z_ARRVAL_P</a>(<a href='../Y/33726.html' title='Multiple used in 4 places.'>pubkeys</a>);
<a id='L4914' name='L4914'></a>4914         <a href='../Y/28547.html' title='Multiple used in 13 places.'>nkeys</a> = <a href='../Y/33727.html' title='Multiple used in 4 places.'>pubkeysht</a> ? <a href='../S/1668.html#L211' title='Defined at 211 in Zend/zend_hash.h.'>zend_hash_num_elements</a>(<a href='../Y/33727.html' title='Multiple used in 4 places.'>pubkeysht</a>) : 0;
<a id='L4915' name='L4915'></a>4915         <strong class='reserved'>if</strong> (!<a href='../Y/28547.html' title='Multiple used in 13 places.'>nkeys</a>) <em class='brace'>{</em>
<a id='L4916' name='L4916'></a>4916                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Fourth argument to openssl_seal() must be a non-empty array");
<a id='L4917' name='L4917'></a>4917                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4918' name='L4918'></a>4918         <em class='brace'>}</em>
<a id='L4919' name='L4919'></a>4919 
<a id='L4920' name='L4920'></a>4920         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>);
<a id='L4921' name='L4921'></a>4921 
<a id='L4922' name='L4922'></a>4922         <strong class='reserved'>if</strong> (<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>) <em class='brace'>{</em>
<a id='L4923' name='L4923'></a>4923                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> = <a href='../Y/2162.html' title='Multiple used in 5 places.'>EVP_get_cipherbyname</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>);
<a id='L4924' name='L4924'></a>4924                 <strong class='reserved'>if</strong> (!<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>) <em class='brace'>{</em>
<a id='L4925' name='L4925'></a>4925                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown signature algorithm.");
<a id='L4926' name='L4926'></a>4926                         <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4927' name='L4927'></a>4927                 <em class='brace'>}</em>
<a id='L4928' name='L4928'></a>4928         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L4929' name='L4929'></a>4929                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> = <a href='../Y/2170.html' title='Multiple used in 2 places.'>EVP_rc4</a>();
<a id='L4930' name='L4930'></a>4930         <em class='brace'>}</em>
<a id='L4931' name='L4931'></a>4931 
<a id='L4932' name='L4932'></a>4932         <a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a> = <a href='../Y/2102.html' title='Multiple used in 5 places.'>EVP_CIPHER_iv_length</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>);
<a id='L4933' name='L4933'></a>4933         <strong class='reserved'>if</strong> (!<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a> &amp;&amp; <a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a> &gt; 0) <em class='brace'>{</em>
<a id='L4934' name='L4934'></a>4934                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>,
<a id='L4935' name='L4935'></a>4935                                 "Cipher algorithm requires an IV to be supplied as a sixth parameter");
<a id='L4936' name='L4936'></a>4936                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L4937' name='L4937'></a>4937         <em class='brace'>}</em>
<a id='L4938' name='L4938'></a>4938 
<a id='L4939' name='L4939'></a>4939         <a href='../Y/32833.html' title='Multiple used in 10 places.'>pkeys</a> = <a href='../D/29341.html' title='Multiple defined in 2 places.'>safe_emalloc</a>(<a href='../Y/28547.html' title='Multiple used in 13 places.'>nkeys</a>, <strong class='reserved'>sizeof</strong>(*<a href='../Y/32833.html' title='Multiple used in 10 places.'>pkeys</a>), 0);
<a id='L4940' name='L4940'></a>4940         <a href='../Y/16520.html' title='Multiple used in 6 places.'>eksl</a> = <a href='../D/29341.html' title='Multiple defined in 2 places.'>safe_emalloc</a>(<a href='../Y/28547.html' title='Multiple used in 13 places.'>nkeys</a>, <strong class='reserved'>sizeof</strong>(*<a href='../Y/16520.html' title='Multiple used in 6 places.'>eksl</a>), 0);
<a id='L4941' name='L4941'></a>4941         <a href='../Y/16519.html' title='Multiple used in 12 places.'>eks</a> = <a href='../D/29341.html' title='Multiple defined in 2 places.'>safe_emalloc</a>(<a href='../Y/28547.html' title='Multiple used in 13 places.'>nkeys</a>, <strong class='reserved'>sizeof</strong>(*<a href='../Y/16519.html' title='Multiple used in 12 places.'>eks</a>), 0);
<a id='L4942' name='L4942'></a>4942         <a href='../S/868.html#L374' title='Defined at 374 in ext/pcre/pcrelib/pcre_internal.h.'>memset</a>(<a href='../Y/16519.html' title='Multiple used in 12 places.'>eks</a>, 0, <strong class='reserved'>sizeof</strong>(*<a href='../Y/16519.html' title='Multiple used in 12 places.'>eks</a>) * <a href='../Y/28547.html' title='Multiple used in 13 places.'>nkeys</a>);
<a id='L4943' name='L4943'></a>4943         <a href='../Y/24468.html' title='Multiple used in 6 places.'>key_resources</a> = <a href='../D/29341.html' title='Multiple defined in 2 places.'>safe_emalloc</a>(<a href='../Y/28547.html' title='Multiple used in 13 places.'>nkeys</a>, <strong class='reserved'>sizeof</strong>(<a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a>*), 0);
<a id='L4944' name='L4944'></a>4944         <a href='../S/868.html#L374' title='Defined at 374 in ext/pcre/pcrelib/pcre_internal.h.'>memset</a>(<a href='../Y/24468.html' title='Multiple used in 6 places.'>key_resources</a>, 0, <strong class='reserved'>sizeof</strong>(<a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a>*) * <a href='../Y/28547.html' title='Multiple used in 13 places.'>nkeys</a>);
<a id='L4945' name='L4945'></a>4945         <a href='../S/868.html#L374' title='Defined at 374 in ext/pcre/pcrelib/pcre_internal.h.'>memset</a>(<a href='../Y/32833.html' title='Multiple used in 10 places.'>pkeys</a>, 0, <strong class='reserved'>sizeof</strong>(*<a href='../Y/32833.html' title='Multiple used in 10 places.'>pkeys</a>) * <a href='../Y/28547.html' title='Multiple used in 13 places.'>nkeys</a>);
<a id='L4946' name='L4946'></a>4946 
<a id='L4947' name='L4947'></a>4947         <em class='comment'>/* get the public keys we are using to seal this data */</em>
<a id='L4948' name='L4948'></a>4948         <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a> = 0;
<a id='L4949' name='L4949'></a>4949         <a href='../S/1668.html#L774' title='Defined at 774 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_VAL</a>(<a href='../Y/33727.html' title='Multiple used in 4 places.'>pubkeysht</a>, <a href='../Y/33725.html' title='Multiple used in 15 places.'>pubkey</a>) <em class='brace'>{</em>
<a id='L4950' name='L4950'></a>4950                 <a href='../Y/32833.html' title='Multiple used in 10 places.'>pkeys</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>] = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../Y/33725.html' title='Multiple used in 15 places.'>pubkey</a>, 1, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, 0, &amp;<a href='../Y/24468.html' title='Multiple used in 6 places.'>key_resources</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>]);
<a id='L4951' name='L4951'></a>4951                 <strong class='reserved'>if</strong> (<a href='../Y/32833.html' title='Multiple used in 10 places.'>pkeys</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>] == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L4952' name='L4952'></a>4952                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "not a public key (%dth member of pubkeys)", <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>+1);
<a id='L4953' name='L4953'></a>4953                         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L4954' name='L4954'></a>4954                         <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4955' name='L4955'></a>4955                 <em class='brace'>}</em>
<a id='L4956' name='L4956'></a>4956                 <a href='../Y/16519.html' title='Multiple used in 12 places.'>eks</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>] = <a href='../D/21334.html' title='Multiple defined in 2 places.'>emalloc</a>(<a href='../Y/2144.html' title='Multiple used in 7 places.'>EVP_PKEY_size</a>(<a href='../Y/32833.html' title='Multiple used in 10 places.'>pkeys</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>]) + 1);
<a id='L4957' name='L4957'></a>4957                 <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>++;
<a id='L4958' name='L4958'></a>4958         <em class='brace'>}</em> <a href='../S/1668.html#L766' title='Defined at 766 in Zend/zend_hash.h.'>ZEND_HASH_FOREACH_END</a>();
<a id='L4959' name='L4959'></a>4959 
<a id='L4960' name='L4960'></a>4960         <strong class='reserved'>if</strong> (!<a href='../Y/2112.html' title='Multiple used in 2 places.'>EVP_EncryptInit</a>(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>,<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>,<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>,<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>)) <em class='brace'>{</em>
<a id='L4961' name='L4961'></a>4961                 <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L4962' name='L4962'></a>4962                 <a href='../Y/2098.html' title='Multiple used in 7 places.'>EVP_CIPHER_CTX_cleanup</a>(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>);
<a id='L4963' name='L4963'></a>4963                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4964' name='L4964'></a>4964         <em class='brace'>}</em>
<a id='L4965' name='L4965'></a>4965 
<a id='L4966' name='L4966'></a>4966         <em class='comment'>/* allocate one byte extra to make room for \0 */</em>
<a id='L4967' name='L4967'></a>4967         <a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a> = <a href='../D/21334.html' title='Multiple defined in 2 places.'>emalloc</a>(<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a> + EVP_CIPHER_CTX_block_size(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>));
<a id='L4968' name='L4968'></a>4968         <a href='../Y/2098.html' title='Multiple used in 7 places.'>EVP_CIPHER_CTX_cleanup</a>(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>);
<a id='L4969' name='L4969'></a>4969 
<a id='L4970' name='L4970'></a>4970         <strong class='reserved'>if</strong> (!EVP_SealInit(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>, <a href='../Y/16519.html' title='Multiple used in 12 places.'>eks</a>, <a href='../Y/16520.html' title='Multiple used in 6 places.'>eksl</a>, &amp;<a href='../Y/24242.html' title='Multiple used in 8 places.'>iv_buf</a>[0], <a href='../Y/32833.html' title='Multiple used in 10 places.'>pkeys</a>, <a href='../Y/28547.html' title='Multiple used in 13 places.'>nkeys</a>) ||
<a id='L4971' name='L4971'></a>4971                         !EVP_SealUpdate(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>, <a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>, &amp;<a href='../Y/24984.html' title='Multiple used in 67 places.'>len1</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, (<strong class='reserved'>int</strong>)<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>) ||
<a id='L4972' name='L4972'></a>4972                         !EVP_SealFinal(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>, <a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a> + <a href='../Y/24984.html' title='Multiple used in 67 places.'>len1</a>, &amp;<a href='../Y/24985.html' title='Multiple used in 107 places.'>len2</a>)) <em class='brace'>{</em>
<a id='L4973' name='L4973'></a>4973                 <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L4974' name='L4974'></a>4974                 <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>);
<a id='L4975' name='L4975'></a>4975                 <a href='../Y/2098.html' title='Multiple used in 7 places.'>EVP_CIPHER_CTX_cleanup</a>(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>);
<a id='L4976' name='L4976'></a>4976                 <strong class='reserved'>goto</strong> <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>;
<a id='L4977' name='L4977'></a>4977         <em class='brace'>}</em>
<a id='L4978' name='L4978'></a>4978 
<a id='L4979' name='L4979'></a>4979         <strong class='reserved'>if</strong> (<a href='../Y/24984.html' title='Multiple used in 67 places.'>len1</a> + <a href='../Y/24985.html' title='Multiple used in 107 places.'>len2</a> &gt; 0) <em class='brace'>{</em>
<a id='L4980' name='L4980'></a>4980                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/35545.html' title='Multiple used in 5 places.'>sealdata</a>);
<a id='L4981' name='L4981'></a>4981                 <a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>[<a href='../Y/24984.html' title='Multiple used in 67 places.'>len1</a> + <a href='../Y/24985.html' title='Multiple used in 107 places.'>len2</a>] = '\0';
<a id='L4982' name='L4982'></a>4982                 <a href='../S/1731.html#L637' title='Defined at 637 in Zend/zend_types.h.'>ZVAL_NEW_STR</a>(<a href='../Y/35545.html' title='Multiple used in 5 places.'>sealdata</a>, <a href='../S/1725.html#L155' title='Defined at 155 in Zend/zend_string.h.'>zend_string_init</a>((<strong class='reserved'>char</strong>*)<a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>, <a href='../Y/24984.html' title='Multiple used in 67 places.'>len1</a> + <a href='../Y/24985.html' title='Multiple used in 107 places.'>len2</a>, 0));
<a id='L4983' name='L4983'></a>4983                 <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>);
<a id='L4984' name='L4984'></a>4984 
<a id='L4985' name='L4985'></a>4985                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/16518.html' title='Multiple used in 6 places.'>ekeys</a>);
<a id='L4986' name='L4986'></a>4986                 <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(<a href='../Y/16518.html' title='Multiple used in 6 places.'>ekeys</a>);
<a id='L4987' name='L4987'></a>4987                 <strong class='reserved'>for</strong> (<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>=0; <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>&lt;<a href='../Y/28547.html' title='Multiple used in 13 places.'>nkeys</a>; <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>++) <em class='brace'>{</em>
<a id='L4988' name='L4988'></a>4988                         <a href='../Y/16519.html' title='Multiple used in 12 places.'>eks</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>][<a href='../Y/16520.html' title='Multiple used in 6 places.'>eksl</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>]] = '\0';
<a id='L4989' name='L4989'></a>4989                         <a href='../S/1631.html#L1556' title='Defined at 1556 in Zend/zend_API.c.'>add_next_index_stringl</a>(<a href='../Y/16518.html' title='Multiple used in 6 places.'>ekeys</a>, (<strong class='reserved'>const</strong> <strong class='reserved'>char</strong>*)<a href='../Y/16519.html' title='Multiple used in 12 places.'>eks</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>], <a href='../Y/16520.html' title='Multiple used in 6 places.'>eksl</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>]);
<a id='L4990' name='L4990'></a>4990                         <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/16519.html' title='Multiple used in 12 places.'>eks</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>]);
<a id='L4991' name='L4991'></a>4991                         <a href='../Y/16519.html' title='Multiple used in 12 places.'>eks</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>] = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L4992' name='L4992'></a>4992                 <em class='brace'>}</em>
<a id='L4993' name='L4993'></a>4993 
<a id='L4994' name='L4994'></a>4994                 <strong class='reserved'>if</strong> (<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>) <em class='brace'>{</em>
<a id='L4995' name='L4995'></a>4995                         <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>);
<a id='L4996' name='L4996'></a>4996                         <a href='../Y/24242.html' title='Multiple used in 8 places.'>iv_buf</a>[<a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a>] = '\0';
<a id='L4997' name='L4997'></a>4997                         <a href='../S/1731.html#L637' title='Defined at 637 in Zend/zend_types.h.'>ZVAL_NEW_STR</a>(<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>, <a href='../S/1725.html#L155' title='Defined at 155 in Zend/zend_string.h.'>zend_string_init</a>((<strong class='reserved'>char</strong>*)<a href='../Y/24242.html' title='Multiple used in 8 places.'>iv_buf</a>, <a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a>, 0));
<a id='L4998' name='L4998'></a>4998                 <em class='brace'>}</em>
<a id='L4999' name='L4999'></a>4999         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L5000' name='L5000'></a>5000                 <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>);
<a id='L5001' name='L5001'></a>5001         <em class='brace'>}</em>
<a id='L5002' name='L5002'></a>5002         <a href='../S/1632.html#L613' title='Defined at 613 in Zend/zend_API.h.'>RETVAL_LONG</a>(<a href='../Y/24984.html' title='Multiple used in 67 places.'>len1</a> + <a href='../Y/24985.html' title='Multiple used in 107 places.'>len2</a>);
<a id='L5003' name='L5003'></a>5003         <a href='../Y/2098.html' title='Multiple used in 7 places.'>EVP_CIPHER_CTX_cleanup</a>(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>);
<a id='L5004' name='L5004'></a>5004 
<a id='L5005' name='L5005'></a>5005 <a href='../Y/13793.html' title='Multiple used in 47 places.'>clean_exit</a>:
<a id='L5006' name='L5006'></a>5006         <strong class='reserved'>for</strong> (<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>=0; <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>&lt;<a href='../Y/28547.html' title='Multiple used in 13 places.'>nkeys</a>; <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>++) <em class='brace'>{</em>
<a id='L5007' name='L5007'></a>5007                 <strong class='reserved'>if</strong> (<a href='../Y/24468.html' title='Multiple used in 6 places.'>key_resources</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>] == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a> &amp;&amp; <a href='../Y/32833.html' title='Multiple used in 10 places.'>pkeys</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>] != <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L5008' name='L5008'></a>5008                         <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32833.html' title='Multiple used in 10 places.'>pkeys</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>]);
<a id='L5009' name='L5009'></a>5009                 <em class='brace'>}</em>
<a id='L5010' name='L5010'></a>5010                 <strong class='reserved'>if</strong> (<a href='../Y/16519.html' title='Multiple used in 12 places.'>eks</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>]) <em class='brace'>{</em>
<a id='L5011' name='L5011'></a>5011                         <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/16519.html' title='Multiple used in 12 places.'>eks</a>[<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>]);
<a id='L5012' name='L5012'></a>5012                 <em class='brace'>}</em>
<a id='L5013' name='L5013'></a>5013         <em class='brace'>}</em>
<a id='L5014' name='L5014'></a>5014         <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/16519.html' title='Multiple used in 12 places.'>eks</a>);
<a id='L5015' name='L5015'></a>5015         <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/16520.html' title='Multiple used in 6 places.'>eksl</a>);
<a id='L5016' name='L5016'></a>5016         <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/32833.html' title='Multiple used in 10 places.'>pkeys</a>);
<a id='L5017' name='L5017'></a>5017         <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/24468.html' title='Multiple used in 6 places.'>key_resources</a>);
<a id='L5018' name='L5018'></a>5018 <em class='brace'>}</em>
<a id='L5019' name='L5019'></a>5019 <em class='comment'>/* }}} */</em>
<a id='L5020' name='L5020'></a>5020 
<a id='L5021' name='L5021'></a>5021 <em class='comment'>/* {{{ proto bool openssl_open(string data, &amp;string opendata, string ekey, mixed privkey)</em>
<a id='L5022' name='L5022'></a>5022 <em class='comment'>   Opens data */</em>
<a id='L5023' name='L5023'></a>5023 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29751.html' title='Multiple used in 3 places.'>openssl_open</a>)
<a id='L5024' name='L5024'></a>5024 <em class='brace'>{</em>
<a id='L5025' name='L5025'></a>5025         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../Y/33407.html' title='Multiple used in 12 places.'>privkey</a>, *<a href='../Y/29722.html' title='Multiple used in 5 places.'>opendata</a>;
<a id='L5026' name='L5026'></a>5026         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>;
<a id='L5027' name='L5027'></a>5027         <strong class='reserved'>int</strong> <a href='../Y/24984.html' title='Multiple used in 67 places.'>len1</a>, <a href='../Y/24985.html' title='Multiple used in 107 places.'>len2</a>, <a href='../Y/13712.html' title='Multiple used in 4 places.'>cipher_iv_len</a>;
<a id='L5028' name='L5028'></a>5028         <strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *<a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>, *<a href='../Y/24242.html' title='Multiple used in 8 places.'>iv_buf</a>;
<a id='L5029' name='L5029'></a>5029         <a href='../S/1731.html#L90' title='Defined at 90 in Zend/zend_types.h.'>zend_resource</a> *<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L5030' name='L5030'></a>5030         <a href='../Y/2096.html' title='Multiple used in 4 places.'>EVP_CIPHER_CTX</a> <a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>;
<a id='L5031' name='L5031'></a>5031         <strong class='reserved'>char</strong> * <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>;
<a id='L5032' name='L5032'></a>5032         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>;
<a id='L5033' name='L5033'></a>5033         <strong class='reserved'>char</strong> * <a href='../Y/16516.html' title='Multiple used in 35 places.'>ekey</a>;
<a id='L5034' name='L5034'></a>5034         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/16517.html' title='Multiple used in 12 places.'>ekey_len</a>;
<a id='L5035' name='L5035'></a>5035         <strong class='reserved'>char</strong> *<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, *<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L5036' name='L5036'></a>5036         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a> = 0, <a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a> = 0;
<a id='L5037' name='L5037'></a>5037         <strong class='reserved'>const</strong> <a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a> *<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>;
<a id='L5038' name='L5038'></a>5038 
<a id='L5039' name='L5039'></a>5039         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "sz/sz|ss", &amp;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, &amp;<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, &amp;<a href='../Y/29722.html' title='Multiple used in 5 places.'>opendata</a>,
<a id='L5040' name='L5040'></a>5040                                 &amp;<a href='../Y/16516.html' title='Multiple used in 35 places.'>ekey</a>, &amp;<a href='../Y/16517.html' title='Multiple used in 12 places.'>ekey_len</a>, &amp;<a href='../Y/33407.html' title='Multiple used in 12 places.'>privkey</a>, &amp;<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>, &amp;<a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>, &amp;<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>, &amp;<a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L5041' name='L5041'></a>5041                 <strong class='reserved'>return</strong>;
<a id='L5042' name='L5042'></a>5042         <em class='brace'>}</em>
<a id='L5043' name='L5043'></a>5043 
<a id='L5044' name='L5044'></a>5044         <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = <a href='../S/851.html#L3229' title='Defined at 3229 in ext/openssl/openssl.c.'>php_openssl_evp_from_zval</a>(<a href='../Y/33407.html' title='Multiple used in 12 places.'>privkey</a>, 0, "", 0, &amp;<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a>);
<a id='L5045' name='L5045'></a>5045         <strong class='reserved'>if</strong> (<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L5046' name='L5046'></a>5046                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "unable to coerce parameter 4 into a private key");
<a id='L5047' name='L5047'></a>5047                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5048' name='L5048'></a>5048         <em class='brace'>}</em>
<a id='L5049' name='L5049'></a>5049 
<a id='L5050' name='L5050'></a>5050         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/16517.html' title='Multiple used in 12 places.'>ekey_len</a>, <a href='../Y/16516.html' title='Multiple used in 35 places.'>ekey</a>);
<a id='L5051' name='L5051'></a>5051         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>);
<a id='L5052' name='L5052'></a>5052 
<a id='L5053' name='L5053'></a>5053         <strong class='reserved'>if</strong> (<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>) <em class='brace'>{</em>
<a id='L5054' name='L5054'></a>5054                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> = <a href='../Y/2162.html' title='Multiple used in 5 places.'>EVP_get_cipherbyname</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>);
<a id='L5055' name='L5055'></a>5055                 <strong class='reserved'>if</strong> (!<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>) <em class='brace'>{</em>
<a id='L5056' name='L5056'></a>5056                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown signature algorithm.");
<a id='L5057' name='L5057'></a>5057                         <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5058' name='L5058'></a>5058                 <em class='brace'>}</em>
<a id='L5059' name='L5059'></a>5059         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L5060' name='L5060'></a>5060                 <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a> = <a href='../Y/2170.html' title='Multiple used in 2 places.'>EVP_rc4</a>();
<a id='L5061' name='L5061'></a>5061         <em class='brace'>}</em>
<a id='L5062' name='L5062'></a>5062 
<a id='L5063' name='L5063'></a>5063         <a href='../Y/13712.html' title='Multiple used in 4 places.'>cipher_iv_len</a> = <a href='../Y/2102.html' title='Multiple used in 5 places.'>EVP_CIPHER_iv_length</a>(<a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>);
<a id='L5064' name='L5064'></a>5064         <strong class='reserved'>if</strong> (<a href='../Y/13712.html' title='Multiple used in 4 places.'>cipher_iv_len</a> &gt; 0) <em class='brace'>{</em>
<a id='L5065' name='L5065'></a>5065                 <strong class='reserved'>if</strong> (!<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>) <em class='brace'>{</em>
<a id='L5066' name='L5066'></a>5066                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>,
<a id='L5067' name='L5067'></a>5067                                         "Cipher algorithm requires an IV to be supplied as a sixth parameter");
<a id='L5068' name='L5068'></a>5068                         <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5069' name='L5069'></a>5069                 <em class='brace'>}</em>
<a id='L5070' name='L5070'></a>5070                 <strong class='reserved'>if</strong> (<a href='../Y/13712.html' title='Multiple used in 4 places.'>cipher_iv_len</a> != <a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a>) <em class='brace'>{</em>
<a id='L5071' name='L5071'></a>5071                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "IV length is invalid");
<a id='L5072' name='L5072'></a>5072                         <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5073' name='L5073'></a>5073                 <em class='brace'>}</em>
<a id='L5074' name='L5074'></a>5074                 <a href='../Y/24242.html' title='Multiple used in 8 places.'>iv_buf</a> = (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>;
<a id='L5075' name='L5075'></a>5075         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L5076' name='L5076'></a>5076                 <a href='../Y/24242.html' title='Multiple used in 8 places.'>iv_buf</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L5077' name='L5077'></a>5077         <em class='brace'>}</em>
<a id='L5078' name='L5078'></a>5078 
<a id='L5079' name='L5079'></a>5079         <a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a> = <a href='../D/21334.html' title='Multiple defined in 2 places.'>emalloc</a>(<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a> + 1);
<a id='L5080' name='L5080'></a>5080 
<a id='L5081' name='L5081'></a>5081         <strong class='reserved'>if</strong> (EVP_OpenInit(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>, <a href='../S/800.html#L488' title='Defined at 488 in ext/mysqlnd/mysqlnd_structs.h.'>cipher</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../Y/16516.html' title='Multiple used in 35 places.'>ekey</a>, (<strong class='reserved'>int</strong>)<a href='../Y/16517.html' title='Multiple used in 12 places.'>ekey_len</a>, <a href='../Y/24242.html' title='Multiple used in 8 places.'>iv_buf</a>, <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>) &amp;&amp;
<a id='L5082' name='L5082'></a>5082                         EVP_OpenUpdate(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>, <a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>, &amp;<a href='../Y/24984.html' title='Multiple used in 67 places.'>len1</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, (<strong class='reserved'>int</strong>)<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>)) <em class='brace'>{</em>
<a id='L5083' name='L5083'></a>5083                 <strong class='reserved'>if</strong> (!EVP_OpenFinal(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>, <a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a> + <a href='../Y/24984.html' title='Multiple used in 67 places.'>len1</a>, &amp;<a href='../Y/24985.html' title='Multiple used in 107 places.'>len2</a>) || (<a href='../Y/24984.html' title='Multiple used in 67 places.'>len1</a> + <a href='../Y/24985.html' title='Multiple used in 107 places.'>len2</a> == 0)) <em class='brace'>{</em>
<a id='L5084' name='L5084'></a>5084                         <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>);
<a id='L5085' name='L5085'></a>5085                         <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L5086' name='L5086'></a>5086                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L5087' name='L5087'></a>5087                         <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/29722.html' title='Multiple used in 5 places.'>opendata</a>);
<a id='L5088' name='L5088'></a>5088                         <a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>[<a href='../Y/24984.html' title='Multiple used in 67 places.'>len1</a> + <a href='../Y/24985.html' title='Multiple used in 107 places.'>len2</a>] = '\0';
<a id='L5089' name='L5089'></a>5089                         <a href='../S/1731.html#L637' title='Defined at 637 in Zend/zend_types.h.'>ZVAL_NEW_STR</a>(<a href='../Y/29722.html' title='Multiple used in 5 places.'>opendata</a>, <a href='../S/1725.html#L155' title='Defined at 155 in Zend/zend_string.h.'>zend_string_init</a>((<strong class='reserved'>char</strong>*)<a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>, <a href='../Y/24984.html' title='Multiple used in 67 places.'>len1</a> + <a href='../Y/24985.html' title='Multiple used in 107 places.'>len2</a>, 0));
<a id='L5090' name='L5090'></a>5090                         <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>);
<a id='L5091' name='L5091'></a>5091                         <a href='../S/1632.html#L627' title='Defined at 627 in Zend/zend_API.h.'>RETVAL_TRUE</a>;
<a id='L5092' name='L5092'></a>5092                 <em class='brace'>}</em>
<a id='L5093' name='L5093'></a>5093         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L5094' name='L5094'></a>5094                 <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/12975.html' title='Multiple used in 3888 places.'>buf</a>);
<a id='L5095' name='L5095'></a>5095                 <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L5096' name='L5096'></a>5096         <em class='brace'>}</em>
<a id='L5097' name='L5097'></a>5097         <strong class='reserved'>if</strong> (<a href='../Y/24488.html' title='Multiple used in 42 places.'>keyresource</a> == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L5098' name='L5098'></a>5098                 <a href='../Y/2141.html' title='Multiple used in 28 places.'>EVP_PKEY_free</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>);
<a id='L5099' name='L5099'></a>5099         <em class='brace'>}</em>
<a id='L5100' name='L5100'></a>5100         <a href='../Y/2098.html' title='Multiple used in 7 places.'>EVP_CIPHER_CTX_cleanup</a>(&amp;<a href='../Y/14682.html' title='Multiple used in 2260 places.'>ctx</a>);
<a id='L5101' name='L5101'></a>5101 <em class='brace'>}</em>
<a id='L5102' name='L5102'></a>5102 <em class='comment'>/* }}} */</em>
<a id='L5103' name='L5103'></a>5103 
<a id='L5104' name='L5104'></a>5104 <strong class='reserved'>static</strong> <strong class='reserved'>void</strong> <a href='../R/22460.html' title='Multiple referred from 2 places.'>openssl_add_method_or_alias</a>(<strong class='reserved'>const</strong> <a href='../Y/4343.html' title='Multiple used in 2 places.'>OBJ_NAME</a> *<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>, <strong class='reserved'>void</strong> *<a href='../D/19680.html' title='Multiple defined in 2 places.'>arg</a>) <em class='comment'>/* {{{ */</em>
<a id='L5105' name='L5105'></a>5105 <em class='brace'>{</em>
<a id='L5106' name='L5106'></a>5106         <a href='../S/1631.html#L1547' title='Defined at 1547 in Zend/zend_API.c.'>add_next_index_string</a>((<a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a>*)<a href='../D/19680.html' title='Multiple defined in 2 places.'>arg</a>, (<strong class='reserved'>char</strong>*)<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>-&gt;<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>);
<a id='L5107' name='L5107'></a>5107 <em class='brace'>}</em>
<a id='L5108' name='L5108'></a>5108 <em class='comment'>/* }}} */</em>
<a id='L5109' name='L5109'></a>5109 
<a id='L5110' name='L5110'></a>5110 <strong class='reserved'>static</strong> <strong class='reserved'>void</strong> <a href='../R/22459.html' title='Multiple referred from 2 places.'>openssl_add_method</a>(<strong class='reserved'>const</strong> <a href='../Y/4343.html' title='Multiple used in 2 places.'>OBJ_NAME</a> *<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>, <strong class='reserved'>void</strong> *<a href='../D/19680.html' title='Multiple defined in 2 places.'>arg</a>) <em class='comment'>/* {{{ */</em>
<a id='L5111' name='L5111'></a>5111 <em class='brace'>{</em>
<a id='L5112' name='L5112'></a>5112         <strong class='reserved'>if</strong> (<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>-&gt;<a href='../Y/9061.html' title='Multiple used in 280 places.'>alias</a> == 0) <em class='brace'>{</em>
<a id='L5113' name='L5113'></a>5113                 <a href='../S/1631.html#L1547' title='Defined at 1547 in Zend/zend_API.c.'>add_next_index_string</a>((<a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a>*)<a href='../D/19680.html' title='Multiple defined in 2 places.'>arg</a>, (<strong class='reserved'>char</strong>*)<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>-&gt;<a href='../D/25114.html' title='Multiple defined in 4 places.'>name</a>);
<a id='L5114' name='L5114'></a>5114         <em class='brace'>}</em>
<a id='L5115' name='L5115'></a>5115 <em class='brace'>}</em>
<a id='L5116' name='L5116'></a>5116 <em class='comment'>/* }}} */</em>
<a id='L5117' name='L5117'></a>5117 
<a id='L5118' name='L5118'></a>5118 <em class='comment'>/* {{{ proto array openssl_get_md_methods([bool aliases = false])</em>
<a id='L5119' name='L5119'></a>5119 <em class='comment'>   Return array of available digest methods */</em>
<a id='L5120' name='L5120'></a>5120 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29747.html' title='Multiple used in 3 places.'>openssl_get_md_methods</a>)
<a id='L5121' name='L5121'></a>5121 <em class='brace'>{</em>
<a id='L5122' name='L5122'></a>5122         <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../Y/9070.html' title='Multiple used in 21 places.'>aliases</a> = 0;
<a id='L5123' name='L5123'></a>5123 
<a id='L5124' name='L5124'></a>5124         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "|b", &amp;<a href='../Y/9070.html' title='Multiple used in 21 places.'>aliases</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L5125' name='L5125'></a>5125                 <strong class='reserved'>return</strong>;
<a id='L5126' name='L5126'></a>5126         <em class='brace'>}</em>
<a id='L5127' name='L5127'></a>5127         <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>);
<a id='L5128' name='L5128'></a>5128         <a href='../Y/4346.html' title='Multiple used in 2 places.'>OBJ_NAME_do_all_sorted</a>(OBJ_NAME_TYPE_MD_METH,
<a id='L5129' name='L5129'></a>5129                 <a href='../Y/9070.html' title='Multiple used in 21 places.'>aliases</a> ? <a href='../S/851.html#L5104' title='Defined at 5104 in ext/openssl/openssl.c.'>openssl_add_method_or_alias</a>: <a href='../S/851.html#L5110' title='Defined at 5110 in ext/openssl/openssl.c.'>openssl_add_method</a>,
<a id='L5130' name='L5130'></a>5130                 <a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>);
<a id='L5131' name='L5131'></a>5131 <em class='brace'>}</em>
<a id='L5132' name='L5132'></a>5132 <em class='comment'>/* }}} */</em>
<a id='L5133' name='L5133'></a>5133 
<a id='L5134' name='L5134'></a>5134 <em class='comment'>/* {{{ proto array openssl_get_cipher_methods([bool aliases = false])</em>
<a id='L5135' name='L5135'></a>5135 <em class='comment'>   Return array of available cipher methods */</em>
<a id='L5136' name='L5136'></a>5136 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29746.html' title='Multiple used in 3 places.'>openssl_get_cipher_methods</a>)
<a id='L5137' name='L5137'></a>5137 <em class='brace'>{</em>
<a id='L5138' name='L5138'></a>5138         <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../Y/9070.html' title='Multiple used in 21 places.'>aliases</a> = 0;
<a id='L5139' name='L5139'></a>5139 
<a id='L5140' name='L5140'></a>5140         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "|b", &amp;<a href='../Y/9070.html' title='Multiple used in 21 places.'>aliases</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L5141' name='L5141'></a>5141                 <strong class='reserved'>return</strong>;
<a id='L5142' name='L5142'></a>5142         <em class='brace'>}</em>
<a id='L5143' name='L5143'></a>5143         <a href='../S/1632.html#L375' title='Defined at 375 in Zend/zend_API.h.'>array_init</a>(<a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>);
<a id='L5144' name='L5144'></a>5144         <a href='../Y/4346.html' title='Multiple used in 2 places.'>OBJ_NAME_do_all_sorted</a>(OBJ_NAME_TYPE_CIPHER_METH,
<a id='L5145' name='L5145'></a>5145                 <a href='../Y/9070.html' title='Multiple used in 21 places.'>aliases</a> ? <a href='../S/851.html#L5104' title='Defined at 5104 in ext/openssl/openssl.c.'>openssl_add_method_or_alias</a>: <a href='../S/851.html#L5110' title='Defined at 5110 in ext/openssl/openssl.c.'>openssl_add_method</a>,
<a id='L5146' name='L5146'></a>5146                 <a href='../D/29192.html' title='Multiple defined in 2 places.'>return_value</a>);
<a id='L5147' name='L5147'></a>5147 <em class='brace'>}</em>
<a id='L5148' name='L5148'></a>5148 <em class='comment'>/* }}} */</em>
<a id='L5149' name='L5149'></a>5149 
<a id='L5150' name='L5150'></a>5150 <em class='comment'>/* {{{ proto string openssl_digest(string data, string method [, bool raw_output=false])</em>
<a id='L5151' name='L5151'></a>5151 <em class='comment'>   Computes digest hash value for given data using given method, returns raw or binhex encoded string */</em>
<a id='L5152' name='L5152'></a>5152 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29740.html' title='Multiple used in 3 places.'>openssl_digest</a>)
<a id='L5153' name='L5153'></a>5153 <em class='brace'>{</em>
<a id='L5154' name='L5154'></a>5154         <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../Y/33992.html' title='Multiple used in 60 places.'>raw_output</a> = 0;
<a id='L5155' name='L5155'></a>5155         <strong class='reserved'>char</strong> *<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, *<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>;
<a id='L5156' name='L5156'></a>5156         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, <a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>;
<a id='L5157' name='L5157'></a>5157         <strong class='reserved'>const</strong> <a href='../Y/2117.html' title='Multiple used in 21 places.'>EVP_MD</a> *<a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>;
<a id='L5158' name='L5158'></a>5158         <a href='../Y/2118.html' title='Multiple used in 5 places.'>EVP_MD_CTX</a> <a href='../Y/26415.html' title='Multiple used in 26 places.'>md_ctx</a>;
<a id='L5159' name='L5159'></a>5159         <strong class='reserved'>unsigned</strong> <strong class='reserved'>int</strong> <a href='../Y/36164.html' title='Multiple used in 22 places.'>siglen</a>;
<a id='L5160' name='L5160'></a>5160         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a>;
<a id='L5161' name='L5161'></a>5161 
<a id='L5162' name='L5162'></a>5162         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "ss|b", &amp;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, &amp;<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, &amp;<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>, &amp;<a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>, &amp;<a href='../Y/33992.html' title='Multiple used in 60 places.'>raw_output</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L5163' name='L5163'></a>5163                 <strong class='reserved'>return</strong>;
<a id='L5164' name='L5164'></a>5164         <em class='brace'>}</em>
<a id='L5165' name='L5165'></a>5165         <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a> = <a href='../Y/2163.html' title='Multiple used in 6 places.'>EVP_get_digestbyname</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>);
<a id='L5166' name='L5166'></a>5166         <strong class='reserved'>if</strong> (!<a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>) <em class='brace'>{</em>
<a id='L5167' name='L5167'></a>5167                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown signature algorithm");
<a id='L5168' name='L5168'></a>5168                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5169' name='L5169'></a>5169         <em class='brace'>}</em>
<a id='L5170' name='L5170'></a>5170 
<a id='L5171' name='L5171'></a>5171         <a href='../Y/36164.html' title='Multiple used in 22 places.'>siglen</a> = EVP_MD_size(<a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>);
<a id='L5172' name='L5172'></a>5172         <a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(<a href='../Y/36164.html' title='Multiple used in 22 places.'>siglen</a>, 0);
<a id='L5173' name='L5173'></a>5173 
<a id='L5174' name='L5174'></a>5174         EVP_DigestInit(&amp;<a href='../Y/26415.html' title='Multiple used in 26 places.'>md_ctx</a>, <a href='../Y/26420.html' title='Multiple used in 36 places.'>mdtype</a>);
<a id='L5175' name='L5175'></a>5175         EVP_DigestUpdate(&amp;<a href='../Y/26415.html' title='Multiple used in 26 places.'>md_ctx</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>);
<a id='L5176' name='L5176'></a>5176         <strong class='reserved'>if</strong> (EVP_DigestFinal (&amp;<a href='../Y/26415.html' title='Multiple used in 26 places.'>md_ctx</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a>), &amp;<a href='../Y/36164.html' title='Multiple used in 22 places.'>siglen</a>)) <em class='brace'>{</em>
<a id='L5177' name='L5177'></a>5177                 <strong class='reserved'>if</strong> (<a href='../Y/33992.html' title='Multiple used in 60 places.'>raw_output</a>) <em class='brace'>{</em>
<a id='L5178' name='L5178'></a>5178                         <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a>)[<a href='../Y/36164.html' title='Multiple used in 22 places.'>siglen</a>] = '\0';
<a id='L5179' name='L5179'></a>5179                         <a href='../S/1725.html#L41' title='Defined at 41 in Zend/zend_string.h.'>ZSTR_LEN</a>(<a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a>) = <a href='../Y/36164.html' title='Multiple used in 22 places.'>siglen</a>;
<a id='L5180' name='L5180'></a>5180                         <a href='../S/1632.html#L615' title='Defined at 615 in Zend/zend_API.h.'>RETVAL_STR</a>(<a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a>);
<a id='L5181' name='L5181'></a>5181                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L5182' name='L5182'></a>5182                         <strong class='reserved'>int</strong> <a href='../Y/15703.html' title='Multiple used in 3 places.'>digest_str_len</a> = <a href='../Y/36164.html' title='Multiple used in 22 places.'>siglen</a> * 2;
<a id='L5183' name='L5183'></a>5183                         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/15702.html' title='Multiple used in 6 places.'>digest_str</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(<a href='../Y/15703.html' title='Multiple used in 3 places.'>digest_str_len</a>, 0);
<a id='L5184' name='L5184'></a>5184 
<a id='L5185' name='L5185'></a>5185                         <a href='../S/1122.html#L32' title='Defined at 32 in ext/standard/md5.c.'>make_digest_ex</a>(<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/15702.html' title='Multiple used in 6 places.'>digest_str</a>), (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a>), <a href='../Y/36164.html' title='Multiple used in 22 places.'>siglen</a>);
<a id='L5186' name='L5186'></a>5186                         <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/15702.html' title='Multiple used in 6 places.'>digest_str</a>)[<a href='../Y/15703.html' title='Multiple used in 3 places.'>digest_str_len</a>] = '\0';
<a id='L5187' name='L5187'></a>5187                         <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a>);
<a id='L5188' name='L5188'></a>5188                         <a href='../S/1632.html#L615' title='Defined at 615 in Zend/zend_API.h.'>RETVAL_STR</a>(<a href='../Y/15702.html' title='Multiple used in 6 places.'>digest_str</a>);
<a id='L5189' name='L5189'></a>5189                 <em class='brace'>}</em>
<a id='L5190' name='L5190'></a>5190         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L5191' name='L5191'></a>5191                 <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../Y/36151.html' title='Multiple used in 34 places.'>sigbuf</a>);
<a id='L5192' name='L5192'></a>5192                 <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L5193' name='L5193'></a>5193         <em class='brace'>}</em>
<a id='L5194' name='L5194'></a>5194 <em class='brace'>}</em>
<a id='L5195' name='L5195'></a>5195 <em class='comment'>/* }}} */</em>
<a id='L5196' name='L5196'></a>5196 
<a id='L5197' name='L5197'></a>5197 <strong class='reserved'>static</strong> <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../R/24325.html' title='Multiple referred from 2 places.'>php_openssl_validate_iv</a>(<strong class='reserved'>char</strong> **<a href='../Y/32813.html' title='Multiple used in 6 places.'>piv</a>, <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> *<a href='../Y/32814.html' title='Multiple used in 10 places.'>piv_len</a>, <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/24245.html' title='Multiple used in 10 places.'>iv_required_len</a>)
<a id='L5198' name='L5198'></a>5198 <em class='brace'>{</em>
<a id='L5199' name='L5199'></a>5199         <strong class='reserved'>char</strong> *<a href='../Y/24244.html' title='Multiple used in 7 places.'>iv_new</a>;
<a id='L5200' name='L5200'></a>5200 
<a id='L5201' name='L5201'></a>5201         <em class='comment'>/* Best case scenario, user behaved */</em>
<a id='L5202' name='L5202'></a>5202         <strong class='reserved'>if</strong> (*<a href='../Y/32814.html' title='Multiple used in 10 places.'>piv_len</a> == <a href='../Y/24245.html' title='Multiple used in 10 places.'>iv_required_len</a>) <em class='brace'>{</em>
<a id='L5203' name='L5203'></a>5203                 <strong class='reserved'>return</strong> 0;
<a id='L5204' name='L5204'></a>5204         <em class='brace'>}</em>
<a id='L5205' name='L5205'></a>5205 
<a id='L5206' name='L5206'></a>5206         <a href='../Y/24244.html' title='Multiple used in 7 places.'>iv_new</a> = <a href='../S/1629.html#L166' title='Defined at 166 in Zend/zend_alloc.h.'>ecalloc</a>(1, <a href='../Y/24245.html' title='Multiple used in 10 places.'>iv_required_len</a> + 1);
<a id='L5207' name='L5207'></a>5207 
<a id='L5208' name='L5208'></a>5208         <strong class='reserved'>if</strong> (*<a href='../Y/32814.html' title='Multiple used in 10 places.'>piv_len</a> == 0) <em class='brace'>{</em>
<a id='L5209' name='L5209'></a>5209                 <em class='comment'>/* BC behavior */</em>
<a id='L5210' name='L5210'></a>5210                 *<a href='../Y/32814.html' title='Multiple used in 10 places.'>piv_len</a> = <a href='../Y/24245.html' title='Multiple used in 10 places.'>iv_required_len</a>;
<a id='L5211' name='L5211'></a>5211                 *<a href='../Y/32813.html' title='Multiple used in 6 places.'>piv</a> = <a href='../Y/24244.html' title='Multiple used in 7 places.'>iv_new</a>;
<a id='L5212' name='L5212'></a>5212                 <strong class='reserved'>return</strong> 1;
<a id='L5213' name='L5213'></a>5213         <em class='brace'>}</em>
<a id='L5214' name='L5214'></a>5214 
<a id='L5215' name='L5215'></a>5215         <strong class='reserved'>if</strong> (*<a href='../Y/32814.html' title='Multiple used in 10 places.'>piv_len</a> &lt; <a href='../Y/24245.html' title='Multiple used in 10 places.'>iv_required_len</a>) <em class='brace'>{</em>
<a id='L5216' name='L5216'></a>5216                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "IV passed is only %zd bytes long, cipher expects an IV of precisely %zd bytes, padding with \\0", *<a href='../Y/32814.html' title='Multiple used in 10 places.'>piv_len</a>, <a href='../Y/24245.html' title='Multiple used in 10 places.'>iv_required_len</a>);
<a id='L5217' name='L5217'></a>5217                 <a href='../D/24499.html' title='Multiple defined in 4 places.'>memcpy</a>(<a href='../Y/24244.html' title='Multiple used in 7 places.'>iv_new</a>, *<a href='../Y/32813.html' title='Multiple used in 6 places.'>piv</a>, *<a href='../Y/32814.html' title='Multiple used in 10 places.'>piv_len</a>);
<a id='L5218' name='L5218'></a>5218                 *<a href='../Y/32814.html' title='Multiple used in 10 places.'>piv_len</a> = <a href='../Y/24245.html' title='Multiple used in 10 places.'>iv_required_len</a>;
<a id='L5219' name='L5219'></a>5219                 *<a href='../Y/32813.html' title='Multiple used in 6 places.'>piv</a> = <a href='../Y/24244.html' title='Multiple used in 7 places.'>iv_new</a>;
<a id='L5220' name='L5220'></a>5220                 <strong class='reserved'>return</strong> 1;
<a id='L5221' name='L5221'></a>5221         <em class='brace'>}</em>
<a id='L5222' name='L5222'></a>5222 
<a id='L5223' name='L5223'></a>5223         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "IV passed is %zd bytes long which is longer than the %zd expected by selected cipher, truncating", *<a href='../Y/32814.html' title='Multiple used in 10 places.'>piv_len</a>, <a href='../Y/24245.html' title='Multiple used in 10 places.'>iv_required_len</a>);
<a id='L5224' name='L5224'></a>5224         <a href='../D/24499.html' title='Multiple defined in 4 places.'>memcpy</a>(<a href='../Y/24244.html' title='Multiple used in 7 places.'>iv_new</a>, *<a href='../Y/32813.html' title='Multiple used in 6 places.'>piv</a>, <a href='../Y/24245.html' title='Multiple used in 10 places.'>iv_required_len</a>);
<a id='L5225' name='L5225'></a>5225         *<a href='../Y/32814.html' title='Multiple used in 10 places.'>piv_len</a> = <a href='../Y/24245.html' title='Multiple used in 10 places.'>iv_required_len</a>;
<a id='L5226' name='L5226'></a>5226         *<a href='../Y/32813.html' title='Multiple used in 6 places.'>piv</a> = <a href='../Y/24244.html' title='Multiple used in 7 places.'>iv_new</a>;
<a id='L5227' name='L5227'></a>5227         <strong class='reserved'>return</strong> 1;
<a id='L5228' name='L5228'></a>5228 
<a id='L5229' name='L5229'></a>5229 <em class='brace'>}</em>
<a id='L5230' name='L5230'></a>5230 
<a id='L5231' name='L5231'></a>5231 <em class='comment'>/* {{{ proto string openssl_encrypt(string data, string method, string password [, long options=0 [, string $iv='']])</em>
<a id='L5232' name='L5232'></a>5232 <em class='comment'>   Encrypts given data with given method and key, returns raw or base64 encoded string */</em>
<a id='L5233' name='L5233'></a>5233 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29741.html' title='Multiple used in 3 places.'>openssl_encrypt</a>)
<a id='L5234' name='L5234'></a>5234 <em class='brace'>{</em>
<a id='L5235' name='L5235'></a>5235         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../D/25509.html' title='Multiple defined in 3 places.'>options</a> = 0;
<a id='L5236' name='L5236'></a>5236         <strong class='reserved'>char</strong> *<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, *<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>, *<a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>, *<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a> = "";
<a id='L5237' name='L5237'></a>5237         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, <a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>, <a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>, <a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a> = 0, <a href='../Y/25899.html' title='Multiple used in 4 places.'>max_iv_len</a>;
<a id='L5238' name='L5238'></a>5238         <strong class='reserved'>const</strong> <a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a> *<a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>;
<a id='L5239' name='L5239'></a>5239         <a href='../Y/2096.html' title='Multiple used in 4 places.'>EVP_CIPHER_CTX</a> <a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>;
<a id='L5240' name='L5240'></a>5240         <strong class='reserved'>int</strong> <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>=0, <a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a>, <a href='../Y/24485.html' title='Multiple used in 98 places.'>keylen</a>;
<a id='L5241' name='L5241'></a>5241         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>;
<a id='L5242' name='L5242'></a>5242         <strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>;
<a id='L5243' name='L5243'></a>5243         <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../Y/18359.html' title='Multiple used in 6 places.'>free_iv</a>;
<a id='L5244' name='L5244'></a>5244 
<a id='L5245' name='L5245'></a>5245         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "sss|ls", &amp;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, &amp;<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, &amp;<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>, &amp;<a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>, &amp;<a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>, &amp;<a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>, &amp;<a href='../D/25509.html' title='Multiple defined in 3 places.'>options</a>, &amp;<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>, &amp;<a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L5246' name='L5246'></a>5246                 <strong class='reserved'>return</strong>;
<a id='L5247' name='L5247'></a>5247         <em class='brace'>}</em>
<a id='L5248' name='L5248'></a>5248         <a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a> = <a href='../Y/2162.html' title='Multiple used in 5 places.'>EVP_get_cipherbyname</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>);
<a id='L5249' name='L5249'></a>5249         <strong class='reserved'>if</strong> (!<a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>) <em class='brace'>{</em>
<a id='L5250' name='L5250'></a>5250                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown cipher algorithm");
<a id='L5251' name='L5251'></a>5251                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5252' name='L5252'></a>5252         <em class='brace'>}</em>
<a id='L5253' name='L5253'></a>5253 
<a id='L5254' name='L5254'></a>5254         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>);
<a id='L5255' name='L5255'></a>5255 
<a id='L5256' name='L5256'></a>5256         <a href='../Y/24485.html' title='Multiple used in 98 places.'>keylen</a> = <a href='../Y/2103.html' title='Multiple used in 2 places.'>EVP_CIPHER_key_length</a>(<a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>);
<a id='L5257' name='L5257'></a>5257         <strong class='reserved'>if</strong> (<a href='../Y/24485.html' title='Multiple used in 98 places.'>keylen</a> &gt; <a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>) <em class='brace'>{</em>
<a id='L5258' name='L5258'></a>5258                 <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = <a href='../D/21334.html' title='Multiple defined in 2 places.'>emalloc</a>(<a href='../Y/24485.html' title='Multiple used in 98 places.'>keylen</a>);
<a id='L5259' name='L5259'></a>5259                 <a href='../S/868.html#L374' title='Defined at 374 in ext/pcre/pcrelib/pcre_internal.h.'>memset</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, 0, <a href='../Y/24485.html' title='Multiple used in 98 places.'>keylen</a>);
<a id='L5260' name='L5260'></a>5260                 <a href='../D/24499.html' title='Multiple defined in 4 places.'>memcpy</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, <a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>, <a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>);
<a id='L5261' name='L5261'></a>5261         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L5262' name='L5262'></a>5262                 <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>;
<a id='L5263' name='L5263'></a>5263         <em class='brace'>}</em>
<a id='L5264' name='L5264'></a>5264 
<a id='L5265' name='L5265'></a>5265         <a href='../Y/25899.html' title='Multiple used in 4 places.'>max_iv_len</a> = <a href='../Y/2102.html' title='Multiple used in 5 places.'>EVP_CIPHER_iv_length</a>(<a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>);
<a id='L5266' name='L5266'></a>5266         <strong class='reserved'>if</strong> (<a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a> == 0 &amp;&amp; <a href='../Y/25899.html' title='Multiple used in 4 places.'>max_iv_len</a> &gt; 0) <em class='brace'>{</em>
<a id='L5267' name='L5267'></a>5267                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Using an empty Initialization Vector (iv) is potentially insecure and not recommended");
<a id='L5268' name='L5268'></a>5268         <em class='brace'>}</em>
<a id='L5269' name='L5269'></a>5269         <a href='../Y/18359.html' title='Multiple used in 6 places.'>free_iv</a> = <a href='../S/851.html#L5197' title='Defined at 5197 in ext/openssl/openssl.c.'>php_openssl_validate_iv</a>(&amp;<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>, &amp;<a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a>, <a href='../Y/25899.html' title='Multiple used in 4 places.'>max_iv_len</a>);
<a id='L5270' name='L5270'></a>5270 
<a id='L5271' name='L5271'></a>5271         <a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a> = (<strong class='reserved'>int</strong>)<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a> + <a href='../Y/2101.html' title='Multiple used in 2 places.'>EVP_CIPHER_block_size</a>(<a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>);
<a id='L5272' name='L5272'></a>5272         <a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(<a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a>, 0);
<a id='L5273' name='L5273'></a>5273 
<a id='L5274' name='L5274'></a>5274         <a href='../Y/2112.html' title='Multiple used in 2 places.'>EVP_EncryptInit</a>(&amp;<a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>, <a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L5275' name='L5275'></a>5275         <strong class='reserved'>if</strong> (<a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a> &gt; <a href='../Y/24485.html' title='Multiple used in 98 places.'>keylen</a>) <em class='brace'>{</em>
<a id='L5276' name='L5276'></a>5276                 <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>, <a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>);
<a id='L5277' name='L5277'></a>5277                 <a href='../Y/2099.html' title='Multiple used in 2 places.'>EVP_CIPHER_CTX_set_key_length</a>(&amp;<a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>, (<strong class='reserved'>int</strong>)<a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>);
<a id='L5278' name='L5278'></a>5278         <em class='brace'>}</em>
<a id='L5279' name='L5279'></a>5279         EVP_EncryptInit_ex(&amp;<a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>);
<a id='L5280' name='L5280'></a>5280         <strong class='reserved'>if</strong> (<a href='../D/25509.html' title='Multiple defined in 3 places.'>options</a> &amp; <a href='../S/852.html#L33' title='Defined at 33 in ext/openssl/php_openssl.h.'>OPENSSL_ZERO_PADDING</a>) <em class='brace'>{</em>
<a id='L5281' name='L5281'></a>5281                 <a href='../Y/2100.html' title='Multiple used in 2 places.'>EVP_CIPHER_CTX_set_padding</a>(&amp;<a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>, 0);
<a id='L5282' name='L5282'></a>5282         <em class='brace'>}</em>
<a id='L5283' name='L5283'></a>5283         <strong class='reserved'>if</strong> (<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a> &gt; 0) <em class='brace'>{</em>
<a id='L5284' name='L5284'></a>5284                 EVP_EncryptUpdate(&amp;<a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>), &amp;<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, (<strong class='reserved'>int</strong>)<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>);
<a id='L5285' name='L5285'></a>5285         <em class='brace'>}</em>
<a id='L5286' name='L5286'></a>5286         <a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a> = <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>;
<a id='L5287' name='L5287'></a>5287         <strong class='reserved'>if</strong> (EVP_EncryptFinal(&amp;<a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>) + <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>, &amp;<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>)) <em class='brace'>{</em>
<a id='L5288' name='L5288'></a>5288                 <a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a> += <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>;
<a id='L5289' name='L5289'></a>5289                 <strong class='reserved'>if</strong> (<a href='../D/25509.html' title='Multiple defined in 3 places.'>options</a> &amp; <a href='../S/852.html#L32' title='Defined at 32 in ext/openssl/php_openssl.h.'>OPENSSL_RAW_DATA</a>) <em class='brace'>{</em>
<a id='L5290' name='L5290'></a>5290                         <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>)[<a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a>] = '\0';
<a id='L5291' name='L5291'></a>5291                         <a href='../S/1725.html#L41' title='Defined at 41 in Zend/zend_string.h.'>ZSTR_LEN</a>(<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>) = <a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a>;
<a id='L5292' name='L5292'></a>5292                         <a href='../S/1632.html#L615' title='Defined at 615 in Zend/zend_API.h.'>RETVAL_STR</a>(<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>);
<a id='L5293' name='L5293'></a>5293                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L5294' name='L5294'></a>5294                         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/12449.html' title='Multiple used in 10 places.'>base64_str</a>;
<a id='L5295' name='L5295'></a>5295 
<a id='L5296' name='L5296'></a>5296                         <a href='../Y/12449.html' title='Multiple used in 10 places.'>base64_str</a> = <a href='../S/1062.html#L56' title='Defined at 56 in ext/standard/base64.c.'>php_base64_encode</a>((<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>), <a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a>);
<a id='L5297' name='L5297'></a>5297                         <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>);
<a id='L5298' name='L5298'></a>5298                         <a href='../S/1632.html#L615' title='Defined at 615 in Zend/zend_API.h.'>RETVAL_STR</a>(<a href='../Y/12449.html' title='Multiple used in 10 places.'>base64_str</a>);
<a id='L5299' name='L5299'></a>5299                 <em class='brace'>}</em>
<a id='L5300' name='L5300'></a>5300         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L5301' name='L5301'></a>5301                 <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>);
<a id='L5302' name='L5302'></a>5302                 <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L5303' name='L5303'></a>5303         <em class='brace'>}</em>
<a id='L5304' name='L5304'></a>5304         <strong class='reserved'>if</strong> (<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> != (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>) <em class='brace'>{</em>
<a id='L5305' name='L5305'></a>5305                 <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>);
<a id='L5306' name='L5306'></a>5306         <em class='brace'>}</em>
<a id='L5307' name='L5307'></a>5307         <strong class='reserved'>if</strong> (<a href='../Y/18359.html' title='Multiple used in 6 places.'>free_iv</a>) <em class='brace'>{</em>
<a id='L5308' name='L5308'></a>5308                 <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>);
<a id='L5309' name='L5309'></a>5309         <em class='brace'>}</em>
<a id='L5310' name='L5310'></a>5310         <a href='../Y/2098.html' title='Multiple used in 7 places.'>EVP_CIPHER_CTX_cleanup</a>(&amp;<a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>);
<a id='L5311' name='L5311'></a>5311 <em class='brace'>}</em>
<a id='L5312' name='L5312'></a>5312 <em class='comment'>/* }}} */</em>
<a id='L5313' name='L5313'></a>5313 
<a id='L5314' name='L5314'></a>5314 <em class='comment'>/* {{{ proto string openssl_decrypt(string data, string method, string password [, long options=0 [, string $iv = '']])</em>
<a id='L5315' name='L5315'></a>5315 <em class='comment'>   Takes raw or base64 encoded string and decrypts it using given method and key */</em>
<a id='L5316' name='L5316'></a>5316 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29738.html' title='Multiple used in 3 places.'>openssl_decrypt</a>)
<a id='L5317' name='L5317'></a>5317 <em class='brace'>{</em>
<a id='L5318' name='L5318'></a>5318         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../D/25509.html' title='Multiple defined in 3 places.'>options</a> = 0;
<a id='L5319' name='L5319'></a>5319         <strong class='reserved'>char</strong> *<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, *<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>, *<a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>, *<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a> = "";
<a id='L5320' name='L5320'></a>5320         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, <a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>, <a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>, <a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a> = 0;
<a id='L5321' name='L5321'></a>5321         <strong class='reserved'>const</strong> <a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a> *<a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>;
<a id='L5322' name='L5322'></a>5322         <a href='../Y/2096.html' title='Multiple used in 4 places.'>EVP_CIPHER_CTX</a> <a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>;
<a id='L5323' name='L5323'></a>5323         <strong class='reserved'>int</strong> <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>, <a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a>, <a href='../Y/24485.html' title='Multiple used in 98 places.'>keylen</a>;
<a id='L5324' name='L5324'></a>5324         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>;
<a id='L5325' name='L5325'></a>5325         <strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>;
<a id='L5326' name='L5326'></a>5326         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../Y/12449.html' title='Multiple used in 10 places.'>base64_str</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L5327' name='L5327'></a>5327         <a href='../S/1731.html#L46' title='Defined at 46 in Zend/zend_types.h.'>zend_bool</a> <a href='../Y/18359.html' title='Multiple used in 6 places.'>free_iv</a>;
<a id='L5328' name='L5328'></a>5328 
<a id='L5329' name='L5329'></a>5329         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "sss|ls", &amp;<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, &amp;<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, &amp;<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>, &amp;<a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>, &amp;<a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>, &amp;<a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>, &amp;<a href='../D/25509.html' title='Multiple defined in 3 places.'>options</a>, &amp;<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>, &amp;<a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L5330' name='L5330'></a>5330                 <strong class='reserved'>return</strong>;
<a id='L5331' name='L5331'></a>5331         <em class='brace'>}</em>
<a id='L5332' name='L5332'></a>5332 
<a id='L5333' name='L5333'></a>5333         <strong class='reserved'>if</strong> (!<a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>) <em class='brace'>{</em>
<a id='L5334' name='L5334'></a>5334                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown cipher algorithm");
<a id='L5335' name='L5335'></a>5335                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5336' name='L5336'></a>5336         <em class='brace'>}</em>
<a id='L5337' name='L5337'></a>5337 
<a id='L5338' name='L5338'></a>5338         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>, <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>);
<a id='L5339' name='L5339'></a>5339 
<a id='L5340' name='L5340'></a>5340         <a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a> = <a href='../Y/2162.html' title='Multiple used in 5 places.'>EVP_get_cipherbyname</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>);
<a id='L5341' name='L5341'></a>5341         <strong class='reserved'>if</strong> (!<a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>) <em class='brace'>{</em>
<a id='L5342' name='L5342'></a>5342                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown cipher algorithm");
<a id='L5343' name='L5343'></a>5343                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5344' name='L5344'></a>5344         <em class='brace'>}</em>
<a id='L5345' name='L5345'></a>5345 
<a id='L5346' name='L5346'></a>5346         <strong class='reserved'>if</strong> (!(<a href='../D/25509.html' title='Multiple defined in 3 places.'>options</a> &amp; <a href='../S/852.html#L32' title='Defined at 32 in ext/openssl/php_openssl.h.'>OPENSSL_RAW_DATA</a>)) <em class='brace'>{</em>
<a id='L5347' name='L5347'></a>5347                 <a href='../Y/12449.html' title='Multiple used in 10 places.'>base64_str</a> = <a href='../S/1062.html#L130' title='Defined at 130 in ext/standard/base64.c.'>php_base64_decode</a>((<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, (<strong class='reserved'>int</strong>)<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>);
<a id='L5348' name='L5348'></a>5348                 <strong class='reserved'>if</strong> (!<a href='../Y/12449.html' title='Multiple used in 10 places.'>base64_str</a>) <em class='brace'>{</em>
<a id='L5349' name='L5349'></a>5349                         <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Failed to base64 decode the input");
<a id='L5350' name='L5350'></a>5350                         <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5351' name='L5351'></a>5351                 <em class='brace'>}</em>
<a id='L5352' name='L5352'></a>5352                 <a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a> = <a href='../S/1725.html#L41' title='Defined at 41 in Zend/zend_string.h.'>ZSTR_LEN</a>(<a href='../Y/12449.html' title='Multiple used in 10 places.'>base64_str</a>);
<a id='L5353' name='L5353'></a>5353                 <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a> = <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/12449.html' title='Multiple used in 10 places.'>base64_str</a>);
<a id='L5354' name='L5354'></a>5354         <em class='brace'>}</em>
<a id='L5355' name='L5355'></a>5355 
<a id='L5356' name='L5356'></a>5356         <a href='../Y/24485.html' title='Multiple used in 98 places.'>keylen</a> = <a href='../Y/2103.html' title='Multiple used in 2 places.'>EVP_CIPHER_key_length</a>(<a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>);
<a id='L5357' name='L5357'></a>5357         <strong class='reserved'>if</strong> (<a href='../Y/24485.html' title='Multiple used in 98 places.'>keylen</a> &gt; <a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>) <em class='brace'>{</em>
<a id='L5358' name='L5358'></a>5358                 <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = <a href='../D/21334.html' title='Multiple defined in 2 places.'>emalloc</a>(<a href='../Y/24485.html' title='Multiple used in 98 places.'>keylen</a>);
<a id='L5359' name='L5359'></a>5359                 <a href='../S/868.html#L374' title='Defined at 374 in ext/pcre/pcrelib/pcre_internal.h.'>memset</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, 0, <a href='../Y/24485.html' title='Multiple used in 98 places.'>keylen</a>);
<a id='L5360' name='L5360'></a>5360                 <a href='../D/24499.html' title='Multiple defined in 4 places.'>memcpy</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, <a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>, <a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>);
<a id='L5361' name='L5361'></a>5361         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L5362' name='L5362'></a>5362                 <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> = (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>;
<a id='L5363' name='L5363'></a>5363         <em class='brace'>}</em>
<a id='L5364' name='L5364'></a>5364 
<a id='L5365' name='L5365'></a>5365         <a href='../Y/18359.html' title='Multiple used in 6 places.'>free_iv</a> = <a href='../S/851.html#L5197' title='Defined at 5197 in ext/openssl/openssl.c.'>php_openssl_validate_iv</a>(&amp;<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>, &amp;<a href='../Y/24243.html' title='Multiple used in 37 places.'>iv_len</a>, <a href='../Y/2102.html' title='Multiple used in 5 places.'>EVP_CIPHER_iv_length</a>(<a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>));
<a id='L5366' name='L5366'></a>5366 
<a id='L5367' name='L5367'></a>5367         <a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a> = (<strong class='reserved'>int</strong>)<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a> + <a href='../Y/2101.html' title='Multiple used in 2 places.'>EVP_CIPHER_block_size</a>(<a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>);
<a id='L5368' name='L5368'></a>5368         <a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(<a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a>, 0);
<a id='L5369' name='L5369'></a>5369 
<a id='L5370' name='L5370'></a>5370         EVP_DecryptInit(&amp;<a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>, <a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L5371' name='L5371'></a>5371         <strong class='reserved'>if</strong> (<a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a> &gt; <a href='../Y/24485.html' title='Multiple used in 98 places.'>keylen</a>) <em class='brace'>{</em>
<a id='L5372' name='L5372'></a>5372                 <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>, <a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>);
<a id='L5373' name='L5373'></a>5373                 <a href='../Y/2099.html' title='Multiple used in 2 places.'>EVP_CIPHER_CTX_set_key_length</a>(&amp;<a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>, (<strong class='reserved'>int</strong>)<a href='../Y/31259.html' title='Multiple used in 68 places.'>password_len</a>);
<a id='L5374' name='L5374'></a>5374         <em class='brace'>}</em>
<a id='L5375' name='L5375'></a>5375         EVP_DecryptInit_ex(&amp;<a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>);
<a id='L5376' name='L5376'></a>5376         <strong class='reserved'>if</strong> (<a href='../D/25509.html' title='Multiple defined in 3 places.'>options</a> &amp; <a href='../S/852.html#L33' title='Defined at 33 in ext/openssl/php_openssl.h.'>OPENSSL_ZERO_PADDING</a>) <em class='brace'>{</em>
<a id='L5377' name='L5377'></a>5377                 <a href='../Y/2100.html' title='Multiple used in 2 places.'>EVP_CIPHER_CTX_set_padding</a>(&amp;<a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>, 0);
<a id='L5378' name='L5378'></a>5378         <em class='brace'>}</em>
<a id='L5379' name='L5379'></a>5379         EVP_DecryptUpdate(&amp;<a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>), &amp;<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>, (<strong class='reserved'>int</strong>)<a href='../Y/15015.html' title='Multiple used in 153 places.'>data_len</a>);
<a id='L5380' name='L5380'></a>5380         <a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a> = <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>;
<a id='L5381' name='L5381'></a>5381         <strong class='reserved'>if</strong> (EVP_DecryptFinal(&amp;<a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>, (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong> *)<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>) + <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>, &amp;<a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>)) <em class='brace'>{</em>
<a id='L5382' name='L5382'></a>5382                 <a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a> += <a href='../Y/22042.html' title='Multiple used in 12009 places.'>i</a>;
<a id='L5383' name='L5383'></a>5383                 <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>)[<a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a>] = '\0';
<a id='L5384' name='L5384'></a>5384                 <a href='../S/1725.html#L41' title='Defined at 41 in Zend/zend_string.h.'>ZSTR_LEN</a>(<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>) = <a href='../Y/30161.html' title='Multiple used in 49 places.'>outlen</a>;
<a id='L5385' name='L5385'></a>5385                 <a href='../S/1632.html#L615' title='Defined at 615 in Zend/zend_API.h.'>RETVAL_STR</a>(<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>);
<a id='L5386' name='L5386'></a>5386         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L5387' name='L5387'></a>5387                 <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../Y/30144.html' title='Multiple used in 111 places.'>outbuf</a>);
<a id='L5388' name='L5388'></a>5388                 <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L5389' name='L5389'></a>5389         <em class='brace'>}</em>
<a id='L5390' name='L5390'></a>5390         <strong class='reserved'>if</strong> (<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a> != (<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../Y/31256.html' title='Multiple used in 148 places.'>password</a>) <em class='brace'>{</em>
<a id='L5391' name='L5391'></a>5391                 <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>);
<a id='L5392' name='L5392'></a>5392         <em class='brace'>}</em>
<a id='L5393' name='L5393'></a>5393         <strong class='reserved'>if</strong> (<a href='../Y/18359.html' title='Multiple used in 6 places.'>free_iv</a>) <em class='brace'>{</em>
<a id='L5394' name='L5394'></a>5394                 <a href='../D/21328.html' title='Multiple defined in 2 places.'>efree</a>(<a href='../Y/24240.html' title='Multiple used in 59 places.'>iv</a>);
<a id='L5395' name='L5395'></a>5395         <em class='brace'>}</em>
<a id='L5396' name='L5396'></a>5396         <strong class='reserved'>if</strong> (<a href='../Y/12449.html' title='Multiple used in 10 places.'>base64_str</a>) <em class='brace'>{</em>
<a id='L5397' name='L5397'></a>5397                 <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../Y/12449.html' title='Multiple used in 10 places.'>base64_str</a>);
<a id='L5398' name='L5398'></a>5398         <em class='brace'>}</em>
<a id='L5399' name='L5399'></a>5399         <a href='../Y/2098.html' title='Multiple used in 7 places.'>EVP_CIPHER_CTX_cleanup</a>(&amp;<a href='../Y/13707.html' title='Multiple used in 16 places.'>cipher_ctx</a>);
<a id='L5400' name='L5400'></a>5400 <em class='brace'>}</em>
<a id='L5401' name='L5401'></a>5401 <em class='comment'>/* }}} */</em>
<a id='L5402' name='L5402'></a>5402 
<a id='L5403' name='L5403'></a>5403 <em class='comment'>/* {{{ proto int openssl_cipher_iv_length(string $method) */</em>
<a id='L5404' name='L5404'></a>5404 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29731.html' title='Multiple used in 3 places.'>openssl_cipher_iv_length</a>)
<a id='L5405' name='L5405'></a>5405 <em class='brace'>{</em>
<a id='L5406' name='L5406'></a>5406         <strong class='reserved'>char</strong> *<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>;
<a id='L5407' name='L5407'></a>5407         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>;
<a id='L5408' name='L5408'></a>5408         <strong class='reserved'>const</strong> <a href='../Y/2095.html' title='Multiple used in 15 places.'>EVP_CIPHER</a> *<a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>;
<a id='L5409' name='L5409'></a>5409 
<a id='L5410' name='L5410'></a>5410         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "s", &amp;<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>, &amp;<a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L5411' name='L5411'></a>5411                 <strong class='reserved'>return</strong>;
<a id='L5412' name='L5412'></a>5412         <em class='brace'>}</em>
<a id='L5413' name='L5413'></a>5413 
<a id='L5414' name='L5414'></a>5414         <strong class='reserved'>if</strong> (!<a href='../Y/26531.html' title='Multiple used in 21 places.'>method_len</a>) <em class='brace'>{</em>
<a id='L5415' name='L5415'></a>5415                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown cipher algorithm");
<a id='L5416' name='L5416'></a>5416                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5417' name='L5417'></a>5417         <em class='brace'>}</em>
<a id='L5418' name='L5418'></a>5418 
<a id='L5419' name='L5419'></a>5419         <a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a> = <a href='../Y/2162.html' title='Multiple used in 5 places.'>EVP_get_cipherbyname</a>(<a href='../Y/26521.html' title='Multiple used in 490 places.'>method</a>);
<a id='L5420' name='L5420'></a>5420         <strong class='reserved'>if</strong> (!<a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>) <em class='brace'>{</em>
<a id='L5421' name='L5421'></a>5421                 <a href='../S/1378.html#L312' title='Defined at 312 in main/php.h.'>php_error_docref</a>(<a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>, <a href='../S/1651.html#L26' title='Defined at 26 in Zend/zend_errors.h.'>E_WARNING</a>, "Unknown cipher algorithm");
<a id='L5422' name='L5422'></a>5422                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5423' name='L5423'></a>5423         <em class='brace'>}</em>
<a id='L5424' name='L5424'></a>5424 
<a id='L5425' name='L5425'></a>5425         <a href='../S/1632.html#L631' title='Defined at 631 in Zend/zend_API.h.'>RETURN_LONG</a>(<a href='../Y/2102.html' title='Multiple used in 5 places.'>EVP_CIPHER_iv_length</a>(<a href='../Y/13715.html' title='Multiple used in 18 places.'>cipher_type</a>));
<a id='L5426' name='L5426'></a>5426 <em class='brace'>}</em>
<a id='L5427' name='L5427'></a>5427 <em class='comment'>/* }}} */</em>
<a id='L5428' name='L5428'></a>5428 
<a id='L5429' name='L5429'></a>5429 
<a id='L5430' name='L5430'></a>5430 <em class='comment'>/* {{{ proto string openssl_dh_compute_key(string pub_key, resource dh_key)</em>
<a id='L5431' name='L5431'></a>5431 <em class='comment'>   Computes shared secret for public value of remote DH key and local DH key */</em>
<a id='L5432' name='L5432'></a>5432 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29739.html' title='Multiple used in 3 places.'>openssl_dh_compute_key</a>)
<a id='L5433' name='L5433'></a>5433 <em class='brace'>{</em>
<a id='L5434' name='L5434'></a>5434         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>;
<a id='L5435' name='L5435'></a>5435         <strong class='reserved'>char</strong> *<a href='../Y/33722.html' title='Multiple used in 3 places.'>pub_str</a>;
<a id='L5436' name='L5436'></a>5436         <a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a> <a href='../Y/33721.html' title='Multiple used in 4 places.'>pub_len</a>;
<a id='L5437' name='L5437'></a>5437         <a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>;
<a id='L5438' name='L5438'></a>5438         <a href='../Y/217.html' title='Multiple used in 3 places.'>BIGNUM</a> *<a href='../Y/33718.html' title='Multiple used in 35 places.'>pub</a>;
<a id='L5439' name='L5439'></a>5439         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>;
<a id='L5440' name='L5440'></a>5440         <strong class='reserved'>int</strong> <a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a>;
<a id='L5441' name='L5441'></a>5441 
<a id='L5442' name='L5442'></a>5442         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "sr", &amp;<a href='../Y/33722.html' title='Multiple used in 3 places.'>pub_str</a>, &amp;<a href='../Y/33721.html' title='Multiple used in 4 places.'>pub_len</a>, &amp;<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L5443' name='L5443'></a>5443                 <strong class='reserved'>return</strong>;
<a id='L5444' name='L5444'></a>5444         <em class='brace'>}</em>
<a id='L5445' name='L5445'></a>5445         <strong class='reserved'>if</strong> ((<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a> = (<a href='../Y/2126.html' title='Multiple used in 46 places.'>EVP_PKEY</a> *)<a href='../S/1690.html#L124' title='Defined at 124 in Zend/zend_list.c.'>zend_fetch_resource</a>(<a href='../S/1731.html#L552' title='Defined at 552 in Zend/zend_types.h.'>Z_RES_P</a>(<a href='../D/23759.html' title='Multiple defined in 4 places.'>key</a>), "OpenSSL key", <a href='../Y/24897.html' title='Multiple used in 14 places.'>le_key</a>)) == <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L5446' name='L5446'></a>5446                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5447' name='L5447'></a>5447         <em class='brace'>}</em>
<a id='L5448' name='L5448'></a>5448         <strong class='reserved'>if</strong> (<a href='../Y/2145.html' title='Multiple used in 4 places.'>EVP_PKEY_type</a>(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../D/32173.html' title='Multiple defined in 6 places.'>type</a>) != <a href='../Y/2127.html' title='Multiple used in 3 places.'>EVP_PKEY_DH</a> || !<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>) <em class='brace'>{</em>
<a id='L5449' name='L5449'></a>5449                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5450' name='L5450'></a>5450         <em class='brace'>}</em>
<a id='L5451' name='L5451'></a>5451 
<a id='L5452' name='L5452'></a>5452         <a href='../S/851.html#L549' title='Defined at 549 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_SIZE_T_TO_INT</a>(<a href='../Y/33721.html' title='Multiple used in 4 places.'>pub_len</a>, <a href='../Y/33720.html' title='Multiple used in 8 places.'>pub_key</a>);
<a id='L5453' name='L5453'></a>5453         <a href='../Y/33718.html' title='Multiple used in 35 places.'>pub</a> = <a href='../Y/249.html' title='Multiple used in 2 places.'>BN_bin2bn</a>((<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../Y/33722.html' title='Multiple used in 3 places.'>pub_str</a>, (<strong class='reserved'>int</strong>)<a href='../Y/33721.html' title='Multiple used in 4 places.'>pub_len</a>, <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>);
<a id='L5454' name='L5454'></a>5454 
<a id='L5455' name='L5455'></a>5455         <a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(DH_size(<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>), 0);
<a id='L5456' name='L5456'></a>5456         <a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a> = DH_compute_key((<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>), <a href='../Y/33718.html' title='Multiple used in 35 places.'>pub</a>, <a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>-&gt;<a href='../Y/32832.html' title='Multiple used in 125 places.'>pkey</a>.<a href='../Y/15669.html' title='Multiple used in 29 places.'>dh</a>);
<a id='L5457' name='L5457'></a>5457 
<a id='L5458' name='L5458'></a>5458         <strong class='reserved'>if</strong> (<a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a> &gt;= 0) <em class='brace'>{</em>
<a id='L5459' name='L5459'></a>5459                 <a href='../S/1725.html#L41' title='Defined at 41 in Zend/zend_string.h.'>ZSTR_LEN</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>) = <a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a>;
<a id='L5460' name='L5460'></a>5460                 <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>)[<a href='../Y/24983.html' title='Multiple used in 4653 places.'>len</a>] = 0;
<a id='L5461' name='L5461'></a>5461                 <a href='../S/1632.html#L615' title='Defined at 615 in Zend/zend_API.h.'>RETVAL_STR</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>);
<a id='L5462' name='L5462'></a>5462         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L5463' name='L5463'></a>5463                 <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../D/20795.html' title='Multiple defined in 7 places.'>data</a>);
<a id='L5464' name='L5464'></a>5464                 <a href='../S/1632.html#L626' title='Defined at 626 in Zend/zend_API.h.'>RETVAL_FALSE</a>;
<a id='L5465' name='L5465'></a>5465         <em class='brace'>}</em>
<a id='L5466' name='L5466'></a>5466 
<a id='L5467' name='L5467'></a>5467         <a href='../Y/251.html' title='Multiple used in 4 places.'>BN_free</a>(<a href='../Y/33718.html' title='Multiple used in 35 places.'>pub</a>);
<a id='L5468' name='L5468'></a>5468 <em class='brace'>}</em>
<a id='L5469' name='L5469'></a>5469 <em class='comment'>/* }}} */</em>
<a id='L5470' name='L5470'></a>5470 
<a id='L5471' name='L5471'></a>5471 <em class='comment'>/* {{{ proto string openssl_random_pseudo_bytes(integer length [, &amp;bool returned_strong_result])</em>
<a id='L5472' name='L5472'></a>5472 <em class='comment'>   Returns a string of the length specified filled with random pseudo bytes */</em>
<a id='L5473' name='L5473'></a>5473 <a href='../R/7042.html' title='Multiple referred from 2099 places.'>PHP_FUNCTION</a>(<a href='../Y/29773.html' title='Multiple used in 3 places.'>openssl_random_pseudo_bytes</a>)
<a id='L5474' name='L5474'></a>5474 <em class='brace'>{</em>
<a id='L5475' name='L5475'></a>5475         <a href='../D/34229.html' title='Multiple defined in 2 places.'>zend_long</a> <a href='../Y/13011.html' title='Multiple used in 27 places.'>buffer_length</a>;
<a id='L5476' name='L5476'></a>5476         <a href='../S/1731.html#L87' title='Defined at 87 in Zend/zend_types.h.'>zend_string</a> *<a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L5477' name='L5477'></a>5477         <a href='../S/1731.html#L84' title='Defined at 84 in Zend/zend_types.h.'>zval</a> *<a href='../Y/44107.html' title='Multiple used in 11 places.'>zstrong_result_returned</a> = <a href='../D/5944.html' title='Multiple defined in 8 places.'>NULL</a>;
<a id='L5478' name='L5478'></a>5478 
<a id='L5479' name='L5479'></a>5479         <strong class='reserved'>if</strong> (<a href='../S/1631.html#L954' title='Defined at 954 in Zend/zend_API.c.'>zend_parse_parameters</a>(<a href='../S/1632.html#L367' title='Defined at 367 in Zend/zend_API.h.'>ZEND_NUM_ARGS</a>(), "l|z/", &amp;<a href='../Y/13011.html' title='Multiple used in 27 places.'>buffer_length</a>, &amp;<a href='../Y/44107.html' title='Multiple used in 11 places.'>zstrong_result_returned</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>) <em class='brace'>{</em>
<a id='L5480' name='L5480'></a>5480                 <strong class='reserved'>return</strong>;
<a id='L5481' name='L5481'></a>5481         <em class='brace'>}</em>
<a id='L5482' name='L5482'></a>5482 
<a id='L5483' name='L5483'></a>5483         <strong class='reserved'>if</strong> (<a href='../Y/13011.html' title='Multiple used in 27 places.'>buffer_length</a> &lt;= 0) <em class='brace'>{</em>
<a id='L5484' name='L5484'></a>5484                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5485' name='L5485'></a>5485         <em class='brace'>}</em>
<a id='L5486' name='L5486'></a>5486 
<a id='L5487' name='L5487'></a>5487         <strong class='reserved'>if</strong> (<a href='../Y/44107.html' title='Multiple used in 11 places.'>zstrong_result_returned</a>) <em class='brace'>{</em>
<a id='L5488' name='L5488'></a>5488                 <a href='../S/1733.html#L121' title='Defined at 121 in Zend/zend_variables.h.'>zval_dtor</a>(<a href='../Y/44107.html' title='Multiple used in 11 places.'>zstrong_result_returned</a>);
<a id='L5489' name='L5489'></a>5489                 <a href='../S/1731.html#L595' title='Defined at 595 in Zend/zend_types.h.'>ZVAL_FALSE</a>(<a href='../Y/44107.html' title='Multiple used in 11 places.'>zstrong_result_returned</a>);
<a id='L5490' name='L5490'></a>5490         <em class='brace'>}</em>
<a id='L5491' name='L5491'></a>5491 
<a id='L5492' name='L5492'></a>5492         <a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a> = <a href='../S/1725.html#L119' title='Defined at 119 in Zend/zend_string.h.'>zend_string_alloc</a>(<a href='../Y/13011.html' title='Multiple used in 27 places.'>buffer_length</a>, 0);
<a id='L5493' name='L5493'></a>5493 
<a id='L5494' name='L5494'></a>5494 <em class='sharp'>#ifdef</em> <a href='../Y/5051.html' title='Multiple used in 686 places.'>PHP_WIN32</a>
<a id='L5495' name='L5495'></a>5495         <em class='comment'>/* random/urandom equivalent on Windows */</em>
<a id='L5496' name='L5496'></a>5496         <strong class='reserved'>if</strong> (<a href='../S/1623.html#L80' title='Defined at 80 in win32/winutil.c.'>php_win32_get_random_bytes</a>((<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>-&gt;<a href='../Y/40037.html' title='Multiple used in 2923 places.'>val</a>, (<a href='../Y/36246.html' title='Multiple used in 4587 places.'>size_t</a>) <a href='../Y/13011.html' title='Multiple used in 27 places.'>buffer_length</a>) == <a href='../S/1731.html#L51' title='Defined at 51 in Zend/zend_types.h.'>FAILURE</a>)<em class='brace'>{</em>
<a id='L5497' name='L5497'></a>5497                 <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>);
<a id='L5498' name='L5498'></a>5498                 <strong class='reserved'>if</strong> (<a href='../Y/44107.html' title='Multiple used in 11 places.'>zstrong_result_returned</a>) <em class='brace'>{</em>
<a id='L5499' name='L5499'></a>5499                         <a href='../S/1731.html#L595' title='Defined at 595 in Zend/zend_types.h.'>ZVAL_FALSE</a>(<a href='../Y/44107.html' title='Multiple used in 11 places.'>zstrong_result_returned</a>);
<a id='L5500' name='L5500'></a>5500                 <em class='brace'>}</em>
<a id='L5501' name='L5501'></a>5501                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5502' name='L5502'></a>5502         <em class='brace'>}</em>
<a id='L5503' name='L5503'></a>5503 <em class='sharp'>#else</em>
<a id='L5504' name='L5504'></a>5504 
<a id='L5505' name='L5505'></a>5505         <a href='../S/851.html#L555' title='Defined at 555 in ext/openssl/openssl.c.'>PHP_OPENSSL_CHECK_LONG_TO_INT</a>(<a href='../Y/13011.html' title='Multiple used in 27 places.'>buffer_length</a>, <a href='../D/23811.html' title='Multiple defined in 3 places.'>length</a>);
<a id='L5506' name='L5506'></a>5506 
<a id='L5507' name='L5507'></a>5507         <strong class='reserved'>if</strong> (RAND_bytes((<strong class='reserved'>unsigned</strong> <strong class='reserved'>char</strong>*)<a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>), (<strong class='reserved'>int</strong>)<a href='../Y/13011.html' title='Multiple used in 27 places.'>buffer_length</a>) &lt;= 0) <em class='brace'>{</em>
<a id='L5508' name='L5508'></a>5508                 <a href='../S/1725.html#L267' title='Defined at 267 in Zend/zend_string.h.'>zend_string_release</a>(<a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>);
<a id='L5509' name='L5509'></a>5509                 <strong class='reserved'>if</strong> (<a href='../Y/44107.html' title='Multiple used in 11 places.'>zstrong_result_returned</a>) <em class='brace'>{</em>
<a id='L5510' name='L5510'></a>5510                         <a href='../S/1731.html#L595' title='Defined at 595 in Zend/zend_types.h.'>ZVAL_FALSE</a>(<a href='../Y/44107.html' title='Multiple used in 11 places.'>zstrong_result_returned</a>);
<a id='L5511' name='L5511'></a>5511                 <em class='brace'>}</em>
<a id='L5512' name='L5512'></a>5512                 <a href='../S/1632.html#L644' title='Defined at 644 in Zend/zend_API.h.'>RETURN_FALSE</a>;
<a id='L5513' name='L5513'></a>5513         <em class='brace'>}</em>
<a id='L5514' name='L5514'></a>5514 <em class='sharp'>#endif</em>
<a id='L5515' name='L5515'></a>5515 
<a id='L5516' name='L5516'></a>5516         <a href='../S/1725.html#L40' title='Defined at 40 in Zend/zend_string.h.'>ZSTR_VAL</a>(<a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>)[<a href='../Y/13011.html' title='Multiple used in 27 places.'>buffer_length</a>] = 0;
<a id='L5517' name='L5517'></a>5517         <a href='../S/1632.html#L615' title='Defined at 615 in Zend/zend_API.h.'>RETVAL_STR</a>(<a href='../S/1313.html#L43' title='Defined at 43 in ext/zip/lib/zip_source_buffer.c.'>buffer</a>);
<a id='L5518' name='L5518'></a>5518 
<a id='L5519' name='L5519'></a>5519         <strong class='reserved'>if</strong> (<a href='../Y/44107.html' title='Multiple used in 11 places.'>zstrong_result_returned</a>) <em class='brace'>{</em>
<a id='L5520' name='L5520'></a>5520                 <a href='../S/1731.html#L603' title='Defined at 603 in Zend/zend_types.h.'>ZVAL_BOOL</a>(<a href='../Y/44107.html' title='Multiple used in 11 places.'>zstrong_result_returned</a>, 1);
<a id='L5521' name='L5521'></a>5521         <em class='brace'>}</em>
<a id='L5522' name='L5522'></a>5522 <em class='brace'>}</em>
<a id='L5523' name='L5523'></a>5523 <em class='comment'>/* }}} */</em>
<a id='L5524' name='L5524'></a>5524 
<a id='L5525' name='L5525'></a>5525 <em class='comment'>/*</em>
<a id='L5526' name='L5526'></a>5526 <em class='comment'> * Local variables:</em>
<a id='L5527' name='L5527'></a>5527 <em class='comment'> * tab-width: 8</em>
<a id='L5528' name='L5528'></a>5528 <em class='comment'> * c-basic-offset: 8</em>
<a id='L5529' name='L5529'></a>5529 <em class='comment'> * End:</em>
<a id='L5530' name='L5530'></a>5530 <em class='comment'> * vim600: sw=4 ts=4 fdm=marker</em>
<a id='L5531' name='L5531'></a>5531 <em class='comment'> * vim&lt;600: sw=4 ts=4</em>
<a id='L5532' name='L5532'></a>5532 <em class='comment'> */</em>
<a id='L5533' name='L5533'></a>5533 
</pre>
<hr />
<a id='BOTTOM' name='BOTTOM'></a>
<em class='comment'>/* [&lt;][&gt;]<a href='#L564'>[^]</a><a href='#L5473'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</em>
</body>
</html>
