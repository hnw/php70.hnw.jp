<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>TWG</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/1588.html#L111'>TWG</a>               111 TSRM/tsrm_win32.c 	PSID pSid = TWG(impersonation_token_sid);</span>
<span class='curline'><a href='../S/1588.html#L250'>TWG</a>               250 TSRM/tsrm_win32.c 					 TWG(impersonation_token) = NULL;</span>
<span class='curline'><a href='../S/1588.html#L259'>TWG</a>               259 TSRM/tsrm_win32.c 			if (TWG(impersonation_token_sid)) {</span>
<span class='curline'><a href='../S/1588.html#L260'>TWG</a>               260 TSRM/tsrm_win32.c 				free(TWG(impersonation_token_sid));</span>
<span class='curline'><a href='../S/1588.html#L262'>TWG</a>               262 TSRM/tsrm_win32.c 			TWG(impersonation_token_sid) = NULL;</span>
<span class='curline'><a href='../S/1588.html#L267'>TWG</a>               267 TSRM/tsrm_win32.c 		if (!TWG(impersonation_token_sid) || !EqualSid(token_sid, TWG(impersonation_token_sid))) {</span>
<span class='curline'><a href='../S/1588.html#L268'>TWG</a>               268 TSRM/tsrm_win32.c 			if (TWG(impersonation_token_sid)) {</span>
<span class='curline'><a href='../S/1588.html#L269'>TWG</a>               269 TSRM/tsrm_win32.c 				free(TWG(impersonation_token_sid));</span>
<span class='curline'><a href='../S/1588.html#L271'>TWG</a>               271 TSRM/tsrm_win32.c 			TWG(impersonation_token_sid) = token_sid;</span>
<span class='curline'><a href='../S/1588.html#L274'>TWG</a>               274 TSRM/tsrm_win32.c 			if (!DuplicateToken(thread_token, SecurityImpersonation, &amp;TWG(impersonation_token))) {</span>
<span class='curline'><a href='../S/1588.html#L323'>TWG</a>               323 TSRM/tsrm_win32.c 		if(TWG(impersonation_token) == NULL) {</span>
<span class='curline'><a href='../S/1588.html#L340'>TWG</a>               340 TSRM/tsrm_win32.c 		if(!AccessCheck((PSECURITY_DESCRIPTOR)psec_desc, TWG(impersonation_token), desired_access, &amp;gen_map, &amp;privilege_set, &amp;priv_set_length, &amp;granted_access, &amp;fAccess)) {</span>
<span class='curline'><a href='../S/1588.html#L391'>TWG</a>               391 TSRM/tsrm_win32.c 	for (ptr = TWG(process); ptr &lt; (TWG(process) + TWG(process_size)); ptr++) {</span>
<span class='curline'><a href='../S/1588.html#L397'>TWG</a>               397 TSRM/tsrm_win32.c 	if (ptr &lt; (TWG(process) + TWG(process_size))) {</span>
<span class='curline'><a href='../S/1588.html#L401'>TWG</a>               401 TSRM/tsrm_win32.c 	newptr = (process_pair*)realloc((void*)TWG(process), (TWG(process_size)+1)*sizeof(process_pair));</span>
<span class='curline'><a href='../S/1588.html#L406'>TWG</a>               406 TSRM/tsrm_win32.c 	TWG(process) = newptr;</span>
<span class='curline'><a href='../S/1588.html#L407'>TWG</a>               407 TSRM/tsrm_win32.c 	ptr = newptr + TWG(process_size);</span>
<span class='curline'><a href='../S/1588.html#L408'>TWG</a>               408 TSRM/tsrm_win32.c 	TWG(process_size)++;</span>
<span class='curline'><a href='../S/1588.html#L417'>TWG</a>               417 TSRM/tsrm_win32.c 	for (ptr = TWG(shm); ptr &lt; (TWG(shm) + TWG(shm_size)); ptr++) {</span>
<span class='curline'><a href='../S/1588.html#L428'>TWG</a>               428 TSRM/tsrm_win32.c 	if (ptr &lt; (TWG(shm) + TWG(shm_size))) {</span>
<span class='curline'><a href='../S/1588.html#L432'>TWG</a>               432 TSRM/tsrm_win32.c 	newptr = (shm_pair*)realloc((void*)TWG(shm), (TWG(shm_size)+1)*sizeof(shm_pair));</span>
<span class='curline'><a href='../S/1588.html#L437'>TWG</a>               437 TSRM/tsrm_win32.c 	TWG(shm) = newptr;</span>
<span class='curline'><a href='../S/1588.html#L438'>TWG</a>               438 TSRM/tsrm_win32.c 	ptr = newptr + TWG(shm_size);</span>
<span class='curline'><a href='../S/1588.html#L439'>TWG</a>               439 TSRM/tsrm_win32.c 	TWG(shm_size)++;</span>
<span class='curline'><a href='../S/1588.html#L536'>TWG</a>               536 TSRM/tsrm_win32.c 	cmd = (char*)malloc(strlen(command)+strlen(TWG(comspec))+sizeof(" /c ")+2);</span>
<span class='curline'><a href='../S/1588.html#L541'>TWG</a>               541 TSRM/tsrm_win32.c 	sprintf(cmd, "%s /c \"%s\"", TWG(comspec), command);</span>
</pre>
</body>
</html>
