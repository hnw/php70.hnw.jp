<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>PS</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/987.html#L275'>PS</a>                275 ext/session/mod_mm.c 	int save_path_len = strlen(PS(save_path));</span>
<span class='curline'><a href='../S/987.html#L295'>PS</a>                295 ext/session/mod_mm.c 	memcpy(ps_mm_path, PS(save_path), save_path_len);</span>
<span class='curline'><a href='../S/987.html#L296'>PS</a>                296 ext/session/mod_mm.c 	if (save_path_len &amp;&amp; PS(save_path)[save_path_len - 1] != DEFAULT_SLASH) {</span>
<span class='curline'><a href='../S/987.html#L358'>PS</a>                358 ext/session/mod_mm.c 	if (PS(use_strict_mode)</span>
<span class='curline'><a href='../S/987.html#L362'>PS</a>                362 ext/session/mod_mm.c 			efree(PS(id));</span>
<span class='curline'><a href='../S/987.html#L363'>PS</a>                363 ext/session/mod_mm.c 			PS(id) = NULL;</span>
<span class='curline'><a href='../S/987.html#L365'>PS</a>                365 ext/session/mod_mm.c 		PS(id) = PS(mod)-&gt;s_create_sid((void **)&amp;data);</span>
<span class='curline'><a href='../S/987.html#L366'>PS</a>                366 ext/session/mod_mm.c 		if (!PS(id)) {</span>
<span class='curline'><a href='../S/987.html#L369'>PS</a>                369 ext/session/mod_mm.c 		if (PS(use_cookies)) {</span>
<span class='curline'><a href='../S/987.html#L370'>PS</a>                370 ext/session/mod_mm.c 			PS(send_cookie) = 1;</span>
<span class='curline'><a href='../S/987.html#L373'>PS</a>                373 ext/session/mod_mm.c 		PS(session_status) = php_session_active;</span>
<span class='curline'><a href='../S/987.html#L376'>PS</a>                376 ext/session/mod_mm.c 	sd = ps_sd_lookup(data, PS(id)-&gt;val, 0);</span>
<span class='curline'><a href='../S/989.html#L48'>PS</a>                 48 ext/session/mod_user.c #define PSF(a) PS(mod_user_names).name.ps_##a</span>
<span class='curline'><a href='../S/989.html#L89'>PS</a>                 89 ext/session/mod_user.c 	PS(mod_user_implemented) = 1;</span>
<span class='curline'><a href='../S/989.html#L99'>PS</a>                 99 ext/session/mod_user.c 	if (!PS(mod_user_implemented)) {</span>
<span class='curline'><a href='../S/989.html#L110'>PS</a>                110 ext/session/mod_user.c 	PS(mod_user_implemented) = 0;</span>
<span class='curline'><a href='../S/991.html#L25'>PS</a>                 25 ext/session/mod_user_class.c 	if (PS(default_mod) == NULL) {				\</span>
<span class='curline'><a href='../S/991.html#L32'>PS</a>                 32 ext/session/mod_user_class.c 	if (!PS(mod_user_is_open)) {			\</span>
<span class='curline'><a href='../S/991.html#L50'>PS</a>                 50 ext/session/mod_user_class.c 	PS(mod_user_is_open) = 1;</span>
<span class='curline'><a href='../S/991.html#L51'>PS</a>                 51 ext/session/mod_user_class.c 	RETVAL_BOOL(SUCCESS == PS(default_mod)-&gt;s_open(&amp;PS(mod_data), save_path, session_name));</span>
<span class='curline'><a href='../S/991.html#L65'>PS</a>                 65 ext/session/mod_user_class.c 	PS(mod_user_is_open) = 0;</span>
<span class='curline'><a href='../S/991.html#L66'>PS</a>                 66 ext/session/mod_user_class.c 	RETVAL_BOOL(SUCCESS == PS(default_mod)-&gt;s_close(&amp;PS(mod_data)));</span>
<span class='curline'><a href='../S/991.html#L83'>PS</a>                 83 ext/session/mod_user_class.c 	if (PS(default_mod)-&gt;s_read(&amp;PS(mod_data), key, &amp;val, PS(gc_maxlifetime)) == FAILURE) {</span>
<span class='curline'><a href='../S/991.html#L103'>PS</a>                103 ext/session/mod_user_class.c 	RETURN_BOOL(SUCCESS == PS(default_mod)-&gt;s_write(&amp;PS(mod_data), key, val, PS(gc_maxlifetime)));</span>
<span class='curline'><a href='../S/991.html#L119'>PS</a>                119 ext/session/mod_user_class.c 	RETURN_BOOL(SUCCESS == PS(default_mod)-&gt;s_destroy(&amp;PS(mod_data), key));</span>
<span class='curline'><a href='../S/991.html#L136'>PS</a>                136 ext/session/mod_user_class.c 	RETURN_BOOL(SUCCESS == PS(default_mod)-&gt;s_gc(&amp;PS(mod_data), maxlifetime, &amp;nrdels));</span>
<span class='curline'><a href='../S/991.html#L152'>PS</a>                152 ext/session/mod_user_class.c 	id = PS(default_mod)-&gt;s_create_sid(&amp;PS(mod_data));</span>
<span class='curline'><a href='../S/991.html#L188'>PS</a>                188 ext/session/mod_user_class.c 	RETVAL_BOOL(SUCCESS == PS(default_mod)-&gt;s_write(&amp;PS(mod_data), key, val, PS(gc_maxlifetime)));</span>
<span class='curline'><a href='../S/992.html#L287'>PS</a>                287 ext/session/php_session.h 	if (!Z_ISNULL(PS(http_session_vars))) {							\</span>
<span class='curline'><a href='../S/992.html#L288'>PS</a>                288 ext/session/php_session.h 		zend_hash_del(Z_ARRVAL(PS(http_session_vars)), name);		\</span>
<span class='curline'><a href='../S/992.html#L299'>PS</a>                299 ext/session/php_session.h 	HashTable *_ht = Z_ARRVAL_P(Z_REFVAL(PS(http_session_vars)));	\</span>
<span class='curline'><a href='../S/993.html#L89'>PS</a>                 89 ext/session/session.c 	if (Z_ISREF_P(&amp;PS(http_session_vars)) &amp;&amp; Z_TYPE_P(Z_REFVAL(PS(http_session_vars))) == IS_ARRAY)</span>
<span class='curline'><a href='../S/993.html#L92'>PS</a>                 92 ext/session/session.c 	if (PS(session_status) == php_session_active) {	\</span>
<span class='curline'><a href='../S/993.html#L97'>PS</a>                 97 ext/session/session.c #define APPLY_TRANS_SID (PS(use_trans_sid) &amp;&amp; !PS(use_only_cookies))</span>
<span class='curline'><a href='../S/993.html#L105'>PS</a>                105 ext/session/session.c 	PS(id) = NULL;</span>
<span class='curline'><a href='../S/993.html#L106'>PS</a>                106 ext/session/session.c 	PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/993.html#L107'>PS</a>                107 ext/session/session.c 	PS(mod_data) = NULL;</span>
<span class='curline'><a href='../S/993.html#L108'>PS</a>                108 ext/session/session.c 	PS(mod_user_is_open) = 0;</span>
<span class='curline'><a href='../S/993.html#L109'>PS</a>                109 ext/session/session.c 	PS(define_sid) = 1;</span>
<span class='curline'><a href='../S/993.html#L110'>PS</a>                110 ext/session/session.c 	PS(session_vars) = NULL;</span>
<span class='curline'><a href='../S/993.html#L111'>PS</a>                111 ext/session/session.c 	ZVAL_UNDEF(&amp;PS(http_session_vars));</span>
<span class='curline'><a href='../S/993.html#L119'>PS</a>                119 ext/session/session.c 	if (!Z_ISUNDEF(PS(http_session_vars))) {</span>
<span class='curline'><a href='../S/993.html#L120'>PS</a>                120 ext/session/session.c 		zval_ptr_dtor(&amp;PS(http_session_vars));</span>
<span class='curline'><a href='../S/993.html#L121'>PS</a>                121 ext/session/session.c 		ZVAL_UNDEF(&amp;PS(http_session_vars));</span>
<span class='curline'><a href='../S/993.html#L123'>PS</a>                123 ext/session/session.c 	if (PS(mod_data) || PS(mod_user_implemented)) {</span>
<span class='curline'><a href='../S/993.html#L125'>PS</a>                125 ext/session/session.c 			PS(mod)-&gt;s_close(&amp;PS(mod_data));</span>
<span class='curline'><a href='../S/993.html#L128'>PS</a>                128 ext/session/session.c 	if (PS(id)) {</span>
<span class='curline'><a href='../S/993.html#L129'>PS</a>                129 ext/session/session.c 		zend_string_release(PS(id));</span>
<span class='curline'><a href='../S/993.html#L130'>PS</a>                130 ext/session/session.c 		PS(id) = NULL;</span>
<span class='curline'><a href='../S/993.html#L132'>PS</a>                132 ext/session/session.c 	if (PS(session_vars)) {</span>
<span class='curline'><a href='../S/993.html#L133'>PS</a>                133 ext/session/session.c 		zend_string_release(PS(session_vars));</span>
<span class='curline'><a href='../S/993.html#L134'>PS</a>                134 ext/session/session.c 		PS(session_vars) = NULL;</span>
<span class='curline'><a href='../S/993.html#L143'>PS</a>                143 ext/session/session.c 	if (PS(session_status) != php_session_active) {</span>
<span class='curline'><a href='../S/993.html#L148'>PS</a>                148 ext/session/session.c 	if (PS(id) &amp;&amp; PS(mod)-&gt;s_destroy(&amp;PS(mod_data), PS(id)) == FAILURE) {</span>
<span class='curline'><a href='../S/993.html#L165'>PS</a>                165 ext/session/session.c 		sym_track = zend_hash_find(Z_ARRVAL_P(Z_REFVAL(PS(http_session_vars))), name);</span>
<span class='curline'><a href='../S/993.html#L174'>PS</a>                174 ext/session/session.c 		zend_hash_update(Z_ARRVAL_P(Z_REFVAL(PS(http_session_vars))), name, &amp;empty_var);</span>
<span class='curline'><a href='../S/993.html#L182'>PS</a>                182 ext/session/session.c 		return zend_hash_update(Z_ARRVAL_P(Z_REFVAL(PS(http_session_vars))), name, state_val);</span>
<span class='curline'><a href='../S/993.html#L191'>PS</a>                191 ext/session/session.c 		return zend_hash_find(Z_ARRVAL_P(Z_REFVAL(PS(http_session_vars))), name);</span>
<span class='curline'><a href='../S/993.html#L204'>PS</a>                204 ext/session/session.c 	if (!Z_ISUNDEF(PS(http_session_vars))) {</span>
<span class='curline'><a href='../S/993.html#L205'>PS</a>                205 ext/session/session.c 		zval_ptr_dtor(&amp;PS(http_session_vars));</span>
<span class='curline'><a href='../S/993.html#L209'>PS</a>                209 ext/session/session.c 	ZVAL_NEW_REF(&amp;PS(http_session_vars), &amp;session_vars);</span>
<span class='curline'><a href='../S/993.html#L210'>PS</a>                210 ext/session/session.c 	Z_ADDREF_P(&amp;PS(http_session_vars));</span>
<span class='curline'><a href='../S/993.html#L211'>PS</a>                211 ext/session/session.c 	zend_hash_update_ind(&amp;EG(symbol_table), var_name, &amp;PS(http_session_vars));</span>
<span class='curline'><a href='../S/993.html#L219'>PS</a>                219 ext/session/session.c 		if (!PS(serializer)) {</span>
<span class='curline'><a href='../S/993.html#L223'>PS</a>                223 ext/session/session.c 		return PS(serializer)-&gt;encode();</span>
<span class='curline'><a href='../S/993.html#L233'>PS</a>                233 ext/session/session.c 	if (!PS(serializer)) {</span>
<span class='curline'><a href='../S/993.html#L237'>PS</a>                237 ext/session/session.c 	if (PS(serializer)-&gt;decode(ZSTR_VAL(data), ZSTR_LEN(data)) == FAILURE) {</span>
<span class='curline'><a href='../S/993.html#L329'>PS</a>                329 ext/session/session.c 	switch (PS(hash_func)) {</span>
<span class='curline'><a href='../S/993.html#L342'>PS</a>                342 ext/session/session.c 			if (!PS(hash_ops)) {</span>
<span class='curline'><a href='../S/993.html#L348'>PS</a>                348 ext/session/session.c 			hash_context = emalloc(PS(hash_ops)-&gt;context_size);</span>
<span class='curline'><a href='../S/993.html#L349'>PS</a>                349 ext/session/session.c 			PS(hash_ops)-&gt;hash_init(hash_context);</span>
<span class='curline'><a href='../S/993.html#L350'>PS</a>                350 ext/session/session.c 			PS(hash_ops)-&gt;hash_update(hash_context, (unsigned char *) buf, strlen(buf));</span>
<span class='curline'><a href='../S/993.html#L351'>PS</a>                351 ext/session/session.c 			digest_len = PS(hash_ops)-&gt;digest_size;</span>
<span class='curline'><a href='../S/993.html#L361'>PS</a>                361 ext/session/session.c 	if (PS(entropy_length) &gt; 0) {</span>
<span class='curline'><a href='../S/993.html#L364'>PS</a>                364 ext/session/session.c 		size_t toread = PS(entropy_length);</span>
<span class='curline'><a href='../S/993.html#L368'>PS</a>                368 ext/session/session.c 			switch (PS(hash_func)) {</span>
<span class='curline'><a href='../S/993.html#L377'>PS</a>                377 ext/session/session.c 					PS(hash_ops)-&gt;hash_update(hash_context, rbuf, toread);</span>
<span class='curline'><a href='../S/993.html#L385'>PS</a>                385 ext/session/session.c 		fd = VCWD_OPEN(PS(entropy_file), O_RDONLY);</span>
<span class='curline'><a href='../S/993.html#L389'>PS</a>                389 ext/session/session.c 			int to_read = PS(entropy_length);</span>
<span class='curline'><a href='../S/993.html#L395'>PS</a>                395 ext/session/session.c 				switch (PS(hash_func)) {</span>
<span class='curline'><a href='../S/993.html#L404'>PS</a>                404 ext/session/session.c 						PS(hash_ops)-&gt;hash_update(hash_context, rbuf, n);</span>
<span class='curline'><a href='../S/993.html#L416'>PS</a>                416 ext/session/session.c 	switch (PS(hash_func)) {</span>
<span class='curline'><a href='../S/993.html#L425'>PS</a>                425 ext/session/session.c 			PS(hash_ops)-&gt;hash_final(digest, hash_context);</span>
<span class='curline'><a href='../S/993.html#L431'>PS</a>                431 ext/session/session.c 	if (PS(hash_bits_per_character) &lt; 4</span>
<span class='curline'><a href='../S/993.html#L432'>PS</a>                432 ext/session/session.c 			|| PS(hash_bits_per_character) &gt; 6) {</span>
<span class='curline'><a href='../S/993.html#L433'>PS</a>                433 ext/session/session.c 		PS(hash_bits_per_character) = 4;</span>
<span class='curline'><a href='../S/993.html#L438'>PS</a>                438 ext/session/session.c 	outid = zend_string_alloc((digest_len + 2) * ((8.0f / PS(hash_bits_per_character) + 0.5)), 0);</span>
<span class='curline'><a href='../S/993.html#L439'>PS</a>                439 ext/session/session.c 	ZSTR_LEN(outid) = (size_t)(bin_to_readable((char *)digest, digest_len, ZSTR_VAL(outid), (char)PS(hash_bits_per_character)) - (char *)&amp;ZSTR_VAL(outid));</span>
<span class='curline'><a href='../S/993.html#L486'>PS</a>                486 ext/session/session.c 	if ((PS(mod_data) || PS(mod_user_implemented)) &amp;&amp; PS(gc_probability) &gt; 0) {</span>
<span class='curline'><a href='../S/993.html#L489'>PS</a>                489 ext/session/session.c 		nrand = (int) ((float) PS(gc_divisor) * php_combined_lcg());</span>
<span class='curline'><a href='../S/993.html#L490'>PS</a>                490 ext/session/session.c 		if (nrand &lt; PS(gc_probability)) {</span>
<span class='curline'><a href='../S/993.html#L491'>PS</a>                491 ext/session/session.c 			PS(mod)-&gt;s_gc(&amp;PS(mod_data), PS(gc_maxlifetime), &amp;nrdels);</span>
<span class='curline'><a href='../S/993.html#L506'>PS</a>                506 ext/session/session.c 	if (!PS(mod)) {</span>
<span class='curline'><a href='../S/993.html#L512'>PS</a>                512 ext/session/session.c 	if (PS(mod)-&gt;s_open(&amp;PS(mod_data), PS(save_path), PS(session_name)) == FAILURE</span>
<span class='curline'><a href='../S/993.html#L515'>PS</a>                515 ext/session/session.c 		php_error_docref(NULL, E_ERROR, "Failed to initialize storage module: %s (path: %s)", PS(mod)-&gt;s_name, PS(save_path));</span>
<span class='curline'><a href='../S/993.html#L520'>PS</a>                520 ext/session/session.c 	if (!PS(id)) {</span>
<span class='curline'><a href='../S/993.html#L521'>PS</a>                521 ext/session/session.c 		PS(id) = PS(mod)-&gt;s_create_sid(&amp;PS(mod_data));</span>
<span class='curline'><a href='../S/993.html#L522'>PS</a>                522 ext/session/session.c 		if (!PS(id)) {</span>
<span class='curline'><a href='../S/993.html#L523'>PS</a>                523 ext/session/session.c 			php_error_docref(NULL, E_ERROR, "Failed to create session ID: %s (path: %s)", PS(mod)-&gt;s_name, PS(save_path));</span>
<span class='curline'><a href='../S/993.html#L526'>PS</a>                526 ext/session/session.c 		if (PS(use_cookies)) {</span>
<span class='curline'><a href='../S/993.html#L527'>PS</a>                527 ext/session/session.c 			PS(send_cookie) = 1;</span>
<span class='curline'><a href='../S/993.html#L529'>PS</a>                529 ext/session/session.c 	} else if (PS(use_strict_mode) &amp;&amp; PS(mod)-&gt;s_validate_sid &amp;&amp;</span>
<span class='curline'><a href='../S/993.html#L530'>PS</a>                530 ext/session/session.c 		PS(mod)-&gt;s_validate_sid(&amp;PS(mod_data), PS(id)) == FAILURE) {</span>
<span class='curline'><a href='../S/993.html#L531'>PS</a>                531 ext/session/session.c 		if (PS(id)) {</span>
<span class='curline'><a href='../S/993.html#L532'>PS</a>                532 ext/session/session.c 			zend_string_release(PS(id));</span>
<span class='curline'><a href='../S/993.html#L534'>PS</a>                534 ext/session/session.c 		PS(id) = PS(mod)-&gt;s_create_sid(&amp;PS(mod_data));</span>
<span class='curline'><a href='../S/993.html#L535'>PS</a>                535 ext/session/session.c 		if (!PS(id)) {</span>
<span class='curline'><a href='../S/993.html#L536'>PS</a>                536 ext/session/session.c 			PS(id) = php_session_create_id(NULL);</span>
<span class='curline'><a href='../S/993.html#L538'>PS</a>                538 ext/session/session.c 		if (PS(use_cookies)) {</span>
<span class='curline'><a href='../S/993.html#L539'>PS</a>                539 ext/session/session.c 			PS(send_cookie) = 1;</span>
<span class='curline'><a href='../S/993.html#L544'>PS</a>                544 ext/session/session.c 	PS(session_status) = php_session_active;</span>
<span class='curline'><a href='../S/993.html#L548'>PS</a>                548 ext/session/session.c 	if (PS(mod)-&gt;s_read(&amp;PS(mod_data), PS(id), &amp;val, PS(gc_maxlifetime)) == FAILURE) {</span>
<span class='curline'><a href='../S/993.html#L559'>PS</a>                559 ext/session/session.c 	if (PS(session_vars)) {</span>
<span class='curline'><a href='../S/993.html#L560'>PS</a>                560 ext/session/session.c 		zend_string_release(PS(session_vars));</span>
<span class='curline'><a href='../S/993.html#L561'>PS</a>                561 ext/session/session.c 		PS(session_vars) = NULL;</span>
<span class='curline'><a href='../S/993.html#L564'>PS</a>                564 ext/session/session.c 		if (PS(lazy_write)) {</span>
<span class='curline'><a href='../S/993.html#L565'>PS</a>                565 ext/session/session.c 			PS(session_vars) = zend_string_copy(val);</span>
<span class='curline'><a href='../S/993.html#L579'>PS</a>                579 ext/session/session.c 			if (PS(mod_data) || PS(mod_user_implemented)) {</span>
<span class='curline'><a href='../S/993.html#L584'>PS</a>                584 ext/session/session.c 					if (PS(lazy_write) &amp;&amp; PS(session_vars)</span>
<span class='curline'><a href='../S/993.html#L585'>PS</a>                585 ext/session/session.c 						&amp;&amp; PS(mod)-&gt;s_update_timestamp</span>
<span class='curline'><a href='../S/993.html#L586'>PS</a>                586 ext/session/session.c 						&amp;&amp; PS(mod)-&gt;s_update_timestamp != php_session_update_timestamp</span>
<span class='curline'><a href='../S/993.html#L587'>PS</a>                587 ext/session/session.c 						&amp;&amp; ZSTR_LEN(val) == ZSTR_LEN(PS(session_vars))</span>
<span class='curline'><a href='../S/993.html#L588'>PS</a>                588 ext/session/session.c 						&amp;&amp; !memcmp(ZSTR_VAL(val), ZSTR_VAL(PS(session_vars)), ZSTR_LEN(val))</span>
<span class='curline'><a href='../S/993.html#L590'>PS</a>                590 ext/session/session.c 						ret = PS(mod)-&gt;s_update_timestamp(&amp;PS(mod_data), PS(id), val, PS(gc_maxlifetime));</span>
<span class='curline'><a href='../S/993.html#L592'>PS</a>                592 ext/session/session.c 						ret = PS(mod)-&gt;s_write(&amp;PS(mod_data), PS(id), val, PS(gc_maxlifetime));</span>
<span class='curline'><a href='../S/993.html#L596'>PS</a>                596 ext/session/session.c 					ret = PS(mod)-&gt;s_write(&amp;PS(mod_data), PS(id), ZSTR_EMPTY_ALLOC(), PS(gc_maxlifetime));</span>
<span class='curline'><a href='../S/993.html#L604'>PS</a>                604 ext/session/session.c 								 PS(mod)-&gt;s_name,</span>
<span class='curline'><a href='../S/993.html#L605'>PS</a>                605 ext/session/session.c 								 PS(save_path));</span>
<span class='curline'><a href='../S/993.html#L610'>PS</a>                610 ext/session/session.c 	if (PS(mod_data) || PS(mod_user_implemented)) {</span>
<span class='curline'><a href='../S/993.html#L611'>PS</a>                611 ext/session/session.c 		PS(mod)-&gt;s_close(&amp;PS(mod_data));</span>
<span class='curline'><a href='../S/993.html#L643'>PS</a>                643 ext/session/session.c 	PS(default_mod) = PS(mod);</span>
<span class='curline'><a href='../S/993.html#L644'>PS</a>                644 ext/session/session.c 	PS(mod) = tmp;</span>
<span class='curline'><a href='../S/993.html#L672'>PS</a>                672 ext/session/session.c 	PS(serializer) = tmp;</span>
<span class='curline'><a href='../S/993.html#L683'>PS</a>                683 ext/session/session.c 		PS(use_trans_sid) = (zend_bool) 1;</span>
<span class='curline'><a href='../S/993.html#L685'>PS</a>                685 ext/session/session.c 		PS(use_trans_sid) = (zend_bool) atoi(ZSTR_VAL(new_value));</span>
<span class='curline'><a href='../S/993.html#L753'>PS</a>                753 ext/session/session.c 	PS(hash_ops) = NULL;</span>
<span class='curline'><a href='../S/993.html#L759'>PS</a>                759 ext/session/session.c 		PS(hash_func) = val ? 1 : 0;</span>
<span class='curline'><a href='../S/993.html#L766'>PS</a>                766 ext/session/session.c 		PS(hash_func) = PS_HASH_FUNC_MD5;</span>
<span class='curline'><a href='../S/993.html#L773'>PS</a>                773 ext/session/session.c 		PS(hash_func) = PS_HASH_FUNC_SHA1;</span>
<span class='curline'><a href='../S/993.html#L783'>PS</a>                783 ext/session/session.c 		PS(hash_func) = PS_HASH_FUNC_OTHER;</span>
<span class='curline'><a href='../S/993.html#L784'>PS</a>                784 ext/session/session.c 		PS(hash_ops) = ops;</span>
<span class='curline'><a href='../S/993.html#L809'>PS</a>                809 ext/session/session.c 		PS(rfc1867_freq) = -tmp;</span>
<span class='curline'><a href='../S/993.html#L811'>PS</a>                811 ext/session/session.c 		PS(rfc1867_freq) = tmp;</span>
<span class='curline'><a href='../S/993.html#L881'>PS</a>                881 ext/session/session.c 		php_var_serialize(&amp;buf, Z_REFVAL(PS(http_session_vars)), &amp;var_hash);</span>
<span class='curline'><a href='../S/993.html#L899'>PS</a>                899 ext/session/session.c 	if (!Z_ISUNDEF(PS(http_session_vars))) {</span>
<span class='curline'><a href='../S/993.html#L900'>PS</a>                900 ext/session/session.c 		zval_ptr_dtor(&amp;PS(http_session_vars));</span>
<span class='curline'><a href='../S/993.html#L905'>PS</a>                905 ext/session/session.c 	ZVAL_NEW_REF(&amp;PS(http_session_vars), &amp;session_vars);</span>
<span class='curline'><a href='../S/993.html#L906'>PS</a>                906 ext/session/session.c 	Z_ADDREF_P(&amp;PS(http_session_vars));</span>
<span class='curline'><a href='../S/993.html#L907'>PS</a>                907 ext/session/session.c 	zend_hash_update_ind(&amp;EG(symbol_table), var_name, &amp;PS(http_session_vars));</span>
<span class='curline'><a href='../S/993.html#L970'>PS</a>                970 ext/session/session.c 			if ((Z_TYPE_P(tmp) == IS_ARRAY &amp;&amp; Z_ARRVAL_P(tmp) == &amp;EG(symbol_table)) || tmp == &amp;PS(http_session_vars)) {</span>
<span class='curline'><a href='../S/993.html#L1064'>PS</a>               1064 ext/session/session.c 			if ((Z_TYPE_P(tmp) == IS_ARRAY &amp;&amp; Z_ARRVAL_P(tmp) == &amp;EG(symbol_table)) || tmp == &amp;PS(http_session_vars)) {</span>
<span class='curline'><a href='../S/993.html#L1237'>PS</a>               1237 ext/session/session.c 	now = tv.tv_sec + PS(cache_expire) * 60;</span>
<span class='curline'><a href='../S/993.html#L1242'>PS</a>               1242 ext/session/session.c 	snprintf(buf, sizeof(buf) , "Cache-Control: public, max-age=" ZEND_LONG_FMT, PS(cache_expire) * 60); /* SAFE */</span>
<span class='curline'><a href='../S/993.html#L1253'>PS</a>               1253 ext/session/session.c 	snprintf(buf, sizeof(buf), "Cache-Control: private, max-age=" ZEND_LONG_FMT, PS(cache_expire) * 60); /* SAFE */</span>
<span class='curline'><a href='../S/993.html#L1291'>PS</a>               1291 ext/session/session.c 	if (PS(cache_limiter)[0] == '\0') return 0;</span>
<span class='curline'><a href='../S/993.html#L1306'>PS</a>               1306 ext/session/session.c 		if (!strcasecmp(lim-&gt;name, PS(cache_limiter))) {</span>
<span class='curline'><a href='../S/993.html#L1335'>PS</a>               1335 ext/session/session.c 	e_session_name = php_url_encode(PS(session_name), strlen(PS(session_name)));</span>
<span class='curline'><a href='../S/993.html#L1384'>PS</a>               1384 ext/session/session.c 	e_session_name = php_url_encode(PS(session_name), strlen(PS(session_name)));</span>
<span class='curline'><a href='../S/993.html#L1385'>PS</a>               1385 ext/session/session.c 	e_id = php_url_encode(ZSTR_VAL(PS(id)), ZSTR_LEN(PS(id)));</span>
<span class='curline'><a href='../S/993.html#L1395'>PS</a>               1395 ext/session/session.c 	if (PS(cookie_lifetime) &gt; 0) {</span>
<span class='curline'><a href='../S/993.html#L1400'>PS</a>               1400 ext/session/session.c 		t = tv.tv_sec + PS(cookie_lifetime);</span>
<span class='curline'><a href='../S/993.html#L1409'>PS</a>               1409 ext/session/session.c 			smart_str_append_long(&amp;ncookie, PS(cookie_lifetime));</span>
<span class='curline'><a href='../S/993.html#L1413'>PS</a>               1413 ext/session/session.c 	if (PS(cookie_path)[0]) {</span>
<span class='curline'><a href='../S/993.html#L1415'>PS</a>               1415 ext/session/session.c 		smart_str_appends(&amp;ncookie, PS(cookie_path));</span>
<span class='curline'><a href='../S/993.html#L1418'>PS</a>               1418 ext/session/session.c 	if (PS(cookie_domain)[0]) {</span>
<span class='curline'><a href='../S/993.html#L1420'>PS</a>               1420 ext/session/session.c 		smart_str_appends(&amp;ncookie, PS(cookie_domain));</span>
<span class='curline'><a href='../S/993.html#L1423'>PS</a>               1423 ext/session/session.c 	if (PS(cookie_secure)) {</span>
<span class='curline'><a href='../S/993.html#L1427'>PS</a>               1427 ext/session/session.c 	if (PS(cookie_httponly)) {</span>
<span class='curline'><a href='../S/993.html#L1475'>PS</a>               1475 ext/session/session.c 		PS(id) = zend_string_init(Z_STRVAL_P(ppid), Z_STRLEN_P(ppid), 0);</span>
<span class='curline'><a href='../S/993.html#L1476'>PS</a>               1476 ext/session/session.c 		PS(send_cookie) = 0;</span>
<span class='curline'><a href='../S/993.html#L1478'>PS</a>               1478 ext/session/session.c 		PS(id) = NULL;</span>
<span class='curline'><a href='../S/993.html#L1479'>PS</a>               1479 ext/session/session.c 		PS(send_cookie) = 1;</span>
<span class='curline'><a href='../S/993.html#L1485'>PS</a>               1485 ext/session/session.c 	int module_number = PS(module_number);</span>
<span class='curline'><a href='../S/993.html#L1488'>PS</a>               1488 ext/session/session.c 	if (!PS(id)) {</span>
<span class='curline'><a href='../S/993.html#L1493'>PS</a>               1493 ext/session/session.c 	if (PS(use_cookies) &amp;&amp; PS(send_cookie)) {</span>
<span class='curline'><a href='../S/993.html#L1495'>PS</a>               1495 ext/session/session.c 		PS(send_cookie) = 0;</span>
<span class='curline'><a href='../S/993.html#L1503'>PS</a>               1503 ext/session/session.c 	if (PS(define_sid)) {</span>
<span class='curline'><a href='../S/993.html#L1506'>PS</a>               1506 ext/session/session.c 		smart_str_appends(&amp;var, PS(session_name));</span>
<span class='curline'><a href='../S/993.html#L1508'>PS</a>               1508 ext/session/session.c 		smart_str_appends(&amp;var, ZSTR_VAL(PS(id)));</span>
<span class='curline'><a href='../S/993.html#L1532'>PS</a>               1532 ext/session/session.c 		php_url_scanner_add_var(PS(session_name), strlen(PS(session_name)), ZSTR_VAL(PS(id)), ZSTR_LEN(PS(id)), 1);</span>
<span class='curline'><a href='../S/993.html#L1544'>PS</a>               1544 ext/session/session.c 	switch (PS(session_status)) {</span>
<span class='curline'><a href='../S/993.html#L1552'>PS</a>               1552 ext/session/session.c 			if (!PS(mod) &amp;&amp; value) {</span>
<span class='curline'><a href='../S/993.html#L1553'>PS</a>               1553 ext/session/session.c 				PS(mod) = _php_find_ps_module(value);</span>
<span class='curline'><a href='../S/993.html#L1554'>PS</a>               1554 ext/session/session.c 				if (!PS(mod)) {</span>
<span class='curline'><a href='../S/993.html#L1560'>PS</a>               1560 ext/session/session.c 			if (!PS(serializer) &amp;&amp; value) {</span>
<span class='curline'><a href='../S/993.html#L1561'>PS</a>               1561 ext/session/session.c 				PS(serializer) = _php_find_ps_serializer(value);</span>
<span class='curline'><a href='../S/993.html#L1562'>PS</a>               1562 ext/session/session.c 				if (!PS(serializer)) {</span>
<span class='curline'><a href='../S/993.html#L1567'>PS</a>               1567 ext/session/session.c 			PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/993.html#L1573'>PS</a>               1573 ext/session/session.c 			PS(define_sid) = !PS(use_only_cookies); /* SID constant is defined when non-cookie ID is used */</span>
<span class='curline'><a href='../S/993.html#L1574'>PS</a>               1574 ext/session/session.c 			PS(send_cookie) = PS(use_cookies) || PS(use_only_cookies);</span>
<span class='curline'><a href='../S/993.html#L1577'>PS</a>               1577 ext/session/session.c 	lensess = strlen(PS(session_name));</span>
<span class='curline'><a href='../S/993.html#L1587'>PS</a>               1587 ext/session/session.c 	if (!PS(id)) {</span>
<span class='curline'><a href='../S/993.html#L1588'>PS</a>               1588 ext/session/session.c 		if (PS(use_cookies) &amp;&amp; (data = zend_hash_str_find(&amp;EG(symbol_table), "_COOKIE", sizeof("_COOKIE") - 1))) {</span>
<span class='curline'><a href='../S/993.html#L1590'>PS</a>               1590 ext/session/session.c 			if (Z_TYPE_P(data) == IS_ARRAY &amp;&amp; (ppid = zend_hash_str_find(Z_ARRVAL_P(data), PS(session_name), lensess))) {</span>
<span class='curline'><a href='../S/993.html#L1592'>PS</a>               1592 ext/session/session.c 				PS(send_cookie) = 0;</span>
<span class='curline'><a href='../S/993.html#L1596'>PS</a>               1596 ext/session/session.c 		if (PS(define_sid) &amp;&amp; !PS(id) &amp;&amp; (data = zend_hash_str_find(&amp;EG(symbol_table), "_GET", sizeof("_GET") - 1))) {</span>
<span class='curline'><a href='../S/993.html#L1598'>PS</a>               1598 ext/session/session.c 			if (Z_TYPE_P(data) == IS_ARRAY &amp;&amp; (ppid = zend_hash_str_find(Z_ARRVAL_P(data), PS(session_name), lensess))) {</span>
<span class='curline'><a href='../S/993.html#L1603'>PS</a>               1603 ext/session/session.c 		if (PS(define_sid) &amp;&amp; !PS(id) &amp;&amp; (data = zend_hash_str_find(&amp;EG(symbol_table), "_POST", sizeof("_POST") - 1))) {</span>
<span class='curline'><a href='../S/993.html#L1605'>PS</a>               1605 ext/session/session.c 			if (Z_TYPE_P(data) == IS_ARRAY &amp;&amp; (ppid = zend_hash_str_find(Z_ARRVAL_P(data), PS(session_name), lensess))) {</span>
<span class='curline'><a href='../S/993.html#L1613'>PS</a>               1613 ext/session/session.c 		if (PS(define_sid) &amp;&amp; !PS(id) &amp;&amp;</span>
<span class='curline'><a href='../S/993.html#L1617'>PS</a>               1617 ext/session/session.c 			(p = strstr(Z_STRVAL_P(data), PS(session_name))) &amp;&amp;</span>
<span class='curline'><a href='../S/993.html#L1623'>PS</a>               1623 ext/session/session.c 				PS(id) = zend_string_init(p, q - p, 0);</span>
<span class='curline'><a href='../S/993.html#L1629'>PS</a>               1629 ext/session/session.c 		if (PS(define_sid) &amp;&amp; PS(id) &amp;&amp;</span>
<span class='curline'><a href='../S/993.html#L1630'>PS</a>               1630 ext/session/session.c 			PS(extern_referer_chk)[0] != '\0' &amp;&amp;</span>
<span class='curline'><a href='../S/993.html#L1635'>PS</a>               1635 ext/session/session.c 			strstr(Z_STRVAL_P(data), PS(extern_referer_chk)) == NULL</span>
<span class='curline'><a href='../S/993.html#L1637'>PS</a>               1637 ext/session/session.c 			zend_string_release(PS(id));</span>
<span class='curline'><a href='../S/993.html#L1638'>PS</a>               1638 ext/session/session.c 			PS(id) = NULL;</span>
<span class='curline'><a href='../S/993.html#L1644'>PS</a>               1644 ext/session/session.c 	if (PS(id) &amp;&amp; strpbrk(ZSTR_VAL(PS(id)), "\r\n\t &lt;&gt;'\"\\")) {</span>
<span class='curline'><a href='../S/993.html#L1645'>PS</a>               1645 ext/session/session.c 		zend_string_release(PS(id));</span>
<span class='curline'><a href='../S/993.html#L1646'>PS</a>               1646 ext/session/session.c 		PS(id) = NULL;</span>
<span class='curline'><a href='../S/993.html#L1656'>PS</a>               1656 ext/session/session.c 	if (PS(session_status) == php_session_active) {</span>
<span class='curline'><a href='../S/993.html#L1657'>PS</a>               1657 ext/session/session.c 		PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/993.html#L1665'>PS</a>               1665 ext/session/session.c 	if (PS(session_status) == php_session_active) {</span>
<span class='curline'><a href='../S/993.html#L1666'>PS</a>               1666 ext/session/session.c 		PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/993.html#L1667'>PS</a>               1667 ext/session/session.c 		if (PS(mod_data) || PS(mod_user_implemented)) {</span>
<span class='curline'><a href='../S/993.html#L1668'>PS</a>               1668 ext/session/session.c 			PS(mod)-&gt;s_close(&amp;PS(mod_data));</span>
<span class='curline'><a href='../S/993.html#L1676'>PS</a>               1676 ext/session/session.c 	if (PS(session_status) == php_session_active) {</span>
<span class='curline'><a href='../S/993.html#L1688'>PS</a>               1688 ext/session/session.c 	if (APPLY_TRANS_SID &amp;&amp; (PS(session_status) == php_session_active)) {</span>
<span class='curline'><a href='../S/993.html#L1689'>PS</a>               1689 ext/session/session.c 		*new = php_url_scanner_adapt_single_url(url, urllen, PS(session_name), ZSTR_VAL(PS(id)), newlen, 1);</span>
<span class='curline'><a href='../S/993.html#L1708'>PS</a>               1708 ext/session/session.c 	if (!PS(use_cookies) ||</span>
<span class='curline'><a href='../S/993.html#L1753'>PS</a>               1753 ext/session/session.c 	add_assoc_long(return_value, "lifetime", PS(cookie_lifetime));</span>
<span class='curline'><a href='../S/993.html#L1754'>PS</a>               1754 ext/session/session.c 	add_assoc_string(return_value, "path", PS(cookie_path));</span>
<span class='curline'><a href='../S/993.html#L1755'>PS</a>               1755 ext/session/session.c 	add_assoc_string(return_value, "domain", PS(cookie_domain));</span>
<span class='curline'><a href='../S/993.html#L1756'>PS</a>               1756 ext/session/session.c 	add_assoc_bool(return_value, "secure", PS(cookie_secure));</span>
<span class='curline'><a href='../S/993.html#L1757'>PS</a>               1757 ext/session/session.c 	add_assoc_bool(return_value, "httponly", PS(cookie_httponly));</span>
<span class='curline'><a href='../S/993.html#L1772'>PS</a>               1772 ext/session/session.c 	RETVAL_STRING(PS(session_name));</span>
<span class='curline'><a href='../S/993.html#L1794'>PS</a>               1794 ext/session/session.c 	if (PS(mod) &amp;&amp; PS(mod)-&gt;s_name) {</span>
<span class='curline'><a href='../S/993.html#L1795'>PS</a>               1795 ext/session/session.c 		RETVAL_STRING(PS(mod)-&gt;s_name);</span>
<span class='curline'><a href='../S/993.html#L1807'>PS</a>               1807 ext/session/session.c 		if (PS(mod_data) || PS(mod_user_implemented)) {</span>
<span class='curline'><a href='../S/993.html#L1808'>PS</a>               1808 ext/session/session.c 			PS(mod)-&gt;s_close(&amp;PS(mod_data));</span>
<span class='curline'><a href='../S/993.html#L1810'>PS</a>               1810 ext/session/session.c 		PS(mod_data) = NULL;</span>
<span class='curline'><a href='../S/993.html#L1828'>PS</a>               1828 ext/session/session.c 	if (PS(session_status) != php_session_none) {</span>
<span class='curline'><a href='../S/993.html#L1847'>PS</a>               1847 ext/session/session.c 				if (!Z_ISUNDEF(PS(mod_user_names).names[i])) {</span>
<span class='curline'><a href='../S/993.html#L1848'>PS</a>               1848 ext/session/session.c 					zval_ptr_dtor(&amp;PS(mod_user_names).names[i]);</span>
<span class='curline'><a href='../S/993.html#L1851'>PS</a>               1851 ext/session/session.c 				array_init_size(&amp;PS(mod_user_names).names[i], 2);</span>
<span class='curline'><a href='../S/993.html#L1853'>PS</a>               1853 ext/session/session.c 				add_next_index_zval(&amp;PS(mod_user_names).names[i], obj);</span>
<span class='curline'><a href='../S/993.html#L1854'>PS</a>               1854 ext/session/session.c 				add_next_index_str(&amp;PS(mod_user_names).names[i], zend_string_copy(func_name));</span>
<span class='curline'><a href='../S/993.html#L1866'>PS</a>               1866 ext/session/session.c 				if (!Z_ISUNDEF(PS(mod_user_names).names[i])) {</span>
<span class='curline'><a href='../S/993.html#L1867'>PS</a>               1867 ext/session/session.c 					zval_ptr_dtor(&amp;PS(mod_user_names).names[i]);</span>
<span class='curline'><a href='../S/993.html#L1869'>PS</a>               1869 ext/session/session.c 				array_init_size(&amp;PS(mod_user_names).names[i], 2);</span>
<span class='curline'><a href='../S/993.html#L1871'>PS</a>               1871 ext/session/session.c 				add_next_index_zval(&amp;PS(mod_user_names).names[i], obj);</span>
<span class='curline'><a href='../S/993.html#L1872'>PS</a>               1872 ext/session/session.c 				add_next_index_str(&amp;PS(mod_user_names).names[i], zend_string_copy(func_name));</span>
<span class='curline'><a href='../S/993.html#L1874'>PS</a>               1874 ext/session/session.c 				if (!Z_ISUNDEF(PS(mod_user_names).names[i])) {</span>
<span class='curline'><a href='../S/993.html#L1875'>PS</a>               1875 ext/session/session.c 					zval_ptr_dtor(&amp;PS(mod_user_names).names[i]);</span>
<span class='curline'><a href='../S/993.html#L1876'>PS</a>               1876 ext/session/session.c 					ZVAL_UNDEF(&amp;PS(mod_user_names).names[i]);</span>
<span class='curline'><a href='../S/993.html#L1886'>PS</a>               1886 ext/session/session.c 				if (!Z_ISUNDEF(PS(mod_user_names).names[i])) {</span>
<span class='curline'><a href='../S/993.html#L1887'>PS</a>               1887 ext/session/session.c 					zval_ptr_dtor(&amp;PS(mod_user_names).names[i]);</span>
<span class='curline'><a href='../S/993.html#L1889'>PS</a>               1889 ext/session/session.c 				array_init_size(&amp;PS(mod_user_names).names[i], 2);</span>
<span class='curline'><a href='../S/993.html#L1891'>PS</a>               1891 ext/session/session.c 				add_next_index_zval(&amp;PS(mod_user_names).names[i], obj);</span>
<span class='curline'><a href='../S/993.html#L1892'>PS</a>               1892 ext/session/session.c 				add_next_index_str(&amp;PS(mod_user_names).names[i], zend_string_copy(func_name));</span>
<span class='curline'><a href='../S/993.html#L1894'>PS</a>               1894 ext/session/session.c 				if (!Z_ISUNDEF(PS(mod_user_names).names[i])) {</span>
<span class='curline'><a href='../S/993.html#L1895'>PS</a>               1895 ext/session/session.c 					zval_ptr_dtor(&amp;PS(mod_user_names).names[i]);</span>
<span class='curline'><a href='../S/993.html#L1896'>PS</a>               1896 ext/session/session.c 					ZVAL_UNDEF(&amp;PS(mod_user_names).names[i]);</span>
<span class='curline'><a href='../S/993.html#L1922'>PS</a>               1922 ext/session/session.c 		if (PS(mod) &amp;&amp; PS(session_status) != php_session_active &amp;&amp; PS(mod) != &amp;ps_mod_user) {</span>
<span class='curline'><a href='../S/993.html#L1955'>PS</a>               1955 ext/session/session.c 	if (PS(mod) &amp;&amp; PS(mod) != &amp;ps_mod_user) {</span>
<span class='curline'><a href='../S/993.html#L1964'>PS</a>               1964 ext/session/session.c 		if (!Z_ISUNDEF(PS(mod_user_names).names[i])) {</span>
<span class='curline'><a href='../S/993.html#L1965'>PS</a>               1965 ext/session/session.c 			zval_ptr_dtor(&amp;PS(mod_user_names).names[i]);</span>
<span class='curline'><a href='../S/993.html#L1967'>PS</a>               1967 ext/session/session.c 		ZVAL_COPY(&amp;PS(mod_user_names).names[i], &amp;args[i]);</span>
<span class='curline'><a href='../S/993.html#L1985'>PS</a>               1985 ext/session/session.c 	RETVAL_STRING(PS(save_path));</span>
<span class='curline'><a href='../S/993.html#L2011'>PS</a>               2011 ext/session/session.c 	if (PS(id)) {</span>
<span class='curline'><a href='../S/993.html#L2014'>PS</a>               2014 ext/session/session.c 		size_t len = strlen(ZSTR_VAL(PS(id)));</span>
<span class='curline'><a href='../S/993.html#L2015'>PS</a>               2015 ext/session/session.c 		if (UNEXPECTED(len != ZSTR_LEN(PS(id)))) {</span>
<span class='curline'><a href='../S/993.html#L2016'>PS</a>               2016 ext/session/session.c 			RETVAL_NEW_STR(zend_string_init(ZSTR_VAL(PS(id)), len, 0));</span>
<span class='curline'><a href='../S/993.html#L2018'>PS</a>               2018 ext/session/session.c 			RETVAL_STR_COPY(PS(id));</span>
<span class='curline'><a href='../S/993.html#L2025'>PS</a>               2025 ext/session/session.c 		if (PS(id)) {</span>
<span class='curline'><a href='../S/993.html#L2026'>PS</a>               2026 ext/session/session.c 			zend_string_release(PS(id));</span>
<span class='curline'><a href='../S/993.html#L2028'>PS</a>               2028 ext/session/session.c 		PS(id) = zend_string_copy(name);</span>
<span class='curline'><a href='../S/993.html#L2044'>PS</a>               2044 ext/session/session.c 	if (SG(headers_sent) &amp;&amp; PS(use_cookies)) {</span>
<span class='curline'><a href='../S/993.html#L2049'>PS</a>               2049 ext/session/session.c 	if (PS(session_status) != php_session_active) {</span>
<span class='curline'><a href='../S/993.html#L2056'>PS</a>               2056 ext/session/session.c 		if (PS(mod)-&gt;s_destroy(&amp;PS(mod_data), PS(id)) == FAILURE) {</span>
<span class='curline'><a href='../S/993.html#L2057'>PS</a>               2057 ext/session/session.c 			PS(mod)-&gt;s_close(&amp;PS(mod_data));</span>
<span class='curline'><a href='../S/993.html#L2058'>PS</a>               2058 ext/session/session.c 			PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/993.html#L2059'>PS</a>               2059 ext/session/session.c 			php_error_docref(NULL, E_WARNING, "Session object destruction failed.  ID: %s (path: %s)", PS(mod)-&gt;s_name, PS(save_path));</span>
<span class='curline'><a href='../S/993.html#L2066'>PS</a>               2066 ext/session/session.c 			ret = PS(mod)-&gt;s_write(&amp;PS(mod_data), PS(id), data, PS(gc_maxlifetime));</span>
<span class='curline'><a href='../S/993.html#L2069'>PS</a>               2069 ext/session/session.c 			ret = PS(mod)-&gt;s_write(&amp;PS(mod_data), PS(id), ZSTR_EMPTY_ALLOC(), PS(gc_maxlifetime));</span>
<span class='curline'><a href='../S/993.html#L2072'>PS</a>               2072 ext/session/session.c 			PS(mod)-&gt;s_close(&amp;PS(mod_data));</span>
<span class='curline'><a href='../S/993.html#L2073'>PS</a>               2073 ext/session/session.c 			PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/993.html#L2074'>PS</a>               2074 ext/session/session.c 			php_error_docref(NULL, E_WARNING, "Session write failed. ID: %s (path: %s)", PS(mod)-&gt;s_name, PS(save_path));</span>
<span class='curline'><a href='../S/993.html#L2078'>PS</a>               2078 ext/session/session.c 	PS(mod)-&gt;s_close(&amp;PS(mod_data));</span>
<span class='curline'><a href='../S/993.html#L2081'>PS</a>               2081 ext/session/session.c 	if (PS(session_vars)) {</span>
<span class='curline'><a href='../S/993.html#L2082'>PS</a>               2082 ext/session/session.c 		zend_string_release(PS(session_vars));</span>
<span class='curline'><a href='../S/993.html#L2083'>PS</a>               2083 ext/session/session.c 		PS(session_vars) = NULL;</span>
<span class='curline'><a href='../S/993.html#L2085'>PS</a>               2085 ext/session/session.c 	zend_string_release(PS(id));</span>
<span class='curline'><a href='../S/993.html#L2086'>PS</a>               2086 ext/session/session.c 	PS(id) = PS(mod)-&gt;s_create_sid(&amp;PS(mod_data));</span>
<span class='curline'><a href='../S/993.html#L2087'>PS</a>               2087 ext/session/session.c 	if (!PS(id)) {</span>
<span class='curline'><a href='../S/993.html#L2088'>PS</a>               2088 ext/session/session.c 		PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/993.html#L2089'>PS</a>               2089 ext/session/session.c 		php_error_docref(NULL, E_RECOVERABLE_ERROR, "Failed to create new session ID: %s (path: %s)", PS(mod)-&gt;s_name, PS(save_path));</span>
<span class='curline'><a href='../S/993.html#L2092'>PS</a>               2092 ext/session/session.c 	if (PS(mod)-&gt;s_open(&amp;PS(mod_data), PS(save_path), PS(session_name)) == FAILURE) {</span>
<span class='curline'><a href='../S/993.html#L2093'>PS</a>               2093 ext/session/session.c 		PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/993.html#L2094'>PS</a>               2094 ext/session/session.c 		php_error_docref(NULL, E_RECOVERABLE_ERROR, "Failed to create(open) session ID: %s (path: %s)", PS(mod)-&gt;s_name, PS(save_path));</span>
<span class='curline'><a href='../S/993.html#L2097'>PS</a>               2097 ext/session/session.c 	if (PS(use_strict_mode) &amp;&amp; PS(mod)-&gt;s_validate_sid &amp;&amp;</span>
<span class='curline'><a href='../S/993.html#L2098'>PS</a>               2098 ext/session/session.c 		PS(mod)-&gt;s_validate_sid(&amp;PS(mod_data), PS(id)) == FAILURE) {</span>
<span class='curline'><a href='../S/993.html#L2099'>PS</a>               2099 ext/session/session.c 		zend_string_release(PS(id));</span>
<span class='curline'><a href='../S/993.html#L2100'>PS</a>               2100 ext/session/session.c 		PS(id) = PS(mod)-&gt;s_create_sid(&amp;PS(mod_data));</span>
<span class='curline'><a href='../S/993.html#L2101'>PS</a>               2101 ext/session/session.c 		if (!PS(id)) {</span>
<span class='curline'><a href='../S/993.html#L2102'>PS</a>               2102 ext/session/session.c 			PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/993.html#L2103'>PS</a>               2103 ext/session/session.c 			php_error_docref(NULL, E_RECOVERABLE_ERROR, "Failed to create session ID by collision: %s (path: %s)", PS(mod)-&gt;s_name, PS(save_path));</span>
<span class='curline'><a href='../S/993.html#L2108'>PS</a>               2108 ext/session/session.c 	if (PS(mod)-&gt;s_read(&amp;PS(mod_data), PS(id), &amp;data, PS(gc_maxlifetime)) == FAILURE) {</span>
<span class='curline'><a href='../S/993.html#L2109'>PS</a>               2109 ext/session/session.c 		PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/993.html#L2110'>PS</a>               2110 ext/session/session.c 		php_error_docref(NULL, E_RECOVERABLE_ERROR, "Failed to create(read) session ID: %s (path: %s)", PS(mod)-&gt;s_name, PS(save_path));</span>
<span class='curline'><a href='../S/993.html#L2117'>PS</a>               2117 ext/session/session.c 	if (PS(use_cookies)) {</span>
<span class='curline'><a href='../S/993.html#L2118'>PS</a>               2118 ext/session/session.c 		PS(send_cookie) = 1;</span>
<span class='curline'><a href='../S/993.html#L2149'>PS</a>               2149 ext/session/session.c 	if (PS(session_status) == php_session_active) {</span>
<span class='curline'><a href='../S/993.html#L2150'>PS</a>               2150 ext/session/session.c 		new_id = PS(mod)-&gt;s_create_sid(&amp;PS(mod_data));</span>
<span class='curline'><a href='../S/993.html#L2181'>PS</a>               2181 ext/session/session.c 	RETVAL_STRING(PS(cache_limiter));</span>
<span class='curline'><a href='../S/993.html#L2202'>PS</a>               2202 ext/session/session.c 	RETVAL_LONG(PS(cache_expire));</span>
<span class='curline'><a href='../S/993.html#L2238'>PS</a>               2238 ext/session/session.c 	if (PS(session_status) != php_session_active) {</span>
<span class='curline'><a href='../S/993.html#L2280'>PS</a>               2280 ext/session/session.c 	if (PS(id) &amp;&amp; !(ZSTR_LEN(PS(id)))) {</span>
<span class='curline'><a href='../S/993.html#L2315'>PS</a>               2315 ext/session/session.c 	if (PS(session_status) != php_session_active) {</span>
<span class='curline'><a href='../S/993.html#L2343'>PS</a>               2343 ext/session/session.c 	if (PS(session_status) != php_session_active) {</span>
<span class='curline'><a href='../S/993.html#L2348'>PS</a>               2348 ext/session/session.c 		HashTable *ht_sess_var = Z_ARRVAL_P(Z_REFVAL(PS(http_session_vars)));</span>
<span class='curline'><a href='../S/993.html#L2388'>PS</a>               2388 ext/session/session.c 	RETURN_LONG(PS(session_status));</span>
<span class='curline'><a href='../S/993.html#L2600'>PS</a>               2600 ext/session/session.c 	if (PS(mod) == NULL) {</span>
<span class='curline'><a href='../S/993.html#L2605'>PS</a>               2605 ext/session/session.c 			PS(mod) = _php_find_ps_module(value);</span>
<span class='curline'><a href='../S/993.html#L2609'>PS</a>               2609 ext/session/session.c 	if (PS(serializer) == NULL) {</span>
<span class='curline'><a href='../S/993.html#L2614'>PS</a>               2614 ext/session/session.c 			PS(serializer) = _php_find_ps_serializer(value);</span>
<span class='curline'><a href='../S/993.html#L2618'>PS</a>               2618 ext/session/session.c 	if (PS(mod) == NULL || PS(serializer) == NULL) {</span>
<span class='curline'><a href='../S/993.html#L2620'>PS</a>               2620 ext/session/session.c 		PS(session_status) = php_session_disabled;</span>
<span class='curline'><a href='../S/993.html#L2633'>PS</a>               2633 ext/session/session.c 	return php_rinit_session(PS(auto_start));</span>
<span class='curline'><a href='../S/993.html#L2648'>PS</a>               2648 ext/session/session.c 		if (!Z_ISUNDEF(PS(mod_user_names).names[i])) {</span>
<span class='curline'><a href='../S/993.html#L2649'>PS</a>               2649 ext/session/session.c 			zval_ptr_dtor(&amp;PS(mod_user_names).names[i]);</span>
<span class='curline'><a href='../S/993.html#L2650'>PS</a>               2650 ext/session/session.c 			ZVAL_UNDEF(&amp;PS(mod_user_names).names[i]);</span>
<span class='curline'><a href='../S/993.html#L2690'>PS</a>               2690 ext/session/session.c 	PS(module_number) = module_number; /* if we really need this var we need to init it in zts mode as well! */</span>
<span class='curline'><a href='../S/993.html#L2692'>PS</a>               2692 ext/session/session.c 	PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/993.html#L2817'>PS</a>               2817 ext/session/session.c 	if ((ppid = zend_hash_str_find(Z_ARRVAL(PG(http_globals)[where]), PS(session_name), progress-&gt;sname_len))</span>
<span class='curline'><a href='../S/993.html#L2831'>PS</a>               2831 ext/session/session.c 	if (PS(use_cookies)) {</span>
<span class='curline'><a href='../S/993.html#L2838'>PS</a>               2838 ext/session/session.c 	if (PS(use_only_cookies)) {</span>
<span class='curline'><a href='../S/993.html#L2849'>PS</a>               2849 ext/session/session.c 	if ((progress_ary = zend_symtable_find(Z_ARRVAL_P(Z_REFVAL(PS(http_session_vars))), progress-&gt;key.s)) == NULL) {</span>
<span class='curline'><a href='../S/993.html#L2868'>PS</a>               2868 ext/session/session.c 		if (PS(rfc1867_min_freq) &gt; 0.0) {</span>
<span class='curline'><a href='../S/993.html#L2876'>PS</a>               2876 ext/session/session.c 			progress-&gt;next_update_time = dtv + PS(rfc1867_min_freq);</span>
<span class='curline'><a href='../S/993.html#L2883'>PS</a>               2883 ext/session/session.c 	PS(session_status) = php_session_active;</span>
<span class='curline'><a href='../S/993.html#L2887'>PS</a>               2887 ext/session/session.c 		zend_hash_update(Z_ARRVAL_P(Z_REFVAL(PS(http_session_vars))), progress-&gt;key.s, &amp;progress-&gt;data);</span>
<span class='curline'><a href='../S/993.html#L2895'>PS</a>               2895 ext/session/session.c 	PS(session_status) = php_session_active;</span>
<span class='curline'><a href='../S/993.html#L2897'>PS</a>               2897 ext/session/session.c 		zend_hash_del(Z_ARRVAL_P(Z_REFVAL(PS(http_session_vars))), progress-&gt;key.s);</span>
<span class='curline'><a href='../S/993.html#L2910'>PS</a>               2910 ext/session/session.c 	if (!PS(rfc1867_enabled)) {</span>
<span class='curline'><a href='../S/993.html#L2914'>PS</a>               2914 ext/session/session.c 	progress = PS(rfc1867_progress);</span>
<span class='curline'><a href='../S/993.html#L2921'>PS</a>               2921 ext/session/session.c 			progress-&gt;sname_len  = strlen(PS(session_name));</span>
<span class='curline'><a href='../S/993.html#L2922'>PS</a>               2922 ext/session/session.c 			PS(rfc1867_progress) = progress;</span>
<span class='curline'><a href='../S/993.html#L2943'>PS</a>               2943 ext/session/session.c 				if (name_len == progress-&gt;sname_len &amp;&amp; memcmp(data-&gt;name, PS(session_name), name_len) == 0) {</span>
<span class='curline'><a href='../S/993.html#L2946'>PS</a>               2946 ext/session/session.c 				} else if (name_len == strlen(PS(rfc1867_name)) &amp;&amp; memcmp(data-&gt;name, PS(rfc1867_name), name_len + 1) == 0) {</span>
<span class='curline'><a href='../S/993.html#L2948'>PS</a>               2948 ext/session/session.c 					smart_str_appends(&amp;progress-&gt;key, PS(rfc1867_prefix));</span>
<span class='curline'><a href='../S/993.html#L2970'>PS</a>               2970 ext/session/session.c 				if (PS(rfc1867_freq) &gt;= 0) {</span>
<span class='curline'><a href='../S/993.html#L2971'>PS</a>               2971 ext/session/session.c 					progress-&gt;update_step = PS(rfc1867_freq);</span>
<span class='curline'><a href='../S/993.html#L2972'>PS</a>               2972 ext/session/session.c 				} else if (PS(rfc1867_freq) &lt; 0) { /* % of total size */</span>
<span class='curline'><a href='../S/993.html#L2973'>PS</a>               2973 ext/session/session.c 					progress-&gt;update_step = progress-&gt;content_length * -PS(rfc1867_freq) / 100;</span>
<span class='curline'><a href='../S/993.html#L2990'>PS</a>               2990 ext/session/session.c 				PS(id) = zend_string_init(Z_STRVAL(progress-&gt;sid), Z_STRLEN(progress-&gt;sid), 0);</span>
<span class='curline'><a href='../S/993.html#L2993'>PS</a>               2993 ext/session/session.c 					PS(use_trans_sid) = 1;</span>
<span class='curline'><a href='../S/993.html#L2994'>PS</a>               2994 ext/session/session.c 					PS(use_only_cookies) = 0;</span>
<span class='curline'><a href='../S/993.html#L2996'>PS</a>               2996 ext/session/session.c 				PS(send_cookie) = 0;</span>
<span class='curline'><a href='../S/993.html#L3055'>PS</a>               3055 ext/session/session.c 				if (PS(rfc1867_cleanup)) {</span>
<span class='curline'><a href='../S/993.html#L3072'>PS</a>               3072 ext/session/session.c 			PS(rfc1867_progress) = NULL;</span>
<span class='curline'><a href='../S/1018.html#L1698'>PS</a>               1698 ext/soap/soap.c 			if (PS(session_status) != php_session_active &amp;&amp;</span>
<span class='curline'><a href='../S/1018.html#L1699'>PS</a>               1699 ext/soap/soap.c 			    PS(session_status) != php_session_disabled) {</span>
<span class='curline'><a href='../S/1018.html#L1704'>PS</a>               1704 ext/soap/soap.c 			session_vars = &amp;PS(http_session_vars);</span>
<span class='curline'><a href='../S/1018.html#L1770'>PS</a>               1770 ext/soap/soap.c 				zval *session_vars = &amp;PS(http_session_vars);</span>
</pre>
</body>
</html>
