<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>ssl_handle</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/189.html#L187'>ssl_handle</a>        187 ext/ftp/ftp.c  			SSL_shutdown(ftp-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L188'>ssl_handle</a>        188 ext/ftp/ftp.c  			SSL_free(ftp-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L294'>ssl_handle</a>        294 ext/ftp/ftp.c  		ftp-&gt;ssl_handle = SSL_new(ctx);</span>
<span class='curline'><a href='../S/189.html#L295'>ssl_handle</a>        295 ext/ftp/ftp.c  		if (ftp-&gt;ssl_handle == NULL) {</span>
<span class='curline'><a href='../S/189.html#L301'>ssl_handle</a>        301 ext/ftp/ftp.c  		SSL_set_fd(ftp-&gt;ssl_handle, ftp-&gt;fd);</span>
<span class='curline'><a href='../S/189.html#L304'>ssl_handle</a>        304 ext/ftp/ftp.c  			res = SSL_connect(ftp-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L305'>ssl_handle</a>        305 ext/ftp/ftp.c  			err = SSL_get_error(ftp-&gt;ssl_handle, res);</span>
<span class='curline'><a href='../S/189.html#L315'>ssl_handle</a>        315 ext/ftp/ftp.c  					SSL_shutdown(ftp-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L335'>ssl_handle</a>        335 ext/ftp/ftp.c  					SSL_shutdown(ftp-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L336'>ssl_handle</a>        336 ext/ftp/ftp.c  					SSL_free(ftp-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L1293'>ssl_handle</a>       1293 ext/ftp/ftp.c  			handle = ftp-&gt;ssl_handle;</span>
<span class='curline'><a href='../S/189.html#L1296'>ssl_handle</a>       1296 ext/ftp/ftp.c  			handle = ftp-&gt;data-&gt;ssl_handle;</span>
<span class='curline'><a href='../S/189.html#L1382'>ssl_handle</a>       1382 ext/ftp/ftp.c  		handle = ftp-&gt;ssl_handle;</span>
<span class='curline'><a href='../S/189.html#L1385'>ssl_handle</a>       1385 ext/ftp/ftp.c  		handle = ftp-&gt;data-&gt;ssl_handle;</span>
<span class='curline'><a href='../S/189.html#L1674'>ssl_handle</a>       1674 ext/ftp/ftp.c  		data-&gt;ssl_handle = SSL_new(ctx);</span>
<span class='curline'><a href='../S/189.html#L1675'>ssl_handle</a>       1675 ext/ftp/ftp.c  		if (data-&gt;ssl_handle == NULL) {</span>
<span class='curline'><a href='../S/189.html#L1682'>ssl_handle</a>       1682 ext/ftp/ftp.c  		SSL_set_fd(data-&gt;ssl_handle, data-&gt;fd);</span>
<span class='curline'><a href='../S/189.html#L1685'>ssl_handle</a>       1685 ext/ftp/ftp.c  			SSL_copy_session_id(data-&gt;ssl_handle, ftp-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L1689'>ssl_handle</a>       1689 ext/ftp/ftp.c  			res = SSL_connect(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L1690'>ssl_handle</a>       1690 ext/ftp/ftp.c  			err = SSL_get_error(data-&gt;ssl_handle, res);</span>
<span class='curline'><a href='../S/189.html#L1699'>ssl_handle</a>       1699 ext/ftp/ftp.c  					SSL_shutdown(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L1719'>ssl_handle</a>       1719 ext/ftp/ftp.c  					SSL_shutdown(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L1720'>ssl_handle</a>       1720 ext/ftp/ftp.c  					SSL_free(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L1749'>ssl_handle</a>       1749 ext/ftp/ftp.c  			ctx = SSL_get_SSL_CTX(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L1752'>ssl_handle</a>       1752 ext/ftp/ftp.c  			SSL_shutdown(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L1753'>ssl_handle</a>       1753 ext/ftp/ftp.c  			SSL_free(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L1762'>ssl_handle</a>       1762 ext/ftp/ftp.c  			ctx = SSL_get_SSL_CTX(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L1765'>ssl_handle</a>       1765 ext/ftp/ftp.c  			SSL_shutdown(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/189.html#L1766'>ssl_handle</a>       1766 ext/ftp/ftp.c  			SSL_free(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/190.html#L54'>ssl_handle</a>         54 ext/ftp/ftp.h  	SSL		*ssl_handle;	/* ssl handle */</span>
<span class='curline'><a href='../S/190.html#L87'>ssl_handle</a>         87 ext/ftp/ftp.h  	SSL				*ssl_handle;      /* handle for control connection */</span>
<span class='curline'><a href='../S/853.html#L146'>ssl_handle</a>        146 ext/openssl/xp_ssl.c 	SSL *ssl_handle;</span>
<span class='curline'><a href='../S/853.html#L190'>ssl_handle</a>        190 ext/openssl/xp_ssl.c 	int err = SSL_get_error(sslsock-&gt;ssl_handle, nr_bytes);</span>
<span class='curline'><a href='../S/853.html#L215'>ssl_handle</a>        215 ext/openssl/xp_ssl.c 					SSL_set_shutdown(sslsock-&gt;ssl_handle, SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);</span>
<span class='curline'><a href='../S/853.html#L1138'>ssl_handle</a>       1138 ext/openssl/xp_ssl.c 	SSL_set_info_callback(sslsock-&gt;ssl_handle, info_callback);</span>
<span class='curline'><a href='../S/853.html#L1290'>ssl_handle</a>       1290 ext/openssl/xp_ssl.c static int server_sni_callback(SSL *ssl_handle, int *al, void *arg) /* {{{ */</span>
<span class='curline'><a href='../S/853.html#L1297'>ssl_handle</a>       1297 ext/openssl/xp_ssl.c 	server_name = SSL_get_servername(ssl_handle, TLSEXT_NAMETYPE_host_name);</span>
<span class='curline'><a href='../S/853.html#L1303'>ssl_handle</a>       1303 ext/openssl/xp_ssl.c 	stream = (php_stream*)SSL_get_ex_data(ssl_handle, php_openssl_get_ssl_stream_data_index());</span>
<span class='curline'><a href='../S/853.html#L1312'>ssl_handle</a>       1312 ext/openssl/xp_ssl.c 			SSL_set_SSL_CTX(ssl_handle, sslsock-&gt;sni_certs[i].ctx);</span>
<span class='curline'><a href='../S/853.html#L1425'>ssl_handle</a>       1425 ext/openssl/xp_ssl.c 		SSL_set_tlsext_host_name(sslsock-&gt;ssl_handle, sni_server_name);</span>
<span class='curline'><a href='../S/853.html#L1474'>ssl_handle</a>       1474 ext/openssl/xp_ssl.c static int server_alpn_callback(SSL *ssl_handle, const unsigned char **out, unsigned char *outlen,</span>
<span class='curline'><a href='../S/853.html#L1502'>ssl_handle</a>       1502 ext/openssl/xp_ssl.c 	if (sslsock-&gt;ssl_handle) {</span>
<span class='curline'><a href='../S/853.html#L1628'>ssl_handle</a>       1628 ext/openssl/xp_ssl.c 	sslsock-&gt;ssl_handle = SSL_new(sslsock-&gt;ctx);</span>
<span class='curline'><a href='../S/853.html#L1630'>ssl_handle</a>       1630 ext/openssl/xp_ssl.c 	if (sslsock-&gt;ssl_handle == NULL) {</span>
<span class='curline'><a href='../S/853.html#L1636'>ssl_handle</a>       1636 ext/openssl/xp_ssl.c 		SSL_set_ex_data(sslsock-&gt;ssl_handle, php_openssl_get_ssl_stream_data_index(), stream);</span>
<span class='curline'><a href='../S/853.html#L1639'>ssl_handle</a>       1639 ext/openssl/xp_ssl.c 	if (!SSL_set_fd(sslsock-&gt;ssl_handle, sslsock-&gt;s.socket)) {</span>
<span class='curline'><a href='../S/853.html#L1657'>ssl_handle</a>       1657 ext/openssl/xp_ssl.c 		long mode = SSL_get_mode(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1658'>ssl_handle</a>       1658 ext/openssl/xp_ssl.c 		SSL_set_mode(sslsock-&gt;ssl_handle, mode | SSL_MODE_RELEASE_BUFFERS);</span>
<span class='curline'><a href='../S/853.html#L1665'>ssl_handle</a>       1665 ext/openssl/xp_ssl.c 		} else if (((php_openssl_netstream_data_t*)cparam-&gt;inputs.session-&gt;abstract)-&gt;ssl_handle == NULL) {</span>
<span class='curline'><a href='../S/853.html#L1668'>ssl_handle</a>       1668 ext/openssl/xp_ssl.c 			SSL_copy_session_id(sslsock-&gt;ssl_handle, ((php_openssl_netstream_data_t*)cparam-&gt;inputs.session-&gt;abstract)-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1676'>ssl_handle</a>       1676 ext/openssl/xp_ssl.c static zend_array *capture_session_meta(SSL *ssl_handle) /* {{{ */</span>
<span class='curline'><a href='../S/853.html#L1680'>ssl_handle</a>       1680 ext/openssl/xp_ssl.c 	long proto = SSL_version(ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1681'>ssl_handle</a>       1681 ext/openssl/xp_ssl.c 	const SSL_CIPHER *cipher = SSL_get_current_cipher(ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1742'>ssl_handle</a>       1742 ext/openssl/xp_ssl.c 		chain = SSL_get_peer_cert_chain(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1790'>ssl_handle</a>       1790 ext/openssl/xp_ssl.c 				SSL_set_connect_state(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1792'>ssl_handle</a>       1792 ext/openssl/xp_ssl.c 				SSL_set_accept_state(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1813'>ssl_handle</a>       1813 ext/openssl/xp_ssl.c 				n = SSL_connect(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1815'>ssl_handle</a>       1815 ext/openssl/xp_ssl.c 				n = SSL_accept(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1834'>ssl_handle</a>       1834 ext/openssl/xp_ssl.c 					int err = SSL_get_error(sslsock-&gt;ssl_handle, n);</span>
<span class='curline'><a href='../S/853.html#L1853'>ssl_handle</a>       1853 ext/openssl/xp_ssl.c 			peer_cert = SSL_get_peer_certificate(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1858'>ssl_handle</a>       1858 ext/openssl/xp_ssl.c 			if (FAILURE == apply_peer_verification_policy(sslsock-&gt;ssl_handle, peer_cert, stream)) {</span>
<span class='curline'><a href='../S/853.html#L1859'>ssl_handle</a>       1859 ext/openssl/xp_ssl.c 				SSL_shutdown(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1876'>ssl_handle</a>       1876 ext/openssl/xp_ssl.c 						ZVAL_ARR(&amp;meta_arr, capture_session_meta(sslsock-&gt;ssl_handle));</span>
<span class='curline'><a href='../S/853.html#L1887'>ssl_handle</a>       1887 ext/openssl/xp_ssl.c 			peer_cert = SSL_get_peer_certificate(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1901'>ssl_handle</a>       1901 ext/openssl/xp_ssl.c 		SSL_shutdown(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1985'>ssl_handle</a>       1985 ext/openssl/xp_ssl.c 				nr_bytes = SSL_read(sslsock-&gt;ssl_handle, buf, (int)count);</span>
<span class='curline'><a href='../S/853.html#L1995'>ssl_handle</a>       1995 ext/openssl/xp_ssl.c 				nr_bytes = SSL_write(sslsock-&gt;ssl_handle, buf, (int)count);</span>
<span class='curline'><a href='../S/853.html#L2007'>ssl_handle</a>       2007 ext/openssl/xp_ssl.c 				int err = SSL_get_error(sslsock-&gt;ssl_handle, nr_bytes );</span>
<span class='curline'><a href='../S/853.html#L2020'>ssl_handle</a>       2020 ext/openssl/xp_ssl.c 					stream-&gt;eof = (retry == 0 &amp;&amp; errno != EAGAIN &amp;&amp; !SSL_pending(sslsock-&gt;ssl_handle));</span>
<span class='curline'><a href='../S/853.html#L2042'>ssl_handle</a>       2042 ext/openssl/xp_ssl.c 				int err = SSL_get_error(sslsock-&gt;ssl_handle, nr_bytes);</span>
<span class='curline'><a href='../S/853.html#L2128'>ssl_handle</a>       2128 ext/openssl/xp_ssl.c 			SSL_shutdown(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L2131'>ssl_handle</a>       2131 ext/openssl/xp_ssl.c 		if (sslsock-&gt;ssl_handle) {</span>
<span class='curline'><a href='../S/853.html#L2132'>ssl_handle</a>       2132 ext/openssl/xp_ssl.c 			SSL_free(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L2133'>ssl_handle</a>       2133 ext/openssl/xp_ssl.c 			sslsock-&gt;ssl_handle = NULL;</span>
<span class='curline'><a href='../S/853.html#L2276'>ssl_handle</a>       2276 ext/openssl/xp_ssl.c 				switch (SSL_version(sslsock-&gt;ssl_handle)) {</span>
<span class='curline'><a href='../S/853.html#L2293'>ssl_handle</a>       2293 ext/openssl/xp_ssl.c 				cipher = SSL_get_current_cipher(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L2305'>ssl_handle</a>       2305 ext/openssl/xp_ssl.c 					SSL_get0_alpn_selected(sslsock-&gt;ssl_handle, &amp;alpn_proto, &amp;alpn_proto_len);</span>
<span class='curline'><a href='../S/853.html#L2349'>ssl_handle</a>       2349 ext/openssl/xp_ssl.c 							n = SSL_peek(sslsock-&gt;ssl_handle, &amp;buf, sizeof(buf));</span>
<span class='curline'><a href='../S/853.html#L2351'>ssl_handle</a>       2351 ext/openssl/xp_ssl.c 								int err = SSL_get_error(sslsock-&gt;ssl_handle, n);</span>
<span class='curline'><a href='../S/853.html#L2458'>ssl_handle</a>       2458 ext/openssl/xp_ssl.c 					&amp;&amp; (pending = (size_t)SSL_pending(sslsock-&gt;ssl_handle)) &gt; 0) {</span>
</pre>
</body>
</html>
