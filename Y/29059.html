<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>objid_query</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/1004.html#L373'>objid_query</a>       373 ext/snmp/snmp.c struct objid_query {</span>
<span class='curline'><a href='../S/1004.html#L701'>objid_query</a>       701 ext/snmp/snmp.c 							struct objid_query *objid_query)</span>
<span class='curline'><a href='../S/1004.html#L723'>objid_query</a>       723 ext/snmp/snmp.c 		memmove((char *)root, (char *)(objid_query-&gt;vars[0].name), (objid_query-&gt;vars[0].name_length) * sizeof(oid));</span>
<span class='curline'><a href='../S/1004.html#L724'>objid_query</a>       724 ext/snmp/snmp.c 		rootlen = objid_query-&gt;vars[0].name_length;</span>
<span class='curline'><a href='../S/1004.html#L725'>objid_query</a>       725 ext/snmp/snmp.c 		objid_query-&gt;offset = objid_query-&gt;count;</span>
<span class='curline'><a href='../S/1004.html#L736'>objid_query</a>       736 ext/snmp/snmp.c 	if ((st &amp; SNMP_CMD_SET) &amp;&amp; objid_query-&gt;count &gt; objid_query-&gt;step) {</span>
<span class='curline'><a href='../S/1004.html#L747'>objid_query</a>       747 ext/snmp/snmp.c 				pdu-&gt;non_repeaters = objid_query-&gt;non_repeaters;</span>
<span class='curline'><a href='../S/1004.html#L748'>objid_query</a>       748 ext/snmp/snmp.c 				pdu-&gt;max_repetitions = objid_query-&gt;max_repetitions;</span>
<span class='curline'><a href='../S/1004.html#L750'>objid_query</a>       750 ext/snmp/snmp.c 			snmp_add_null_var(pdu, objid_query-&gt;vars[0].name, objid_query-&gt;vars[0].name_length);</span>
<span class='curline'><a href='../S/1004.html#L764'>objid_query</a>       764 ext/snmp/snmp.c 			for (count = 0; objid_query-&gt;offset &lt; objid_query-&gt;count &amp;&amp; count &lt; objid_query-&gt;step; objid_query-&gt;offset++, count++){</span>
<span class='curline'><a href='../S/1004.html#L766'>objid_query</a>       766 ext/snmp/snmp.c 					if ((snmp_errno = snmp_add_var(pdu, objid_query-&gt;vars[objid_query-&gt;offset].name, objid_query-&gt;vars[objid_query-&gt;offset].name_length, objid_query-&gt;vars[objid_query-&gt;offset].type, objid_query-&gt;vars[objid_query-&gt;offset].value))) {</span>
<span class='curline'><a href='../S/1004.html#L767'>objid_query</a>       767 ext/snmp/snmp.c 						snprint_objid(buf, sizeof(buf), objid_query-&gt;vars[objid_query-&gt;offset].name, objid_query-&gt;vars[objid_query-&gt;offset].name_length);</span>
<span class='curline'><a href='../S/1004.html#L768'>objid_query</a>       768 ext/snmp/snmp.c 						php_snmp_error(getThis(), NULL, PHP_SNMP_ERRNO_OID_PARSING_ERROR, "Could not add variable: OID='%s' type='%c' value='%s': %s", buf, objid_query-&gt;vars[objid_query-&gt;offset].type, objid_query-&gt;vars[objid_query-&gt;offset].value, snmp_api_errstring(snmp_errno));</span>
<span class='curline'><a href='../S/1004.html#L775'>objid_query</a>       775 ext/snmp/snmp.c 					snmp_add_null_var(pdu, objid_query-&gt;vars[objid_query-&gt;offset].name, objid_query-&gt;vars[objid_query-&gt;offset].name_length);</span>
<span class='curline'><a href='../S/1004.html#L791'>objid_query</a>       791 ext/snmp/snmp.c 					if (objid_query-&gt;offset &lt; objid_query-&gt;count) { /* we have unprocessed OIDs */</span>
<span class='curline'><a href='../S/1004.html#L822'>objid_query</a>       822 ext/snmp/snmp.c 							objid_query-&gt;offset = 0;</span>
<span class='curline'><a href='../S/1004.html#L829'>objid_query</a>       829 ext/snmp/snmp.c 					php_snmp_getvalue(vars, &amp;snmpval, objid_query-&gt;valueretrieval);</span>
<span class='curline'><a href='../S/1004.html#L831'>objid_query</a>       831 ext/snmp/snmp.c 					if (objid_query-&gt;array_output) {</span>
<span class='curline'><a href='../S/1004.html#L839'>objid_query</a>       839 ext/snmp/snmp.c 							for (count = 0; count &lt; objid_query-&gt;count; count++) {</span>
<span class='curline'><a href='../S/1004.html#L840'>objid_query</a>       840 ext/snmp/snmp.c 								if (objid_query-&gt;vars[count].name_length == vars-&gt;name_length &amp;&amp; snmp_oid_compare(objid_query-&gt;vars[count].name, objid_query-&gt;vars[count].name_length, vars-&gt;name, vars-&gt;name_length) == 0) {</span>
<span class='curline'><a href='../S/1004.html#L842'>objid_query</a>       842 ext/snmp/snmp.c 									objid_query-&gt;vars[count].name_length = 0; /* mark this name as used */</span>
<span class='curline'><a href='../S/1004.html#L847'>objid_query</a>       847 ext/snmp/snmp.c 								add_assoc_zval(return_value, objid_query-&gt;vars[count].oid, &amp;snmpval);</span>
<span class='curline'><a href='../S/1004.html#L876'>objid_query</a>       876 ext/snmp/snmp.c 						if (objid_query-&gt;oid_increasing_check == TRUE &amp;&amp; snmp_oid_compare(objid_query-&gt;vars[0].name, objid_query-&gt;vars[0].name_length, vars-&gt;name, vars-&gt;name_length) &gt;= 0) {</span>
<span class='curline'><a href='../S/1004.html#L881'>objid_query</a>       881 ext/snmp/snmp.c 							memmove((char *)(objid_query-&gt;vars[0].name), (char *)vars-&gt;name, vars-&gt;name_length * sizeof(oid));</span>
<span class='curline'><a href='../S/1004.html#L882'>objid_query</a>       882 ext/snmp/snmp.c 							objid_query-&gt;vars[0].name_length = vars-&gt;name_length;</span>
<span class='curline'><a href='../S/1004.html#L887'>objid_query</a>       887 ext/snmp/snmp.c 				if (objid_query-&gt;offset &lt; objid_query-&gt;count) { /* we have unprocessed OIDs */</span>
<span class='curline'><a href='../S/1004.html#L891'>objid_query</a>       891 ext/snmp/snmp.c 				if (st &amp; SNMP_CMD_WALK &amp;&amp; response-&gt;errstat == SNMP_ERR_TOOBIG &amp;&amp; objid_query-&gt;max_repetitions &gt; 1) { /* Answer will not fit into single packet */</span>
<span class='curline'><a href='../S/1004.html#L892'>objid_query</a>       892 ext/snmp/snmp.c 					objid_query-&gt;max_repetitions /= 2;</span>
<span class='curline'><a href='../S/1004.html#L902'>objid_query</a>       902 ext/snmp/snmp.c 					if (st &amp; (SNMP_CMD_GET | SNMP_CMD_GETNEXT) &amp;&amp; response-&gt;errstat == SNMP_ERR_TOOBIG &amp;&amp; objid_query-&gt;step &gt; 1) { /* Answer will not fit into single packet */</span>
<span class='curline'><a href='../S/1004.html#L903'>objid_query</a>       903 ext/snmp/snmp.c 						objid_query-&gt;offset = ((objid_query-&gt;offset &gt; objid_query-&gt;step) ? (objid_query-&gt;offset - objid_query-&gt;step) : 0 );</span>
<span class='curline'><a href='../S/1004.html#L904'>objid_query</a>       904 ext/snmp/snmp.c 						objid_query-&gt;step /= 2;</span>
<span class='curline'><a href='../S/1004.html#L923'>objid_query</a>       923 ext/snmp/snmp.c 					if (objid_query-&gt;array_output) {</span>
<span class='curline'><a href='../S/1004.html#L932'>objid_query</a>       932 ext/snmp/snmp.c 			if (objid_query-&gt;array_output) {</span>
<span class='curline'><a href='../S/1004.html#L942'>objid_query</a>       942 ext/snmp/snmp.c 			if (objid_query-&gt;array_output) {</span>
<span class='curline'><a href='../S/1004.html#L962'>objid_query</a>       962 ext/snmp/snmp.c static int php_snmp_parse_oid(zval *object, int st, struct objid_query *objid_query, zval *oid, zval *type, zval *value)</span>
<span class='curline'><a href='../S/1004.html#L982'>objid_query</a>       982 ext/snmp/snmp.c 	objid_query-&gt;count = 0;</span>
<span class='curline'><a href='../S/1004.html#L983'>objid_query</a>       983 ext/snmp/snmp.c 	objid_query-&gt;array_output = ((st &amp; SNMP_CMD_WALK) ? TRUE : FALSE);</span>
<span class='curline'><a href='../S/1004.html#L985'>objid_query</a>       985 ext/snmp/snmp.c 		objid_query-&gt;vars = (snmpobjarg *)emalloc(sizeof(snmpobjarg));</span>
<span class='curline'><a href='../S/1004.html#L986'>objid_query</a>       986 ext/snmp/snmp.c 		if (objid_query-&gt;vars == NULL) {</span>
<span class='curline'><a href='../S/1004.html#L988'>objid_query</a>       988 ext/snmp/snmp.c 			efree(objid_query-&gt;vars);</span>
<span class='curline'><a href='../S/1004.html#L991'>objid_query</a>       991 ext/snmp/snmp.c 		objid_query-&gt;vars[objid_query-&gt;count].oid = Z_STRVAL_P(oid);</span>
<span class='curline'><a href='../S/1004.html#L996'>objid_query</a>       996 ext/snmp/snmp.c 					efree(objid_query-&gt;vars);</span>
<span class='curline'><a href='../S/1004.html#L1000'>objid_query</a>      1000 ext/snmp/snmp.c 				objid_query-&gt;vars[objid_query-&gt;count].type = *pptr;</span>
<span class='curline'><a href='../S/1004.html#L1001'>objid_query</a>      1001 ext/snmp/snmp.c 				objid_query-&gt;vars[objid_query-&gt;count].value = Z_STRVAL_P(value);</span>
<span class='curline'><a href='../S/1004.html#L1004'>objid_query</a>      1004 ext/snmp/snmp.c 				efree(objid_query-&gt;vars);</span>
<span class='curline'><a href='../S/1004.html#L1008'>objid_query</a>      1008 ext/snmp/snmp.c 		objid_query-&gt;count++;</span>
<span class='curline'><a href='../S/1004.html#L1014'>objid_query</a>      1014 ext/snmp/snmp.c 		objid_query-&gt;vars = (snmpobjarg *)emalloc(sizeof(snmpobjarg) * zend_hash_num_elements(Z_ARRVAL_P(oid)));</span>
<span class='curline'><a href='../S/1004.html#L1015'>objid_query</a>      1015 ext/snmp/snmp.c 		if (objid_query-&gt;vars == NULL) {</span>
<span class='curline'><a href='../S/1004.html#L1017'>objid_query</a>      1017 ext/snmp/snmp.c 			efree(objid_query-&gt;vars);</span>
<span class='curline'><a href='../S/1004.html#L1020'>objid_query</a>      1020 ext/snmp/snmp.c 		objid_query-&gt;array_output = ( (st &amp; SNMP_CMD_SET) ? FALSE : TRUE );</span>
<span class='curline'><a href='../S/1004.html#L1023'>objid_query</a>      1023 ext/snmp/snmp.c 			objid_query-&gt;vars[objid_query-&gt;count].oid = Z_STRVAL_P(tmp_oid);</span>
<span class='curline'><a href='../S/1004.html#L1027'>objid_query</a>      1027 ext/snmp/snmp.c 					objid_query-&gt;vars[objid_query-&gt;count].type = *pptr;</span>
<span class='curline'><a href='../S/1004.html#L1040'>objid_query</a>      1040 ext/snmp/snmp.c 							efree(objid_query-&gt;vars);</span>
<span class='curline'><a href='../S/1004.html#L1044'>objid_query</a>      1044 ext/snmp/snmp.c 						objid_query-&gt;vars[objid_query-&gt;count].type = *pptr;</span>
<span class='curline'><a href='../S/1004.html#L1048'>objid_query</a>      1048 ext/snmp/snmp.c 						efree(objid_query-&gt;vars);</span>
<span class='curline'><a href='../S/1004.html#L1054'>objid_query</a>      1054 ext/snmp/snmp.c 					objid_query-&gt;vars[objid_query-&gt;count].value = Z_STRVAL_P(value);</span>
<span class='curline'><a href='../S/1004.html#L1065'>objid_query</a>      1065 ext/snmp/snmp.c 						objid_query-&gt;vars[objid_query-&gt;count].value = Z_STRVAL_P(tmp_value);</span>
<span class='curline'><a href='../S/1004.html#L1069'>objid_query</a>      1069 ext/snmp/snmp.c 						efree(objid_query-&gt;vars);</span>
<span class='curline'><a href='../S/1004.html#L1074'>objid_query</a>      1074 ext/snmp/snmp.c 			objid_query-&gt;count++;</span>
<span class='curline'><a href='../S/1004.html#L1080'>objid_query</a>      1080 ext/snmp/snmp.c 		if (objid_query-&gt;count &gt; 1) {</span>
<span class='curline'><a href='../S/1004.html#L1082'>objid_query</a>      1082 ext/snmp/snmp.c 			efree(objid_query-&gt;vars);</span>
<span class='curline'><a href='../S/1004.html#L1085'>objid_query</a>      1085 ext/snmp/snmp.c 		objid_query-&gt;vars[0].name_length = MAX_NAME_LEN;</span>
<span class='curline'><a href='../S/1004.html#L1086'>objid_query</a>      1086 ext/snmp/snmp.c 		if (strlen(objid_query-&gt;vars[0].oid)) { /* on a walk, an empty string means top of tree - no error */</span>
<span class='curline'><a href='../S/1004.html#L1087'>objid_query</a>      1087 ext/snmp/snmp.c 			if (!snmp_parse_oid(objid_query-&gt;vars[0].oid, objid_query-&gt;vars[0].name, &amp;(objid_query-&gt;vars[0].name_length))) {</span>
<span class='curline'><a href='../S/1004.html#L1088'>objid_query</a>      1088 ext/snmp/snmp.c 				php_snmp_error(object, NULL, PHP_SNMP_ERRNO_OID_PARSING_ERROR, "Invalid object identifier: %s", objid_query-&gt;vars[0].oid);</span>
<span class='curline'><a href='../S/1004.html#L1089'>objid_query</a>      1089 ext/snmp/snmp.c 				efree(objid_query-&gt;vars);</span>
<span class='curline'><a href='../S/1004.html#L1093'>objid_query</a>      1093 ext/snmp/snmp.c 			memmove((char *)objid_query-&gt;vars[0].name, (char *)objid_mib, sizeof(objid_mib));</span>
<span class='curline'><a href='../S/1004.html#L1094'>objid_query</a>      1094 ext/snmp/snmp.c 			objid_query-&gt;vars[0].name_length = sizeof(objid_mib) / sizeof(oid);</span>
<span class='curline'><a href='../S/1004.html#L1097'>objid_query</a>      1097 ext/snmp/snmp.c 		for (objid_query-&gt;offset = 0; objid_query-&gt;offset &lt; objid_query-&gt;count; objid_query-&gt;offset++) {</span>
<span class='curline'><a href='../S/1004.html#L1098'>objid_query</a>      1098 ext/snmp/snmp.c 			objid_query-&gt;vars[objid_query-&gt;offset].name_length = MAX_OID_LEN;</span>
<span class='curline'><a href='../S/1004.html#L1099'>objid_query</a>      1099 ext/snmp/snmp.c 			if (!snmp_parse_oid(objid_query-&gt;vars[objid_query-&gt;offset].oid, objid_query-&gt;vars[objid_query-&gt;offset].name, &amp;(objid_query-&gt;vars[objid_query-&gt;offset].name_length))) {</span>
<span class='curline'><a href='../S/1004.html#L1100'>objid_query</a>      1100 ext/snmp/snmp.c 				php_snmp_error(object, NULL, PHP_SNMP_ERRNO_OID_PARSING_ERROR, "Invalid object identifier: %s", objid_query-&gt;vars[objid_query-&gt;offset].oid);</span>
<span class='curline'><a href='../S/1004.html#L1101'>objid_query</a>      1101 ext/snmp/snmp.c 				efree(objid_query-&gt;vars);</span>
<span class='curline'><a href='../S/1004.html#L1106'>objid_query</a>      1106 ext/snmp/snmp.c 	objid_query-&gt;offset = 0;</span>
<span class='curline'><a href='../S/1004.html#L1107'>objid_query</a>      1107 ext/snmp/snmp.c 	objid_query-&gt;step = objid_query-&gt;count;</span>
<span class='curline'><a href='../S/1004.html#L1108'>objid_query</a>      1108 ext/snmp/snmp.c 	return (objid_query-&gt;count &gt; 0);</span>
<span class='curline'><a href='../S/1004.html#L1423'>objid_query</a>      1423 ext/snmp/snmp.c 	struct objid_query objid_query;</span>
<span class='curline'><a href='../S/1004.html#L1429'>objid_query</a>      1429 ext/snmp/snmp.c 	objid_query.max_repetitions = -1;</span>
<span class='curline'><a href='../S/1004.html#L1430'>objid_query</a>      1430 ext/snmp/snmp.c 	objid_query.non_repeaters = 0;</span>
<span class='curline'><a href='../S/1004.html#L1431'>objid_query</a>      1431 ext/snmp/snmp.c 	objid_query.valueretrieval = SNMP_G(valueretrieval);</span>
<span class='curline'><a href='../S/1004.html#L1432'>objid_query</a>      1432 ext/snmp/snmp.c 	objid_query.oid_increasing_check = TRUE;</span>
<span class='curline'><a href='../S/1004.html#L1472'>objid_query</a>      1472 ext/snmp/snmp.c 			if (zend_parse_parameters(argc, "z|bll", &amp;oid, &amp;suffix_keys, &amp;(objid_query.max_repetitions), &amp;(objid_query.non_repeaters)) == FAILURE) {</span>
<span class='curline'><a href='../S/1004.html#L1494'>objid_query</a>      1494 ext/snmp/snmp.c 	if (!php_snmp_parse_oid(getThis(), st, &amp;objid_query, oid, type, value)) {</span>
<span class='curline'><a href='../S/1004.html#L1500'>objid_query</a>      1500 ext/snmp/snmp.c 			efree(objid_query.vars);</span>
<span class='curline'><a href='../S/1004.html#L1505'>objid_query</a>      1505 ext/snmp/snmp.c 			efree(objid_query.vars);</span>
<span class='curline'><a href='../S/1004.html#L1516'>objid_query</a>      1516 ext/snmp/snmp.c 			efree(objid_query.vars);</span>
<span class='curline'><a href='../S/1004.html#L1521'>objid_query</a>      1521 ext/snmp/snmp.c 			objid_query.step = snmp_object-&gt;max_oids;</span>
<span class='curline'><a href='../S/1004.html#L1522'>objid_query</a>      1522 ext/snmp/snmp.c 			if (objid_query.max_repetitions &lt; 0) { /* unspecified in function call, use session-wise */</span>
<span class='curline'><a href='../S/1004.html#L1523'>objid_query</a>      1523 ext/snmp/snmp.c 				objid_query.max_repetitions = snmp_object-&gt;max_oids;</span>
<span class='curline'><a href='../S/1004.html#L1526'>objid_query</a>      1526 ext/snmp/snmp.c 		objid_query.oid_increasing_check = snmp_object-&gt;oid_increasing_check;</span>
<span class='curline'><a href='../S/1004.html#L1527'>objid_query</a>      1527 ext/snmp/snmp.c 		objid_query.valueretrieval = snmp_object-&gt;valueretrieval;</span>
<span class='curline'><a href='../S/1004.html#L1536'>objid_query</a>      1536 ext/snmp/snmp.c 	if (objid_query.max_repetitions &lt; 0) {</span>
<span class='curline'><a href='../S/1004.html#L1537'>objid_query</a>      1537 ext/snmp/snmp.c 		objid_query.max_repetitions = 20; /* provide correct default value */</span>
<span class='curline'><a href='../S/1004.html#L1540'>objid_query</a>      1540 ext/snmp/snmp.c 	php_snmp_internal(INTERNAL_FUNCTION_PARAM_PASSTHRU, st, session, &amp;objid_query);</span>
<span class='curline'><a href='../S/1004.html#L1542'>objid_query</a>      1542 ext/snmp/snmp.c 	efree(objid_query.vars);</span>
</pre>
</body>
</html>
