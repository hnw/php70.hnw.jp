<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>req</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/456.html#L2636'>req</a>              2636 ext/ldap/ldap.c int _ldap_rebind_proc(LDAP *ldap, const char *url, ber_tag_t req, ber_int_t msgid, void *params)</span>
<span class='curline'><a href='../S/851.html#L650'>req</a>               650 ext/openssl/openssl.c static EVP_PKEY * php_openssl_generate_private_key(struct php_x509_request * req);</span>
<span class='curline'><a href='../S/851.html#L832'>req</a>               832 ext/openssl/openssl.c static int add_oid_section(struct php_x509_request * req) /* {{{ */</span>
<span class='curline'><a href='../S/851.html#L839'>req</a>               839 ext/openssl/openssl.c 	str = CONF_get_string(req-&gt;req_config, NULL, "oid_section");</span>
<span class='curline'><a href='../S/851.html#L843'>req</a>               843 ext/openssl/openssl.c 	sktmp = CONF_get_section(req-&gt;req_config, str);</span>
<span class='curline'><a href='../S/851.html#L859'>req</a>               859 ext/openssl/openssl.c #define PHP_SSL_REQ_INIT(req)		memset(req, 0, sizeof(*req))</span>
<span class='curline'><a href='../S/851.html#L860'>req</a>               860 ext/openssl/openssl.c #define PHP_SSL_REQ_DISPOSE(req)	php_openssl_dispose_config(req)</span>
<span class='curline'><a href='../S/851.html#L861'>req</a>               861 ext/openssl/openssl.c #define PHP_SSL_REQ_PARSE(req, zval)	php_openssl_parse_config(req, zval)</span>
<span class='curline'><a href='../S/851.html#L863'>req</a>               863 ext/openssl/openssl.c #define PHP_SSL_CONFIG_SYNTAX_CHECK(var) if (req-&gt;var &amp;&amp; php_openssl_config_check_syntax(#var, \</span>
<span class='curline'><a href='../S/851.html#L864'>req</a>               864 ext/openssl/openssl.c 			req-&gt;config_filename, req-&gt;var, req-&gt;req_config) == FAILURE) return FAILURE</span>
<span class='curline'><a href='../S/851.html#L899'>req</a>               899 ext/openssl/openssl.c static int php_openssl_parse_config(struct php_x509_request * req, zval * optional_args) /* {{{ */</span>
<span class='curline'><a href='../S/851.html#L904'>req</a>               904 ext/openssl/openssl.c 	SET_OPTIONAL_STRING_ARG("config", req-&gt;config_filename, default_ssl_conf_filename);</span>
<span class='curline'><a href='../S/851.html#L905'>req</a>               905 ext/openssl/openssl.c 	SET_OPTIONAL_STRING_ARG("config_section_name", req-&gt;section_name, "req");</span>
<span class='curline'><a href='../S/851.html#L906'>req</a>               906 ext/openssl/openssl.c 	req-&gt;global_config = CONF_load(NULL, default_ssl_conf_filename, NULL);</span>
<span class='curline'><a href='../S/851.html#L907'>req</a>               907 ext/openssl/openssl.c 	req-&gt;req_config = CONF_load(NULL, req-&gt;config_filename, NULL);</span>
<span class='curline'><a href='../S/851.html#L909'>req</a>               909 ext/openssl/openssl.c 	if (req-&gt;req_config == NULL) {</span>
<span class='curline'><a href='../S/851.html#L914'>req</a>               914 ext/openssl/openssl.c 	str = CONF_get_string(req-&gt;req_config, NULL, "oid_file");</span>
<span class='curline'><a href='../S/851.html#L922'>req</a>               922 ext/openssl/openssl.c 	if (add_oid_section(req) == FAILURE) {</span>
<span class='curline'><a href='../S/851.html#L925'>req</a>               925 ext/openssl/openssl.c 	SET_OPTIONAL_STRING_ARG("digest_alg", req-&gt;digest_name,</span>
<span class='curline'><a href='../S/851.html#L926'>req</a>               926 ext/openssl/openssl.c 		CONF_get_string(req-&gt;req_config, req-&gt;section_name, "default_md"));</span>
<span class='curline'><a href='../S/851.html#L927'>req</a>               927 ext/openssl/openssl.c 	SET_OPTIONAL_STRING_ARG("x509_extensions", req-&gt;extensions_section,</span>
<span class='curline'><a href='../S/851.html#L928'>req</a>               928 ext/openssl/openssl.c 		CONF_get_string(req-&gt;req_config, req-&gt;section_name, "x509_extensions"));</span>
<span class='curline'><a href='../S/851.html#L929'>req</a>               929 ext/openssl/openssl.c 	SET_OPTIONAL_STRING_ARG("req_extensions", req-&gt;request_extensions_section,</span>
<span class='curline'><a href='../S/851.html#L930'>req</a>               930 ext/openssl/openssl.c 		CONF_get_string(req-&gt;req_config, req-&gt;section_name, "req_extensions"));</span>
<span class='curline'><a href='../S/851.html#L931'>req</a>               931 ext/openssl/openssl.c 	SET_OPTIONAL_LONG_ARG("private_key_bits", req-&gt;priv_key_bits,</span>
<span class='curline'><a href='../S/851.html#L932'>req</a>               932 ext/openssl/openssl.c 		CONF_get_number(req-&gt;req_config, req-&gt;section_name, "default_bits"));</span>
<span class='curline'><a href='../S/851.html#L934'>req</a>               934 ext/openssl/openssl.c 	SET_OPTIONAL_LONG_ARG("private_key_type", req-&gt;priv_key_type, OPENSSL_KEYTYPE_DEFAULT);</span>
<span class='curline'><a href='../S/851.html#L937'>req</a>               937 ext/openssl/openssl.c 		req-&gt;priv_key_encrypt = Z_TYPE_P(item) == IS_TRUE ? 1 : 0;</span>
<span class='curline'><a href='../S/851.html#L939'>req</a>               939 ext/openssl/openssl.c 		str = CONF_get_string(req-&gt;req_config, req-&gt;section_name, "encrypt_rsa_key");</span>
<span class='curline'><a href='../S/851.html#L941'>req</a>               941 ext/openssl/openssl.c 			str = CONF_get_string(req-&gt;req_config, req-&gt;section_name, "encrypt_key");</span>
<span class='curline'><a href='../S/851.html#L944'>req</a>               944 ext/openssl/openssl.c 			req-&gt;priv_key_encrypt = 0;</span>
<span class='curline'><a href='../S/851.html#L946'>req</a>               946 ext/openssl/openssl.c 			req-&gt;priv_key_encrypt = 1;</span>
<span class='curline'><a href='../S/851.html#L950'>req</a>               950 ext/openssl/openssl.c 	if (req-&gt;priv_key_encrypt &amp;&amp; optional_args &amp;&amp; (item = zend_hash_str_find(Z_ARRVAL_P(optional_args), "encrypt_key_cipher", sizeof("encrypt_key_cipher")-1)) != NULL</span>
<span class='curline'><a href='../S/851.html#L958'>req</a>               958 ext/openssl/openssl.c 			req-&gt;priv_key_encrypt_cipher = cipher;</span>
<span class='curline'><a href='../S/851.html#L961'>req</a>               961 ext/openssl/openssl.c 		req-&gt;priv_key_encrypt_cipher = NULL;</span>
<span class='curline'><a href='../S/851.html#L967'>req</a>               967 ext/openssl/openssl.c 	if (req-&gt;digest_name == NULL) {</span>
<span class='curline'><a href='../S/851.html#L968'>req</a>               968 ext/openssl/openssl.c 		req-&gt;digest_name = CONF_get_string(req-&gt;req_config, req-&gt;section_name, "default_md");</span>
<span class='curline'><a href='../S/851.html#L970'>req</a>               970 ext/openssl/openssl.c 	if (req-&gt;digest_name) {</span>
<span class='curline'><a href='../S/851.html#L971'>req</a>               971 ext/openssl/openssl.c 		req-&gt;digest = req-&gt;md_alg = EVP_get_digestbyname(req-&gt;digest_name);</span>
<span class='curline'><a href='../S/851.html#L973'>req</a>               973 ext/openssl/openssl.c 	if (req-&gt;md_alg == NULL) {</span>
<span class='curline'><a href='../S/851.html#L974'>req</a>               974 ext/openssl/openssl.c 		req-&gt;md_alg = req-&gt;digest = EVP_sha1();</span>
<span class='curline'><a href='../S/851.html#L980'>req</a>               980 ext/openssl/openssl.c 	str = CONF_get_string(req-&gt;req_config, req-&gt;section_name, "string_mask");</span>
<span class='curline'><a href='../S/851.html#L992'>req</a>               992 ext/openssl/openssl.c static void php_openssl_dispose_config(struct php_x509_request * req) /* {{{ */</span>
<span class='curline'><a href='../S/851.html#L994'>req</a>               994 ext/openssl/openssl.c 	if (req-&gt;priv_key) {</span>
<span class='curline'><a href='../S/851.html#L995'>req</a>               995 ext/openssl/openssl.c 		EVP_PKEY_free(req-&gt;priv_key);</span>
<span class='curline'><a href='../S/851.html#L996'>req</a>               996 ext/openssl/openssl.c 		req-&gt;priv_key = NULL;</span>
<span class='curline'><a href='../S/851.html#L998'>req</a>               998 ext/openssl/openssl.c 	if (req-&gt;global_config) {</span>
<span class='curline'><a href='../S/851.html#L999'>req</a>               999 ext/openssl/openssl.c 		CONF_free(req-&gt;global_config);</span>
<span class='curline'><a href='../S/851.html#L1000'>req</a>              1000 ext/openssl/openssl.c 		req-&gt;global_config = NULL;</span>
<span class='curline'><a href='../S/851.html#L1002'>req</a>              1002 ext/openssl/openssl.c 	if (req-&gt;req_config) {</span>
<span class='curline'><a href='../S/851.html#L1003'>req</a>              1003 ext/openssl/openssl.c 		CONF_free(req-&gt;req_config);</span>
<span class='curline'><a href='../S/851.html#L1004'>req</a>              1004 ext/openssl/openssl.c 		req-&gt;req_config = NULL;</span>
<span class='curline'><a href='../S/851.html#L2661'>req</a>              2661 ext/openssl/openssl.c static int php_openssl_make_REQ(struct php_x509_request * req, X509_REQ * csr, zval * dn, zval * attribs)</span>
<span class='curline'><a href='../S/851.html#L2666'>req</a>              2666 ext/openssl/openssl.c 	dn_sect = CONF_get_string(req-&gt;req_config, req-&gt;section_name, "distinguished_name");</span>
<span class='curline'><a href='../S/851.html#L2670'>req</a>              2670 ext/openssl/openssl.c 	dn_sk = CONF_get_section(req-&gt;req_config, dn_sect);</span>
<span class='curline'><a href='../S/851.html#L2674'>req</a>              2674 ext/openssl/openssl.c 	attr_sect = CONF_get_string(req-&gt;req_config, req-&gt;section_name, "attributes");</span>
<span class='curline'><a href='../S/851.html#L2678'>req</a>              2678 ext/openssl/openssl.c 		attr_sk = CONF_get_section(req-&gt;req_config, attr_sect);</span>
<span class='curline'><a href='../S/851.html#L2801'>req</a>              2801 ext/openssl/openssl.c 	X509_REQ_set_pubkey(csr, req-&gt;priv_key);</span>
<span class='curline'><a href='../S/851.html#L2954'>req</a>              2954 ext/openssl/openssl.c 	struct php_x509_request req;</span>
<span class='curline'><a href='../S/851.html#L2960'>req</a>              2960 ext/openssl/openssl.c 	PHP_SSL_REQ_INIT(&amp;req);</span>
<span class='curline'><a href='../S/851.html#L2984'>req</a>              2984 ext/openssl/openssl.c 	if (PHP_SSL_REQ_PARSE(&amp;req, args) == FAILURE) {</span>
<span class='curline'><a href='../S/851.html#L3032'>req</a>              3032 ext/openssl/openssl.c 	if (req.extensions_section) {</span>
<span class='curline'><a href='../S/851.html#L3036'>req</a>              3036 ext/openssl/openssl.c 		X509V3_set_conf_lhash(&amp;ctx, req.req_config);</span>
<span class='curline'><a href='../S/851.html#L3037'>req</a>              3037 ext/openssl/openssl.c 		if (!X509V3_EXT_add_conf(req.req_config, &amp;ctx, req.extensions_section, new_cert)) {</span>
<span class='curline'><a href='../S/851.html#L3043'>req</a>              3043 ext/openssl/openssl.c 	if (!X509_sign(new_cert, priv_key, req.digest)) {</span>
<span class='curline'><a href='../S/851.html#L3057'>req</a>              3057 ext/openssl/openssl.c 	PHP_SSL_REQ_DISPOSE(&amp;req);</span>
<span class='curline'><a href='../S/851.html#L3081'>req</a>              3081 ext/openssl/openssl.c 	struct php_x509_request req;</span>
<span class='curline'><a href='../S/851.html#L3093'>req</a>              3093 ext/openssl/openssl.c 	PHP_SSL_REQ_INIT(&amp;req);</span>
<span class='curline'><a href='../S/851.html#L3095'>req</a>              3095 ext/openssl/openssl.c 	if (PHP_SSL_REQ_PARSE(&amp;req, args) == SUCCESS) {</span>
<span class='curline'><a href='../S/851.html#L3098'>req</a>              3098 ext/openssl/openssl.c 			req.priv_key = php_openssl_evp_from_zval(out_pkey, 0, NULL, 0, &amp;key_resource);</span>
<span class='curline'><a href='../S/851.html#L3099'>req</a>              3099 ext/openssl/openssl.c 			if (req.priv_key != NULL) {</span>
<span class='curline'><a href='../S/851.html#L3103'>req</a>              3103 ext/openssl/openssl.c 		if (req.priv_key == NULL) {</span>
<span class='curline'><a href='../S/851.html#L3104'>req</a>              3104 ext/openssl/openssl.c 			php_openssl_generate_private_key(&amp;req);</span>
<span class='curline'><a href='../S/851.html#L3106'>req</a>              3106 ext/openssl/openssl.c 		if (req.priv_key == NULL) {</span>
<span class='curline'><a href='../S/851.html#L3111'>req</a>              3111 ext/openssl/openssl.c 				if (php_openssl_make_REQ(&amp;req, csr, dn, attribs) == SUCCESS) {</span>
<span class='curline'><a href='../S/851.html#L3115'>req</a>              3115 ext/openssl/openssl.c 					X509V3_set_conf_lhash(&amp;ext_ctx, req.req_config);</span>
<span class='curline'><a href='../S/851.html#L3118'>req</a>              3118 ext/openssl/openssl.c 					if (req.request_extensions_section &amp;&amp; !X509V3_EXT_REQ_add_conf(req.req_config,</span>
<span class='curline'><a href='../S/851.html#L3119'>req</a>              3119 ext/openssl/openssl.c 								&amp;ext_ctx, req.request_extensions_section, csr))</span>
<span class='curline'><a href='../S/851.html#L3121'>req</a>              3121 ext/openssl/openssl.c 						php_error_docref(NULL, E_WARNING, "Error loading extension section %s", req.request_extensions_section);</span>
<span class='curline'><a href='../S/851.html#L3125'>req</a>              3125 ext/openssl/openssl.c 						if (X509_REQ_sign(csr, req.priv_key, req.digest)) {</span>
<span class='curline'><a href='../S/851.html#L3135'>req</a>              3135 ext/openssl/openssl.c 							ZVAL_RES(out_pkey, zend_register_resource(req.priv_key, le_key));</span>
<span class='curline'><a href='../S/851.html#L3136'>req</a>              3136 ext/openssl/openssl.c 							req.priv_key = NULL; /* make sure the cleanup code doesn't zap it! */</span>
<span class='curline'><a href='../S/851.html#L3138'>req</a>              3138 ext/openssl/openssl.c 							req.priv_key = NULL; /* make sure the cleanup code doesn't zap it! */</span>
<span class='curline'><a href='../S/851.html#L3145'>req</a>              3145 ext/openssl/openssl.c 						req.priv_key = NULL;</span>
<span class='curline'><a href='../S/851.html#L3154'>req</a>              3154 ext/openssl/openssl.c 	PHP_SSL_REQ_DISPOSE(&amp;req);</span>
<span class='curline'><a href='../S/851.html#L3387'>req</a>              3387 ext/openssl/openssl.c static EVP_PKEY * php_openssl_generate_private_key(struct php_x509_request * req)</span>
<span class='curline'><a href='../S/851.html#L3393'>req</a>              3393 ext/openssl/openssl.c 	if (req-&gt;priv_key_bits &lt; MIN_KEY_LENGTH) {</span>
<span class='curline'><a href='../S/851.html#L3395'>req</a>              3395 ext/openssl/openssl.c 				MIN_KEY_LENGTH, req-&gt;priv_key_bits);</span>
<span class='curline'><a href='../S/851.html#L3399'>req</a>              3399 ext/openssl/openssl.c 	randfile = CONF_get_string(req-&gt;req_config, req-&gt;section_name, "RANDFILE");</span>
<span class='curline'><a href='../S/851.html#L3402'>req</a>              3402 ext/openssl/openssl.c 	if ((req-&gt;priv_key = EVP_PKEY_new()) != NULL) {</span>
<span class='curline'><a href='../S/851.html#L3403'>req</a>              3403 ext/openssl/openssl.c 		switch(req-&gt;priv_key_type) {</span>
<span class='curline'><a href='../S/851.html#L3409'>req</a>              3409 ext/openssl/openssl.c 					rsaparam = (RSA*)RSA_generate_key(req-&gt;priv_key_bits, RSA_F4, NULL, NULL);</span>
<span class='curline'><a href='../S/851.html#L3419'>req</a>              3419 ext/openssl/openssl.c 						RSA_generate_key_ex(rsaparam, req-&gt;priv_key_bits, bne, NULL);</span>
<span class='curline'><a href='../S/851.html#L3423'>req</a>              3423 ext/openssl/openssl.c 					if (rsaparam &amp;&amp; EVP_PKEY_assign_RSA(req-&gt;priv_key, rsaparam)) {</span>
<span class='curline'><a href='../S/851.html#L3424'>req</a>              3424 ext/openssl/openssl.c 						return_val = req-&gt;priv_key;</span>
<span class='curline'><a href='../S/851.html#L3433'>req</a>              3433 ext/openssl/openssl.c 					dsaparam = DSA_generate_parameters(req-&gt;priv_key_bits, NULL, 0, NULL, NULL, NULL, NULL);</span>
<span class='curline'><a href='../S/851.html#L3435'>req</a>              3435 ext/openssl/openssl.c 					DSA_generate_parameters_ex(dsaparam, req-&gt;priv_key_bits, NULL, 0, NULL, NULL, NULL);</span>
<span class='curline'><a href='../S/851.html#L3440'>req</a>              3440 ext/openssl/openssl.c 							if (EVP_PKEY_assign_DSA(req-&gt;priv_key, dsaparam)) {</span>
<span class='curline'><a href='../S/851.html#L3441'>req</a>              3441 ext/openssl/openssl.c 								return_val = req-&gt;priv_key;</span>
<span class='curline'><a href='../S/851.html#L3456'>req</a>              3456 ext/openssl/openssl.c 					dhparam = DH_generate_parameters(req-&gt;priv_key_bits, 2, NULL, NULL);</span>
<span class='curline'><a href='../S/851.html#L3458'>req</a>              3458 ext/openssl/openssl.c 					DH_generate_parameters_ex(dhparam, req-&gt;priv_key_bits, 2, NULL);</span>
<span class='curline'><a href='../S/851.html#L3463'>req</a>              3463 ext/openssl/openssl.c 							if (EVP_PKEY_assign_DH(req-&gt;priv_key, dhparam)) {</span>
<span class='curline'><a href='../S/851.html#L3464'>req</a>              3464 ext/openssl/openssl.c 								return_val = req-&gt;priv_key;</span>
<span class='curline'><a href='../S/851.html#L3481'>req</a>              3481 ext/openssl/openssl.c 		EVP_PKEY_free(req-&gt;priv_key);</span>
<span class='curline'><a href='../S/851.html#L3482'>req</a>              3482 ext/openssl/openssl.c 		req-&gt;priv_key = NULL;</span>
<span class='curline'><a href='../S/851.html#L3570'>req</a>              3570 ext/openssl/openssl.c 	struct php_x509_request req;</span>
<span class='curline'><a href='../S/851.html#L3654'>req</a>              3654 ext/openssl/openssl.c 	PHP_SSL_REQ_INIT(&amp;req);</span>
<span class='curline'><a href='../S/851.html#L3656'>req</a>              3656 ext/openssl/openssl.c 	if (PHP_SSL_REQ_PARSE(&amp;req, args) == SUCCESS)</span>
<span class='curline'><a href='../S/851.html#L3658'>req</a>              3658 ext/openssl/openssl.c 		if (php_openssl_generate_private_key(&amp;req)) {</span>
<span class='curline'><a href='../S/851.html#L3660'>req</a>              3660 ext/openssl/openssl.c 			RETVAL_RES(zend_register_resource(req.priv_key, le_key));</span>
<span class='curline'><a href='../S/851.html#L3662'>req</a>              3662 ext/openssl/openssl.c 			req.priv_key = NULL;</span>
<span class='curline'><a href='../S/851.html#L3665'>req</a>              3665 ext/openssl/openssl.c 	PHP_SSL_REQ_DISPOSE(&amp;req);</span>
<span class='curline'><a href='../S/851.html#L3673'>req</a>              3673 ext/openssl/openssl.c 	struct php_x509_request req;</span>
<span class='curline'><a href='../S/851.html#L3703'>req</a>              3703 ext/openssl/openssl.c 	PHP_SSL_REQ_INIT(&amp;req);</span>
<span class='curline'><a href='../S/851.html#L3705'>req</a>              3705 ext/openssl/openssl.c 	if (PHP_SSL_REQ_PARSE(&amp;req, args) == SUCCESS) {</span>
<span class='curline'><a href='../S/851.html#L3708'>req</a>              3708 ext/openssl/openssl.c 		if (passphrase &amp;&amp; req.priv_key_encrypt) {</span>
<span class='curline'><a href='../S/851.html#L3709'>req</a>              3709 ext/openssl/openssl.c 			if (req.priv_key_encrypt_cipher) {</span>
<span class='curline'><a href='../S/851.html#L3710'>req</a>              3710 ext/openssl/openssl.c 				cipher = req.priv_key_encrypt_cipher;</span>
<span class='curline'><a href='../S/851.html#L3735'>req</a>              3735 ext/openssl/openssl.c 	PHP_SSL_REQ_DISPOSE(&amp;req);</span>
<span class='curline'><a href='../S/851.html#L3750'>req</a>              3750 ext/openssl/openssl.c 	struct php_x509_request req;</span>
<span class='curline'><a href='../S/851.html#L3773'>req</a>              3773 ext/openssl/openssl.c 	PHP_SSL_REQ_INIT(&amp;req);</span>
<span class='curline'><a href='../S/851.html#L3775'>req</a>              3775 ext/openssl/openssl.c 	if (PHP_SSL_REQ_PARSE(&amp;req, args) == SUCCESS) {</span>
<span class='curline'><a href='../S/851.html#L3778'>req</a>              3778 ext/openssl/openssl.c 		if (passphrase &amp;&amp; req.priv_key_encrypt) {</span>
<span class='curline'><a href='../S/851.html#L3779'>req</a>              3779 ext/openssl/openssl.c 			if (req.priv_key_encrypt_cipher) {</span>
<span class='curline'><a href='../S/851.html#L3780'>req</a>              3780 ext/openssl/openssl.c 				cipher = req.priv_key_encrypt_cipher;</span>
<span class='curline'><a href='../S/851.html#L3812'>req</a>              3812 ext/openssl/openssl.c 	PHP_SSL_REQ_DISPOSE(&amp;req);</span>
<span class='curline'><a href='../S/982.html#L150'>req</a>               150 ext/recode/recode.c 	char *req, *str;</span>
<span class='curline'><a href='../S/982.html#L152'>req</a>               152 ext/recode/recode.c 	if (zend_parse_parameters(ZEND_NUM_ARGS(), "ss", &amp;req, &amp;req_len, &amp;str, &amp;str_len) == FAILURE) {</span>
<span class='curline'><a href='../S/982.html#L163'>req</a>               163 ext/recode/recode.c 	if (!recode_scan_request(request, req)) {</span>
<span class='curline'><a href='../S/982.html#L164'>req</a>               164 ext/recode/recode.c 		php_error_docref(NULL, E_WARNING, "Illegal recode request '%s'", req);</span>
<span class='curline'><a href='../S/982.html#L189'>req</a>               189 ext/recode/recode.c 	char *req;</span>
<span class='curline'><a href='../S/982.html#L195'>req</a>               195 ext/recode/recode.c 	if (zend_parse_parameters(ZEND_NUM_ARGS(), "srr", &amp;req, &amp;req_len, &amp;input, &amp;output) == FAILURE) {</span>
<span class='curline'><a href='../S/982.html#L216'>req</a>               216 ext/recode/recode.c 	if (!recode_scan_request(request, req)) {</span>
<span class='curline'><a href='../S/982.html#L217'>req</a>               217 ext/recode/recode.c 		php_error_docref(NULL, E_WARNING, "Illegal recode request '%s'", req);</span>
<span class='curline'><a href='../S/1232.html#L747'>req</a>               747 ext/xmlrpc/libxmlrpc/xmlrpc.c    XMLRPC_REQUEST req = XMLRPC_REQUEST_FromXML(in_buf, len, in_options);</span>
<span class='curline'><a href='../S/1232.html#L749'>req</a>               749 ext/xmlrpc/libxmlrpc/xmlrpc.c    if(req) {</span>
<span class='curline'><a href='../S/1232.html#L750'>req</a>               750 ext/xmlrpc/libxmlrpc/xmlrpc.c       xResponse = req-&gt;io;</span>
<span class='curline'><a href='../S/1232.html#L751'>req</a>               751 ext/xmlrpc/libxmlrpc/xmlrpc.c       XMLRPC_RequestFree(req, 0);</span>
<span class='curline'><a href='../S/1366.html#L877'>req</a>               877 main/fastcgi.c 	fcgi_request *req = calloc(1, sizeof(fcgi_request));</span>
<span class='curline'><a href='../S/1366.html#L878'>req</a>               878 main/fastcgi.c 	req-&gt;listen_socket = listen_socket;</span>
<span class='curline'><a href='../S/1366.html#L879'>req</a>               879 main/fastcgi.c 	req-&gt;fd = -1;</span>
<span class='curline'><a href='../S/1366.html#L880'>req</a>               880 main/fastcgi.c 	req-&gt;id = -1;</span>
<span class='curline'><a href='../S/1366.html#L896'>req</a>               896 main/fastcgi.c 	req-&gt;out_pos = req-&gt;out_buf;</span>
<span class='curline'><a href='../S/1366.html#L897'>req</a>               897 main/fastcgi.c 	req-&gt;hook.on_accept = on_accept ? on_accept : fcgi_hook_dummy;</span>
<span class='curline'><a href='../S/1366.html#L898'>req</a>               898 main/fastcgi.c 	req-&gt;hook.on_read = on_read ? on_read : fcgi_hook_dummy;</span>
<span class='curline'><a href='../S/1366.html#L899'>req</a>               899 main/fastcgi.c 	req-&gt;hook.on_close = on_close ? on_close : fcgi_hook_dummy;</span>
<span class='curline'><a href='../S/1366.html#L902'>req</a>               902 main/fastcgi.c 	req-&gt;tcp = !GetNamedPipeInfo((HANDLE)_get_osfhandle(req-&gt;listen_socket), NULL, NULL, NULL, NULL);</span>
<span class='curline'><a href='../S/1366.html#L905'>req</a>               905 main/fastcgi.c 	fcgi_hash_init(&amp;req-&gt;env);</span>
<span class='curline'><a href='../S/1366.html#L907'>req</a>               907 main/fastcgi.c 	return req;</span>
<span class='curline'><a href='../S/1366.html#L910'>req</a>               910 main/fastcgi.c void fcgi_destroy_request(fcgi_request *req) {</span>
<span class='curline'><a href='../S/1366.html#L911'>req</a>               911 main/fastcgi.c 	fcgi_hash_destroy(&amp;req-&gt;env);</span>
<span class='curline'><a href='../S/1366.html#L912'>req</a>               912 main/fastcgi.c 	free(req);</span>
<span class='curline'><a href='../S/1366.html#L915'>req</a>               915 main/fastcgi.c static inline ssize_t safe_write(fcgi_request *req, const void *buf, size_t count)</span>
<span class='curline'><a href='../S/1366.html#L928'>req</a>               928 main/fastcgi.c 		if (!req-&gt;tcp) {</span>
<span class='curline'><a href='../S/1366.html#L931'>req</a>               931 main/fastcgi.c 			ret = write(req-&gt;fd, ((char*)buf)+n, out_len);</span>
<span class='curline'><a href='../S/1366.html#L935'>req</a>               935 main/fastcgi.c 			ret = send(req-&gt;fd, ((char*)buf)+n, out_len, 0);</span>
<span class='curline'><a href='../S/1366.html#L941'>req</a>               941 main/fastcgi.c 		ret = write(req-&gt;fd, ((char*)buf)+n, count-n);</span>
<span class='curline'><a href='../S/1366.html#L952'>req</a>               952 main/fastcgi.c static inline ssize_t safe_read(fcgi_request *req, const void *buf, size_t count)</span>
<span class='curline'><a href='../S/1366.html#L965'>req</a>               965 main/fastcgi.c 		if (!req-&gt;tcp) {</span>
<span class='curline'><a href='../S/1366.html#L968'>req</a>               968 main/fastcgi.c 			ret = read(req-&gt;fd, ((char*)buf)+n, in_len);</span>
<span class='curline'><a href='../S/1366.html#L972'>req</a>               972 main/fastcgi.c 			ret = recv(req-&gt;fd, ((char*)buf)+n, in_len, 0);</span>
<span class='curline'><a href='../S/1366.html#L978'>req</a>               978 main/fastcgi.c 		ret = read(req-&gt;fd, ((char*)buf)+n, count-n);</span>
<span class='curline'><a href='../S/1366.html#L1009'>req</a>              1009 main/fastcgi.c static int fcgi_get_params(fcgi_request *req, unsigned char *p, unsigned char *end)</span>
<span class='curline'><a href='../S/1366.html#L1035'>req</a>              1035 main/fastcgi.c 		fcgi_hash_set(&amp;req-&gt;env, FCGI_HASH_FUNC(p, name_len), (char*)p, name_len, (char*)p + name_len, val_len);</span>
<span class='curline'><a href='../S/1366.html#L1041'>req</a>              1041 main/fastcgi.c static int fcgi_read_request(fcgi_request *req)</span>
<span class='curline'><a href='../S/1366.html#L1047'>req</a>              1047 main/fastcgi.c 	req-&gt;keep = 0;</span>
<span class='curline'><a href='../S/1366.html#L1048'>req</a>              1048 main/fastcgi.c 	req-&gt;closed = 0;</span>
<span class='curline'><a href='../S/1366.html#L1049'>req</a>              1049 main/fastcgi.c 	req-&gt;in_len = 0;</span>
<span class='curline'><a href='../S/1366.html#L1050'>req</a>              1050 main/fastcgi.c 	req-&gt;out_hdr = NULL;</span>
<span class='curline'><a href='../S/1366.html#L1051'>req</a>              1051 main/fastcgi.c 	req-&gt;out_pos = req-&gt;out_buf;</span>
<span class='curline'><a href='../S/1366.html#L1052'>req</a>              1052 main/fastcgi.c 	req-&gt;has_env = 1;</span>
<span class='curline'><a href='../S/1366.html#L1054'>req</a>              1054 main/fastcgi.c 	if (safe_read(req, &amp;hdr, sizeof(fcgi_header)) != sizeof(fcgi_header) ||</span>
<span class='curline'><a href='../S/1366.html#L1063'>req</a>              1063 main/fastcgi.c 		if (safe_read(req, &amp;hdr, sizeof(fcgi_header)) != sizeof(fcgi_header) ||</span>
<span class='curline'><a href='../S/1366.html#L1076'>req</a>              1076 main/fastcgi.c 	req-&gt;id = (hdr.requestIdB1 &lt;&lt; 8) + hdr.requestIdB0;</span>
<span class='curline'><a href='../S/1366.html#L1079'>req</a>              1079 main/fastcgi.c 		if (safe_read(req, buf, len+padding) != len+padding) {</span>
<span class='curline'><a href='../S/1366.html#L1083'>req</a>              1083 main/fastcgi.c 		req-&gt;keep = (((fcgi_begin_request*)buf)-&gt;flags &amp; FCGI_KEEP_CONN);</span>
<span class='curline'><a href='../S/1366.html#L1085'>req</a>              1085 main/fastcgi.c 		if (req-&gt;keep &amp;&amp; req-&gt;tcp &amp;&amp; !req-&gt;nodelay) {</span>
<span class='curline'><a href='../S/1366.html#L1092'>req</a>              1092 main/fastcgi.c 			setsockopt(req-&gt;fd, IPPROTO_TCP, TCP_NODELAY, (char*)&amp;on, sizeof(on));</span>
<span class='curline'><a href='../S/1366.html#L1093'>req</a>              1093 main/fastcgi.c 			req-&gt;nodelay = 1;</span>
<span class='curline'><a href='../S/1366.html#L1098'>req</a>              1098 main/fastcgi.c 				fcgi_hash_set(&amp;req-&gt;env, FCGI_HASH_FUNC("FCGI_ROLE", sizeof("FCGI_ROLE")-1), "FCGI_ROLE", sizeof("FCGI_ROLE")-1, "RESPONDER", sizeof("RESPONDER")-1);</span>
<span class='curline'><a href='../S/1366.html#L1101'>req</a>              1101 main/fastcgi.c 				fcgi_hash_set(&amp;req-&gt;env, FCGI_HASH_FUNC("FCGI_ROLE", sizeof("FCGI_ROLE")-1), "FCGI_ROLE", sizeof("FCGI_ROLE")-1, "AUTHORIZER", sizeof("AUTHORIZER")-1);</span>
<span class='curline'><a href='../S/1366.html#L1104'>req</a>              1104 main/fastcgi.c 				fcgi_hash_set(&amp;req-&gt;env, FCGI_HASH_FUNC("FCGI_ROLE", sizeof("FCGI_ROLE")-1), "FCGI_ROLE", sizeof("FCGI_ROLE")-1, "FILTER", sizeof("FILTER")-1);</span>
<span class='curline'><a href='../S/1366.html#L1110'>req</a>              1110 main/fastcgi.c 		if (safe_read(req, &amp;hdr, sizeof(fcgi_header)) != sizeof(fcgi_header) ||</span>
<span class='curline'><a href='../S/1366.html#L1123'>req</a>              1123 main/fastcgi.c 			if (safe_read(req, buf, len+padding) != len+padding) {</span>
<span class='curline'><a href='../S/1366.html#L1124'>req</a>              1124 main/fastcgi.c 				req-&gt;keep = 0;</span>
<span class='curline'><a href='../S/1366.html#L1128'>req</a>              1128 main/fastcgi.c 			if (!fcgi_get_params(req, buf, buf+len)) {</span>
<span class='curline'><a href='../S/1366.html#L1129'>req</a>              1129 main/fastcgi.c 				req-&gt;keep = 0;</span>
<span class='curline'><a href='../S/1366.html#L1133'>req</a>              1133 main/fastcgi.c 			if (safe_read(req, &amp;hdr, sizeof(fcgi_header)) != sizeof(fcgi_header) ||</span>
<span class='curline'><a href='../S/1366.html#L1135'>req</a>              1135 main/fastcgi.c 				req-&gt;keep = 0;</span>
<span class='curline'><a href='../S/1366.html#L1147'>req</a>              1147 main/fastcgi.c 		if (safe_read(req, buf, len+padding) != len+padding) {</span>
<span class='curline'><a href='../S/1366.html#L1148'>req</a>              1148 main/fastcgi.c 			req-&gt;keep = 0;</span>
<span class='curline'><a href='../S/1366.html#L1152'>req</a>              1152 main/fastcgi.c 		if (!fcgi_get_params(req, buf, buf+len)) {</span>
<span class='curline'><a href='../S/1366.html#L1153'>req</a>              1153 main/fastcgi.c 			req-&gt;keep = 0;</span>
<span class='curline'><a href='../S/1366.html#L1157'>req</a>              1157 main/fastcgi.c 		q = req-&gt;env.list;</span>
<span class='curline'><a href='../S/1366.html#L1191'>req</a>              1191 main/fastcgi.c 		if (safe_write(req, buf, sizeof(fcgi_header) + len) != (ssize_t)sizeof(fcgi_header)+len) {</span>
<span class='curline'><a href='../S/1366.html#L1192'>req</a>              1192 main/fastcgi.c 			req-&gt;keep = 0;</span>
<span class='curline'><a href='../S/1366.html#L1203'>req</a>              1203 main/fastcgi.c int fcgi_read(fcgi_request *req, char *str, int len)</span>
<span class='curline'><a href='../S/1366.html#L1212'>req</a>              1212 main/fastcgi.c 		if (req-&gt;in_len == 0) {</span>
<span class='curline'><a href='../S/1366.html#L1213'>req</a>              1213 main/fastcgi.c 			if (safe_read(req, &amp;hdr, sizeof(fcgi_header)) != sizeof(fcgi_header) ||</span>
<span class='curline'><a href='../S/1366.html#L1216'>req</a>              1216 main/fastcgi.c 				req-&gt;keep = 0;</span>
<span class='curline'><a href='../S/1366.html#L1219'>req</a>              1219 main/fastcgi.c 			req-&gt;in_len = (hdr.contentLengthB1 &lt;&lt; 8) | hdr.contentLengthB0;</span>
<span class='curline'><a href='../S/1366.html#L1220'>req</a>              1220 main/fastcgi.c 			req-&gt;in_pad = hdr.paddingLength;</span>
<span class='curline'><a href='../S/1366.html#L1221'>req</a>              1221 main/fastcgi.c 			if (req-&gt;in_len == 0) {</span>
<span class='curline'><a href='../S/1366.html#L1226'>req</a>              1226 main/fastcgi.c 		if (req-&gt;in_len &gt;= rest) {</span>
<span class='curline'><a href='../S/1366.html#L1227'>req</a>              1227 main/fastcgi.c 			ret = (int)safe_read(req, str, rest);</span>
<span class='curline'><a href='../S/1366.html#L1229'>req</a>              1229 main/fastcgi.c 			ret = (int)safe_read(req, str, req-&gt;in_len);</span>
<span class='curline'><a href='../S/1366.html#L1232'>req</a>              1232 main/fastcgi.c 			req-&gt;keep = 0;</span>
<span class='curline'><a href='../S/1366.html#L1235'>req</a>              1235 main/fastcgi.c 			req-&gt;in_len -= ret;</span>
<span class='curline'><a href='../S/1366.html#L1239'>req</a>              1239 main/fastcgi.c 			if (req-&gt;in_len == 0) {</span>
<span class='curline'><a href='../S/1366.html#L1240'>req</a>              1240 main/fastcgi.c 				if (req-&gt;in_pad) {</span>
<span class='curline'><a href='../S/1366.html#L1241'>req</a>              1241 main/fastcgi.c 					if (safe_read(req, buf, req-&gt;in_pad) != req-&gt;in_pad) {</span>
<span class='curline'><a href='../S/1366.html#L1242'>req</a>              1242 main/fastcgi.c 						req-&gt;keep = 0;</span>
<span class='curline'><a href='../S/1366.html#L1256'>req</a>              1256 main/fastcgi.c void fcgi_close(fcgi_request *req, int force, int destroy)</span>
<span class='curline'><a href='../S/1366.html#L1258'>req</a>              1258 main/fastcgi.c 	if (destroy &amp;&amp; req-&gt;has_env) {</span>
<span class='curline'><a href='../S/1366.html#L1259'>req</a>              1259 main/fastcgi.c 		fcgi_hash_clean(&amp;req-&gt;env);</span>
<span class='curline'><a href='../S/1366.html#L1260'>req</a>              1260 main/fastcgi.c 		req-&gt;has_env = 0;</span>
<span class='curline'><a href='../S/1366.html#L1264'>req</a>              1264 main/fastcgi.c 	if (is_impersonate &amp;&amp; !req-&gt;tcp) {</span>
<span class='curline'><a href='../S/1366.html#L1269'>req</a>              1269 main/fastcgi.c 	if ((force || !req-&gt;keep) &amp;&amp; req-&gt;fd &gt;= 0) {</span>
<span class='curline'><a href='../S/1366.html#L1271'>req</a>              1271 main/fastcgi.c 		if (!req-&gt;tcp) {</span>
<span class='curline'><a href='../S/1366.html#L1272'>req</a>              1272 main/fastcgi.c 			HANDLE pipe = (HANDLE)_get_osfhandle(req-&gt;fd);</span>
<span class='curline'><a href='../S/1366.html#L1282'>req</a>              1282 main/fastcgi.c 				shutdown(req-&gt;fd, 1);</span>
<span class='curline'><a href='../S/1366.html#L1284'>req</a>              1284 main/fastcgi.c 				while (recv(req-&gt;fd, buf, sizeof(buf), 0) &gt; 0) {}</span>
<span class='curline'><a href='../S/1366.html#L1286'>req</a>              1286 main/fastcgi.c 			closesocket(req-&gt;fd);</span>
<span class='curline'><a href='../S/1366.html#L1292'>req</a>              1292 main/fastcgi.c 			shutdown(req-&gt;fd, 1);</span>
<span class='curline'><a href='../S/1366.html#L1294'>req</a>              1294 main/fastcgi.c 			while (recv(req-&gt;fd, buf, sizeof(buf), 0) &gt; 0) {}</span>
<span class='curline'><a href='../S/1366.html#L1296'>req</a>              1296 main/fastcgi.c 		close(req-&gt;fd);</span>
<span class='curline'><a href='../S/1366.html#L1299'>req</a>              1299 main/fastcgi.c 		req-&gt;nodelay = 0;</span>
<span class='curline'><a href='../S/1366.html#L1301'>req</a>              1301 main/fastcgi.c 		req-&gt;fd = -1;</span>
<span class='curline'><a href='../S/1366.html#L1303'>req</a>              1303 main/fastcgi.c 		req-&gt;hook.on_close();</span>
<span class='curline'><a href='../S/1366.html#L1307'>req</a>              1307 main/fastcgi.c int fcgi_is_closed(fcgi_request *req)</span>
<span class='curline'><a href='../S/1366.html#L1309'>req</a>              1309 main/fastcgi.c 	return (req-&gt;fd &lt; 0);</span>
<span class='curline'><a href='../S/1366.html#L1350'>req</a>              1350 main/fastcgi.c int fcgi_accept_request(fcgi_request *req)</span>
<span class='curline'><a href='../S/1366.html#L1358'>req</a>              1358 main/fastcgi.c 		if (req-&gt;fd &lt; 0) {</span>
<span class='curline'><a href='../S/1366.html#L1364'>req</a>              1364 main/fastcgi.c 				if (!req-&gt;tcp) {</span>
<span class='curline'><a href='../S/1366.html#L1365'>req</a>              1365 main/fastcgi.c 					pipe = (HANDLE)_get_osfhandle(req-&gt;listen_socket);</span>
<span class='curline'><a href='../S/1366.html#L1366'>req</a>              1366 main/fastcgi.c 					FCGI_LOCK(req-&gt;listen_socket);</span>
<span class='curline'><a href='../S/1366.html#L1374'>req</a>              1374 main/fastcgi.c 									FCGI_UNLOCK(req-&gt;listen_socket);</span>
<span class='curline'><a href='../S/1366.html#L1382'>req</a>              1382 main/fastcgi.c 					req-&gt;fd = req-&gt;listen_socket;</span>
<span class='curline'><a href='../S/1366.html#L1383'>req</a>              1383 main/fastcgi.c 					FCGI_UNLOCK(req-&gt;listen_socket);</span>
<span class='curline'><a href='../S/1366.html#L1385'>req</a>              1385 main/fastcgi.c 					SOCKET listen_socket = (SOCKET)_get_osfhandle(req-&gt;listen_socket);</span>
<span class='curline'><a href='../S/1366.html#L1388'>req</a>              1388 main/fastcgi.c 					int listen_socket = req-&gt;listen_socket;</span>
<span class='curline'><a href='../S/1366.html#L1393'>req</a>              1393 main/fastcgi.c 					req-&gt;hook.on_accept();</span>
<span class='curline'><a href='../S/1366.html#L1395'>req</a>              1395 main/fastcgi.c 					FCGI_LOCK(req-&gt;listen_socket);</span>
<span class='curline'><a href='../S/1366.html#L1396'>req</a>              1396 main/fastcgi.c 					req-&gt;fd = accept(listen_socket, (struct sockaddr *)&amp;sa, &amp;len);</span>
<span class='curline'><a href='../S/1366.html#L1397'>req</a>              1397 main/fastcgi.c 					FCGI_UNLOCK(req-&gt;listen_socket);</span>
<span class='curline'><a href='../S/1366.html#L1400'>req</a>              1400 main/fastcgi.c 					if (req-&gt;fd &gt;= 0 &amp;&amp; !fcgi_is_allowed()) {</span>
<span class='curline'><a href='../S/1366.html#L1402'>req</a>              1402 main/fastcgi.c 						closesocket(req-&gt;fd);</span>
<span class='curline'><a href='../S/1366.html#L1403'>req</a>              1403 main/fastcgi.c 						req-&gt;fd = -1;</span>
<span class='curline'><a href='../S/1366.html#L1409'>req</a>              1409 main/fastcgi.c 				if (req-&gt;fd &lt; 0 &amp;&amp; (in_shutdown || errno != EINTR)) {</span>
<span class='curline'><a href='../S/1366.html#L1411'>req</a>              1411 main/fastcgi.c 				if (req-&gt;fd &lt; 0 &amp;&amp; (in_shutdown || (errno != EINTR &amp;&amp; errno != ECONNABORTED))) {</span>
<span class='curline'><a href='../S/1366.html#L1419'>req</a>              1419 main/fastcgi.c 				if (req-&gt;fd &gt;= 0) {</span>
<span class='curline'><a href='../S/1366.html#L1424'>req</a>              1424 main/fastcgi.c 					req-&gt;hook.on_read();</span>
<span class='curline'><a href='../S/1366.html#L1426'>req</a>              1426 main/fastcgi.c 					fds.fd = req-&gt;fd;</span>
<span class='curline'><a href='../S/1366.html#L1436'>req</a>              1436 main/fastcgi.c 					fcgi_close(req, 1, 0);</span>
<span class='curline'><a href='../S/1366.html#L1438'>req</a>              1438 main/fastcgi.c 					req-&gt;hook.on_read();</span>
<span class='curline'><a href='../S/1366.html#L1440'>req</a>              1440 main/fastcgi.c 					if (req-&gt;fd &lt; FD_SETSIZE) {</span>
<span class='curline'><a href='../S/1366.html#L1446'>req</a>              1446 main/fastcgi.c 						FD_SET(req-&gt;fd, &amp;set);</span>
<span class='curline'><a href='../S/1366.html#L1449'>req</a>              1449 main/fastcgi.c 							ret = select(req-&gt;fd + 1, &amp;set, NULL, NULL, &amp;tv) &gt;= 0;</span>
<span class='curline'><a href='../S/1366.html#L1451'>req</a>              1451 main/fastcgi.c 						if (ret &gt; 0 &amp;&amp; FD_ISSET(req-&gt;fd, &amp;set)) {</span>
<span class='curline'><a href='../S/1366.html#L1454'>req</a>              1454 main/fastcgi.c 						fcgi_close(req, 1, 0);</span>
<span class='curline'><a href='../S/1366.html#L1457'>req</a>              1457 main/fastcgi.c 						fcgi_close(req, 1, 0);</span>
<span class='curline'><a href='../S/1366.html#L1466'>req</a>              1466 main/fastcgi.c 		if (fcgi_read_request(req)) {</span>
<span class='curline'><a href='../S/1366.html#L1468'>req</a>              1468 main/fastcgi.c 			if (is_impersonate &amp;&amp; !req-&gt;tcp) {</span>
<span class='curline'><a href='../S/1366.html#L1469'>req</a>              1469 main/fastcgi.c 				pipe = (HANDLE)_get_osfhandle(req-&gt;fd);</span>
<span class='curline'><a href='../S/1366.html#L1471'>req</a>              1471 main/fastcgi.c 					fcgi_close(req, 1, 1);</span>
<span class='curline'><a href='../S/1366.html#L1476'>req</a>              1476 main/fastcgi.c 			return req-&gt;fd;</span>
<span class='curline'><a href='../S/1366.html#L1478'>req</a>              1478 main/fastcgi.c 			fcgi_close(req, 1, 1);</span>
<span class='curline'><a href='../S/1366.html#L1483'>req</a>              1483 main/fastcgi.c static inline fcgi_header* open_packet(fcgi_request *req, fcgi_request_type type)</span>
<span class='curline'><a href='../S/1366.html#L1485'>req</a>              1485 main/fastcgi.c 	req-&gt;out_hdr = (fcgi_header*) req-&gt;out_pos;</span>
<span class='curline'><a href='../S/1366.html#L1486'>req</a>              1486 main/fastcgi.c 	req-&gt;out_hdr-&gt;type = type;</span>
<span class='curline'><a href='../S/1366.html#L1487'>req</a>              1487 main/fastcgi.c 	req-&gt;out_pos += sizeof(fcgi_header);</span>
<span class='curline'><a href='../S/1366.html#L1488'>req</a>              1488 main/fastcgi.c 	return req-&gt;out_hdr;</span>
<span class='curline'><a href='../S/1366.html#L1491'>req</a>              1491 main/fastcgi.c static inline void close_packet(fcgi_request *req)</span>
<span class='curline'><a href='../S/1366.html#L1493'>req</a>              1493 main/fastcgi.c 	if (req-&gt;out_hdr) {</span>
<span class='curline'><a href='../S/1366.html#L1494'>req</a>              1494 main/fastcgi.c 		int len = (int)(req-&gt;out_pos - ((unsigned char*)req-&gt;out_hdr + sizeof(fcgi_header)));</span>
<span class='curline'><a href='../S/1366.html#L1496'>req</a>              1496 main/fastcgi.c 		req-&gt;out_pos += fcgi_make_header(req-&gt;out_hdr, (fcgi_request_type)req-&gt;out_hdr-&gt;type, req-&gt;id, len);</span>
<span class='curline'><a href='../S/1366.html#L1497'>req</a>              1497 main/fastcgi.c 		req-&gt;out_hdr = NULL;</span>
<span class='curline'><a href='../S/1366.html#L1501'>req</a>              1501 main/fastcgi.c int fcgi_flush(fcgi_request *req, int close)</span>
<span class='curline'><a href='../S/1366.html#L1505'>req</a>              1505 main/fastcgi.c 	close_packet(req);</span>
<span class='curline'><a href='../S/1366.html#L1507'>req</a>              1507 main/fastcgi.c 	len = (int)(req-&gt;out_pos - req-&gt;out_buf);</span>
<span class='curline'><a href='../S/1366.html#L1510'>req</a>              1510 main/fastcgi.c 		fcgi_end_request_rec *rec = (fcgi_end_request_rec*)(req-&gt;out_pos);</span>
<span class='curline'><a href='../S/1366.html#L1512'>req</a>              1512 main/fastcgi.c 		fcgi_make_header(&amp;rec-&gt;hdr, FCGI_END_REQUEST, req-&gt;id, sizeof(fcgi_end_request));</span>
<span class='curline'><a href='../S/1366.html#L1521'>req</a>              1521 main/fastcgi.c 	if (safe_write(req, req-&gt;out_buf, len) != len) {</span>
<span class='curline'><a href='../S/1366.html#L1522'>req</a>              1522 main/fastcgi.c 		req-&gt;keep = 0;</span>
<span class='curline'><a href='../S/1366.html#L1523'>req</a>              1523 main/fastcgi.c 		req-&gt;out_pos = req-&gt;out_buf;</span>
<span class='curline'><a href='../S/1366.html#L1527'>req</a>              1527 main/fastcgi.c 	req-&gt;out_pos = req-&gt;out_buf;</span>
<span class='curline'><a href='../S/1366.html#L1531'>req</a>              1531 main/fastcgi.c int fcgi_write(fcgi_request *req, fcgi_request_type type, const char *str, int len)</span>
<span class='curline'><a href='../S/1366.html#L1539'>req</a>              1539 main/fastcgi.c 	if (req-&gt;out_hdr &amp;&amp; req-&gt;out_hdr-&gt;type != type) {</span>
<span class='curline'><a href='../S/1366.html#L1540'>req</a>              1540 main/fastcgi.c 		close_packet(req);</span>
<span class='curline'><a href='../S/1366.html#L1546'>req</a>              1546 main/fastcgi.c 		limit = sizeof(req-&gt;out_buf) - (req-&gt;out_pos - req-&gt;out_buf);</span>
<span class='curline'><a href='../S/1366.html#L1548'>req</a>              1548 main/fastcgi.c 		if (!req-&gt;out_hdr) {</span>
<span class='curline'><a href='../S/1366.html#L1550'>req</a>              1550 main/fastcgi.c 				if (!fcgi_flush(req, 0)) {</span>
<span class='curline'><a href='../S/1366.html#L1554'>req</a>              1554 main/fastcgi.c 			open_packet(req, type);</span>
<span class='curline'><a href='../S/1366.html#L1556'>req</a>              1556 main/fastcgi.c 		limit = sizeof(req-&gt;out_buf) - (req-&gt;out_pos - req-&gt;out_buf);</span>
<span class='curline'><a href='../S/1366.html#L1558'>req</a>              1558 main/fastcgi.c 			memcpy(req-&gt;out_pos, str, rest);</span>
<span class='curline'><a href='../S/1366.html#L1559'>req</a>              1559 main/fastcgi.c 			req-&gt;out_pos += rest;</span>
<span class='curline'><a href='../S/1366.html#L1562'>req</a>              1562 main/fastcgi.c 			memcpy(req-&gt;out_pos, str, limit);</span>
<span class='curline'><a href='../S/1366.html#L1563'>req</a>              1563 main/fastcgi.c 			req-&gt;out_pos += limit;</span>
<span class='curline'><a href='../S/1366.html#L1566'>req</a>              1566 main/fastcgi.c 			if (!fcgi_flush(req, 0)) {</span>
<span class='curline'><a href='../S/1366.html#L1573'>req</a>              1573 main/fastcgi.c 	limit = (int)(sizeof(req-&gt;out_buf) - (req-&gt;out_pos - req-&gt;out_buf));</span>
<span class='curline'><a href='../S/1366.html#L1574'>req</a>              1574 main/fastcgi.c 	if (!req-&gt;out_hdr) {</span>
<span class='curline'><a href='../S/1366.html#L1580'>req</a>              1580 main/fastcgi.c 		if (!req-&gt;out_hdr) {</span>
<span class='curline'><a href='../S/1366.html#L1581'>req</a>              1581 main/fastcgi.c 			open_packet(req, type);</span>
<span class='curline'><a href='../S/1366.html#L1583'>req</a>              1583 main/fastcgi.c 		memcpy(req-&gt;out_pos, str, len);</span>
<span class='curline'><a href='../S/1366.html#L1584'>req</a>              1584 main/fastcgi.c 		req-&gt;out_pos += len;</span>
<span class='curline'><a href='../S/1366.html#L1585'>req</a>              1585 main/fastcgi.c 	} else if (len - limit &lt; sizeof(req-&gt;out_buf) - sizeof(fcgi_header)) {</span>
<span class='curline'><a href='../S/1366.html#L1586'>req</a>              1586 main/fastcgi.c 		if (!req-&gt;out_hdr) {</span>
<span class='curline'><a href='../S/1366.html#L1587'>req</a>              1587 main/fastcgi.c 			open_packet(req, type);</span>
<span class='curline'><a href='../S/1366.html#L1590'>req</a>              1590 main/fastcgi.c 			memcpy(req-&gt;out_pos, str, limit);</span>
<span class='curline'><a href='../S/1366.html#L1591'>req</a>              1591 main/fastcgi.c 			req-&gt;out_pos += limit;</span>
<span class='curline'><a href='../S/1366.html#L1593'>req</a>              1593 main/fastcgi.c 		if (!fcgi_flush(req, 0)) {</span>
<span class='curline'><a href='../S/1366.html#L1597'>req</a>              1597 main/fastcgi.c 			open_packet(req, type);</span>
<span class='curline'><a href='../S/1366.html#L1598'>req</a>              1598 main/fastcgi.c 			memcpy(req-&gt;out_pos, str + limit, len - limit);</span>
<span class='curline'><a href='../S/1366.html#L1599'>req</a>              1599 main/fastcgi.c 			req-&gt;out_pos += len - limit;</span>
<span class='curline'><a href='../S/1366.html#L1605'>req</a>              1605 main/fastcgi.c 		close_packet(req);</span>
<span class='curline'><a href='../S/1366.html#L1607'>req</a>              1607 main/fastcgi.c 			open_packet(req, type);</span>
<span class='curline'><a href='../S/1366.html#L1608'>req</a>              1608 main/fastcgi.c 			fcgi_make_header(req-&gt;out_hdr, type, req-&gt;id, 0xfff8);</span>
<span class='curline'><a href='../S/1366.html#L1609'>req</a>              1609 main/fastcgi.c 			req-&gt;out_hdr = NULL;</span>
<span class='curline'><a href='../S/1366.html#L1610'>req</a>              1610 main/fastcgi.c 			if (!fcgi_flush(req, 0)) {</span>
<span class='curline'><a href='../S/1366.html#L1613'>req</a>              1613 main/fastcgi.c 			if (safe_write(req, str + pos, 0xfff8) != 0xfff8) {</span>
<span class='curline'><a href='../S/1366.html#L1614'>req</a>              1614 main/fastcgi.c 				req-&gt;keep = 0;</span>
<span class='curline'><a href='../S/1366.html#L1623'>req</a>              1623 main/fastcgi.c 		open_packet(req, type);</span>
<span class='curline'><a href='../S/1366.html#L1624'>req</a>              1624 main/fastcgi.c 		fcgi_make_header(req-&gt;out_hdr, type, req-&gt;id, (len - pos) - rest);</span>
<span class='curline'><a href='../S/1366.html#L1625'>req</a>              1625 main/fastcgi.c 		req-&gt;out_hdr = NULL;</span>
<span class='curline'><a href='../S/1366.html#L1626'>req</a>              1626 main/fastcgi.c 		if (!fcgi_flush(req, 0)) {</span>
<span class='curline'><a href='../S/1366.html#L1629'>req</a>              1629 main/fastcgi.c 		if (safe_write(req, str + pos, (len - pos) - rest) != (len - pos) - rest) {</span>
<span class='curline'><a href='../S/1366.html#L1630'>req</a>              1630 main/fastcgi.c 			req-&gt;keep = 0;</span>
<span class='curline'><a href='../S/1366.html#L1634'>req</a>              1634 main/fastcgi.c 			open_packet(req, type);</span>
<span class='curline'><a href='../S/1366.html#L1635'>req</a>              1635 main/fastcgi.c 			memcpy(req-&gt;out_pos, str + len - rest,  rest);</span>
<span class='curline'><a href='../S/1366.html#L1636'>req</a>              1636 main/fastcgi.c 			req-&gt;out_pos += rest;</span>
<span class='curline'><a href='../S/1366.html#L1643'>req</a>              1643 main/fastcgi.c int fcgi_finish_request(fcgi_request *req, int force_close)</span>
<span class='curline'><a href='../S/1366.html#L1647'>req</a>              1647 main/fastcgi.c 	if (req-&gt;fd &gt;= 0) {</span>
<span class='curline'><a href='../S/1366.html#L1648'>req</a>              1648 main/fastcgi.c 		if (!req-&gt;closed) {</span>
<span class='curline'><a href='../S/1366.html#L1649'>req</a>              1649 main/fastcgi.c 			ret = fcgi_flush(req, 1);</span>
<span class='curline'><a href='../S/1366.html#L1650'>req</a>              1650 main/fastcgi.c 			req-&gt;closed = 1;</span>
<span class='curline'><a href='../S/1366.html#L1652'>req</a>              1652 main/fastcgi.c 		fcgi_close(req, force_close, 1);</span>
<span class='curline'><a href='../S/1366.html#L1657'>req</a>              1657 main/fastcgi.c int fcgi_has_env(fcgi_request *req)</span>
<span class='curline'><a href='../S/1366.html#L1659'>req</a>              1659 main/fastcgi.c 	return req &amp;&amp; req-&gt;has_env;</span>
<span class='curline'><a href='../S/1366.html#L1662'>req</a>              1662 main/fastcgi.c char* fcgi_getenv(fcgi_request *req, const char* var, int var_len)</span>
<span class='curline'><a href='../S/1366.html#L1666'>req</a>              1666 main/fastcgi.c 	if (!req) return NULL;</span>
<span class='curline'><a href='../S/1366.html#L1668'>req</a>              1668 main/fastcgi.c 	return fcgi_hash_get(&amp;req-&gt;env, FCGI_HASH_FUNC(var, var_len), (char*)var, var_len, &amp;val_len);</span>
<span class='curline'><a href='../S/1366.html#L1671'>req</a>              1671 main/fastcgi.c char* fcgi_quick_getenv(fcgi_request *req, const char* var, int var_len, unsigned int hash_value)</span>
<span class='curline'><a href='../S/1366.html#L1675'>req</a>              1675 main/fastcgi.c 	return fcgi_hash_get(&amp;req-&gt;env, hash_value, (char*)var, var_len, &amp;val_len);</span>
<span class='curline'><a href='../S/1366.html#L1678'>req</a>              1678 main/fastcgi.c char* fcgi_putenv(fcgi_request *req, char* var, int var_len, char* val)</span>
<span class='curline'><a href='../S/1366.html#L1680'>req</a>              1680 main/fastcgi.c 	if (!req) return NULL;</span>
<span class='curline'><a href='../S/1366.html#L1682'>req</a>              1682 main/fastcgi.c 		fcgi_hash_del(&amp;req-&gt;env, FCGI_HASH_FUNC(var, var_len), var, var_len);</span>
<span class='curline'><a href='../S/1366.html#L1685'>req</a>              1685 main/fastcgi.c 		return fcgi_hash_set(&amp;req-&gt;env, FCGI_HASH_FUNC(var, var_len), var, var_len, val, (unsigned int)strlen(val));</span>
<span class='curline'><a href='../S/1366.html#L1689'>req</a>              1689 main/fastcgi.c char* fcgi_quick_putenv(fcgi_request *req, char* var, int var_len, unsigned int hash_value, char* val)</span>
<span class='curline'><a href='../S/1366.html#L1692'>req</a>              1692 main/fastcgi.c 		fcgi_hash_del(&amp;req-&gt;env, hash_value, var, var_len);</span>
<span class='curline'><a href='../S/1366.html#L1695'>req</a>              1695 main/fastcgi.c 		return fcgi_hash_set(&amp;req-&gt;env, hash_value, var, var_len, val, (unsigned int)strlen(val));</span>
<span class='curline'><a href='../S/1366.html#L1699'>req</a>              1699 main/fastcgi.c void fcgi_loadenv(fcgi_request *req, fcgi_apply_func func, zval *array)</span>
<span class='curline'><a href='../S/1366.html#L1701'>req</a>              1701 main/fastcgi.c 	fcgi_hash_apply(&amp;req-&gt;env, func, array);</span>
<span class='curline'><a href='../S/1367.html#L93'>req</a>                93 main/fastcgi.h int fcgi_is_closed(fcgi_request *req);</span>
<span class='curline'><a href='../S/1367.html#L94'>req</a>                94 main/fastcgi.h void fcgi_close(fcgi_request *req, int force, int destroy);</span>
<span class='curline'><a href='../S/1367.html#L99'>req</a>                99 main/fastcgi.h void fcgi_destroy_request(fcgi_request *req);</span>
<span class='curline'><a href='../S/1367.html#L101'>req</a>               101 main/fastcgi.h int fcgi_accept_request(fcgi_request *req);</span>
<span class='curline'><a href='../S/1367.html#L102'>req</a>               102 main/fastcgi.h int fcgi_finish_request(fcgi_request *req, int force_close);</span>
<span class='curline'><a href='../S/1367.html#L111'>req</a>               111 main/fastcgi.h int   fcgi_has_env(fcgi_request *req);</span>
<span class='curline'><a href='../S/1367.html#L112'>req</a>               112 main/fastcgi.h char* fcgi_getenv(fcgi_request *req, const char* var, int var_len);</span>
<span class='curline'><a href='../S/1367.html#L113'>req</a>               113 main/fastcgi.h char* fcgi_putenv(fcgi_request *req, char* var, int var_len, char* val);</span>
<span class='curline'><a href='../S/1367.html#L114'>req</a>               114 main/fastcgi.h char* fcgi_quick_getenv(fcgi_request *req, const char* var, int var_len, unsigned int hash_value);</span>
<span class='curline'><a href='../S/1367.html#L115'>req</a>               115 main/fastcgi.h char* fcgi_quick_putenv(fcgi_request *req, char* var, int var_len, unsigned int hash_value, char* val);</span>
<span class='curline'><a href='../S/1367.html#L116'>req</a>               116 main/fastcgi.h void  fcgi_loadenv(fcgi_request *req, fcgi_apply_func load_func, zval *array);</span>
<span class='curline'><a href='../S/1367.html#L118'>req</a>               118 main/fastcgi.h int fcgi_read(fcgi_request *req, char *str, int len);</span>
<span class='curline'><a href='../S/1367.html#L120'>req</a>               120 main/fastcgi.h int fcgi_write(fcgi_request *req, fcgi_request_type type, const char *str, int len);</span>
<span class='curline'><a href='../S/1367.html#L121'>req</a>               121 main/fastcgi.h int fcgi_flush(fcgi_request *req, int close);</span>
<span class='curline'><a href='../S/1448.html#L1300'>req</a>              1300 sapi/cli/php_cli_server.c static int php_cli_server_request_ctor(php_cli_server_request *req) /* {{{ */</span>
<span class='curline'><a href='../S/1448.html#L1305'>req</a>              1305 sapi/cli/php_cli_server.c 	req-&gt;protocol_version = 0;</span>
<span class='curline'><a href='../S/1448.html#L1306'>req</a>              1306 sapi/cli/php_cli_server.c 	req-&gt;request_uri = NULL;</span>
<span class='curline'><a href='../S/1448.html#L1307'>req</a>              1307 sapi/cli/php_cli_server.c 	req-&gt;request_uri_len = 0;</span>
<span class='curline'><a href='../S/1448.html#L1308'>req</a>              1308 sapi/cli/php_cli_server.c 	req-&gt;vpath = NULL;</span>
<span class='curline'><a href='../S/1448.html#L1309'>req</a>              1309 sapi/cli/php_cli_server.c 	req-&gt;vpath_len = 0;</span>
<span class='curline'><a href='../S/1448.html#L1310'>req</a>              1310 sapi/cli/php_cli_server.c 	req-&gt;path_translated = NULL;</span>
<span class='curline'><a href='../S/1448.html#L1311'>req</a>              1311 sapi/cli/php_cli_server.c 	req-&gt;path_translated_len = 0;</span>
<span class='curline'><a href='../S/1448.html#L1312'>req</a>              1312 sapi/cli/php_cli_server.c 	req-&gt;path_info = NULL;</span>
<span class='curline'><a href='../S/1448.html#L1313'>req</a>              1313 sapi/cli/php_cli_server.c 	req-&gt;path_info_len = 0;</span>
<span class='curline'><a href='../S/1448.html#L1314'>req</a>              1314 sapi/cli/php_cli_server.c 	req-&gt;query_string = NULL;</span>
<span class='curline'><a href='../S/1448.html#L1315'>req</a>              1315 sapi/cli/php_cli_server.c 	req-&gt;query_string_len = 0;</span>
<span class='curline'><a href='../S/1448.html#L1316'>req</a>              1316 sapi/cli/php_cli_server.c 	zend_hash_init(&amp;req-&gt;headers, 0, NULL, char_ptr_dtor_p, 1);</span>
<span class='curline'><a href='../S/1448.html#L1317'>req</a>              1317 sapi/cli/php_cli_server.c 	zend_hash_init(&amp;req-&gt;headers_original_case, 0, NULL, NULL, 1);</span>
<span class='curline'><a href='../S/1448.html#L1318'>req</a>              1318 sapi/cli/php_cli_server.c 	req-&gt;content = NULL;</span>
<span class='curline'><a href='../S/1448.html#L1319'>req</a>              1319 sapi/cli/php_cli_server.c 	req-&gt;content_len = 0;</span>
<span class='curline'><a href='../S/1448.html#L1320'>req</a>              1320 sapi/cli/php_cli_server.c 	req-&gt;ext = NULL;</span>
<span class='curline'><a href='../S/1448.html#L1321'>req</a>              1321 sapi/cli/php_cli_server.c 	req-&gt;ext_len = 0;</span>
<span class='curline'><a href='../S/1448.html#L1325'>req</a>              1325 sapi/cli/php_cli_server.c static void php_cli_server_request_dtor(php_cli_server_request *req) /* {{{ */</span>
<span class='curline'><a href='../S/1448.html#L1327'>req</a>              1327 sapi/cli/php_cli_server.c 	if (req-&gt;request_uri) {</span>
<span class='curline'><a href='../S/1448.html#L1328'>req</a>              1328 sapi/cli/php_cli_server.c 		pefree(req-&gt;request_uri, 1);</span>
<span class='curline'><a href='../S/1448.html#L1330'>req</a>              1330 sapi/cli/php_cli_server.c 	if (req-&gt;vpath) {</span>
<span class='curline'><a href='../S/1448.html#L1331'>req</a>              1331 sapi/cli/php_cli_server.c 		pefree(req-&gt;vpath, 1);</span>
<span class='curline'><a href='../S/1448.html#L1333'>req</a>              1333 sapi/cli/php_cli_server.c 	if (req-&gt;path_translated) {</span>
<span class='curline'><a href='../S/1448.html#L1334'>req</a>              1334 sapi/cli/php_cli_server.c 		pefree(req-&gt;path_translated, 1);</span>
<span class='curline'><a href='../S/1448.html#L1336'>req</a>              1336 sapi/cli/php_cli_server.c 	if (req-&gt;path_info) {</span>
<span class='curline'><a href='../S/1448.html#L1337'>req</a>              1337 sapi/cli/php_cli_server.c 		pefree(req-&gt;path_info, 1);</span>
<span class='curline'><a href='../S/1448.html#L1339'>req</a>              1339 sapi/cli/php_cli_server.c 	if (req-&gt;query_string) {</span>
<span class='curline'><a href='../S/1448.html#L1340'>req</a>              1340 sapi/cli/php_cli_server.c 		pefree(req-&gt;query_string, 1);</span>
<span class='curline'><a href='../S/1448.html#L1342'>req</a>              1342 sapi/cli/php_cli_server.c 	zend_hash_destroy(&amp;req-&gt;headers);</span>
<span class='curline'><a href='../S/1448.html#L1343'>req</a>              1343 sapi/cli/php_cli_server.c 	zend_hash_destroy(&amp;req-&gt;headers_original_case);</span>
<span class='curline'><a href='../S/1448.html#L1344'>req</a>              1344 sapi/cli/php_cli_server.c 	if (req-&gt;content) {</span>
<span class='curline'><a href='../S/1448.html#L1345'>req</a>              1345 sapi/cli/php_cli_server.c 		pefree(req-&gt;content, 1);</span>
<span class='curline'><a href='../S/1487.html#L1418'>req</a>              1418 sapi/fpm/fpm/fpm_main.c 	fcgi_request *req = fcgi_init_request(listen_fd,</span>
<span class='curline'><a href='../S/1487.html#L1422'>req</a>              1422 sapi/fpm/fpm/fpm_main.c 	return req;</span>
</pre>
</body>
</html>
