<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>pShmNode</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/1054.html#L26522'>pShmNode</a>         26522 ext/sqlite3/libsqlite/sqlite3.c   unixShmNode *pShmNode;          /* Shared memory associated with this inode */</span>
<span class='curline'><a href='../S/1054.html#L26665'>pShmNode</a>         26665 ext/sqlite3/libsqlite/sqlite3.c       assert( pInode-&gt;pShmNode==0 );</span>
<span class='curline'><a href='../S/1054.html#L29532'>pShmNode</a>         29532 ext/sqlite3/libsqlite/sqlite3.c   unixShmNode *pShmNode;     /* The underlying unixShmNode object */</span>
<span class='curline'><a href='../S/1054.html#L29558'>pShmNode</a>         29558 ext/sqlite3/libsqlite/sqlite3.c   unixShmNode *pShmNode; /* Apply locks to this open shared-memory segment */</span>
<span class='curline'><a href='../S/1054.html#L29563'>pShmNode</a>         29563 ext/sqlite3/libsqlite/sqlite3.c   pShmNode = pFile-&gt;pInode-&gt;pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L29564'>pShmNode</a>         29564 ext/sqlite3/libsqlite/sqlite3.c   assert( sqlite3_mutex_held(pShmNode-&gt;mutex) || pShmNode-&gt;nRef==0 );</span>
<span class='curline'><a href='../S/1054.html#L29572'>pShmNode</a>         29572 ext/sqlite3/libsqlite/sqlite3.c   if( pShmNode-&gt;h&gt;=0 ){</span>
<span class='curline'><a href='../S/1054.html#L29582'>pShmNode</a>         29582 ext/sqlite3/libsqlite/sqlite3.c     rc = osFcntl(pShmNode-&gt;h, lkType, &amp;f);</span>
<span class='curline'><a href='../S/1054.html#L29595'>pShmNode</a>         29595 ext/sqlite3/libsqlite/sqlite3.c       pShmNode-&gt;exclMask &amp;= ~mask;</span>
<span class='curline'><a href='../S/1054.html#L29596'>pShmNode</a>         29596 ext/sqlite3/libsqlite/sqlite3.c       pShmNode-&gt;sharedMask &amp;= ~mask;</span>
<span class='curline'><a href='../S/1054.html#L29599'>pShmNode</a>         29599 ext/sqlite3/libsqlite/sqlite3.c       pShmNode-&gt;exclMask &amp;= ~mask;</span>
<span class='curline'><a href='../S/1054.html#L29600'>pShmNode</a>         29600 ext/sqlite3/libsqlite/sqlite3.c       pShmNode-&gt;sharedMask |= mask;</span>
<span class='curline'><a href='../S/1054.html#L29604'>pShmNode</a>         29604 ext/sqlite3/libsqlite/sqlite3.c       pShmNode-&gt;exclMask |= mask;</span>
<span class='curline'><a href='../S/1054.html#L29605'>pShmNode</a>         29605 ext/sqlite3/libsqlite/sqlite3.c       pShmNode-&gt;sharedMask &amp;= ~mask;</span>
<span class='curline'><a href='../S/1054.html#L29618'>pShmNode</a>         29618 ext/sqlite3/libsqlite/sqlite3.c            pShmNode-&gt;sharedMask, pShmNode-&gt;exclMask));</span>
<span class='curline'><a href='../S/1054.html#L29649'>pShmNode</a>         29649 ext/sqlite3/libsqlite/sqlite3.c   unixShmNode *p = pFd-&gt;pInode-&gt;pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L29668'>pShmNode</a>         29668 ext/sqlite3/libsqlite/sqlite3.c     p-&gt;pInode-&gt;pShmNode = 0;</span>
<span class='curline'><a href='../S/1054.html#L29710'>pShmNode</a>         29710 ext/sqlite3/libsqlite/sqlite3.c   struct unixShmNode *pShmNode;   /* The underlying mmapped file */</span>
<span class='curline'><a href='../S/1054.html#L29727'>pShmNode</a>         29727 ext/sqlite3/libsqlite/sqlite3.c   pShmNode = pInode-&gt;pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L29728'>pShmNode</a>         29728 ext/sqlite3/libsqlite/sqlite3.c   if( pShmNode==0 ){</span>
<span class='curline'><a href='../S/1054.html#L29748'>pShmNode</a>         29748 ext/sqlite3/libsqlite/sqlite3.c     pShmNode = sqlite3_malloc64( sizeof(*pShmNode) + nShmFilename );</span>
<span class='curline'><a href='../S/1054.html#L29749'>pShmNode</a>         29749 ext/sqlite3/libsqlite/sqlite3.c     if( pShmNode==0 ){</span>
<span class='curline'><a href='../S/1054.html#L29753'>pShmNode</a>         29753 ext/sqlite3/libsqlite/sqlite3.c     memset(pShmNode, 0, sizeof(*pShmNode)+nShmFilename);</span>
<span class='curline'><a href='../S/1054.html#L29754'>pShmNode</a>         29754 ext/sqlite3/libsqlite/sqlite3.c     zShmFilename = pShmNode-&gt;zFilename = (char*)&amp;pShmNode[1];</span>
<span class='curline'><a href='../S/1054.html#L29763'>pShmNode</a>         29763 ext/sqlite3/libsqlite/sqlite3.c     pShmNode-&gt;h = -1;</span>
<span class='curline'><a href='../S/1054.html#L29764'>pShmNode</a>         29764 ext/sqlite3/libsqlite/sqlite3.c     pDbFd-&gt;pInode-&gt;pShmNode = pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L29765'>pShmNode</a>         29765 ext/sqlite3/libsqlite/sqlite3.c     pShmNode-&gt;pInode = pDbFd-&gt;pInode;</span>
<span class='curline'><a href='../S/1054.html#L29766'>pShmNode</a>         29766 ext/sqlite3/libsqlite/sqlite3.c     pShmNode-&gt;mutex = sqlite3_mutex_alloc(SQLITE_MUTEX_FAST);</span>
<span class='curline'><a href='../S/1054.html#L29767'>pShmNode</a>         29767 ext/sqlite3/libsqlite/sqlite3.c     if( pShmNode-&gt;mutex==0 ){</span>
<span class='curline'><a href='../S/1054.html#L29776'>pShmNode</a>         29776 ext/sqlite3/libsqlite/sqlite3.c         pShmNode-&gt;isReadonly = 1;</span>
<span class='curline'><a href='../S/1054.html#L29778'>pShmNode</a>         29778 ext/sqlite3/libsqlite/sqlite3.c       pShmNode-&gt;h = robust_open(zShmFilename, openFlags, (sStat.st_mode&amp;0777));</span>
<span class='curline'><a href='../S/1054.html#L29779'>pShmNode</a>         29779 ext/sqlite3/libsqlite/sqlite3.c       if( pShmNode-&gt;h&lt;0 ){</span>
<span class='curline'><a href='../S/1054.html#L29788'>pShmNode</a>         29788 ext/sqlite3/libsqlite/sqlite3.c       osFchown(pShmNode-&gt;h, sStat.st_uid, sStat.st_gid);</span>
<span class='curline'><a href='../S/1054.html#L29795'>pShmNode</a>         29795 ext/sqlite3/libsqlite/sqlite3.c         if( robust_ftruncate(pShmNode-&gt;h, 0) ){</span>
<span class='curline'><a href='../S/1054.html#L29807'>pShmNode</a>         29807 ext/sqlite3/libsqlite/sqlite3.c   p-&gt;pShmNode = pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L29809'>pShmNode</a>         29809 ext/sqlite3/libsqlite/sqlite3.c   p-&gt;id = pShmNode-&gt;nextShmId++;</span>
<span class='curline'><a href='../S/1054.html#L29811'>pShmNode</a>         29811 ext/sqlite3/libsqlite/sqlite3.c   pShmNode-&gt;nRef++;</span>
<span class='curline'><a href='../S/1054.html#L29822'>pShmNode</a>         29822 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_enter(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L29823'>pShmNode</a>         29823 ext/sqlite3/libsqlite/sqlite3.c   p-&gt;pNext = pShmNode-&gt;pFirst;</span>
<span class='curline'><a href='../S/1054.html#L29824'>pShmNode</a>         29824 ext/sqlite3/libsqlite/sqlite3.c   pShmNode-&gt;pFirst = p;</span>
<span class='curline'><a href='../S/1054.html#L29825'>pShmNode</a>         29825 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_leave(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L29864'>pShmNode</a>         29864 ext/sqlite3/libsqlite/sqlite3.c   unixShmNode *pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L29876'>pShmNode</a>         29876 ext/sqlite3/libsqlite/sqlite3.c   pShmNode = p-&gt;pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L29877'>pShmNode</a>         29877 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_enter(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L29878'>pShmNode</a>         29878 ext/sqlite3/libsqlite/sqlite3.c   assert( szRegion==pShmNode-&gt;szRegion || pShmNode-&gt;nRegion==0 );</span>
<span class='curline'><a href='../S/1054.html#L29879'>pShmNode</a>         29879 ext/sqlite3/libsqlite/sqlite3.c   assert( pShmNode-&gt;pInode==pDbFd-&gt;pInode );</span>
<span class='curline'><a href='../S/1054.html#L29880'>pShmNode</a>         29880 ext/sqlite3/libsqlite/sqlite3.c   assert( pShmNode-&gt;h&gt;=0 || pDbFd-&gt;pInode-&gt;bProcessLock==1 );</span>
<span class='curline'><a href='../S/1054.html#L29881'>pShmNode</a>         29881 ext/sqlite3/libsqlite/sqlite3.c   assert( pShmNode-&gt;h&lt;0 || pDbFd-&gt;pInode-&gt;bProcessLock==0 );</span>
<span class='curline'><a href='../S/1054.html#L29886'>pShmNode</a>         29886 ext/sqlite3/libsqlite/sqlite3.c   if( pShmNode-&gt;nRegion&lt;nReqRegion ){</span>
<span class='curline'><a href='../S/1054.html#L29891'>pShmNode</a>         29891 ext/sqlite3/libsqlite/sqlite3.c     pShmNode-&gt;szRegion = szRegion;</span>
<span class='curline'><a href='../S/1054.html#L29893'>pShmNode</a>         29893 ext/sqlite3/libsqlite/sqlite3.c     if( pShmNode-&gt;h&gt;=0 ){</span>
<span class='curline'><a href='../S/1054.html#L29898'>pShmNode</a>         29898 ext/sqlite3/libsqlite/sqlite3.c       if( osFstat(pShmNode-&gt;h, &amp;sStat) ){</span>
<span class='curline'><a href='../S/1054.html#L29925'>pShmNode</a>         29925 ext/sqlite3/libsqlite/sqlite3.c             if( seekAndWriteFd(pShmNode-&gt;h, iPg*pgsz + pgsz-1, "", 1, 0)!=1 ){</span>
<span class='curline'><a href='../S/1054.html#L29926'>pShmNode</a>         29926 ext/sqlite3/libsqlite/sqlite3.c               const char *zFile = pShmNode-&gt;zFilename;</span>
<span class='curline'><a href='../S/1054.html#L29937'>pShmNode</a>         29937 ext/sqlite3/libsqlite/sqlite3.c         pShmNode-&gt;apRegion, nReqRegion*sizeof(char *)</span>
<span class='curline'><a href='../S/1054.html#L29943'>pShmNode</a>         29943 ext/sqlite3/libsqlite/sqlite3.c     pShmNode-&gt;apRegion = apNew;</span>
<span class='curline'><a href='../S/1054.html#L29944'>pShmNode</a>         29944 ext/sqlite3/libsqlite/sqlite3.c     while( pShmNode-&gt;nRegion&lt;nReqRegion ){</span>
<span class='curline'><a href='../S/1054.html#L29948'>pShmNode</a>         29948 ext/sqlite3/libsqlite/sqlite3.c       if( pShmNode-&gt;h&gt;=0 ){</span>
<span class='curline'><a href='../S/1054.html#L29950'>pShmNode</a>         29950 ext/sqlite3/libsqlite/sqlite3.c             pShmNode-&gt;isReadonly ? PROT_READ : PROT_READ|PROT_WRITE, </span>
<span class='curline'><a href='../S/1054.html#L29951'>pShmNode</a>         29951 ext/sqlite3/libsqlite/sqlite3.c             MAP_SHARED, pShmNode-&gt;h, szRegion*(i64)pShmNode-&gt;nRegion</span>
<span class='curline'><a href='../S/1054.html#L29954'>pShmNode</a>         29954 ext/sqlite3/libsqlite/sqlite3.c           rc = unixLogError(SQLITE_IOERR_SHMMAP, "mmap", pShmNode-&gt;zFilename);</span>
<span class='curline'><a href='../S/1054.html#L29967'>pShmNode</a>         29967 ext/sqlite3/libsqlite/sqlite3.c         pShmNode-&gt;apRegion[pShmNode-&gt;nRegion+i] = &amp;((char*)pMem)[szRegion*i];</span>
<span class='curline'><a href='../S/1054.html#L29969'>pShmNode</a>         29969 ext/sqlite3/libsqlite/sqlite3.c       pShmNode-&gt;nRegion += nShmPerMap;</span>
<span class='curline'><a href='../S/1054.html#L29974'>pShmNode</a>         29974 ext/sqlite3/libsqlite/sqlite3.c   if( pShmNode-&gt;nRegion&gt;iRegion ){</span>
<span class='curline'><a href='../S/1054.html#L29975'>pShmNode</a>         29975 ext/sqlite3/libsqlite/sqlite3.c     *pp = pShmNode-&gt;apRegion[iRegion];</span>
<span class='curline'><a href='../S/1054.html#L29979'>pShmNode</a>         29979 ext/sqlite3/libsqlite/sqlite3.c   if( pShmNode-&gt;isReadonly &amp;&amp; rc==SQLITE_OK ) rc = SQLITE_READONLY;</span>
<span class='curline'><a href='../S/1054.html#L29980'>pShmNode</a>         29980 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_leave(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L30001'>pShmNode</a>         30001 ext/sqlite3/libsqlite/sqlite3.c   unixShmNode *pShmNode = p-&gt;pShmNode;  /* The underlying file iNode */</span>
<span class='curline'><a href='../S/1054.html#L30005'>pShmNode</a>         30005 ext/sqlite3/libsqlite/sqlite3.c   assert( pShmNode==pDbFd-&gt;pInode-&gt;pShmNode );</span>
<span class='curline'><a href='../S/1054.html#L30006'>pShmNode</a>         30006 ext/sqlite3/libsqlite/sqlite3.c   assert( pShmNode-&gt;pInode==pDbFd-&gt;pInode );</span>
<span class='curline'><a href='../S/1054.html#L30014'>pShmNode</a>         30014 ext/sqlite3/libsqlite/sqlite3.c   assert( pShmNode-&gt;h&gt;=0 || pDbFd-&gt;pInode-&gt;bProcessLock==1 );</span>
<span class='curline'><a href='../S/1054.html#L30015'>pShmNode</a>         30015 ext/sqlite3/libsqlite/sqlite3.c   assert( pShmNode-&gt;h&lt;0 || pDbFd-&gt;pInode-&gt;bProcessLock==0 );</span>
<span class='curline'><a href='../S/1054.html#L30019'>pShmNode</a>         30019 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_enter(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L30024'>pShmNode</a>         30024 ext/sqlite3/libsqlite/sqlite3.c     for(pX=pShmNode-&gt;pFirst; pX; pX=pX-&gt;pNext){</span>
<span class='curline'><a href='../S/1054.html#L30049'>pShmNode</a>         30049 ext/sqlite3/libsqlite/sqlite3.c     for(pX=pShmNode-&gt;pFirst; pX; pX=pX-&gt;pNext){</span>
<span class='curline'><a href='../S/1054.html#L30074'>pShmNode</a>         30074 ext/sqlite3/libsqlite/sqlite3.c     for(pX=pShmNode-&gt;pFirst; pX; pX=pX-&gt;pNext){</span>
<span class='curline'><a href='../S/1054.html#L30092'>pShmNode</a>         30092 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_leave(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L30124'>pShmNode</a>         30124 ext/sqlite3/libsqlite/sqlite3.c   unixShmNode *pShmNode;          /* The underlying shared-memory file */</span>
<span class='curline'><a href='../S/1054.html#L30131'>pShmNode</a>         30131 ext/sqlite3/libsqlite/sqlite3.c   pShmNode = p-&gt;pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L30133'>pShmNode</a>         30133 ext/sqlite3/libsqlite/sqlite3.c   assert( pShmNode==pDbFd-&gt;pInode-&gt;pShmNode );</span>
<span class='curline'><a href='../S/1054.html#L30134'>pShmNode</a>         30134 ext/sqlite3/libsqlite/sqlite3.c   assert( pShmNode-&gt;pInode==pDbFd-&gt;pInode );</span>
<span class='curline'><a href='../S/1054.html#L30138'>pShmNode</a>         30138 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_enter(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L30139'>pShmNode</a>         30139 ext/sqlite3/libsqlite/sqlite3.c   for(pp=&amp;pShmNode-&gt;pFirst; (*pp)!=p; pp = &amp;(*pp)-&gt;pNext){}</span>
<span class='curline'><a href='../S/1054.html#L30145'>pShmNode</a>         30145 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_leave(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L30150'>pShmNode</a>         30150 ext/sqlite3/libsqlite/sqlite3.c   assert( pShmNode-&gt;nRef&gt;0 );</span>
<span class='curline'><a href='../S/1054.html#L30151'>pShmNode</a>         30151 ext/sqlite3/libsqlite/sqlite3.c   pShmNode-&gt;nRef--;</span>
<span class='curline'><a href='../S/1054.html#L30152'>pShmNode</a>         30152 ext/sqlite3/libsqlite/sqlite3.c   if( pShmNode-&gt;nRef==0 ){</span>
<span class='curline'><a href='../S/1054.html#L30153'>pShmNode</a>         30153 ext/sqlite3/libsqlite/sqlite3.c     if( deleteFlag &amp;&amp; pShmNode-&gt;h&gt;=0 ){</span>
<span class='curline'><a href='../S/1054.html#L30154'>pShmNode</a>         30154 ext/sqlite3/libsqlite/sqlite3.c       osUnlink(pShmNode-&gt;zFilename);</span>
<span class='curline'><a href='../S/1054.html#L36671'>pShmNode</a>         36671 ext/sqlite3/libsqlite/sqlite3.c   winShmNode *pShmNode;      /* The underlying winShmNode object */</span>
<span class='curline'><a href='../S/1054.html#L36792'>pShmNode</a>         36792 ext/sqlite3/libsqlite/sqlite3.c   struct winShmNode *pShmNode = 0;   /* The underlying mmapped file */</span>
<span class='curline'><a href='../S/1054.html#L36805'>pShmNode</a>         36805 ext/sqlite3/libsqlite/sqlite3.c   pNew = sqlite3MallocZero( sizeof(*pShmNode) + nName + 17 );</span>
<span class='curline'><a href='../S/1054.html#L36818'>pShmNode</a>         36818 ext/sqlite3/libsqlite/sqlite3.c   for(pShmNode = winShmNodeList; pShmNode; pShmNode=pShmNode-&gt;pNext){</span>
<span class='curline'><a href='../S/1054.html#L36822'>pShmNode</a>         36822 ext/sqlite3/libsqlite/sqlite3.c     if( sqlite3StrICmp(pShmNode-&gt;zFilename, pNew-&gt;zFilename)==0 ) break;</span>
<span class='curline'><a href='../S/1054.html#L36824'>pShmNode</a>         36824 ext/sqlite3/libsqlite/sqlite3.c   if( pShmNode ){</span>
<span class='curline'><a href='../S/1054.html#L36827'>pShmNode</a>         36827 ext/sqlite3/libsqlite/sqlite3.c     pShmNode = pNew;</span>
<span class='curline'><a href='../S/1054.html#L36829'>pShmNode</a>         36829 ext/sqlite3/libsqlite/sqlite3.c     ((winFile*)(&amp;pShmNode-&gt;hFile))-&gt;h = INVALID_HANDLE_VALUE;</span>
<span class='curline'><a href='../S/1054.html#L36830'>pShmNode</a>         36830 ext/sqlite3/libsqlite/sqlite3.c     pShmNode-&gt;pNext = winShmNodeList;</span>
<span class='curline'><a href='../S/1054.html#L36831'>pShmNode</a>         36831 ext/sqlite3/libsqlite/sqlite3.c     winShmNodeList = pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L36833'>pShmNode</a>         36833 ext/sqlite3/libsqlite/sqlite3.c     pShmNode-&gt;mutex = sqlite3_mutex_alloc(SQLITE_MUTEX_FAST);</span>
<span class='curline'><a href='../S/1054.html#L36834'>pShmNode</a>         36834 ext/sqlite3/libsqlite/sqlite3.c     if( pShmNode-&gt;mutex==0 ){</span>
<span class='curline'><a href='../S/1054.html#L36840'>pShmNode</a>         36840 ext/sqlite3/libsqlite/sqlite3.c                  pShmNode-&gt;zFilename,             /* Name of the file (UTF-8) */</span>
<span class='curline'><a href='../S/1054.html#L36841'>pShmNode</a>         36841 ext/sqlite3/libsqlite/sqlite3.c                  (sqlite3_file*)&amp;pShmNode-&gt;hFile,  /* File handle here */</span>
<span class='curline'><a href='../S/1054.html#L36851'>pShmNode</a>         36851 ext/sqlite3/libsqlite/sqlite3.c     if( winShmSystemLock(pShmNode, _SHM_WRLCK, WIN_SHM_DMS, 1)==SQLITE_OK ){</span>
<span class='curline'><a href='../S/1054.html#L36852'>pShmNode</a>         36852 ext/sqlite3/libsqlite/sqlite3.c       rc = winTruncate((sqlite3_file *)&amp;pShmNode-&gt;hFile, 0);</span>
<span class='curline'><a href='../S/1054.html#L36859'>pShmNode</a>         36859 ext/sqlite3/libsqlite/sqlite3.c       winShmSystemLock(pShmNode, _SHM_UNLCK, WIN_SHM_DMS, 1);</span>
<span class='curline'><a href='../S/1054.html#L36860'>pShmNode</a>         36860 ext/sqlite3/libsqlite/sqlite3.c       rc = winShmSystemLock(pShmNode, _SHM_RDLCK, WIN_SHM_DMS, 1);</span>
<span class='curline'><a href='../S/1054.html#L36866'>pShmNode</a>         36866 ext/sqlite3/libsqlite/sqlite3.c   p-&gt;pShmNode = pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L36868'>pShmNode</a>         36868 ext/sqlite3/libsqlite/sqlite3.c   p-&gt;id = pShmNode-&gt;nextShmId++;</span>
<span class='curline'><a href='../S/1054.html#L36870'>pShmNode</a>         36870 ext/sqlite3/libsqlite/sqlite3.c   pShmNode-&gt;nRef++;</span>
<span class='curline'><a href='../S/1054.html#L36881'>pShmNode</a>         36881 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_enter(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L36882'>pShmNode</a>         36882 ext/sqlite3/libsqlite/sqlite3.c   p-&gt;pNext = pShmNode-&gt;pFirst;</span>
<span class='curline'><a href='../S/1054.html#L36883'>pShmNode</a>         36883 ext/sqlite3/libsqlite/sqlite3.c   pShmNode-&gt;pFirst = p;</span>
<span class='curline'><a href='../S/1054.html#L36884'>pShmNode</a>         36884 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_leave(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L36889'>pShmNode</a>         36889 ext/sqlite3/libsqlite/sqlite3.c   winShmSystemLock(pShmNode, _SHM_UNLCK, WIN_SHM_DMS, 1);</span>
<span class='curline'><a href='../S/1054.html#L36907'>pShmNode</a>         36907 ext/sqlite3/libsqlite/sqlite3.c   winShmNode *pShmNode; /* The underlying shared-memory file */</span>
<span class='curline'><a href='../S/1054.html#L36913'>pShmNode</a>         36913 ext/sqlite3/libsqlite/sqlite3.c   pShmNode = p-&gt;pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L36917'>pShmNode</a>         36917 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_enter(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L36918'>pShmNode</a>         36918 ext/sqlite3/libsqlite/sqlite3.c   for(pp=&amp;pShmNode-&gt;pFirst; (*pp)!=p; pp = &amp;(*pp)-&gt;pNext){}</span>
<span class='curline'><a href='../S/1054.html#L36924'>pShmNode</a>         36924 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_leave(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L36929'>pShmNode</a>         36929 ext/sqlite3/libsqlite/sqlite3.c   assert( pShmNode-&gt;nRef&gt;0 );</span>
<span class='curline'><a href='../S/1054.html#L36930'>pShmNode</a>         36930 ext/sqlite3/libsqlite/sqlite3.c   pShmNode-&gt;nRef--;</span>
<span class='curline'><a href='../S/1054.html#L36931'>pShmNode</a>         36931 ext/sqlite3/libsqlite/sqlite3.c   if( pShmNode-&gt;nRef==0 ){</span>
<span class='curline'><a href='../S/1054.html#L36951'>pShmNode</a>         36951 ext/sqlite3/libsqlite/sqlite3.c   winShmNode *pShmNode = p-&gt;pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L36965'>pShmNode</a>         36965 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_enter(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L36970'>pShmNode</a>         36970 ext/sqlite3/libsqlite/sqlite3.c     for(pX=pShmNode-&gt;pFirst; pX; pX=pX-&gt;pNext){</span>
<span class='curline'><a href='../S/1054.html#L36978'>pShmNode</a>         36978 ext/sqlite3/libsqlite/sqlite3.c       rc = winShmSystemLock(pShmNode, _SHM_UNLCK, ofst+WIN_SHM_BASE, n);</span>
<span class='curline'><a href='../S/1054.html#L36995'>pShmNode</a>         36995 ext/sqlite3/libsqlite/sqlite3.c     for(pX=pShmNode-&gt;pFirst; pX; pX=pX-&gt;pNext){</span>
<span class='curline'><a href='../S/1054.html#L37006'>pShmNode</a>         37006 ext/sqlite3/libsqlite/sqlite3.c         rc = winShmSystemLock(pShmNode, _SHM_RDLCK, ofst+WIN_SHM_BASE, n);</span>
<span class='curline'><a href='../S/1054.html#L37020'>pShmNode</a>         37020 ext/sqlite3/libsqlite/sqlite3.c     for(pX=pShmNode-&gt;pFirst; pX; pX=pX-&gt;pNext){</span>
<span class='curline'><a href='../S/1054.html#L37031'>pShmNode</a>         37031 ext/sqlite3/libsqlite/sqlite3.c       rc = winShmSystemLock(pShmNode, _SHM_WRLCK, ofst+WIN_SHM_BASE, n);</span>
<span class='curline'><a href='../S/1054.html#L37038'>pShmNode</a>         37038 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_leave(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L37088'>pShmNode</a>         37088 ext/sqlite3/libsqlite/sqlite3.c   winShmNode *pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L37096'>pShmNode</a>         37096 ext/sqlite3/libsqlite/sqlite3.c   pShmNode = pShm-&gt;pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L37098'>pShmNode</a>         37098 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_enter(pShmNode-&gt;mutex);</span>
<span class='curline'><a href='../S/1054.html#L37099'>pShmNode</a>         37099 ext/sqlite3/libsqlite/sqlite3.c   assert( szRegion==pShmNode-&gt;szRegion || pShmNode-&gt;nRegion==0 );</span>
<span class='curline'><a href='../S/1054.html#L37101'>pShmNode</a>         37101 ext/sqlite3/libsqlite/sqlite3.c   if( pShmNode-&gt;nRegion&lt;=iRegion ){</span>
<span class='curline'><a href='../S/1054.html#L37106'>pShmNode</a>         37106 ext/sqlite3/libsqlite/sqlite3.c     pShmNode-&gt;szRegion = szRegion;</span>
<span class='curline'><a href='../S/1054.html#L37112'>pShmNode</a>         37112 ext/sqlite3/libsqlite/sqlite3.c     rc = winFileSize((sqlite3_file *)&amp;pShmNode-&gt;hFile, &amp;sz);</span>
<span class='curline'><a href='../S/1054.html#L37127'>pShmNode</a>         37127 ext/sqlite3/libsqlite/sqlite3.c       rc = winTruncate((sqlite3_file *)&amp;pShmNode-&gt;hFile, nByte);</span>
<span class='curline'><a href='../S/1054.html#L37137'>pShmNode</a>         37137 ext/sqlite3/libsqlite/sqlite3.c         pShmNode-&gt;aRegion, (iRegion+1)*sizeof(apNew[0])</span>
<span class='curline'><a href='../S/1054.html#L37143'>pShmNode</a>         37143 ext/sqlite3/libsqlite/sqlite3.c     pShmNode-&gt;aRegion = apNew;</span>
<span class='curline'><a href='../S/1054.html#L37145'>pShmNode</a>         37145 ext/sqlite3/libsqlite/sqlite3.c     while( pShmNode-&gt;nRegion&lt;=iRegion ){</span>
<span class='curline'><a href='../S/1054.html#L37150'>pShmNode</a>         37150 ext/sqlite3/libsqlite/sqlite3.c       hMap = osCreateFileMappingFromApp(pShmNode-&gt;hFile.h,</span>
<span class='curline'><a href='../S/1054.html#L37154'>pShmNode</a>         37154 ext/sqlite3/libsqlite/sqlite3.c       hMap = osCreateFileMappingW(pShmNode-&gt;hFile.h,</span>
<span class='curline'><a href='../S/1054.html#L37158'>pShmNode</a>         37158 ext/sqlite3/libsqlite/sqlite3.c       hMap = osCreateFileMappingA(pShmNode-&gt;hFile.h,</span>
<span class='curline'><a href='../S/1054.html#L37163'>pShmNode</a>         37163 ext/sqlite3/libsqlite/sqlite3.c                osGetCurrentProcessId(), pShmNode-&gt;nRegion, nByte,</span>
<span class='curline'><a href='../S/1054.html#L37166'>pShmNode</a>         37166 ext/sqlite3/libsqlite/sqlite3.c         int iOffset = pShmNode-&gt;nRegion*szRegion;</span>
<span class='curline'><a href='../S/1054.html#L37178'>pShmNode</a>         37178 ext/sqlite3/libsqlite/sqlite3.c                  osGetCurrentProcessId(), pShmNode-&gt;nRegion, iOffset,</span>
<span class='curline'><a href='../S/1054.html#L37182'>pShmNode</a>         37182 ext/sqlite3/libsqlite/sqlite3.c         pShmNode-&gt;lastErrno = osGetLastError();</span>
<span class='curline'><a href='../S/1054.html#L37183'>pShmNode</a>         37183 ext/sqlite3/libsqlite/sqlite3.c         rc = winLogError(SQLITE_IOERR_SHMMAP, pShmNode-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L37189'>pShmNode</a>         37189 ext/sqlite3/libsqlite/sqlite3.c       pShmNode-&gt;aRegion[pShmNode-&gt;nRegion].pMap = pMap;</span>
<span class='curline'><a href='../S/1054.html#L37190'>pShmNode</a>         37190 ext/sqlite3/libsqlite/sqlite3.c       pShmNode-&gt;aRegion[pShmNode-&gt;nRegion].hMap = hMap;</span>
<span class='curline'><a href='../S/1054.html#L37191'>pShmNode</a>         37191 ext/sqlite3/libsqlite/sqlite3.c       pShmNode-&gt;nRegion++;</span>
<span class='curline'><a href='../S/1054.html#L37196'>pShmNode</a>         37196 ext/sqlite3/libsqlite/sqlite3.c   if( pShmNode-&gt;nRegion&gt;iRegion ){</span>
<span class='curline'><a href='../S/1054.html#L37199'>pShmNode</a>         37199 ext/sqlite3/libsqlite/sqlite3.c     char *p = (char *)pShmNode-&gt;aRegion[iRegion].pMap;</span>
<span class='curline'><a href='../S/1054.html#L37204'>pShmNode</a>         37204 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_mutex_leave(pShmNode-&gt;mutex);</span>
</pre>
</body>
</html>
