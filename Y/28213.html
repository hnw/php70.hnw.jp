<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>new_cert</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/851.html#L2949'>new_cert</a>         2949 ext/openssl/openssl.c 	X509 * cert = NULL, *new_cert = NULL;</span>
<span class='curline'><a href='../S/851.html#L3006'>new_cert</a>         3006 ext/openssl/openssl.c 	new_cert = X509_new();</span>
<span class='curline'><a href='../S/851.html#L3007'>new_cert</a>         3007 ext/openssl/openssl.c 	if (new_cert == NULL) {</span>
<span class='curline'><a href='../S/851.html#L3012'>new_cert</a>         3012 ext/openssl/openssl.c 	if (!X509_set_version(new_cert, 2))</span>
<span class='curline'><a href='../S/851.html#L3016'>new_cert</a>         3016 ext/openssl/openssl.c 	ASN1_INTEGER_set(X509_get_serialNumber(new_cert), (long)serial);</span>
<span class='curline'><a href='../S/851.html#L3018'>new_cert</a>         3018 ext/openssl/openssl.c 	X509_set_subject_name(new_cert, X509_REQ_get_subject_name(csr));</span>
<span class='curline'><a href='../S/851.html#L3021'>new_cert</a>         3021 ext/openssl/openssl.c 		cert = new_cert;</span>
<span class='curline'><a href='../S/851.html#L3023'>new_cert</a>         3023 ext/openssl/openssl.c 	if (!X509_set_issuer_name(new_cert, X509_get_subject_name(cert))) {</span>
<span class='curline'><a href='../S/851.html#L3026'>new_cert</a>         3026 ext/openssl/openssl.c 	X509_gmtime_adj(X509_get_notBefore(new_cert), 0);</span>
<span class='curline'><a href='../S/851.html#L3027'>new_cert</a>         3027 ext/openssl/openssl.c 	X509_gmtime_adj(X509_get_notAfter(new_cert), 60*60*24*(long)num_days);</span>
<span class='curline'><a href='../S/851.html#L3028'>new_cert</a>         3028 ext/openssl/openssl.c 	i = X509_set_pubkey(new_cert, key);</span>
<span class='curline'><a href='../S/851.html#L3035'>new_cert</a>         3035 ext/openssl/openssl.c 		X509V3_set_ctx(&amp;ctx, cert, new_cert, csr, NULL, 0);</span>
<span class='curline'><a href='../S/851.html#L3037'>new_cert</a>         3037 ext/openssl/openssl.c 		if (!X509V3_EXT_add_conf(req.req_config, &amp;ctx, req.extensions_section, new_cert)) {</span>
<span class='curline'><a href='../S/851.html#L3043'>new_cert</a>         3043 ext/openssl/openssl.c 	if (!X509_sign(new_cert, priv_key, req.digest)) {</span>
<span class='curline'><a href='../S/851.html#L3049'>new_cert</a>         3049 ext/openssl/openssl.c 	ZVAL_RES(return_value, zend_register_resource(new_cert, le_x509));</span>
<span class='curline'><a href='../S/851.html#L3050'>new_cert</a>         3050 ext/openssl/openssl.c 	new_cert = NULL;</span>
<span class='curline'><a href='../S/851.html#L3054'>new_cert</a>         3054 ext/openssl/openssl.c 	if (cert == new_cert) {</span>
<span class='curline'><a href='../S/851.html#L3071'>new_cert</a>         3071 ext/openssl/openssl.c 	if (new_cert) {</span>
<span class='curline'><a href='../S/851.html#L3072'>new_cert</a>         3072 ext/openssl/openssl.c 		X509_free(new_cert);</span>
</pre>
</body>
</html>
