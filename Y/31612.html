<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>peer_cert</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/853.html#L1720'>peer_cert</a>        1720 ext/openssl/xp_ssl.c static int capture_peer_certs(php_stream *stream, php_openssl_netstream_data_t *sslsock, X509 *peer_cert) /* {{{ */</span>
<span class='curline'><a href='../S/853.html#L1729'>peer_cert</a>        1729 ext/openssl/xp_ssl.c 		ZVAL_RES(&amp;zcert, zend_register_resource(peer_cert, php_openssl_get_x509_list_id()));</span>
<span class='curline'><a href='../S/853.html#L1774'>peer_cert</a>        1774 ext/openssl/xp_ssl.c 	X509 *peer_cert;</span>
<span class='curline'><a href='../S/853.html#L1853'>peer_cert</a>        1853 ext/openssl/xp_ssl.c 			peer_cert = SSL_get_peer_certificate(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1854'>peer_cert</a>        1854 ext/openssl/xp_ssl.c 			if (peer_cert &amp;&amp; PHP_STREAM_CONTEXT(stream)) {</span>
<span class='curline'><a href='../S/853.html#L1855'>peer_cert</a>        1855 ext/openssl/xp_ssl.c 				cert_captured = capture_peer_certs(stream, sslsock, peer_cert);</span>
<span class='curline'><a href='../S/853.html#L1858'>peer_cert</a>        1858 ext/openssl/xp_ssl.c 			if (FAILURE == apply_peer_verification_policy(sslsock-&gt;ssl_handle, peer_cert, stream)) {</span>
<span class='curline'><a href='../S/853.html#L1887'>peer_cert</a>        1887 ext/openssl/xp_ssl.c 			peer_cert = SSL_get_peer_certificate(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1888'>peer_cert</a>        1888 ext/openssl/xp_ssl.c 			if (peer_cert &amp;&amp; PHP_STREAM_CONTEXT(stream)) {</span>
<span class='curline'><a href='../S/853.html#L1889'>peer_cert</a>        1889 ext/openssl/xp_ssl.c 				cert_captured = capture_peer_certs(stream, sslsock, peer_cert);</span>
<span class='curline'><a href='../S/853.html#L1893'>peer_cert</a>        1893 ext/openssl/xp_ssl.c 		if (n &amp;&amp; peer_cert &amp;&amp; cert_captured == 0) {</span>
<span class='curline'><a href='../S/853.html#L1894'>peer_cert</a>        1894 ext/openssl/xp_ssl.c 			X509_free(peer_cert);</span>
</pre>
</body>
</html>
