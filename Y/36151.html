<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>sigbuf</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/851.html#L4779'>sigbuf</a>           4779 ext/openssl/openssl.c 	zend_string *sigbuf;</span>
<span class='curline'><a href='../S/851.html#L4814'>sigbuf</a>           4814 ext/openssl/openssl.c 	sigbuf = zend_string_alloc(siglen, 0);</span>
<span class='curline'><a href='../S/851.html#L4818'>sigbuf</a>           4818 ext/openssl/openssl.c 	if (EVP_SignFinal (&amp;md_ctx, (unsigned char*)ZSTR_VAL(sigbuf), &amp;siglen, pkey)) {</span>
<span class='curline'><a href='../S/851.html#L4820'>sigbuf</a>           4820 ext/openssl/openssl.c 		ZSTR_VAL(sigbuf)[siglen] = '\0';</span>
<span class='curline'><a href='../S/851.html#L4821'>sigbuf</a>           4821 ext/openssl/openssl.c 		ZSTR_LEN(sigbuf) = siglen;</span>
<span class='curline'><a href='../S/851.html#L4822'>sigbuf</a>           4822 ext/openssl/openssl.c 		ZVAL_NEW_STR(signature, sigbuf);</span>
<span class='curline'><a href='../S/851.html#L4825'>sigbuf</a>           4825 ext/openssl/openssl.c 		efree(sigbuf);</span>
<span class='curline'><a href='../S/851.html#L5160'>sigbuf</a>           5160 ext/openssl/openssl.c 	zend_string *sigbuf;</span>
<span class='curline'><a href='../S/851.html#L5172'>sigbuf</a>           5172 ext/openssl/openssl.c 	sigbuf = zend_string_alloc(siglen, 0);</span>
<span class='curline'><a href='../S/851.html#L5176'>sigbuf</a>           5176 ext/openssl/openssl.c 	if (EVP_DigestFinal (&amp;md_ctx, (unsigned char *)ZSTR_VAL(sigbuf), &amp;siglen)) {</span>
<span class='curline'><a href='../S/851.html#L5178'>sigbuf</a>           5178 ext/openssl/openssl.c 			ZSTR_VAL(sigbuf)[siglen] = '\0';</span>
<span class='curline'><a href='../S/851.html#L5179'>sigbuf</a>           5179 ext/openssl/openssl.c 			ZSTR_LEN(sigbuf) = siglen;</span>
<span class='curline'><a href='../S/851.html#L5180'>sigbuf</a>           5180 ext/openssl/openssl.c 			RETVAL_STR(sigbuf);</span>
<span class='curline'><a href='../S/851.html#L5185'>sigbuf</a>           5185 ext/openssl/openssl.c 			make_digest_ex(ZSTR_VAL(digest_str), (unsigned char*)ZSTR_VAL(sigbuf), siglen);</span>
<span class='curline'><a href='../S/851.html#L5187'>sigbuf</a>           5187 ext/openssl/openssl.c 			zend_string_release(sigbuf);</span>
<span class='curline'><a href='../S/851.html#L5191'>sigbuf</a>           5191 ext/openssl/openssl.c 		zend_string_release(sigbuf);</span>
<span class='curline'><a href='../S/969.html#L951'>sigbuf</a>            951 ext/phar/tar.c 	char *buf, *signature, *tmp, sigbuf[8];</span>
<span class='curline'><a href='../S/969.html#L1240'>sigbuf</a>           1240 ext/phar/tar.c 		PHAR_SET_32(sigbuf, phar-&gt;sig_flags);</span>
<span class='curline'><a href='../S/969.html#L1241'>sigbuf</a>           1241 ext/phar/tar.c 		PHAR_SET_32(sigbuf + 4, signature_length);</span>
<span class='curline'><a href='../S/969.html#L1243'>sigbuf</a>           1243 ext/phar/tar.c 		if (8 != (int)php_stream_write(entry.fp, sigbuf, 8) || signature_length != (int)php_stream_write(entry.fp, signature, signature_length)) {</span>
<span class='curline'><a href='../S/971.html#L1813'>sigbuf</a>           1813 ext/phar/util.c 			unsigned char *sigbuf;</span>
<span class='curline'><a href='../S/971.html#L1841'>sigbuf</a>           1841 ext/phar/util.c 			sigbuf = emalloc(siglen + 1);</span>
<span class='curline'><a href='../S/971.html#L1844'>sigbuf</a>           1844 ext/phar/util.c 				efree(sigbuf);</span>
<span class='curline'><a href='../S/971.html#L1853'>sigbuf</a>           1853 ext/phar/util.c 					efree(sigbuf);</span>
<span class='curline'><a href='../S/971.html#L1861'>sigbuf</a>           1861 ext/phar/util.c 			if (!EVP_SignFinal (md_ctx, sigbuf,(unsigned int *)&amp;siglen, key)) {</span>
<span class='curline'><a href='../S/971.html#L1862'>sigbuf</a>           1862 ext/phar/util.c 				efree(sigbuf);</span>
<span class='curline'><a href='../S/971.html#L1869'>sigbuf</a>           1869 ext/phar/util.c 			sigbuf[siglen] = '\0';</span>
<span class='curline'><a href='../S/971.html#L1872'>sigbuf</a>           1872 ext/phar/util.c 			sigbuf = NULL;</span>
<span class='curline'><a href='../S/971.html#L1876'>sigbuf</a>           1876 ext/phar/util.c 			if (FAILURE == phar_call_openssl_signverify(1, fp, php_stream_tell(fp), PHAR_G(openssl_privatekey), PHAR_G(openssl_privatekey_len), (char **)&amp;sigbuf, &amp;siglen)) {</span>
<span class='curline'><a href='../S/971.html#L1883'>sigbuf</a>           1883 ext/phar/util.c 			*signature = (char *) sigbuf;</span>
<span class='curline'><a href='../S/972.html#L1110'>sigbuf</a>           1110 ext/phar/zip.c 		char *signature, sigbuf[8];</span>
<span class='curline'><a href='../S/972.html#L1152'>sigbuf</a>           1152 ext/phar/zip.c 		PHAR_SET_32(sigbuf, phar-&gt;sig_flags);</span>
<span class='curline'><a href='../S/972.html#L1153'>sigbuf</a>           1153 ext/phar/zip.c 		PHAR_SET_32(sigbuf + 4, signature_length);</span>
<span class='curline'><a href='../S/972.html#L1155'>sigbuf</a>           1155 ext/phar/zip.c 		if (8 != (int)php_stream_write(entry.fp, sigbuf, 8) || signature_length != (int)php_stream_write(entry.fp, signature, signature_length)) {</span>
</pre>
</body>
</html>
