<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>signature</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/851.html#L343'>signature</a>         343 ext/openssl/openssl.c 	ZEND_ARG_INFO(1, signature)</span>
<span class='curline'><a href='../S/851.html#L350'>signature</a>         350 ext/openssl/openssl.c 	ZEND_ARG_INFO(0, signature)</span>
<span class='curline'><a href='../S/851.html#L4776'>signature</a>        4776 ext/openssl/openssl.c 	zval *key, *signature;</span>
<span class='curline'><a href='../S/851.html#L4788'>signature</a>        4788 ext/openssl/openssl.c 	if (zend_parse_parameters(ZEND_NUM_ARGS(), "sz/z|z", &amp;data, &amp;data_len, &amp;signature, &amp;key, &amp;method) == FAILURE) {</span>
<span class='curline'><a href='../S/851.html#L4819'>signature</a>        4819 ext/openssl/openssl.c 		zval_dtor(signature);</span>
<span class='curline'><a href='../S/851.html#L4822'>signature</a>        4822 ext/openssl/openssl.c 		ZVAL_NEW_STR(signature, sigbuf);</span>
<span class='curline'><a href='../S/851.html#L4847'>signature</a>        4847 ext/openssl/openssl.c 	char * signature;</span>
<span class='curline'><a href='../S/851.html#L4852'>signature</a>        4852 ext/openssl/openssl.c 	if (zend_parse_parameters(ZEND_NUM_ARGS(), "ssz|z", &amp;data, &amp;data_len, &amp;signature, &amp;signature_len, &amp;key, &amp;method) == FAILURE) {</span>
<span class='curline'><a href='../S/851.html#L4856'>signature</a>        4856 ext/openssl/openssl.c 	PHP_OPENSSL_CHECK_SIZE_T_TO_UINT(signature_len, signature);</span>
<span class='curline'><a href='../S/851.html#L4882'>signature</a>        4882 ext/openssl/openssl.c 	err = EVP_VerifyFinal(&amp;md_ctx, (unsigned char *)signature, (unsigned int)signature_len, pkey);</span>
<span class='curline'><a href='../S/960.html#L218'>signature</a>         218 ext/phar/phar.c 	if (phar-&gt;signature) {</span>
<span class='curline'><a href='../S/960.html#L219'>signature</a>         219 ext/phar/phar.c 		pefree(phar-&gt;signature, phar-&gt;is_persistent);</span>
<span class='curline'><a href='../S/960.html#L220'>signature</a>         220 ext/phar/phar.c 		phar-&gt;signature = NULL;</span>
<span class='curline'><a href='../S/960.html#L498'>signature</a>         498 ext/phar/phar.c 	if (signature) {\</span>
<span class='curline'><a href='../S/960.html#L499'>signature</a>         499 ext/phar/phar.c 		pefree(signature, PHAR_G(persist));\</span>
<span class='curline'><a href='../S/960.html#L662'>signature</a>         662 ext/phar/phar.c 	char *signature = NULL;</span>
<span class='curline'><a href='../S/960.html#L814'>signature</a>         814 ext/phar/phar.c 				if (FAILURE == phar_verify_signature(fp, end_of_phar, PHAR_SIG_OPENSSL, sig, signature_len, fname, &amp;signature, &amp;sig_len, error)) {</span>
<span class='curline'><a href='../S/960.html#L844'>signature</a>         844 ext/phar/phar.c 				if (FAILURE == phar_verify_signature(fp, read_len, PHAR_SIG_SHA512, (char *)digest, 64, fname, &amp;signature, &amp;sig_len, error)) {</span>
<span class='curline'><a href='../S/960.html#L871'>signature</a>         871 ext/phar/phar.c 				if (FAILURE == phar_verify_signature(fp, read_len, PHAR_SIG_SHA256, (char *)digest, 32, fname, &amp;signature, &amp;sig_len, error)) {</span>
<span class='curline'><a href='../S/960.html#L909'>signature</a>         909 ext/phar/phar.c 				if (FAILURE == phar_verify_signature(fp, read_len, PHAR_SIG_SHA1, (char *)digest, 20, fname, &amp;signature, &amp;sig_len, error)) {</span>
<span class='curline'><a href='../S/960.html#L936'>signature</a>         936 ext/phar/phar.c 				if (FAILURE == phar_verify_signature(fp, read_len, PHAR_SIG_MD5, (char *)digest, 16, fname, &amp;signature, &amp;sig_len, error)) {</span>
<span class='curline'><a href='../S/960.html#L989'>signature</a>         989 ext/phar/phar.c 			if (signature) {</span>
<span class='curline'><a href='../S/960.html#L990'>signature</a>         990 ext/phar/phar.c 				efree(signature);</span>
<span class='curline'><a href='../S/960.html#L1201'>signature</a>        1201 ext/phar/phar.c 	mydata-&gt;signature = signature;</span>
<span class='curline'><a href='../S/960.html#L1210'>signature</a>        1210 ext/phar/phar.c 			signature = NULL;</span>
<span class='curline'><a href='../S/960.html#L1217'>signature</a>        1217 ext/phar/phar.c 				signature = NULL;</span>
<span class='curline'><a href='../S/960.html#L2380'>signature</a>        2380 ext/phar/phar.c 			if (desc.signature[0] == 'P' &amp;&amp; desc.signature[1] == 'K') {</span>
<span class='curline'><a href='../S/960.html#L3099'>signature</a>        3099 ext/phar/phar.c 		if (phar-&gt;signature) {</span>
<span class='curline'><a href='../S/960.html#L3100'>signature</a>        3100 ext/phar/phar.c 			efree(phar-&gt;signature);</span>
<span class='curline'><a href='../S/960.html#L3101'>signature</a>        3101 ext/phar/phar.c 			phar-&gt;signature = NULL;</span>
<span class='curline'><a href='../S/961.html#L311'>signature</a>         311 ext/phar/phar_internal.h 	char                     *signature;</span>
<span class='curline'><a href='../S/961.html#L555'>signature</a>         555 ext/phar/phar_internal.h int phar_verify_signature(php_stream *fp, size_t end_of_phar, php_uint32 sig_type, char *sig, int sig_len, char *fname, char **signature, int *signature_len, char **error);</span>
<span class='curline'><a href='../S/961.html#L556'>signature</a>         556 ext/phar/phar_internal.h int phar_create_signature(phar_archive_data *phar, php_stream *fp, char **signature, int *signature_length, char **error);</span>
<span class='curline'><a href='../S/962.html#L3051'>signature</a>        3051 ext/phar/phar_object.c 	if (phar_obj-&gt;archive-&gt;signature) {</span>
<span class='curline'><a href='../S/962.html#L3055'>signature</a>        3055 ext/phar/phar_object.c 		add_assoc_stringl(return_value, "hash", phar_obj-&gt;archive-&gt;signature, phar_obj-&gt;archive-&gt;sig_len);</span>
<span class='curline'><a href='../S/964.html#L23'>signature</a>          23 ext/phar/pharzip.h 	char signature[4];       /* local file header signature     4 bytes  (0x04034b50) */</span>
<span class='curline'><a href='../S/964.html#L40'>signature</a>          40 ext/phar/pharzip.h 	char signature[4];  /* signature (optional)            4 bytes */</span>
<span class='curline'><a href='../S/964.html#L56'>signature</a>          56 ext/phar/pharzip.h 	char signature[4];   /* archive extra data signature    4 bytes  (0x08064b50) */</span>
<span class='curline'><a href='../S/964.html#L152'>signature</a>         152 ext/phar/pharzip.h 	char signature[4];            /* central file header signature   4 bytes  (0x02014b50) */</span>
<span class='curline'><a href='../S/964.html#L176'>signature</a>         176 ext/phar/pharzip.h 	char signature[4];  /* header signature                4 bytes  (0x05054b50) */</span>
<span class='curline'><a href='../S/964.html#L182'>signature</a>         182 ext/phar/pharzip.h 	char signature[4];        /* zip64 end of central dir</span>
<span class='curline'><a href='../S/964.html#L209'>signature</a>         209 ext/phar/pharzip.h 	char signature[4];     /* zip64 end of central dir locator</span>
<span class='curline'><a href='../S/964.html#L221'>signature</a>         221 ext/phar/pharzip.h 	char signature[4];           /* end of central dir signature    4 bytes  (0x06054b50) */</span>
<span class='curline'><a href='../S/969.html#L305'>signature</a>         305 ext/phar/tar.c 			if (FAILURE == phar_verify_signature(fp, php_stream_tell(fp) - size - 512, myphar-&gt;sig_flags, buf + 8, size - 8, fname, &amp;myphar-&gt;signature, &amp;myphar-&gt;sig_len, error)) {</span>
<span class='curline'><a href='../S/969.html#L602'>signature</a>         602 ext/phar/tar.c 	if (!myphar-&gt;is_data &amp;&amp; PHAR_G(require_hash) &amp;&amp; !myphar-&gt;signature) {</span>
<span class='curline'><a href='../S/969.html#L951'>signature</a>         951 ext/phar/tar.c 	char *buf, *signature, *tmp, sigbuf[8];</span>
<span class='curline'><a href='../S/969.html#L1209'>signature</a>        1209 ext/phar/tar.c 		if (FAILURE == phar_create_signature(phar, newfile, &amp;signature, &amp;signature_length, error)) {</span>
<span class='curline'><a href='../S/969.html#L1243'>signature</a>        1243 ext/phar/tar.c 		if (8 != (int)php_stream_write(entry.fp, sigbuf, 8) || signature_length != (int)php_stream_write(entry.fp, signature, signature_length)) {</span>
<span class='curline'><a href='../S/969.html#L1244'>signature</a>        1244 ext/phar/tar.c 			efree(signature);</span>
<span class='curline'><a href='../S/969.html#L1256'>signature</a>        1256 ext/phar/tar.c 		efree(signature);</span>
<span class='curline'><a href='../S/971.html#L41'>signature</a>          41 ext/phar/util.c static int phar_call_openssl_signverify(int is_sign, php_stream *fp, zend_off_t end, char *key, int key_len, char **signature, int *signature_len);</span>
<span class='curline'><a href='../S/971.html#L1378'>signature</a>        1378 ext/phar/util.c static int phar_hex_str(const char *digest, size_t digest_len, char **signature) /* {{{ */</span>
<span class='curline'><a href='../S/971.html#L1383'>signature</a>        1383 ext/phar/util.c 	*signature = (char*)safe_pemalloc(digest_len, 2, 1, PHAR_G(persist));</span>
<span class='curline'><a href='../S/971.html#L1386'>signature</a>        1386 ext/phar/util.c 		(*signature)[++pos] = hexChars[((const unsigned char *)digest)[len] &gt;&gt; 4];</span>
<span class='curline'><a href='../S/971.html#L1387'>signature</a>        1387 ext/phar/util.c 		(*signature)[++pos] = hexChars[((const unsigned char *)digest)[len] &amp; 0x0F];</span>
<span class='curline'><a href='../S/971.html#L1389'>signature</a>        1389 ext/phar/util.c 	(*signature)[++pos] = '\0';</span>
<span class='curline'><a href='../S/971.html#L1395'>signature</a>        1395 ext/phar/util.c static int phar_call_openssl_signverify(int is_sign, php_stream *fp, zend_off_t end, char *key, int key_len, char **signature, int *signature_len) /* {{{ */</span>
<span class='curline'><a href='../S/971.html#L1403'>signature</a>        1403 ext/phar/util.c 	ZVAL_STRINGL(&amp;zp[1], *signature, *signature_len);</span>
<span class='curline'><a href='../S/971.html#L1471'>signature</a>        1471 ext/phar/util.c 			*signature = estrndup(Z_STRVAL(zp[1]), Z_STRLEN(zp[1]));</span>
<span class='curline'><a href='../S/971.html#L1483'>signature</a>        1483 ext/phar/util.c int phar_verify_signature(php_stream *fp, size_t end_of_phar, php_uint32 sig_type, char *sig, int sig_len, char *fname, char **signature, int *signature_len, char **error) /* {{{ */</span>
<span class='curline'><a href='../S/971.html#L1604'>signature</a>        1604 ext/phar/util.c 			*signature_len = phar_hex_str((const char*)sig, sig_len, signature);</span>
<span class='curline'><a href='../S/971.html#L1638'>signature</a>        1638 ext/phar/util.c 			*signature_len = phar_hex_str((const char*)digest, sizeof(digest), signature);</span>
<span class='curline'><a href='../S/971.html#L1671'>signature</a>        1671 ext/phar/util.c 			*signature_len = phar_hex_str((const char*)digest, sizeof(digest), signature);</span>
<span class='curline'><a href='../S/971.html#L1712'>signature</a>        1712 ext/phar/util.c 			*signature_len = phar_hex_str((const char*)digest, sizeof(digest), signature);</span>
<span class='curline'><a href='../S/971.html#L1745'>signature</a>        1745 ext/phar/util.c 			*signature_len = phar_hex_str((const char*)digest, sizeof(digest), signature);</span>
<span class='curline'><a href='../S/971.html#L1758'>signature</a>        1758 ext/phar/util.c int phar_create_signature(phar_archive_data *phar, php_stream *fp, char **signature, int *signature_length, char **error) /* {{{ */</span>
<span class='curline'><a href='../S/971.html#L1765'>signature</a>        1765 ext/phar/util.c 	if (phar-&gt;signature) {</span>
<span class='curline'><a href='../S/971.html#L1766'>signature</a>        1766 ext/phar/util.c 		efree(phar-&gt;signature);</span>
<span class='curline'><a href='../S/971.html#L1767'>signature</a>        1767 ext/phar/util.c 		phar-&gt;signature = NULL;</span>
<span class='curline'><a href='../S/971.html#L1783'>signature</a>        1783 ext/phar/util.c 			*signature = estrndup((char *) digest, 64);</span>
<span class='curline'><a href='../S/971.html#L1798'>signature</a>        1798 ext/phar/util.c 			*signature = estrndup((char *) digest, 32);</span>
<span class='curline'><a href='../S/971.html#L1883'>signature</a>        1883 ext/phar/util.c 			*signature = (char *) sigbuf;</span>
<span class='curline'><a href='../S/971.html#L1900'>signature</a>        1900 ext/phar/util.c 			*signature = estrndup((char *) digest, 20);</span>
<span class='curline'><a href='../S/971.html#L1915'>signature</a>        1915 ext/phar/util.c 			*signature = estrndup((char *) digest, 16);</span>
<span class='curline'><a href='../S/971.html#L1921'>signature</a>        1921 ext/phar/util.c 	phar-&gt;sig_len = phar_hex_str((const char *)*signature, *signature_length, &amp;phar-&gt;signature);</span>
<span class='curline'><a href='../S/971.html#L1998'>signature</a>        1998 ext/phar/util.c 	if (phar-&gt;signature) {</span>
<span class='curline'><a href='../S/971.html#L1999'>signature</a>        1999 ext/phar/util.c 		phar-&gt;signature = estrdup(phar-&gt;signature);</span>
<span class='curline'><a href='../S/972.html#L303'>signature</a>         303 ext/phar/zip.c 			if (mydata-&gt;signature) { \</span>
<span class='curline'><a href='../S/972.html#L304'>signature</a>         304 ext/phar/zip.c 				efree(mydata-&gt;signature); \</span>
<span class='curline'><a href='../S/972.html#L325'>signature</a>         325 ext/phar/zip.c 			if (mydata-&gt;signature) { \</span>
<span class='curline'><a href='../S/972.html#L326'>signature</a>         326 ext/phar/zip.c 				efree(mydata-&gt;signature); \</span>
<span class='curline'><a href='../S/972.html#L348'>signature</a>         348 ext/phar/zip.c 		if (memcmp("PK\1\2", zipentry.signature, 4)) {</span>
<span class='curline'><a href='../S/972.html#L427'>signature</a>         427 ext/phar/zip.c 			if (FAILURE == phar_verify_signature(sigfile, php_stream_tell(sigfile), mydata-&gt;sig_flags, sig + 8, entry.uncompressed_filesize - 8, fname, &amp;mydata-&gt;signature, &amp;mydata-&gt;sig_len, error)) {</span>
<span class='curline'><a href='../S/972.html#L816'>signature</a>         816 ext/phar/zip.c 	strncpy(local.signature, "PK\3\4", 4);</span>
<span class='curline'><a href='../S/972.html#L817'>signature</a>         817 ext/phar/zip.c 	strncpy(central.signature, "PK\1\2", 4);</span>
<span class='curline'><a href='../S/972.html#L1110'>signature</a>        1110 ext/phar/zip.c 		char *signature, sigbuf[8];</span>
<span class='curline'><a href='../S/972.html#L1131'>signature</a>        1131 ext/phar/zip.c 		if (FAILURE == phar_create_signature(phar, newfile, &amp;signature, &amp;signature_length, pass-&gt;error)) {</span>
<span class='curline'><a href='../S/972.html#L1155'>signature</a>        1155 ext/phar/zip.c 		if (8 != (int)php_stream_write(entry.fp, sigbuf, 8) || signature_length != (int)php_stream_write(entry.fp, signature, signature_length)) {</span>
<span class='curline'><a href='../S/972.html#L1156'>signature</a>        1156 ext/phar/zip.c 			efree(signature);</span>
<span class='curline'><a href='../S/972.html#L1165'>signature</a>        1165 ext/phar/zip.c 		efree(signature);</span>
<span class='curline'><a href='../S/972.html#L1425'>signature</a>        1425 ext/phar/zip.c 	strncpy(eocd.signature, "PK\5\6", 4);</span>
</pre>
</body>
</html>
