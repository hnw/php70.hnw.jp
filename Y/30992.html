<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>pWal</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/1054.html#L41571'>pWal</a>             41571 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalClose(Wal *pWal, int sync_flags, int, u8 *);</span>
<span class='curline'><a href='../S/1054.html#L41583'>pWal</a>             41583 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalBeginReadTransaction(Wal *pWal, int *);</span>
<span class='curline'><a href='../S/1054.html#L41584'>pWal</a>             41584 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE void sqlite3WalEndReadTransaction(Wal *pWal);</span>
<span class='curline'><a href='../S/1054.html#L41591'>pWal</a>             41591 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE Pgno sqlite3WalDbsize(Wal *pWal);</span>
<span class='curline'><a href='../S/1054.html#L41594'>pWal</a>             41594 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalBeginWriteTransaction(Wal *pWal);</span>
<span class='curline'><a href='../S/1054.html#L41595'>pWal</a>             41595 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalEndWriteTransaction(Wal *pWal);</span>
<span class='curline'><a href='../S/1054.html#L41598'>pWal</a>             41598 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalUndo(Wal *pWal, int (*xUndo)(void *, Pgno), void *pUndoCtx);</span>
<span class='curline'><a href='../S/1054.html#L41602'>pWal</a>             41602 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE void sqlite3WalSavepoint(Wal *pWal, u32 *aWalData);</span>
<span class='curline'><a href='../S/1054.html#L41606'>pWal</a>             41606 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalSavepointUndo(Wal *pWal, u32 *aWalData);</span>
<span class='curline'><a href='../S/1054.html#L41609'>pWal</a>             41609 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalFrames(Wal *pWal, int, PgHdr *, Pgno, int, int);</span>
<span class='curline'><a href='../S/1054.html#L41613'>pWal</a>             41613 ext/sqlite3/libsqlite/sqlite3.c   Wal *pWal,                      /* Write-ahead log connection */</span>
<span class='curline'><a href='../S/1054.html#L41629'>pWal</a>             41629 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalCallback(Wal *pWal);</span>
<span class='curline'><a href='../S/1054.html#L41634'>pWal</a>             41634 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalExclusiveMode(Wal *pWal, int op);</span>
<span class='curline'><a href='../S/1054.html#L41640'>pWal</a>             41640 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalHeapMemory(Wal *pWal);</span>
<span class='curline'><a href='../S/1054.html#L41646'>pWal</a>             41646 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalFramesize(Wal *pWal);</span>
<span class='curline'><a href='../S/1054.html#L42333'>pWal</a>             42333 ext/sqlite3/libsqlite/sqlite3.c   Wal *pWal;                  /* Write-ahead log used by "journal_mode=wal" */</span>
<span class='curline'><a href='../S/1054.html#L42449'>pWal</a>             42449 ext/sqlite3/libsqlite/sqlite3.c   return (pPager-&gt;pWal!=0);</span>
<span class='curline'><a href='../S/1054.html#L43398'>pWal</a>             43398 ext/sqlite3/libsqlite/sqlite3.c     sqlite3WalEndReadTransaction(pPager-&gt;pWal);</span>
<span class='curline'><a href='../S/1054.html#L43640'>pWal</a>             43640 ext/sqlite3/libsqlite/sqlite3.c     rc2 = sqlite3WalEndWriteTransaction(pPager-&gt;pWal);</span>
<span class='curline'><a href='../S/1054.html#L43659'>pWal</a>             43659 ext/sqlite3/libsqlite/sqlite3.c    &amp;&amp; (!pagerUseWal(pPager) || sqlite3WalExclusiveMode(pPager-&gt;pWal, 0))</span>
<span class='curline'><a href='../S/1054.html#L44521'>pWal</a>             44521 ext/sqlite3/libsqlite/sqlite3.c     rc = sqlite3WalReadFrame(pPager-&gt;pWal, iFrame, pgsz, pPg-&gt;pData);</span>
<span class='curline'><a href='../S/1054.html#L44610'>pWal</a>             44610 ext/sqlite3/libsqlite/sqlite3.c       rc = sqlite3WalFindFrame(pPager-&gt;pWal, pPg-&gt;pgno, &amp;iFrame);</span>
<span class='curline'><a href='../S/1054.html#L44649'>pWal</a>             44649 ext/sqlite3/libsqlite/sqlite3.c   rc = sqlite3WalUndo(pPager-&gt;pWal, pagerUndoCallback, (void *)pPager);</span>
<span class='curline'><a href='../S/1054.html#L44679'>pWal</a>             44679 ext/sqlite3/libsqlite/sqlite3.c   assert( pPager-&gt;pWal );</span>
<span class='curline'><a href='../S/1054.html#L44709'>pWal</a>             44709 ext/sqlite3/libsqlite/sqlite3.c   rc = sqlite3WalFrames(pPager-&gt;pWal, </span>
<span class='curline'><a href='../S/1054.html#L44748'>pWal</a>             44748 ext/sqlite3/libsqlite/sqlite3.c   sqlite3WalEndReadTransaction(pPager-&gt;pWal);</span>
<span class='curline'><a href='../S/1054.html#L44750'>pWal</a>             44750 ext/sqlite3/libsqlite/sqlite3.c   rc = sqlite3WalBeginReadTransaction(pPager-&gt;pWal, &amp;changed);</span>
<span class='curline'><a href='../S/1054.html#L44780'>pWal</a>             44780 ext/sqlite3/libsqlite/sqlite3.c   nPage = sqlite3WalDbsize(pPager-&gt;pWal);</span>
<span class='curline'><a href='../S/1054.html#L44991'>pWal</a>             44991 ext/sqlite3/libsqlite/sqlite3.c       rc = sqlite3WalSavepointUndo(pPager-&gt;pWal, pSavepoint-&gt;aWalData);</span>
<span class='curline'><a href='../S/1054.html#L45609'>pWal</a>             45609 ext/sqlite3/libsqlite/sqlite3.c   sqlite3WalClose(pPager-&gt;pWal, pPager-&gt;ckptSyncFlags, pPager-&gt;pageSize, pTmp);</span>
<span class='curline'><a href='../S/1054.html#L45610'>pWal</a>             45610 ext/sqlite3/libsqlite/sqlite3.c   pPager-&gt;pWal = 0;</span>
<span class='curline'><a href='../S/1054.html#L46811'>pWal</a>             46811 ext/sqlite3/libsqlite/sqlite3.c     assert( pPager-&gt;pWal==0 || rc==SQLITE_OK );</span>
<span class='curline'><a href='../S/1054.html#L46936'>pWal</a>             46936 ext/sqlite3/libsqlite/sqlite3.c       rc = sqlite3WalFindFrame(pPager-&gt;pWal, pgno, &amp;iFrame);</span>
<span class='curline'><a href='../S/1054.html#L47035'>pWal</a>             47035 ext/sqlite3/libsqlite/sqlite3.c         rc = sqlite3WalFindFrame(pPager-&gt;pWal, pgno, &amp;iFrame);</span>
<span class='curline'><a href='../S/1054.html#L47230'>pWal</a>             47230 ext/sqlite3/libsqlite/sqlite3.c       if( pPager-&gt;exclusiveMode &amp;&amp; sqlite3WalExclusiveMode(pPager-&gt;pWal, -1) ){</span>
<span class='curline'><a href='../S/1054.html#L47235'>pWal</a>             47235 ext/sqlite3/libsqlite/sqlite3.c         sqlite3WalExclusiveMode(pPager-&gt;pWal, 1);</span>
<span class='curline'><a href='../S/1054.html#L47243'>pWal</a>             47243 ext/sqlite3/libsqlite/sqlite3.c       rc = sqlite3WalBeginWriteTransaction(pPager-&gt;pWal);</span>
<span class='curline'><a href='../S/1054.html#L48155'>pWal</a>             48155 ext/sqlite3/libsqlite/sqlite3.c         sqlite3WalSavepoint(pPager-&gt;pWal, aNew[ii].aWalData);</span>
<span class='curline'><a href='../S/1054.html#L48530'>pWal</a>             48530 ext/sqlite3/libsqlite/sqlite3.c   assert( pPager-&gt;exclusiveMode || 0==sqlite3WalHeapMemory(pPager-&gt;pWal) );</span>
<span class='curline'><a href='../S/1054.html#L48531'>pWal</a>             48531 ext/sqlite3/libsqlite/sqlite3.c   if( eMode&gt;=0 &amp;&amp; !pPager-&gt;tempFile &amp;&amp; !sqlite3WalHeapMemory(pPager-&gt;pWal) ){</span>
<span class='curline'><a href='../S/1054.html#L48680'>pWal</a>             48680 ext/sqlite3/libsqlite/sqlite3.c     sqlite3WalLimit(pPager-&gt;pWal, iLimit);</span>
<span class='curline'><a href='../S/1054.html#L48714'>pWal</a>             48714 ext/sqlite3/libsqlite/sqlite3.c   if( pPager-&gt;pWal ){</span>
<span class='curline'><a href='../S/1054.html#L48715'>pWal</a>             48715 ext/sqlite3/libsqlite/sqlite3.c     rc = sqlite3WalCheckpoint(pPager-&gt;pWal, eMode,</span>
<span class='curline'><a href='../S/1054.html#L48726'>pWal</a>             48726 ext/sqlite3/libsqlite/sqlite3.c   return sqlite3WalCallback(pPager-&gt;pWal);</span>
<span class='curline'><a href='../S/1054.html#L48765'>pWal</a>             48765 ext/sqlite3/libsqlite/sqlite3.c   assert( pPager-&gt;pWal==0 &amp;&amp; pPager-&gt;tempFile==0 );</span>
<span class='curline'><a href='../S/1054.html#L48783'>pWal</a>             48783 ext/sqlite3/libsqlite/sqlite3.c         pPager-&gt;journalSizeLimit, &amp;pPager-&gt;pWal</span>
<span class='curline'><a href='../S/1054.html#L48817'>pWal</a>             48817 ext/sqlite3/libsqlite/sqlite3.c   assert( pbOpen!=0 || (!pPager-&gt;tempFile &amp;&amp; !pPager-&gt;pWal) );</span>
<span class='curline'><a href='../S/1054.html#L48819'>pWal</a>             48819 ext/sqlite3/libsqlite/sqlite3.c   if( !pPager-&gt;tempFile &amp;&amp; !pPager-&gt;pWal ){</span>
<span class='curline'><a href='../S/1054.html#L48855'>pWal</a>             48855 ext/sqlite3/libsqlite/sqlite3.c   if( !pPager-&gt;pWal ){</span>
<span class='curline'><a href='../S/1054.html#L48871'>pWal</a>             48871 ext/sqlite3/libsqlite/sqlite3.c   if( rc==SQLITE_OK &amp;&amp; pPager-&gt;pWal ){</span>
<span class='curline'><a href='../S/1054.html#L48874'>pWal</a>             48874 ext/sqlite3/libsqlite/sqlite3.c       rc = sqlite3WalClose(pPager-&gt;pWal, pPager-&gt;ckptSyncFlags,</span>
<span class='curline'><a href='../S/1054.html#L48876'>pWal</a>             48876 ext/sqlite3/libsqlite/sqlite3.c       pPager-&gt;pWal = 0;</span>
<span class='curline'><a href='../S/1054.html#L48895'>pWal</a>             48895 ext/sqlite3/libsqlite/sqlite3.c   return sqlite3WalFramesize(pPager-&gt;pWal);</span>
<span class='curline'><a href='../S/1054.html#L49420'>pWal</a>             49420 ext/sqlite3/libsqlite/sqlite3.c static int walIndexPage(Wal *pWal, int iPage, volatile u32 **ppPage){</span>
<span class='curline'><a href='../S/1054.html#L49424'>pWal</a>             49424 ext/sqlite3/libsqlite/sqlite3.c   if( pWal-&gt;nWiData&lt;=iPage ){</span>
<span class='curline'><a href='../S/1054.html#L49427'>pWal</a>             49427 ext/sqlite3/libsqlite/sqlite3.c     apNew = (volatile u32 **)sqlite3_realloc64((void *)pWal-&gt;apWiData, nByte);</span>
<span class='curline'><a href='../S/1054.html#L49432'>pWal</a>             49432 ext/sqlite3/libsqlite/sqlite3.c     memset((void*)&amp;apNew[pWal-&gt;nWiData], 0,</span>
<span class='curline'><a href='../S/1054.html#L49433'>pWal</a>             49433 ext/sqlite3/libsqlite/sqlite3.c            sizeof(u32*)*(iPage+1-pWal-&gt;nWiData));</span>
<span class='curline'><a href='../S/1054.html#L49434'>pWal</a>             49434 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;apWiData = apNew;</span>
<span class='curline'><a href='../S/1054.html#L49435'>pWal</a>             49435 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;nWiData = iPage+1;</span>
<span class='curline'><a href='../S/1054.html#L49439'>pWal</a>             49439 ext/sqlite3/libsqlite/sqlite3.c   if( pWal-&gt;apWiData[iPage]==0 ){</span>
<span class='curline'><a href='../S/1054.html#L49440'>pWal</a>             49440 ext/sqlite3/libsqlite/sqlite3.c     if( pWal-&gt;exclusiveMode==WAL_HEAPMEMORY_MODE ){</span>
<span class='curline'><a href='../S/1054.html#L49441'>pWal</a>             49441 ext/sqlite3/libsqlite/sqlite3.c       pWal-&gt;apWiData[iPage] = (u32 volatile *)sqlite3MallocZero(WALINDEX_PGSZ);</span>
<span class='curline'><a href='../S/1054.html#L49442'>pWal</a>             49442 ext/sqlite3/libsqlite/sqlite3.c       if( !pWal-&gt;apWiData[iPage] ) rc = SQLITE_NOMEM;</span>
<span class='curline'><a href='../S/1054.html#L49444'>pWal</a>             49444 ext/sqlite3/libsqlite/sqlite3.c       rc = sqlite3OsShmMap(pWal-&gt;pDbFd, iPage, WALINDEX_PGSZ, </span>
<span class='curline'><a href='../S/1054.html#L49445'>pWal</a>             49445 ext/sqlite3/libsqlite/sqlite3.c           pWal-&gt;writeLock, (void volatile **)&amp;pWal-&gt;apWiData[iPage]</span>
<span class='curline'><a href='../S/1054.html#L49448'>pWal</a>             49448 ext/sqlite3/libsqlite/sqlite3.c         pWal-&gt;readOnly |= WAL_SHM_RDONLY;</span>
<span class='curline'><a href='../S/1054.html#L49454'>pWal</a>             49454 ext/sqlite3/libsqlite/sqlite3.c   *ppPage = pWal-&gt;apWiData[iPage];</span>
<span class='curline'><a href='../S/1054.html#L49462'>pWal</a>             49462 ext/sqlite3/libsqlite/sqlite3.c static volatile WalCkptInfo *walCkptInfo(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L49463'>pWal</a>             49463 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;nWiData&gt;0 &amp;&amp; pWal-&gt;apWiData[0] );</span>
<span class='curline'><a href='../S/1054.html#L49464'>pWal</a>             49464 ext/sqlite3/libsqlite/sqlite3.c   return (volatile WalCkptInfo*)&amp;(pWal-&gt;apWiData[0][sizeof(WalIndexHdr)/2]);</span>
<span class='curline'><a href='../S/1054.html#L49470'>pWal</a>             49470 ext/sqlite3/libsqlite/sqlite3.c static volatile WalIndexHdr *walIndexHdr(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L49471'>pWal</a>             49471 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;nWiData&gt;0 &amp;&amp; pWal-&gt;apWiData[0] );</span>
<span class='curline'><a href='../S/1054.html#L49472'>pWal</a>             49472 ext/sqlite3/libsqlite/sqlite3.c   return (volatile WalIndexHdr*)pWal-&gt;apWiData[0];</span>
<span class='curline'><a href='../S/1054.html#L49534'>pWal</a>             49534 ext/sqlite3/libsqlite/sqlite3.c static void walShmBarrier(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L49535'>pWal</a>             49535 ext/sqlite3/libsqlite/sqlite3.c   if( pWal-&gt;exclusiveMode!=WAL_HEAPMEMORY_MODE ){</span>
<span class='curline'><a href='../S/1054.html#L49536'>pWal</a>             49536 ext/sqlite3/libsqlite/sqlite3.c     sqlite3OsShmBarrier(pWal-&gt;pDbFd);</span>
<span class='curline'><a href='../S/1054.html#L49545'>pWal</a>             49545 ext/sqlite3/libsqlite/sqlite3.c static void walIndexWriteHdr(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L49546'>pWal</a>             49546 ext/sqlite3/libsqlite/sqlite3.c   volatile WalIndexHdr *aHdr = walIndexHdr(pWal);</span>
<span class='curline'><a href='../S/1054.html#L49549'>pWal</a>             49549 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;writeLock );</span>
<span class='curline'><a href='../S/1054.html#L49550'>pWal</a>             49550 ext/sqlite3/libsqlite/sqlite3.c   pWal-&gt;hdr.isInit = 1;</span>
<span class='curline'><a href='../S/1054.html#L49551'>pWal</a>             49551 ext/sqlite3/libsqlite/sqlite3.c   pWal-&gt;hdr.iVersion = WALINDEX_MAX_VERSION;</span>
<span class='curline'><a href='../S/1054.html#L49552'>pWal</a>             49552 ext/sqlite3/libsqlite/sqlite3.c   walChecksumBytes(1, (u8*)&amp;pWal-&gt;hdr, nCksum, 0, pWal-&gt;hdr.aCksum);</span>
<span class='curline'><a href='../S/1054.html#L49553'>pWal</a>             49553 ext/sqlite3/libsqlite/sqlite3.c   memcpy((void *)&amp;aHdr[1], (void *)&amp;pWal-&gt;hdr, sizeof(WalIndexHdr));</span>
<span class='curline'><a href='../S/1054.html#L49554'>pWal</a>             49554 ext/sqlite3/libsqlite/sqlite3.c   walShmBarrier(pWal);</span>
<span class='curline'><a href='../S/1054.html#L49555'>pWal</a>             49555 ext/sqlite3/libsqlite/sqlite3.c   memcpy((void *)&amp;aHdr[0], (void *)&amp;pWal-&gt;hdr, sizeof(WalIndexHdr));</span>
<span class='curline'><a href='../S/1054.html#L49572'>pWal</a>             49572 ext/sqlite3/libsqlite/sqlite3.c   Wal *pWal,                      /* The write-ahead log */</span>
<span class='curline'><a href='../S/1054.html#L49579'>pWal</a>             49579 ext/sqlite3/libsqlite/sqlite3.c   u32 *aCksum = pWal-&gt;hdr.aFrameCksum;</span>
<span class='curline'><a href='../S/1054.html#L49583'>pWal</a>             49583 ext/sqlite3/libsqlite/sqlite3.c   memcpy(&amp;aFrame[8], pWal-&gt;hdr.aSalt, 8);</span>
<span class='curline'><a href='../S/1054.html#L49585'>pWal</a>             49585 ext/sqlite3/libsqlite/sqlite3.c   nativeCksum = (pWal-&gt;hdr.bigEndCksum==SQLITE_BIGENDIAN);</span>
<span class='curline'><a href='../S/1054.html#L49587'>pWal</a>             49587 ext/sqlite3/libsqlite/sqlite3.c   walChecksumBytes(nativeCksum, aData, pWal-&gt;szPage, aCksum, aCksum);</span>
<span class='curline'><a href='../S/1054.html#L49599'>pWal</a>             49599 ext/sqlite3/libsqlite/sqlite3.c   Wal *pWal,                      /* The write-ahead log */</span>
<span class='curline'><a href='../S/1054.html#L49606'>pWal</a>             49606 ext/sqlite3/libsqlite/sqlite3.c   u32 *aCksum = pWal-&gt;hdr.aFrameCksum;</span>
<span class='curline'><a href='../S/1054.html#L49613'>pWal</a>             49613 ext/sqlite3/libsqlite/sqlite3.c   if( memcmp(&amp;pWal-&gt;hdr.aSalt, &amp;aFrame[8], 8)!=0 ){</span>
<span class='curline'><a href='../S/1054.html#L49629'>pWal</a>             49629 ext/sqlite3/libsqlite/sqlite3.c   nativeCksum = (pWal-&gt;hdr.bigEndCksum==SQLITE_BIGENDIAN);</span>
<span class='curline'><a href='../S/1054.html#L49631'>pWal</a>             49631 ext/sqlite3/libsqlite/sqlite3.c   walChecksumBytes(nativeCksum, aData, pWal-&gt;szPage, aCksum, aCksum);</span>
<span class='curline'><a href='../S/1054.html#L49677'>pWal</a>             49677 ext/sqlite3/libsqlite/sqlite3.c static int walLockShared(Wal *pWal, int lockIdx){</span>
<span class='curline'><a href='../S/1054.html#L49679'>pWal</a>             49679 ext/sqlite3/libsqlite/sqlite3.c   if( pWal-&gt;exclusiveMode ) return SQLITE_OK;</span>
<span class='curline'><a href='../S/1054.html#L49680'>pWal</a>             49680 ext/sqlite3/libsqlite/sqlite3.c   rc = sqlite3OsShmLock(pWal-&gt;pDbFd, lockIdx, 1,</span>
<span class='curline'><a href='../S/1054.html#L49682'>pWal</a>             49682 ext/sqlite3/libsqlite/sqlite3.c   WALTRACE(("WAL%p: acquire SHARED-%s %s\n", pWal,</span>
<span class='curline'><a href='../S/1054.html#L49684'>pWal</a>             49684 ext/sqlite3/libsqlite/sqlite3.c   VVA_ONLY( pWal-&gt;lockError = (u8)(rc!=SQLITE_OK &amp;&amp; rc!=SQLITE_BUSY); )</span>
<span class='curline'><a href='../S/1054.html#L49687'>pWal</a>             49687 ext/sqlite3/libsqlite/sqlite3.c static void walUnlockShared(Wal *pWal, int lockIdx){</span>
<span class='curline'><a href='../S/1054.html#L49688'>pWal</a>             49688 ext/sqlite3/libsqlite/sqlite3.c   if( pWal-&gt;exclusiveMode ) return;</span>
<span class='curline'><a href='../S/1054.html#L49689'>pWal</a>             49689 ext/sqlite3/libsqlite/sqlite3.c   (void)sqlite3OsShmLock(pWal-&gt;pDbFd, lockIdx, 1,</span>
<span class='curline'><a href='../S/1054.html#L49691'>pWal</a>             49691 ext/sqlite3/libsqlite/sqlite3.c   WALTRACE(("WAL%p: release SHARED-%s\n", pWal, walLockName(lockIdx)));</span>
<span class='curline'><a href='../S/1054.html#L49693'>pWal</a>             49693 ext/sqlite3/libsqlite/sqlite3.c static int walLockExclusive(Wal *pWal, int lockIdx, int n, int fBlock){</span>
<span class='curline'><a href='../S/1054.html#L49695'>pWal</a>             49695 ext/sqlite3/libsqlite/sqlite3.c   if( pWal-&gt;exclusiveMode ) return SQLITE_OK;</span>
<span class='curline'><a href='../S/1054.html#L49696'>pWal</a>             49696 ext/sqlite3/libsqlite/sqlite3.c   if( fBlock ) sqlite3OsFileControl(pWal-&gt;pDbFd, SQLITE_FCNTL_WAL_BLOCK, 0);</span>
<span class='curline'><a href='../S/1054.html#L49697'>pWal</a>             49697 ext/sqlite3/libsqlite/sqlite3.c   rc = sqlite3OsShmLock(pWal-&gt;pDbFd, lockIdx, n,</span>
<span class='curline'><a href='../S/1054.html#L49699'>pWal</a>             49699 ext/sqlite3/libsqlite/sqlite3.c   WALTRACE(("WAL%p: acquire EXCLUSIVE-%s cnt=%d %s\n", pWal,</span>
<span class='curline'><a href='../S/1054.html#L49701'>pWal</a>             49701 ext/sqlite3/libsqlite/sqlite3.c   VVA_ONLY( pWal-&gt;lockError = (u8)(rc!=SQLITE_OK &amp;&amp; rc!=SQLITE_BUSY); )</span>
<span class='curline'><a href='../S/1054.html#L49704'>pWal</a>             49704 ext/sqlite3/libsqlite/sqlite3.c static void walUnlockExclusive(Wal *pWal, int lockIdx, int n){</span>
<span class='curline'><a href='../S/1054.html#L49705'>pWal</a>             49705 ext/sqlite3/libsqlite/sqlite3.c   if( pWal-&gt;exclusiveMode ) return;</span>
<span class='curline'><a href='../S/1054.html#L49706'>pWal</a>             49706 ext/sqlite3/libsqlite/sqlite3.c   (void)sqlite3OsShmLock(pWal-&gt;pDbFd, lockIdx, n,</span>
<span class='curline'><a href='../S/1054.html#L49708'>pWal</a>             49708 ext/sqlite3/libsqlite/sqlite3.c   WALTRACE(("WAL%p: release EXCLUSIVE-%s cnt=%d\n", pWal,</span>
<span class='curline'><a href='../S/1054.html#L49741'>pWal</a>             49741 ext/sqlite3/libsqlite/sqlite3.c   Wal *pWal,                      /* WAL handle */</span>
<span class='curline'><a href='../S/1054.html#L49750'>pWal</a>             49750 ext/sqlite3/libsqlite/sqlite3.c   rc = walIndexPage(pWal, iHash, &amp;aPgno);</span>
<span class='curline'><a href='../S/1054.html#L49792'>pWal</a>             49792 ext/sqlite3/libsqlite/sqlite3.c static u32 walFramePgno(Wal *pWal, u32 iFrame){</span>
<span class='curline'><a href='../S/1054.html#L49795'>pWal</a>             49795 ext/sqlite3/libsqlite/sqlite3.c     return pWal-&gt;apWiData[0][WALINDEX_HDR_SIZE/sizeof(u32) + iFrame - 1];</span>
<span class='curline'><a href='../S/1054.html#L49797'>pWal</a>             49797 ext/sqlite3/libsqlite/sqlite3.c   return pWal-&gt;apWiData[iHash][(iFrame-1-HASHTABLE_NPAGE_ONE)%HASHTABLE_NPAGE];</span>
<span class='curline'><a href='../S/1054.html#L49812'>pWal</a>             49812 ext/sqlite3/libsqlite/sqlite3.c static void walCleanupHash(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L49820'>pWal</a>             49820 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;writeLock );</span>
<span class='curline'><a href='../S/1054.html#L49821'>pWal</a>             49821 ext/sqlite3/libsqlite/sqlite3.c   testcase( pWal-&gt;hdr.mxFrame==HASHTABLE_NPAGE_ONE-1 );</span>
<span class='curline'><a href='../S/1054.html#L49822'>pWal</a>             49822 ext/sqlite3/libsqlite/sqlite3.c   testcase( pWal-&gt;hdr.mxFrame==HASHTABLE_NPAGE_ONE );</span>
<span class='curline'><a href='../S/1054.html#L49823'>pWal</a>             49823 ext/sqlite3/libsqlite/sqlite3.c   testcase( pWal-&gt;hdr.mxFrame==HASHTABLE_NPAGE_ONE+1 );</span>
<span class='curline'><a href='../S/1054.html#L49825'>pWal</a>             49825 ext/sqlite3/libsqlite/sqlite3.c   if( pWal-&gt;hdr.mxFrame==0 ) return;</span>
<span class='curline'><a href='../S/1054.html#L49831'>pWal</a>             49831 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;nWiData&gt;walFramePage(pWal-&gt;hdr.mxFrame) );</span>
<span class='curline'><a href='../S/1054.html#L49832'>pWal</a>             49832 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;apWiData[walFramePage(pWal-&gt;hdr.mxFrame)] );</span>
<span class='curline'><a href='../S/1054.html#L49833'>pWal</a>             49833 ext/sqlite3/libsqlite/sqlite3.c   walHashGet(pWal, walFramePage(pWal-&gt;hdr.mxFrame), &amp;aHash, &amp;aPgno, &amp;iZero);</span>
<span class='curline'><a href='../S/1054.html#L49838'>pWal</a>             49838 ext/sqlite3/libsqlite/sqlite3.c   iLimit = pWal-&gt;hdr.mxFrame - iZero;</span>
<span class='curline'><a href='../S/1054.html#L49874'>pWal</a>             49874 ext/sqlite3/libsqlite/sqlite3.c static int walIndexAppend(Wal *pWal, u32 iFrame, u32 iPage){</span>
<span class='curline'><a href='../S/1054.html#L49880'>pWal</a>             49880 ext/sqlite3/libsqlite/sqlite3.c   rc = walHashGet(pWal, walFramePage(iFrame), &amp;aHash, &amp;aPgno, &amp;iZero);</span>
<span class='curline'><a href='../S/1054.html#L49908'>pWal</a>             49908 ext/sqlite3/libsqlite/sqlite3.c       walCleanupHash(pWal);</span>
<span class='curline'><a href='../S/1054.html#L49963'>pWal</a>             49963 ext/sqlite3/libsqlite/sqlite3.c static int walIndexRecover(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L49976'>pWal</a>             49976 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;ckptLock==1 || pWal-&gt;ckptLock==0 );</span>
<span class='curline'><a href='../S/1054.html#L49979'>pWal</a>             49979 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;writeLock );</span>
<span class='curline'><a href='../S/1054.html#L49980'>pWal</a>             49980 ext/sqlite3/libsqlite/sqlite3.c   iLock = WAL_ALL_BUT_WRITE + pWal-&gt;ckptLock;</span>
<span class='curline'><a href='../S/1054.html#L49982'>pWal</a>             49982 ext/sqlite3/libsqlite/sqlite3.c   rc = walLockExclusive(pWal, iLock, nLock, 0);</span>
<span class='curline'><a href='../S/1054.html#L49986'>pWal</a>             49986 ext/sqlite3/libsqlite/sqlite3.c   WALTRACE(("WAL%p: recovery begin...\n", pWal));</span>
<span class='curline'><a href='../S/1054.html#L49988'>pWal</a>             49988 ext/sqlite3/libsqlite/sqlite3.c   memset(&amp;pWal-&gt;hdr, 0, sizeof(WalIndexHdr));</span>
<span class='curline'><a href='../S/1054.html#L49990'>pWal</a>             49990 ext/sqlite3/libsqlite/sqlite3.c   rc = sqlite3OsFileSize(pWal-&gt;pWalFd, &amp;nSize);</span>
<span class='curline'><a href='../S/1054.html#L50008'>pWal</a>             50008 ext/sqlite3/libsqlite/sqlite3.c     rc = sqlite3OsRead(pWal-&gt;pWalFd, aBuf, WAL_HDRSIZE, 0);</span>
<span class='curline'><a href='../S/1054.html#L50027'>pWal</a>             50027 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;hdr.bigEndCksum = (u8)(magic&amp;0x00000001);</span>
<span class='curline'><a href='../S/1054.html#L50028'>pWal</a>             50028 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;szPage = szPage;</span>
<span class='curline'><a href='../S/1054.html#L50029'>pWal</a>             50029 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;nCkpt = sqlite3Get4byte(&amp;aBuf[12]);</span>
<span class='curline'><a href='../S/1054.html#L50030'>pWal</a>             50030 ext/sqlite3/libsqlite/sqlite3.c     memcpy(&amp;pWal-&gt;hdr.aSalt, &amp;aBuf[16], 8);</span>
<span class='curline'><a href='../S/1054.html#L50033'>pWal</a>             50033 ext/sqlite3/libsqlite/sqlite3.c     walChecksumBytes(pWal-&gt;hdr.bigEndCksum==SQLITE_BIGENDIAN, </span>
<span class='curline'><a href='../S/1054.html#L50034'>pWal</a>             50034 ext/sqlite3/libsqlite/sqlite3.c         aBuf, WAL_HDRSIZE-2*4, 0, pWal-&gt;hdr.aFrameCksum</span>
<span class='curline'><a href='../S/1054.html#L50036'>pWal</a>             50036 ext/sqlite3/libsqlite/sqlite3.c     if( pWal-&gt;hdr.aFrameCksum[0]!=sqlite3Get4byte(&amp;aBuf[24])</span>
<span class='curline'><a href='../S/1054.html#L50037'>pWal</a>             50037 ext/sqlite3/libsqlite/sqlite3.c      || pWal-&gt;hdr.aFrameCksum[1]!=sqlite3Get4byte(&amp;aBuf[28])</span>
<span class='curline'><a href='../S/1054.html#L50067'>pWal</a>             50067 ext/sqlite3/libsqlite/sqlite3.c       rc = sqlite3OsRead(pWal-&gt;pWalFd, aFrame, szFrame, iOffset);</span>
<span class='curline'><a href='../S/1054.html#L50069'>pWal</a>             50069 ext/sqlite3/libsqlite/sqlite3.c       isValid = walDecodeFrame(pWal, &amp;pgno, &amp;nTruncate, aData, aFrame);</span>
<span class='curline'><a href='../S/1054.html#L50071'>pWal</a>             50071 ext/sqlite3/libsqlite/sqlite3.c       rc = walIndexAppend(pWal, iFrame, pgno);</span>
<span class='curline'><a href='../S/1054.html#L50076'>pWal</a>             50076 ext/sqlite3/libsqlite/sqlite3.c         pWal-&gt;hdr.mxFrame = iFrame;</span>
<span class='curline'><a href='../S/1054.html#L50077'>pWal</a>             50077 ext/sqlite3/libsqlite/sqlite3.c         pWal-&gt;hdr.nPage = nTruncate;</span>
<span class='curline'><a href='../S/1054.html#L50078'>pWal</a>             50078 ext/sqlite3/libsqlite/sqlite3.c         pWal-&gt;hdr.szPage = (u16)((szPage&amp;0xff00) | (szPage&gt;&gt;16));</span>
<span class='curline'><a href='../S/1054.html#L50081'>pWal</a>             50081 ext/sqlite3/libsqlite/sqlite3.c         aFrameCksum[0] = pWal-&gt;hdr.aFrameCksum[0];</span>
<span class='curline'><a href='../S/1054.html#L50082'>pWal</a>             50082 ext/sqlite3/libsqlite/sqlite3.c         aFrameCksum[1] = pWal-&gt;hdr.aFrameCksum[1];</span>
<span class='curline'><a href='../S/1054.html#L50093'>pWal</a>             50093 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;hdr.aFrameCksum[0] = aFrameCksum[0];</span>
<span class='curline'><a href='../S/1054.html#L50094'>pWal</a>             50094 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;hdr.aFrameCksum[1] = aFrameCksum[1];</span>
<span class='curline'><a href='../S/1054.html#L50095'>pWal</a>             50095 ext/sqlite3/libsqlite/sqlite3.c     walIndexWriteHdr(pWal);</span>
<span class='curline'><a href='../S/1054.html#L50101'>pWal</a>             50101 ext/sqlite3/libsqlite/sqlite3.c     pInfo = walCkptInfo(pWal);</span>
<span class='curline'><a href='../S/1054.html#L50105'>pWal</a>             50105 ext/sqlite3/libsqlite/sqlite3.c     if( pWal-&gt;hdr.mxFrame ) pInfo-&gt;aReadMark[1] = pWal-&gt;hdr.mxFrame;</span>
<span class='curline'><a href='../S/1054.html#L50112'>pWal</a>             50112 ext/sqlite3/libsqlite/sqlite3.c     if( pWal-&gt;hdr.nPage ){</span>
<span class='curline'><a href='../S/1054.html#L50115'>pWal</a>             50115 ext/sqlite3/libsqlite/sqlite3.c           pWal-&gt;hdr.mxFrame, pWal-&gt;zWalName</span>
<span class='curline'><a href='../S/1054.html#L50121'>pWal</a>             50121 ext/sqlite3/libsqlite/sqlite3.c   WALTRACE(("WAL%p: recovery %s\n", pWal, rc ? "failed" : "ok"));</span>
<span class='curline'><a href='../S/1054.html#L50122'>pWal</a>             50122 ext/sqlite3/libsqlite/sqlite3.c   walUnlockExclusive(pWal, iLock, nLock);</span>
<span class='curline'><a href='../S/1054.html#L50129'>pWal</a>             50129 ext/sqlite3/libsqlite/sqlite3.c static void walIndexClose(Wal *pWal, int isDelete){</span>
<span class='curline'><a href='../S/1054.html#L50130'>pWal</a>             50130 ext/sqlite3/libsqlite/sqlite3.c   if( pWal-&gt;exclusiveMode==WAL_HEAPMEMORY_MODE ){</span>
<span class='curline'><a href='../S/1054.html#L50132'>pWal</a>             50132 ext/sqlite3/libsqlite/sqlite3.c     for(i=0; i&lt;pWal-&gt;nWiData; i++){</span>
<span class='curline'><a href='../S/1054.html#L50133'>pWal</a>             50133 ext/sqlite3/libsqlite/sqlite3.c       sqlite3_free((void *)pWal-&gt;apWiData[i]);</span>
<span class='curline'><a href='../S/1054.html#L50134'>pWal</a>             50134 ext/sqlite3/libsqlite/sqlite3.c       pWal-&gt;apWiData[i] = 0;</span>
<span class='curline'><a href='../S/1054.html#L50137'>pWal</a>             50137 ext/sqlite3/libsqlite/sqlite3.c     sqlite3OsShmUnmap(pWal-&gt;pDbFd, isDelete);</span>
<span class='curline'><a href='../S/1054.html#L50226'>pWal</a>             50226 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE void sqlite3WalLimit(Wal *pWal, i64 iLimit){</span>
<span class='curline'><a href='../S/1054.html#L50227'>pWal</a>             50227 ext/sqlite3/libsqlite/sqlite3.c   if( pWal ) pWal-&gt;mxWalSize = iLimit;</span>
<span class='curline'><a href='../S/1054.html#L50425'>pWal</a>             50425 ext/sqlite3/libsqlite/sqlite3.c static int walIteratorInit(Wal *pWal, WalIterator **pp){</span>
<span class='curline'><a href='../S/1054.html#L50437'>pWal</a>             50437 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;ckptLock &amp;&amp; pWal-&gt;hdr.mxFrame&gt;0 );</span>
<span class='curline'><a href='../S/1054.html#L50438'>pWal</a>             50438 ext/sqlite3/libsqlite/sqlite3.c   iLast = pWal-&gt;hdr.mxFrame;</span>
<span class='curline'><a href='../S/1054.html#L50467'>pWal</a>             50467 ext/sqlite3/libsqlite/sqlite3.c     rc = walHashGet(pWal, i, &amp;aHash, &amp;aPgno, &amp;iZero);</span>
<span class='curline'><a href='../S/1054.html#L50508'>pWal</a>             50508 ext/sqlite3/libsqlite/sqlite3.c   Wal *pWal,                      /* WAL connection */</span>
<span class='curline'><a href='../S/1054.html#L50516'>pWal</a>             50516 ext/sqlite3/libsqlite/sqlite3.c     rc = walLockExclusive(pWal, lockIdx, n, 0);</span>
<span class='curline'><a href='../S/1054.html#L50525'>pWal</a>             50525 ext/sqlite3/libsqlite/sqlite3.c static int walPagesize(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L50526'>pWal</a>             50526 ext/sqlite3/libsqlite/sqlite3.c   return (pWal-&gt;hdr.szPage&amp;0xfe00) + ((pWal-&gt;hdr.szPage&amp;0x0001)&lt;&lt;16);</span>
<span class='curline'><a href='../S/1054.html#L50546'>pWal</a>             50546 ext/sqlite3/libsqlite/sqlite3.c static void walRestartHdr(Wal *pWal, u32 salt1){</span>
<span class='curline'><a href='../S/1054.html#L50547'>pWal</a>             50547 ext/sqlite3/libsqlite/sqlite3.c   volatile WalCkptInfo *pInfo = walCkptInfo(pWal);</span>
<span class='curline'><a href='../S/1054.html#L50549'>pWal</a>             50549 ext/sqlite3/libsqlite/sqlite3.c   u32 *aSalt = pWal-&gt;hdr.aSalt;   /* Big-endian salt values */</span>
<span class='curline'><a href='../S/1054.html#L50550'>pWal</a>             50550 ext/sqlite3/libsqlite/sqlite3.c   pWal-&gt;nCkpt++;</span>
<span class='curline'><a href='../S/1054.html#L50551'>pWal</a>             50551 ext/sqlite3/libsqlite/sqlite3.c   pWal-&gt;hdr.mxFrame = 0;</span>
<span class='curline'><a href='../S/1054.html#L50553'>pWal</a>             50553 ext/sqlite3/libsqlite/sqlite3.c   memcpy(&amp;pWal-&gt;hdr.aSalt[1], &amp;salt1, 4);</span>
<span class='curline'><a href='../S/1054.html#L50554'>pWal</a>             50554 ext/sqlite3/libsqlite/sqlite3.c   walIndexWriteHdr(pWal);</span>
<span class='curline'><a href='../S/1054.html#L50593'>pWal</a>             50593 ext/sqlite3/libsqlite/sqlite3.c   Wal *pWal,                      /* Wal connection */</span>
<span class='curline'><a href='../S/1054.html#L50610'>pWal</a>             50610 ext/sqlite3/libsqlite/sqlite3.c   szPage = walPagesize(pWal);</span>
<span class='curline'><a href='../S/1054.html#L50613'>pWal</a>             50613 ext/sqlite3/libsqlite/sqlite3.c   pInfo = walCkptInfo(pWal);</span>
<span class='curline'><a href='../S/1054.html#L50614'>pWal</a>             50614 ext/sqlite3/libsqlite/sqlite3.c   if( pInfo-&gt;nBackfill&lt;pWal-&gt;hdr.mxFrame ){</span>
<span class='curline'><a href='../S/1054.html#L50617'>pWal</a>             50617 ext/sqlite3/libsqlite/sqlite3.c     rc = walIteratorInit(pWal, &amp;pIter);</span>
<span class='curline'><a href='../S/1054.html#L50632'>pWal</a>             50632 ext/sqlite3/libsqlite/sqlite3.c     mxSafeFrame = pWal-&gt;hdr.mxFrame;</span>
<span class='curline'><a href='../S/1054.html#L50633'>pWal</a>             50633 ext/sqlite3/libsqlite/sqlite3.c     mxPage = pWal-&gt;hdr.nPage;</span>
<span class='curline'><a href='../S/1054.html#L50645'>pWal</a>             50645 ext/sqlite3/libsqlite/sqlite3.c         assert( y&lt;=pWal-&gt;hdr.mxFrame );</span>
<span class='curline'><a href='../S/1054.html#L50646'>pWal</a>             50646 ext/sqlite3/libsqlite/sqlite3.c         rc = walBusyLock(pWal, xBusy, pBusyArg, WAL_READ_LOCK(i), 1);</span>
<span class='curline'><a href='../S/1054.html#L50649'>pWal</a>             50649 ext/sqlite3/libsqlite/sqlite3.c           walUnlockExclusive(pWal, WAL_READ_LOCK(i), 1);</span>
<span class='curline'><a href='../S/1054.html#L50660'>pWal</a>             50660 ext/sqlite3/libsqlite/sqlite3.c      &amp;&amp; (rc = walBusyLock(pWal, xBusy, pBusyArg, WAL_READ_LOCK(0),1))==SQLITE_OK</span>
<span class='curline'><a href='../S/1054.html#L50667'>pWal</a>             50667 ext/sqlite3/libsqlite/sqlite3.c         rc = sqlite3OsSync(pWal-&gt;pWalFd, sync_flags);</span>
<span class='curline'><a href='../S/1054.html#L50675'>pWal</a>             50675 ext/sqlite3/libsqlite/sqlite3.c         rc = sqlite3OsFileSize(pWal-&gt;pDbFd, &amp;nSize);</span>
<span class='curline'><a href='../S/1054.html#L50677'>pWal</a>             50677 ext/sqlite3/libsqlite/sqlite3.c           sqlite3OsFileControlHint(pWal-&gt;pDbFd, SQLITE_FCNTL_SIZE_HINT, &amp;nReq);</span>
<span class='curline'><a href='../S/1054.html#L50685'>pWal</a>             50685 ext/sqlite3/libsqlite/sqlite3.c         assert( walFramePgno(pWal, iFrame)==iDbpage );</span>
<span class='curline'><a href='../S/1054.html#L50691'>pWal</a>             50691 ext/sqlite3/libsqlite/sqlite3.c         rc = sqlite3OsRead(pWal-&gt;pWalFd, zBuf, szPage, iOffset);</span>
<span class='curline'><a href='../S/1054.html#L50695'>pWal</a>             50695 ext/sqlite3/libsqlite/sqlite3.c         rc = sqlite3OsWrite(pWal-&gt;pDbFd, zBuf, szPage, iOffset);</span>
<span class='curline'><a href='../S/1054.html#L50701'>pWal</a>             50701 ext/sqlite3/libsqlite/sqlite3.c         if( mxSafeFrame==walIndexHdr(pWal)-&gt;mxFrame ){</span>
<span class='curline'><a href='../S/1054.html#L50702'>pWal</a>             50702 ext/sqlite3/libsqlite/sqlite3.c           i64 szDb = pWal-&gt;hdr.nPage*(i64)szPage;</span>
<span class='curline'><a href='../S/1054.html#L50704'>pWal</a>             50704 ext/sqlite3/libsqlite/sqlite3.c           rc = sqlite3OsTruncate(pWal-&gt;pDbFd, szDb);</span>
<span class='curline'><a href='../S/1054.html#L50706'>pWal</a>             50706 ext/sqlite3/libsqlite/sqlite3.c             rc = sqlite3OsSync(pWal-&gt;pDbFd, sync_flags);</span>
<span class='curline'><a href='../S/1054.html#L50715'>pWal</a>             50715 ext/sqlite3/libsqlite/sqlite3.c       walUnlockExclusive(pWal, WAL_READ_LOCK(0), 1);</span>
<span class='curline'><a href='../S/1054.html#L50731'>pWal</a>             50731 ext/sqlite3/libsqlite/sqlite3.c     assert( pWal-&gt;writeLock );</span>
<span class='curline'><a href='../S/1054.html#L50732'>pWal</a>             50732 ext/sqlite3/libsqlite/sqlite3.c     if( pInfo-&gt;nBackfill&lt;pWal-&gt;hdr.mxFrame ){</span>
<span class='curline'><a href='../S/1054.html#L50737'>pWal</a>             50737 ext/sqlite3/libsqlite/sqlite3.c       assert( pInfo-&gt;nBackfill==pWal-&gt;hdr.mxFrame );</span>
<span class='curline'><a href='../S/1054.html#L50738'>pWal</a>             50738 ext/sqlite3/libsqlite/sqlite3.c       rc = walBusyLock(pWal, xBusy, pBusyArg, WAL_READ_LOCK(1), WAL_NREADER-1);</span>
<span class='curline'><a href='../S/1054.html#L50754'>pWal</a>             50754 ext/sqlite3/libsqlite/sqlite3.c           walRestartHdr(pWal, salt1);</span>
<span class='curline'><a href='../S/1054.html#L50755'>pWal</a>             50755 ext/sqlite3/libsqlite/sqlite3.c           rc = sqlite3OsTruncate(pWal-&gt;pWalFd, 0);</span>
<span class='curline'><a href='../S/1054.html#L50757'>pWal</a>             50757 ext/sqlite3/libsqlite/sqlite3.c         walUnlockExclusive(pWal, WAL_READ_LOCK(1), WAL_NREADER-1);</span>
<span class='curline'><a href='../S/1054.html#L50771'>pWal</a>             50771 ext/sqlite3/libsqlite/sqlite3.c static void walLimitSize(Wal *pWal, i64 nMax){</span>
<span class='curline'><a href='../S/1054.html#L50775'>pWal</a>             50775 ext/sqlite3/libsqlite/sqlite3.c   rx = sqlite3OsFileSize(pWal-&gt;pWalFd, &amp;sz);</span>
<span class='curline'><a href='../S/1054.html#L50777'>pWal</a>             50777 ext/sqlite3/libsqlite/sqlite3.c     rx = sqlite3OsTruncate(pWal-&gt;pWalFd, nMax);</span>
<span class='curline'><a href='../S/1054.html#L50781'>pWal</a>             50781 ext/sqlite3/libsqlite/sqlite3.c     sqlite3_log(rx, "cannot limit WAL size: %s", pWal-&gt;zWalName);</span>
<span class='curline'><a href='../S/1054.html#L50789'>pWal</a>             50789 ext/sqlite3/libsqlite/sqlite3.c   Wal *pWal,                      /* Wal to close */</span>
<span class='curline'><a href='../S/1054.html#L50795'>pWal</a>             50795 ext/sqlite3/libsqlite/sqlite3.c   if( pWal ){</span>
<span class='curline'><a href='../S/1054.html#L50806'>pWal</a>             50806 ext/sqlite3/libsqlite/sqlite3.c     rc = sqlite3OsLock(pWal-&gt;pDbFd, SQLITE_LOCK_EXCLUSIVE);</span>
<span class='curline'><a href='../S/1054.html#L50808'>pWal</a>             50808 ext/sqlite3/libsqlite/sqlite3.c       if( pWal-&gt;exclusiveMode==WAL_NORMAL_MODE ){</span>
<span class='curline'><a href='../S/1054.html#L50809'>pWal</a>             50809 ext/sqlite3/libsqlite/sqlite3.c         pWal-&gt;exclusiveMode = WAL_EXCLUSIVE_MODE;</span>
<span class='curline'><a href='../S/1054.html#L50812'>pWal</a>             50812 ext/sqlite3/libsqlite/sqlite3.c           pWal, SQLITE_CHECKPOINT_PASSIVE, 0, 0, sync_flags, nBuf, zBuf, 0, 0</span>
<span class='curline'><a href='../S/1054.html#L50817'>pWal</a>             50817 ext/sqlite3/libsqlite/sqlite3.c             pWal-&gt;pDbFd, SQLITE_FCNTL_PERSIST_WAL, &amp;bPersist</span>
<span class='curline'><a href='../S/1054.html#L50824'>pWal</a>             50824 ext/sqlite3/libsqlite/sqlite3.c         }else if( pWal-&gt;mxWalSize&gt;=0 ){</span>
<span class='curline'><a href='../S/1054.html#L50831'>pWal</a>             50831 ext/sqlite3/libsqlite/sqlite3.c           walLimitSize(pWal, 0);</span>
<span class='curline'><a href='../S/1054.html#L50836'>pWal</a>             50836 ext/sqlite3/libsqlite/sqlite3.c     walIndexClose(pWal, isDelete);</span>
<span class='curline'><a href='../S/1054.html#L50837'>pWal</a>             50837 ext/sqlite3/libsqlite/sqlite3.c     sqlite3OsClose(pWal-&gt;pWalFd);</span>
<span class='curline'><a href='../S/1054.html#L50840'>pWal</a>             50840 ext/sqlite3/libsqlite/sqlite3.c       sqlite3OsDelete(pWal-&gt;pVfs, pWal-&gt;zWalName, 0);</span>
<span class='curline'><a href='../S/1054.html#L50843'>pWal</a>             50843 ext/sqlite3/libsqlite/sqlite3.c     WALTRACE(("WAL%p: closed\n", pWal));</span>
<span class='curline'><a href='../S/1054.html#L50844'>pWal</a>             50844 ext/sqlite3/libsqlite/sqlite3.c     sqlite3_free((void *)pWal-&gt;apWiData);</span>
<span class='curline'><a href='../S/1054.html#L50845'>pWal</a>             50845 ext/sqlite3/libsqlite/sqlite3.c     sqlite3_free(pWal);</span>
<span class='curline'><a href='../S/1054.html#L50867'>pWal</a>             50867 ext/sqlite3/libsqlite/sqlite3.c static int walIndexTryHdr(Wal *pWal, int *pChanged){</span>
<span class='curline'><a href='../S/1054.html#L50873'>pWal</a>             50873 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;nWiData&gt;0 &amp;&amp; pWal-&gt;apWiData[0] );</span>
<span class='curline'><a href='../S/1054.html#L50885'>pWal</a>             50885 ext/sqlite3/libsqlite/sqlite3.c   aHdr = walIndexHdr(pWal);</span>
<span class='curline'><a href='../S/1054.html#L50887'>pWal</a>             50887 ext/sqlite3/libsqlite/sqlite3.c   walShmBarrier(pWal);</span>
<span class='curline'><a href='../S/1054.html#L50901'>pWal</a>             50901 ext/sqlite3/libsqlite/sqlite3.c   if( memcmp(&amp;pWal-&gt;hdr, &amp;h1, sizeof(WalIndexHdr)) ){</span>
<span class='curline'><a href='../S/1054.html#L50903'>pWal</a>             50903 ext/sqlite3/libsqlite/sqlite3.c     memcpy(&amp;pWal-&gt;hdr, &amp;h1, sizeof(WalIndexHdr));</span>
<span class='curline'><a href='../S/1054.html#L50904'>pWal</a>             50904 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;szPage = (pWal-&gt;hdr.szPage&amp;0xfe00) + ((pWal-&gt;hdr.szPage&amp;0x0001)&lt;&lt;16);</span>
<span class='curline'><a href='../S/1054.html#L50905'>pWal</a>             50905 ext/sqlite3/libsqlite/sqlite3.c     testcase( pWal-&gt;szPage&lt;=32768 );</span>
<span class='curline'><a href='../S/1054.html#L50906'>pWal</a>             50906 ext/sqlite3/libsqlite/sqlite3.c     testcase( pWal-&gt;szPage&gt;=65536 );</span>
<span class='curline'><a href='../S/1054.html#L50925'>pWal</a>             50925 ext/sqlite3/libsqlite/sqlite3.c static int walIndexReadHdr(Wal *pWal, int *pChanged){</span>
<span class='curline'><a href='../S/1054.html#L50934'>pWal</a>             50934 ext/sqlite3/libsqlite/sqlite3.c   rc = walIndexPage(pWal, 0, &amp;page0);</span>
<span class='curline'><a href='../S/1054.html#L50938'>pWal</a>             50938 ext/sqlite3/libsqlite/sqlite3.c   assert( page0 || pWal-&gt;writeLock==0 );</span>
<span class='curline'><a href='../S/1054.html#L50945'>pWal</a>             50945 ext/sqlite3/libsqlite/sqlite3.c   badHdr = (page0 ? walIndexTryHdr(pWal, pChanged) : 1);</span>
<span class='curline'><a href='../S/1054.html#L50950'>pWal</a>             50950 ext/sqlite3/libsqlite/sqlite3.c   assert( badHdr==0 || pWal-&gt;writeLock==0 );</span>
<span class='curline'><a href='../S/1054.html#L50952'>pWal</a>             50952 ext/sqlite3/libsqlite/sqlite3.c     if( pWal-&gt;readOnly &amp; WAL_SHM_RDONLY ){</span>
<span class='curline'><a href='../S/1054.html#L50953'>pWal</a>             50953 ext/sqlite3/libsqlite/sqlite3.c       if( SQLITE_OK==(rc = walLockShared(pWal, WAL_WRITE_LOCK)) ){</span>
<span class='curline'><a href='../S/1054.html#L50954'>pWal</a>             50954 ext/sqlite3/libsqlite/sqlite3.c         walUnlockShared(pWal, WAL_WRITE_LOCK);</span>
<span class='curline'><a href='../S/1054.html#L50957'>pWal</a>             50957 ext/sqlite3/libsqlite/sqlite3.c     }else if( SQLITE_OK==(rc = walLockExclusive(pWal, WAL_WRITE_LOCK, 1, 1)) ){</span>
<span class='curline'><a href='../S/1054.html#L50958'>pWal</a>             50958 ext/sqlite3/libsqlite/sqlite3.c       pWal-&gt;writeLock = 1;</span>
<span class='curline'><a href='../S/1054.html#L50959'>pWal</a>             50959 ext/sqlite3/libsqlite/sqlite3.c       if( SQLITE_OK==(rc = walIndexPage(pWal, 0, &amp;page0)) ){</span>
<span class='curline'><a href='../S/1054.html#L50960'>pWal</a>             50960 ext/sqlite3/libsqlite/sqlite3.c         badHdr = walIndexTryHdr(pWal, pChanged);</span>
<span class='curline'><a href='../S/1054.html#L50966'>pWal</a>             50966 ext/sqlite3/libsqlite/sqlite3.c           rc = walIndexRecover(pWal);</span>
<span class='curline'><a href='../S/1054.html#L50970'>pWal</a>             50970 ext/sqlite3/libsqlite/sqlite3.c       pWal-&gt;writeLock = 0;</span>
<span class='curline'><a href='../S/1054.html#L50971'>pWal</a>             50971 ext/sqlite3/libsqlite/sqlite3.c       walUnlockExclusive(pWal, WAL_WRITE_LOCK, 1);</span>
<span class='curline'><a href='../S/1054.html#L50979'>pWal</a>             50979 ext/sqlite3/libsqlite/sqlite3.c   if( badHdr==0 &amp;&amp; pWal-&gt;hdr.iVersion!=WALINDEX_MAX_VERSION ){</span>
<span class='curline'><a href='../S/1054.html#L51042'>pWal</a>             51042 ext/sqlite3/libsqlite/sqlite3.c static int walTryBeginRead(Wal *pWal, int *pChanged, int useWal, int cnt){</span>
<span class='curline'><a href='../S/1054.html#L51049'>pWal</a>             51049 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;readLock&lt;0 );     /* Not currently locked */</span>
<span class='curline'><a href='../S/1054.html#L51071'>pWal</a>             51071 ext/sqlite3/libsqlite/sqlite3.c       VVA_ONLY( pWal-&gt;lockError = 1; )</span>
<span class='curline'><a href='../S/1054.html#L51075'>pWal</a>             51075 ext/sqlite3/libsqlite/sqlite3.c     sqlite3OsSleep(pWal-&gt;pVfs, nDelay);</span>
<span class='curline'><a href='../S/1054.html#L51079'>pWal</a>             51079 ext/sqlite3/libsqlite/sqlite3.c     rc = walIndexReadHdr(pWal, pChanged);</span>
<span class='curline'><a href='../S/1054.html#L51089'>pWal</a>             51089 ext/sqlite3/libsqlite/sqlite3.c       if( pWal-&gt;apWiData[0]==0 ){</span>
<span class='curline'><a href='../S/1054.html#L51098'>pWal</a>             51098 ext/sqlite3/libsqlite/sqlite3.c       }else if( SQLITE_OK==(rc = walLockShared(pWal, WAL_RECOVER_LOCK)) ){</span>
<span class='curline'><a href='../S/1054.html#L51099'>pWal</a>             51099 ext/sqlite3/libsqlite/sqlite3.c         walUnlockShared(pWal, WAL_RECOVER_LOCK);</span>
<span class='curline'><a href='../S/1054.html#L51110'>pWal</a>             51110 ext/sqlite3/libsqlite/sqlite3.c   pInfo = walCkptInfo(pWal);</span>
<span class='curline'><a href='../S/1054.html#L51111'>pWal</a>             51111 ext/sqlite3/libsqlite/sqlite3.c   if( !useWal &amp;&amp; pInfo-&gt;nBackfill==pWal-&gt;hdr.mxFrame ){</span>
<span class='curline'><a href='../S/1054.html#L51115'>pWal</a>             51115 ext/sqlite3/libsqlite/sqlite3.c     rc = walLockShared(pWal, WAL_READ_LOCK(0));</span>
<span class='curline'><a href='../S/1054.html#L51116'>pWal</a>             51116 ext/sqlite3/libsqlite/sqlite3.c     walShmBarrier(pWal);</span>
<span class='curline'><a href='../S/1054.html#L51118'>pWal</a>             51118 ext/sqlite3/libsqlite/sqlite3.c       if( memcmp((void *)walIndexHdr(pWal), &amp;pWal-&gt;hdr, sizeof(WalIndexHdr)) ){</span>
<span class='curline'><a href='../S/1054.html#L51132'>pWal</a>             51132 ext/sqlite3/libsqlite/sqlite3.c         walUnlockShared(pWal, WAL_READ_LOCK(0));</span>
<span class='curline'><a href='../S/1054.html#L51135'>pWal</a>             51135 ext/sqlite3/libsqlite/sqlite3.c       pWal-&gt;readLock = 0;</span>
<span class='curline'><a href='../S/1054.html#L51151'>pWal</a>             51151 ext/sqlite3/libsqlite/sqlite3.c     if( mxReadMark&lt;=thisMark &amp;&amp; thisMark&lt;=pWal-&gt;hdr.mxFrame ){</span>
<span class='curline'><a href='../S/1054.html#L51159'>pWal</a>             51159 ext/sqlite3/libsqlite/sqlite3.c     if( (pWal-&gt;readOnly &amp; WAL_SHM_RDONLY)==0</span>
<span class='curline'><a href='../S/1054.html#L51160'>pWal</a>             51160 ext/sqlite3/libsqlite/sqlite3.c      &amp;&amp; (mxReadMark&lt;pWal-&gt;hdr.mxFrame || mxI==0)</span>
<span class='curline'><a href='../S/1054.html#L51163'>pWal</a>             51163 ext/sqlite3/libsqlite/sqlite3.c         rc = walLockExclusive(pWal, WAL_READ_LOCK(i), 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L51165'>pWal</a>             51165 ext/sqlite3/libsqlite/sqlite3.c           mxReadMark = pInfo-&gt;aReadMark[i] = pWal-&gt;hdr.mxFrame;</span>
<span class='curline'><a href='../S/1054.html#L51167'>pWal</a>             51167 ext/sqlite3/libsqlite/sqlite3.c           walUnlockExclusive(pWal, WAL_READ_LOCK(i), 1);</span>
<span class='curline'><a href='../S/1054.html#L51175'>pWal</a>             51175 ext/sqlite3/libsqlite/sqlite3.c       assert( rc==SQLITE_BUSY || (pWal-&gt;readOnly &amp; WAL_SHM_RDONLY)!=0 );</span>
<span class='curline'><a href='../S/1054.html#L51179'>pWal</a>             51179 ext/sqlite3/libsqlite/sqlite3.c     rc = walLockShared(pWal, WAL_READ_LOCK(mxI));</span>
<span class='curline'><a href='../S/1054.html#L51203'>pWal</a>             51203 ext/sqlite3/libsqlite/sqlite3.c     walShmBarrier(pWal);</span>
<span class='curline'><a href='../S/1054.html#L51205'>pWal</a>             51205 ext/sqlite3/libsqlite/sqlite3.c      || memcmp((void *)walIndexHdr(pWal), &amp;pWal-&gt;hdr, sizeof(WalIndexHdr))</span>
<span class='curline'><a href='../S/1054.html#L51207'>pWal</a>             51207 ext/sqlite3/libsqlite/sqlite3.c       walUnlockShared(pWal, WAL_READ_LOCK(mxI));</span>
<span class='curline'><a href='../S/1054.html#L51210'>pWal</a>             51210 ext/sqlite3/libsqlite/sqlite3.c       assert( mxReadMark&lt;=pWal-&gt;hdr.mxFrame );</span>
<span class='curline'><a href='../S/1054.html#L51211'>pWal</a>             51211 ext/sqlite3/libsqlite/sqlite3.c       pWal-&gt;readLock = (i16)mxI;</span>
<span class='curline'><a href='../S/1054.html#L51231'>pWal</a>             51231 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalBeginReadTransaction(Wal *pWal, int *pChanged){</span>
<span class='curline'><a href='../S/1054.html#L51236'>pWal</a>             51236 ext/sqlite3/libsqlite/sqlite3.c     rc = walTryBeginRead(pWal, pChanged, 0, ++cnt);</span>
<span class='curline'><a href='../S/1054.html#L51249'>pWal</a>             51249 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE void sqlite3WalEndReadTransaction(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L51250'>pWal</a>             51250 ext/sqlite3/libsqlite/sqlite3.c   sqlite3WalEndWriteTransaction(pWal);</span>
<span class='curline'><a href='../S/1054.html#L51251'>pWal</a>             51251 ext/sqlite3/libsqlite/sqlite3.c   if( pWal-&gt;readLock&gt;=0 ){</span>
<span class='curline'><a href='../S/1054.html#L51252'>pWal</a>             51252 ext/sqlite3/libsqlite/sqlite3.c     walUnlockShared(pWal, WAL_READ_LOCK(pWal-&gt;readLock));</span>
<span class='curline'><a href='../S/1054.html#L51253'>pWal</a>             51253 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;readLock = -1;</span>
<span class='curline'><a href='../S/1054.html#L51266'>pWal</a>             51266 ext/sqlite3/libsqlite/sqlite3.c   Wal *pWal,                      /* WAL handle */</span>
<span class='curline'><a href='../S/1054.html#L51271'>pWal</a>             51271 ext/sqlite3/libsqlite/sqlite3.c   u32 iLast = pWal-&gt;hdr.mxFrame;  /* Last page in WAL for this reader */</span>
<span class='curline'><a href='../S/1054.html#L51275'>pWal</a>             51275 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;readLock&gt;=0 || pWal-&gt;lockError );</span>
<span class='curline'><a href='../S/1054.html#L51283'>pWal</a>             51283 ext/sqlite3/libsqlite/sqlite3.c   if( iLast==0 || pWal-&gt;readLock==0 ){</span>
<span class='curline'><a href='../S/1054.html#L51321'>pWal</a>             51321 ext/sqlite3/libsqlite/sqlite3.c     rc = walHashGet(pWal, iHash, &amp;aHash, &amp;aPgno, &amp;iZero);</span>
<span class='curline'><a href='../S/1054.html#L51346'>pWal</a>             51346 ext/sqlite3/libsqlite/sqlite3.c       if( walFramePgno(pWal, iTest)==pgno ){</span>
<span class='curline'><a href='../S/1054.html#L51365'>pWal</a>             51365 ext/sqlite3/libsqlite/sqlite3.c   Wal *pWal,                      /* WAL handle */</span>
<span class='curline'><a href='../S/1054.html#L51372'>pWal</a>             51372 ext/sqlite3/libsqlite/sqlite3.c   sz = pWal-&gt;hdr.szPage;</span>
<span class='curline'><a href='../S/1054.html#L51378'>pWal</a>             51378 ext/sqlite3/libsqlite/sqlite3.c   return sqlite3OsRead(pWal-&gt;pWalFd, pOut, (nOut&gt;sz ? sz : nOut), iOffset);</span>
<span class='curline'><a href='../S/1054.html#L51384'>pWal</a>             51384 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE Pgno sqlite3WalDbsize(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L51385'>pWal</a>             51385 ext/sqlite3/libsqlite/sqlite3.c   if( pWal &amp;&amp; ALWAYS(pWal-&gt;readLock&gt;=0) ){</span>
<span class='curline'><a href='../S/1054.html#L51386'>pWal</a>             51386 ext/sqlite3/libsqlite/sqlite3.c     return pWal-&gt;hdr.nPage;</span>
<span class='curline'><a href='../S/1054.html#L51405'>pWal</a>             51405 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalBeginWriteTransaction(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L51410'>pWal</a>             51410 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;readLock&gt;=0 );</span>
<span class='curline'><a href='../S/1054.html#L51412'>pWal</a>             51412 ext/sqlite3/libsqlite/sqlite3.c   if( pWal-&gt;readOnly ){</span>
<span class='curline'><a href='../S/1054.html#L51419'>pWal</a>             51419 ext/sqlite3/libsqlite/sqlite3.c   rc = walLockExclusive(pWal, WAL_WRITE_LOCK, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L51423'>pWal</a>             51423 ext/sqlite3/libsqlite/sqlite3.c   pWal-&gt;writeLock = 1;</span>
<span class='curline'><a href='../S/1054.html#L51429'>pWal</a>             51429 ext/sqlite3/libsqlite/sqlite3.c   if( memcmp(&amp;pWal-&gt;hdr, (void *)walIndexHdr(pWal), sizeof(WalIndexHdr))!=0 ){</span>
<span class='curline'><a href='../S/1054.html#L51430'>pWal</a>             51430 ext/sqlite3/libsqlite/sqlite3.c     walUnlockExclusive(pWal, WAL_WRITE_LOCK, 1);</span>
<span class='curline'><a href='../S/1054.html#L51431'>pWal</a>             51431 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;writeLock = 0;</span>
<span class='curline'><a href='../S/1054.html#L51442'>pWal</a>             51442 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalEndWriteTransaction(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L51443'>pWal</a>             51443 ext/sqlite3/libsqlite/sqlite3.c   if( pWal-&gt;writeLock ){</span>
<span class='curline'><a href='../S/1054.html#L51444'>pWal</a>             51444 ext/sqlite3/libsqlite/sqlite3.c     walUnlockExclusive(pWal, WAL_WRITE_LOCK, 1);</span>
<span class='curline'><a href='../S/1054.html#L51445'>pWal</a>             51445 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;writeLock = 0;</span>
<span class='curline'><a href='../S/1054.html#L51446'>pWal</a>             51446 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;truncateOnCommit = 0;</span>
<span class='curline'><a href='../S/1054.html#L51463'>pWal</a>             51463 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalUndo(Wal *pWal, int (*xUndo)(void *, Pgno), void *pUndoCtx){</span>
<span class='curline'><a href='../S/1054.html#L51465'>pWal</a>             51465 ext/sqlite3/libsqlite/sqlite3.c   if( ALWAYS(pWal-&gt;writeLock) ){</span>
<span class='curline'><a href='../S/1054.html#L51466'>pWal</a>             51466 ext/sqlite3/libsqlite/sqlite3.c     Pgno iMax = pWal-&gt;hdr.mxFrame;</span>
<span class='curline'><a href='../S/1054.html#L51472'>pWal</a>             51472 ext/sqlite3/libsqlite/sqlite3.c     memcpy(&amp;pWal-&gt;hdr, (void *)walIndexHdr(pWal), sizeof(WalIndexHdr));</span>
<span class='curline'><a href='../S/1054.html#L51474'>pWal</a>             51474 ext/sqlite3/libsqlite/sqlite3.c     for(iFrame=pWal-&gt;hdr.mxFrame+1; </span>
<span class='curline'><a href='../S/1054.html#L51489'>pWal</a>             51489 ext/sqlite3/libsqlite/sqlite3.c       assert( walFramePgno(pWal, iFrame)!=1 );</span>
<span class='curline'><a href='../S/1054.html#L51490'>pWal</a>             51490 ext/sqlite3/libsqlite/sqlite3.c       rc = xUndo(pUndoCtx, walFramePgno(pWal, iFrame));</span>
<span class='curline'><a href='../S/1054.html#L51492'>pWal</a>             51492 ext/sqlite3/libsqlite/sqlite3.c     if( iMax!=pWal-&gt;hdr.mxFrame ) walCleanupHash(pWal);</span>
<span class='curline'><a href='../S/1054.html#L51503'>pWal</a>             51503 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE void sqlite3WalSavepoint(Wal *pWal, u32 *aWalData){</span>
<span class='curline'><a href='../S/1054.html#L51504'>pWal</a>             51504 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;writeLock );</span>
<span class='curline'><a href='../S/1054.html#L51505'>pWal</a>             51505 ext/sqlite3/libsqlite/sqlite3.c   aWalData[0] = pWal-&gt;hdr.mxFrame;</span>
<span class='curline'><a href='../S/1054.html#L51506'>pWal</a>             51506 ext/sqlite3/libsqlite/sqlite3.c   aWalData[1] = pWal-&gt;hdr.aFrameCksum[0];</span>
<span class='curline'><a href='../S/1054.html#L51507'>pWal</a>             51507 ext/sqlite3/libsqlite/sqlite3.c   aWalData[2] = pWal-&gt;hdr.aFrameCksum[1];</span>
<span class='curline'><a href='../S/1054.html#L51508'>pWal</a>             51508 ext/sqlite3/libsqlite/sqlite3.c   aWalData[3] = pWal-&gt;nCkpt;</span>
<span class='curline'><a href='../S/1054.html#L51517'>pWal</a>             51517 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalSavepointUndo(Wal *pWal, u32 *aWalData){</span>
<span class='curline'><a href='../S/1054.html#L51520'>pWal</a>             51520 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;writeLock );</span>
<span class='curline'><a href='../S/1054.html#L51521'>pWal</a>             51521 ext/sqlite3/libsqlite/sqlite3.c   assert( aWalData[3]!=pWal-&gt;nCkpt || aWalData[0]&lt;=pWal-&gt;hdr.mxFrame );</span>
<span class='curline'><a href='../S/1054.html#L51523'>pWal</a>             51523 ext/sqlite3/libsqlite/sqlite3.c   if( aWalData[3]!=pWal-&gt;nCkpt ){</span>
<span class='curline'><a href='../S/1054.html#L51529'>pWal</a>             51529 ext/sqlite3/libsqlite/sqlite3.c     aWalData[3] = pWal-&gt;nCkpt;</span>
<span class='curline'><a href='../S/1054.html#L51532'>pWal</a>             51532 ext/sqlite3/libsqlite/sqlite3.c   if( aWalData[0]&lt;pWal-&gt;hdr.mxFrame ){</span>
<span class='curline'><a href='../S/1054.html#L51533'>pWal</a>             51533 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;hdr.mxFrame = aWalData[0];</span>
<span class='curline'><a href='../S/1054.html#L51534'>pWal</a>             51534 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;hdr.aFrameCksum[0] = aWalData[1];</span>
<span class='curline'><a href='../S/1054.html#L51535'>pWal</a>             51535 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;hdr.aFrameCksum[1] = aWalData[2];</span>
<span class='curline'><a href='../S/1054.html#L51536'>pWal</a>             51536 ext/sqlite3/libsqlite/sqlite3.c     walCleanupHash(pWal);</span>
<span class='curline'><a href='../S/1054.html#L51554'>pWal</a>             51554 ext/sqlite3/libsqlite/sqlite3.c static int walRestartLog(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L51558'>pWal</a>             51558 ext/sqlite3/libsqlite/sqlite3.c   if( pWal-&gt;readLock==0 ){</span>
<span class='curline'><a href='../S/1054.html#L51559'>pWal</a>             51559 ext/sqlite3/libsqlite/sqlite3.c     volatile WalCkptInfo *pInfo = walCkptInfo(pWal);</span>
<span class='curline'><a href='../S/1054.html#L51560'>pWal</a>             51560 ext/sqlite3/libsqlite/sqlite3.c     assert( pInfo-&gt;nBackfill==pWal-&gt;hdr.mxFrame );</span>
<span class='curline'><a href='../S/1054.html#L51564'>pWal</a>             51564 ext/sqlite3/libsqlite/sqlite3.c       rc = walLockExclusive(pWal, WAL_READ_LOCK(1), WAL_NREADER-1, 0);</span>
<span class='curline'><a href='../S/1054.html#L51575'>pWal</a>             51575 ext/sqlite3/libsqlite/sqlite3.c         walRestartHdr(pWal, salt1);</span>
<span class='curline'><a href='../S/1054.html#L51576'>pWal</a>             51576 ext/sqlite3/libsqlite/sqlite3.c         walUnlockExclusive(pWal, WAL_READ_LOCK(1), WAL_NREADER-1);</span>
<span class='curline'><a href='../S/1054.html#L51581'>pWal</a>             51581 ext/sqlite3/libsqlite/sqlite3.c     walUnlockShared(pWal, WAL_READ_LOCK(0));</span>
<span class='curline'><a href='../S/1054.html#L51582'>pWal</a>             51582 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;readLock = -1;</span>
<span class='curline'><a href='../S/1054.html#L51586'>pWal</a>             51586 ext/sqlite3/libsqlite/sqlite3.c       rc = walTryBeginRead(pWal, &amp;notUsed, 1, ++cnt);</span>
<span class='curline'><a href='../S/1054.html#L51602'>pWal</a>             51602 ext/sqlite3/libsqlite/sqlite3.c   Wal *pWal;                   /* The complete WAL information */</span>
<span class='curline'><a href='../S/1054.html#L51656'>pWal</a>             51656 ext/sqlite3/libsqlite/sqlite3.c   walEncodeFrame(p-&gt;pWal, pPage-&gt;pgno, nTruncate, pData, aFrame);</span>
<span class='curline'><a href='../S/1054.html#L51669'>pWal</a>             51669 ext/sqlite3/libsqlite/sqlite3.c   Wal *pWal,                      /* Wal handle to write to */</span>
<span class='curline'><a href='../S/1054.html#L51686'>pWal</a>             51686 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;writeLock );</span>
<span class='curline'><a href='../S/1054.html#L51695'>pWal</a>             51695 ext/sqlite3/libsqlite/sqlite3.c               pWal, cnt, pWal-&gt;hdr.mxFrame, isCommit ? "Commit" : "Spill"));</span>
<span class='curline'><a href='../S/1054.html#L51702'>pWal</a>             51702 ext/sqlite3/libsqlite/sqlite3.c   if( SQLITE_OK!=(rc = walRestartLog(pWal)) ){</span>
<span class='curline'><a href='../S/1054.html#L51710'>pWal</a>             51710 ext/sqlite3/libsqlite/sqlite3.c   iFrame = pWal-&gt;hdr.mxFrame;</span>
<span class='curline'><a href='../S/1054.html#L51718'>pWal</a>             51718 ext/sqlite3/libsqlite/sqlite3.c     sqlite3Put4byte(&amp;aWalHdr[12], pWal-&gt;nCkpt);</span>
<span class='curline'><a href='../S/1054.html#L51719'>pWal</a>             51719 ext/sqlite3/libsqlite/sqlite3.c     if( pWal-&gt;nCkpt==0 ) sqlite3_randomness(8, pWal-&gt;hdr.aSalt);</span>
<span class='curline'><a href='../S/1054.html#L51720'>pWal</a>             51720 ext/sqlite3/libsqlite/sqlite3.c     memcpy(&amp;aWalHdr[16], pWal-&gt;hdr.aSalt, 8);</span>
<span class='curline'><a href='../S/1054.html#L51725'>pWal</a>             51725 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;szPage = szPage;</span>
<span class='curline'><a href='../S/1054.html#L51726'>pWal</a>             51726 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;hdr.bigEndCksum = SQLITE_BIGENDIAN;</span>
<span class='curline'><a href='../S/1054.html#L51727'>pWal</a>             51727 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;hdr.aFrameCksum[0] = aCksum[0];</span>
<span class='curline'><a href='../S/1054.html#L51728'>pWal</a>             51728 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;hdr.aFrameCksum[1] = aCksum[1];</span>
<span class='curline'><a href='../S/1054.html#L51729'>pWal</a>             51729 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;truncateOnCommit = 1;</span>
<span class='curline'><a href='../S/1054.html#L51731'>pWal</a>             51731 ext/sqlite3/libsqlite/sqlite3.c     rc = sqlite3OsWrite(pWal-&gt;pWalFd, aWalHdr, sizeof(aWalHdr), 0);</span>
<span class='curline'><a href='../S/1054.html#L51732'>pWal</a>             51732 ext/sqlite3/libsqlite/sqlite3.c     WALTRACE(("WAL%p: wal-header write %s\n", pWal, rc ? "failed" : "ok"));</span>
<span class='curline'><a href='../S/1054.html#L51744'>pWal</a>             51744 ext/sqlite3/libsqlite/sqlite3.c     if( pWal-&gt;syncHeader &amp;&amp; sync_flags ){</span>
<span class='curline'><a href='../S/1054.html#L51745'>pWal</a>             51745 ext/sqlite3/libsqlite/sqlite3.c       rc = sqlite3OsSync(pWal-&gt;pWalFd, sync_flags &amp; SQLITE_SYNC_MASK);</span>
<span class='curline'><a href='../S/1054.html#L51749'>pWal</a>             51749 ext/sqlite3/libsqlite/sqlite3.c   assert( (int)pWal-&gt;szPage==szPage );</span>
<span class='curline'><a href='../S/1054.html#L51752'>pWal</a>             51752 ext/sqlite3/libsqlite/sqlite3.c   w.pWal = pWal;</span>
<span class='curline'><a href='../S/1054.html#L51753'>pWal</a>             51753 ext/sqlite3/libsqlite/sqlite3.c   w.pFd = pWal-&gt;pWalFd;</span>
<span class='curline'><a href='../S/1054.html#L51787'>pWal</a>             51787 ext/sqlite3/libsqlite/sqlite3.c     if( pWal-&gt;padToSectorBoundary ){</span>
<span class='curline'><a href='../S/1054.html#L51788'>pWal</a>             51788 ext/sqlite3/libsqlite/sqlite3.c       int sectorSize = sqlite3SectorSize(pWal-&gt;pWalFd);</span>
<span class='curline'><a href='../S/1054.html#L51805'>pWal</a>             51805 ext/sqlite3/libsqlite/sqlite3.c   if( isCommit &amp;&amp; pWal-&gt;truncateOnCommit &amp;&amp; pWal-&gt;mxWalSize&gt;=0 ){</span>
<span class='curline'><a href='../S/1054.html#L51806'>pWal</a>             51806 ext/sqlite3/libsqlite/sqlite3.c     i64 sz = pWal-&gt;mxWalSize;</span>
<span class='curline'><a href='../S/1054.html#L51807'>pWal</a>             51807 ext/sqlite3/libsqlite/sqlite3.c     if( walFrameOffset(iFrame+nExtra+1, szPage)&gt;pWal-&gt;mxWalSize ){</span>
<span class='curline'><a href='../S/1054.html#L51810'>pWal</a>             51810 ext/sqlite3/libsqlite/sqlite3.c     walLimitSize(pWal, sz);</span>
<span class='curline'><a href='../S/1054.html#L51811'>pWal</a>             51811 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;truncateOnCommit = 0;</span>
<span class='curline'><a href='../S/1054.html#L51819'>pWal</a>             51819 ext/sqlite3/libsqlite/sqlite3.c   iFrame = pWal-&gt;hdr.mxFrame;</span>
<span class='curline'><a href='../S/1054.html#L51822'>pWal</a>             51822 ext/sqlite3/libsqlite/sqlite3.c     rc = walIndexAppend(pWal, iFrame, p-&gt;pgno);</span>
<span class='curline'><a href='../S/1054.html#L51827'>pWal</a>             51827 ext/sqlite3/libsqlite/sqlite3.c     rc = walIndexAppend(pWal, iFrame, pLast-&gt;pgno);</span>
<span class='curline'><a href='../S/1054.html#L51832'>pWal</a>             51832 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;hdr.szPage = (u16)((szPage&amp;0xff00) | (szPage&gt;&gt;16));</span>
<span class='curline'><a href='../S/1054.html#L51835'>pWal</a>             51835 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;hdr.mxFrame = iFrame;</span>
<span class='curline'><a href='../S/1054.html#L51837'>pWal</a>             51837 ext/sqlite3/libsqlite/sqlite3.c       pWal-&gt;hdr.iChange++;</span>
<span class='curline'><a href='../S/1054.html#L51838'>pWal</a>             51838 ext/sqlite3/libsqlite/sqlite3.c       pWal-&gt;hdr.nPage = nTruncate;</span>
<span class='curline'><a href='../S/1054.html#L51842'>pWal</a>             51842 ext/sqlite3/libsqlite/sqlite3.c       walIndexWriteHdr(pWal);</span>
<span class='curline'><a href='../S/1054.html#L51843'>pWal</a>             51843 ext/sqlite3/libsqlite/sqlite3.c       pWal-&gt;iCallback = iFrame;</span>
<span class='curline'><a href='../S/1054.html#L51847'>pWal</a>             51847 ext/sqlite3/libsqlite/sqlite3.c   WALTRACE(("WAL%p: frame write %s\n", pWal, rc ? "failed" : "ok"));</span>
<span class='curline'><a href='../S/1054.html#L51862'>pWal</a>             51862 ext/sqlite3/libsqlite/sqlite3.c   Wal *pWal,                      /* Wal connection */</span>
<span class='curline'><a href='../S/1054.html#L51877'>pWal</a>             51877 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;ckptLock==0 );</span>
<span class='curline'><a href='../S/1054.html#L51878'>pWal</a>             51878 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;writeLock==0 );</span>
<span class='curline'><a href='../S/1054.html#L51884'>pWal</a>             51884 ext/sqlite3/libsqlite/sqlite3.c   if( pWal-&gt;readOnly ) return SQLITE_READONLY;</span>
<span class='curline'><a href='../S/1054.html#L51885'>pWal</a>             51885 ext/sqlite3/libsqlite/sqlite3.c   WALTRACE(("WAL%p: checkpoint begins\n", pWal));</span>
<span class='curline'><a href='../S/1054.html#L51889'>pWal</a>             51889 ext/sqlite3/libsqlite/sqlite3.c   rc = walLockExclusive(pWal, WAL_CKPT_LOCK, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L51901'>pWal</a>             51901 ext/sqlite3/libsqlite/sqlite3.c   pWal-&gt;ckptLock = 1;</span>
<span class='curline'><a href='../S/1054.html#L51913'>pWal</a>             51913 ext/sqlite3/libsqlite/sqlite3.c     rc = walBusyLock(pWal, xBusy, pBusyArg, WAL_WRITE_LOCK, 1);</span>
<span class='curline'><a href='../S/1054.html#L51915'>pWal</a>             51915 ext/sqlite3/libsqlite/sqlite3.c       pWal-&gt;writeLock = 1;</span>
<span class='curline'><a href='../S/1054.html#L51925'>pWal</a>             51925 ext/sqlite3/libsqlite/sqlite3.c     rc = walIndexReadHdr(pWal, &amp;isChanged);</span>
<span class='curline'><a href='../S/1054.html#L51926'>pWal</a>             51926 ext/sqlite3/libsqlite/sqlite3.c     if( isChanged &amp;&amp; pWal-&gt;pDbFd-&gt;pMethods-&gt;iVersion&gt;=3 ){</span>
<span class='curline'><a href='../S/1054.html#L51927'>pWal</a>             51927 ext/sqlite3/libsqlite/sqlite3.c       sqlite3OsUnfetch(pWal-&gt;pDbFd, 0, 0);</span>
<span class='curline'><a href='../S/1054.html#L51933'>pWal</a>             51933 ext/sqlite3/libsqlite/sqlite3.c     if( pWal-&gt;hdr.mxFrame &amp;&amp; walPagesize(pWal)!=nBuf ){</span>
<span class='curline'><a href='../S/1054.html#L51936'>pWal</a>             51936 ext/sqlite3/libsqlite/sqlite3.c       rc = walCheckpoint(pWal, eMode2, xBusy2, pBusyArg, sync_flags, zBuf);</span>
<span class='curline'><a href='../S/1054.html#L51941'>pWal</a>             51941 ext/sqlite3/libsqlite/sqlite3.c       if( pnLog ) *pnLog = (int)pWal-&gt;hdr.mxFrame;</span>
<span class='curline'><a href='../S/1054.html#L51942'>pWal</a>             51942 ext/sqlite3/libsqlite/sqlite3.c       if( pnCkpt ) *pnCkpt = (int)(walCkptInfo(pWal)-&gt;nBackfill);</span>
<span class='curline'><a href='../S/1054.html#L51953'>pWal</a>             51953 ext/sqlite3/libsqlite/sqlite3.c     memset(&amp;pWal-&gt;hdr, 0, sizeof(WalIndexHdr));</span>
<span class='curline'><a href='../S/1054.html#L51957'>pWal</a>             51957 ext/sqlite3/libsqlite/sqlite3.c   sqlite3WalEndWriteTransaction(pWal);</span>
<span class='curline'><a href='../S/1054.html#L51958'>pWal</a>             51958 ext/sqlite3/libsqlite/sqlite3.c   walUnlockExclusive(pWal, WAL_CKPT_LOCK, 1);</span>
<span class='curline'><a href='../S/1054.html#L51959'>pWal</a>             51959 ext/sqlite3/libsqlite/sqlite3.c   pWal-&gt;ckptLock = 0;</span>
<span class='curline'><a href='../S/1054.html#L51960'>pWal</a>             51960 ext/sqlite3/libsqlite/sqlite3.c   WALTRACE(("WAL%p: checkpoint %s\n", pWal, rc ? "failed" : "ok"));</span>
<span class='curline'><a href='../S/1054.html#L51969'>pWal</a>             51969 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalCallback(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L51971'>pWal</a>             51971 ext/sqlite3/libsqlite/sqlite3.c   if( pWal ){</span>
<span class='curline'><a href='../S/1054.html#L51972'>pWal</a>             51972 ext/sqlite3/libsqlite/sqlite3.c     ret = pWal-&gt;iCallback;</span>
<span class='curline'><a href='../S/1054.html#L51973'>pWal</a>             51973 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;iCallback = 0;</span>
<span class='curline'><a href='../S/1054.html#L52002'>pWal</a>             52002 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalExclusiveMode(Wal *pWal, int op){</span>
<span class='curline'><a href='../S/1054.html#L52004'>pWal</a>             52004 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;writeLock==0 );</span>
<span class='curline'><a href='../S/1054.html#L52005'>pWal</a>             52005 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;exclusiveMode!=WAL_HEAPMEMORY_MODE || op==-1 );</span>
<span class='curline'><a href='../S/1054.html#L52013'>pWal</a>             52013 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;readLock&gt;=0 || pWal-&gt;lockError );</span>
<span class='curline'><a href='../S/1054.html#L52014'>pWal</a>             52014 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal-&gt;readLock&gt;=0 || (op&lt;=0 &amp;&amp; pWal-&gt;exclusiveMode==0) );</span>
<span class='curline'><a href='../S/1054.html#L52017'>pWal</a>             52017 ext/sqlite3/libsqlite/sqlite3.c     if( pWal-&gt;exclusiveMode ){</span>
<span class='curline'><a href='../S/1054.html#L52018'>pWal</a>             52018 ext/sqlite3/libsqlite/sqlite3.c       pWal-&gt;exclusiveMode = 0;</span>
<span class='curline'><a href='../S/1054.html#L52019'>pWal</a>             52019 ext/sqlite3/libsqlite/sqlite3.c       if( walLockShared(pWal, WAL_READ_LOCK(pWal-&gt;readLock))!=SQLITE_OK ){</span>
<span class='curline'><a href='../S/1054.html#L52020'>pWal</a>             52020 ext/sqlite3/libsqlite/sqlite3.c         pWal-&gt;exclusiveMode = 1;</span>
<span class='curline'><a href='../S/1054.html#L52022'>pWal</a>             52022 ext/sqlite3/libsqlite/sqlite3.c       rc = pWal-&gt;exclusiveMode==0;</span>
<span class='curline'><a href='../S/1054.html#L52028'>pWal</a>             52028 ext/sqlite3/libsqlite/sqlite3.c     assert( pWal-&gt;exclusiveMode==0 );</span>
<span class='curline'><a href='../S/1054.html#L52029'>pWal</a>             52029 ext/sqlite3/libsqlite/sqlite3.c     assert( pWal-&gt;readLock&gt;=0 );</span>
<span class='curline'><a href='../S/1054.html#L52030'>pWal</a>             52030 ext/sqlite3/libsqlite/sqlite3.c     walUnlockShared(pWal, WAL_READ_LOCK(pWal-&gt;readLock));</span>
<span class='curline'><a href='../S/1054.html#L52031'>pWal</a>             52031 ext/sqlite3/libsqlite/sqlite3.c     pWal-&gt;exclusiveMode = 1;</span>
<span class='curline'><a href='../S/1054.html#L52034'>pWal</a>             52034 ext/sqlite3/libsqlite/sqlite3.c     rc = pWal-&gt;exclusiveMode==0;</span>
<span class='curline'><a href='../S/1054.html#L52044'>pWal</a>             52044 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalHeapMemory(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L52045'>pWal</a>             52045 ext/sqlite3/libsqlite/sqlite3.c   return (pWal &amp;&amp; pWal-&gt;exclusiveMode==WAL_HEAPMEMORY_MODE );</span>
<span class='curline'><a href='../S/1054.html#L52054'>pWal</a>             52054 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3WalFramesize(Wal *pWal){</span>
<span class='curline'><a href='../S/1054.html#L52055'>pWal</a>             52055 ext/sqlite3/libsqlite/sqlite3.c   assert( pWal==0 || pWal-&gt;readLock&gt;=0 );</span>
<span class='curline'><a href='../S/1054.html#L52056'>pWal</a>             52056 ext/sqlite3/libsqlite/sqlite3.c   return (pWal ? pWal-&gt;szPage : 0);</span>
</pre>
</body>
</html>
