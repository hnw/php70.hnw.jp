<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>sslsock</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/853.html#L189'>sslsock</a>           189 ext/openssl/xp_ssl.c 	php_openssl_netstream_data_t *sslsock = (php_openssl_netstream_data_t*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/853.html#L190'>sslsock</a>           190 ext/openssl/xp_ssl.c 	int err = SSL_get_error(sslsock-&gt;ssl_handle, nr_bytes);</span>
<span class='curline'><a href='../S/853.html#L206'>sslsock</a>           206 ext/openssl/xp_ssl.c 			retry = is_init ? 1 : sslsock-&gt;s.is_blocked;</span>
<span class='curline'><a href='../S/853.html#L215'>sslsock</a>           215 ext/openssl/xp_ssl.c 					SSL_set_shutdown(sslsock-&gt;ssl_handle, SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);</span>
<span class='curline'><a href='../S/853.html#L489'>sslsock</a>           489 ext/openssl/xp_ssl.c 	php_openssl_netstream_data_t *sslsock = (php_openssl_netstream_data_t*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/853.html#L493'>sslsock</a>           493 ext/openssl/xp_ssl.c 		: sslsock-&gt;is_client;</span>
<span class='curline'><a href='../S/853.html#L497'>sslsock</a>           497 ext/openssl/xp_ssl.c 		: sslsock-&gt;is_client;</span>
<span class='curline'><a href='../S/853.html#L551'>sslsock</a>           551 ext/openssl/xp_ssl.c 		if (peer_name == NULL &amp;&amp; sslsock-&gt;is_client) {</span>
<span class='curline'><a href='../S/853.html#L552'>sslsock</a>           552 ext/openssl/xp_ssl.c 			peer_name = sslsock-&gt;url_name;</span>
<span class='curline'><a href='../S/853.html#L599'>sslsock</a>           599 ext/openssl/xp_ssl.c 	php_openssl_netstream_data_t *sslsock;</span>
<span class='curline'><a href='../S/853.html#L605'>sslsock</a>           605 ext/openssl/xp_ssl.c 	sslsock = (php_openssl_netstream_data_t*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/853.html#L723'>sslsock</a>           723 ext/openssl/xp_ssl.c 		ssl_policy_params.dwAuthType = (sslsock-&gt;is_client) ? AUTHTYPE_SERVER : AUTHTYPE_CLIENT;</span>
<span class='curline'><a href='../S/853.html#L840'>sslsock</a>           840 ext/openssl/xp_ssl.c 	php_openssl_netstream_data_t *sslsock = (php_openssl_netstream_data_t*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/853.html#L848'>sslsock</a>           848 ext/openssl/xp_ssl.c 	} else if (!sslsock-&gt;is_client) {</span>
<span class='curline'><a href='../S/853.html#L875'>sslsock</a>           875 ext/openssl/xp_ssl.c 		if (sslsock-&gt;is_client &amp;&amp; !SSL_CTX_set_default_verify_paths(ctx)) {</span>
<span class='curline'><a href='../S/853.html#L1034'>sslsock</a>          1034 ext/openssl/xp_ssl.c 	php_openssl_netstream_data_t *sslsock;</span>
<span class='curline'><a href='../S/853.html#L1039'>sslsock</a>          1039 ext/openssl/xp_ssl.c 	sslsock = (php_openssl_netstream_data_t*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/853.html#L1043'>sslsock</a>          1043 ext/openssl/xp_ssl.c 	if (sslsock-&gt;reneg-&gt;prev_handshake == 0) {</span>
<span class='curline'><a href='../S/853.html#L1044'>sslsock</a>          1044 ext/openssl/xp_ssl.c 		sslsock-&gt;reneg-&gt;prev_handshake = now.tv_sec;</span>
<span class='curline'><a href='../S/853.html#L1048'>sslsock</a>          1048 ext/openssl/xp_ssl.c 	elapsed_time = (now.tv_sec - sslsock-&gt;reneg-&gt;prev_handshake);</span>
<span class='curline'><a href='../S/853.html#L1049'>sslsock</a>          1049 ext/openssl/xp_ssl.c 	sslsock-&gt;reneg-&gt;prev_handshake = now.tv_sec;</span>
<span class='curline'><a href='../S/853.html#L1050'>sslsock</a>          1050 ext/openssl/xp_ssl.c 	sslsock-&gt;reneg-&gt;tokens -= (elapsed_time * (sslsock-&gt;reneg-&gt;limit / sslsock-&gt;reneg-&gt;window));</span>
<span class='curline'><a href='../S/853.html#L1052'>sslsock</a>          1052 ext/openssl/xp_ssl.c 	if (sslsock-&gt;reneg-&gt;tokens &lt; 0) {</span>
<span class='curline'><a href='../S/853.html#L1053'>sslsock</a>          1053 ext/openssl/xp_ssl.c 		sslsock-&gt;reneg-&gt;tokens = 0;</span>
<span class='curline'><a href='../S/853.html#L1055'>sslsock</a>          1055 ext/openssl/xp_ssl.c 	++sslsock-&gt;reneg-&gt;tokens;</span>
<span class='curline'><a href='../S/853.html#L1058'>sslsock</a>          1058 ext/openssl/xp_ssl.c 	if (sslsock-&gt;reneg-&gt;tokens &gt; sslsock-&gt;reneg-&gt;limit) {</span>
<span class='curline'><a href='../S/853.html#L1062'>sslsock</a>          1062 ext/openssl/xp_ssl.c 		sslsock-&gt;reneg-&gt;should_close = 1;</span>
<span class='curline'><a href='../S/853.html#L1080'>sslsock</a>          1080 ext/openssl/xp_ssl.c 				sslsock-&gt;reneg-&gt;should_close = 0;</span>
<span class='curline'><a href='../S/853.html#L1101'>sslsock</a>          1101 ext/openssl/xp_ssl.c static void init_server_reneg_limit(php_stream *stream, php_openssl_netstream_data_t *sslsock) /* {{{ */</span>
<span class='curline'><a href='../S/853.html#L1128'>sslsock</a>          1128 ext/openssl/xp_ssl.c 	sslsock-&gt;reneg = (void*)pemalloc(sizeof(php_openssl_handshake_bucket_t),</span>
<span class='curline'><a href='../S/853.html#L1132'>sslsock</a>          1132 ext/openssl/xp_ssl.c 	sslsock-&gt;reneg-&gt;limit = limit;</span>
<span class='curline'><a href='../S/853.html#L1133'>sslsock</a>          1133 ext/openssl/xp_ssl.c 	sslsock-&gt;reneg-&gt;window = window;</span>
<span class='curline'><a href='../S/853.html#L1134'>sslsock</a>          1134 ext/openssl/xp_ssl.c 	sslsock-&gt;reneg-&gt;prev_handshake = 0;</span>
<span class='curline'><a href='../S/853.html#L1135'>sslsock</a>          1135 ext/openssl/xp_ssl.c 	sslsock-&gt;reneg-&gt;tokens = 0;</span>
<span class='curline'><a href='../S/853.html#L1136'>sslsock</a>          1136 ext/openssl/xp_ssl.c 	sslsock-&gt;reneg-&gt;should_close = 0;</span>
<span class='curline'><a href='../S/853.html#L1138'>sslsock</a>          1138 ext/openssl/xp_ssl.c 	SSL_set_info_callback(sslsock-&gt;ssl_handle, info_callback);</span>
<span class='curline'><a href='../S/853.html#L1293'>sslsock</a>          1293 ext/openssl/xp_ssl.c 	php_openssl_netstream_data_t *sslsock;</span>
<span class='curline'><a href='../S/853.html#L1304'>sslsock</a>          1304 ext/openssl/xp_ssl.c 	sslsock = (php_openssl_netstream_data_t*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/853.html#L1306'>sslsock</a>          1306 ext/openssl/xp_ssl.c 	if (!(sslsock-&gt;sni_cert_count &amp;&amp; sslsock-&gt;sni_certs)) {</span>
<span class='curline'><a href='../S/853.html#L1310'>sslsock</a>          1310 ext/openssl/xp_ssl.c 	for (i=0; i &lt; sslsock-&gt;sni_cert_count; i++) {</span>
<span class='curline'><a href='../S/853.html#L1311'>sslsock</a>          1311 ext/openssl/xp_ssl.c 		if (matches_wildcard_name(server_name, sslsock-&gt;sni_certs[i].name)) {</span>
<span class='curline'><a href='../S/853.html#L1312'>sslsock</a>          1312 ext/openssl/xp_ssl.c 			SSL_set_SSL_CTX(ssl_handle, sslsock-&gt;sni_certs[i].ctx);</span>
<span class='curline'><a href='../S/853.html#L1321'>sslsock</a>          1321 ext/openssl/xp_ssl.c static int enable_server_sni(php_stream *stream, php_openssl_netstream_data_t *sslsock)</span>
<span class='curline'><a href='../S/853.html#L1348'>sslsock</a>          1348 ext/openssl/xp_ssl.c 	sslsock-&gt;sni_cert_count = zend_hash_num_elements(Z_ARRVAL_P(val));</span>
<span class='curline'><a href='../S/853.html#L1349'>sslsock</a>          1349 ext/openssl/xp_ssl.c 	if (sslsock-&gt;sni_cert_count == 0) {</span>
<span class='curline'><a href='../S/853.html#L1356'>sslsock</a>          1356 ext/openssl/xp_ssl.c 	sslsock-&gt;sni_certs = (php_openssl_sni_cert_t*)safe_pemalloc(sslsock-&gt;sni_cert_count,</span>
<span class='curline'><a href='../S/853.html#L1392'>sslsock</a>          1392 ext/openssl/xp_ssl.c 				sslsock-&gt;sni_certs[i].name = pestrdup(ZSTR_VAL(key), php_stream_is_persistent(stream));</span>
<span class='curline'><a href='../S/853.html#L1393'>sslsock</a>          1393 ext/openssl/xp_ssl.c 				sslsock-&gt;sni_certs[i].ctx = ctx;</span>
<span class='curline'><a href='../S/853.html#L1405'>sslsock</a>          1405 ext/openssl/xp_ssl.c 	SSL_CTX_set_tlsext_servername_callback(sslsock-&gt;ctx, server_sni_callback);</span>
<span class='curline'><a href='../S/853.html#L1410'>sslsock</a>          1410 ext/openssl/xp_ssl.c static void enable_client_sni(php_stream *stream, php_openssl_netstream_data_t *sslsock) /* {{{ */</span>
<span class='curline'><a href='../S/853.html#L1420'>sslsock</a>          1420 ext/openssl/xp_ssl.c 	sni_server_name = sslsock-&gt;url_name;</span>
<span class='curline'><a href='../S/853.html#L1425'>sslsock</a>          1425 ext/openssl/xp_ssl.c 		SSL_set_tlsext_host_name(sslsock-&gt;ssl_handle, sni_server_name);</span>
<span class='curline'><a href='../S/853.html#L1477'>sslsock</a>          1477 ext/openssl/xp_ssl.c 	php_openssl_netstream_data_t *sslsock = arg;</span>
<span class='curline'><a href='../S/853.html#L1480'>sslsock</a>          1480 ext/openssl/xp_ssl.c 		((unsigned char **)out, outlen, sslsock-&gt;alpn_ctx-&gt;data, sslsock-&gt;alpn_ctx-&gt;len, in,</span>
<span class='curline'><a href='../S/853.html#L1491'>sslsock</a>          1491 ext/openssl/xp_ssl.c 		php_openssl_netstream_data_t *sslsock,</span>
<span class='curline'><a href='../S/853.html#L1502'>sslsock</a>          1502 ext/openssl/xp_ssl.c 	if (sslsock-&gt;ssl_handle) {</span>
<span class='curline'><a href='../S/853.html#L1503'>sslsock</a>          1503 ext/openssl/xp_ssl.c 		if (sslsock-&gt;s.is_blocked) {</span>
<span class='curline'><a href='../S/853.html#L1515'>sslsock</a>          1515 ext/openssl/xp_ssl.c 	sslsock-&gt;is_client = cparam-&gt;inputs.method &amp; STREAM_CRYPTO_IS_CLIENT;</span>
<span class='curline'><a href='../S/853.html#L1521'>sslsock</a>          1521 ext/openssl/xp_ssl.c 		method = php_select_crypto_method(method_flags, sslsock-&gt;is_client);</span>
<span class='curline'><a href='../S/853.html#L1526'>sslsock</a>          1526 ext/openssl/xp_ssl.c 		method = sslsock-&gt;is_client ? SSLv23_client_method() : SSLv23_server_method();</span>
<span class='curline'><a href='../S/853.html#L1534'>sslsock</a>          1534 ext/openssl/xp_ssl.c 	sslsock-&gt;ctx = SSL_CTX_new(method);</span>
<span class='curline'><a href='../S/853.html#L1537'>sslsock</a>          1537 ext/openssl/xp_ssl.c 	sslsock-&gt;ctx = SSL_CTX_new((SSL_METHOD*)method);</span>
<span class='curline'><a href='../S/853.html#L1540'>sslsock</a>          1540 ext/openssl/xp_ssl.c 	if (sslsock-&gt;ctx == NULL) {</span>
<span class='curline'><a href='../S/853.html#L1562'>sslsock</a>          1562 ext/openssl/xp_ssl.c 		disable_peer_verification(sslsock-&gt;ctx, stream);</span>
<span class='curline'><a href='../S/853.html#L1563'>sslsock</a>          1563 ext/openssl/xp_ssl.c 	} else if (FAILURE == enable_peer_verification(sslsock-&gt;ctx, stream)) {</span>
<span class='curline'><a href='../S/853.html#L1569'>sslsock</a>          1569 ext/openssl/xp_ssl.c 		SSL_CTX_set_default_passwd_cb_userdata(sslsock-&gt;ctx, stream);</span>
<span class='curline'><a href='../S/853.html#L1570'>sslsock</a>          1570 ext/openssl/xp_ssl.c 		SSL_CTX_set_default_passwd_cb(sslsock-&gt;ctx, passwd_callback);</span>
<span class='curline'><a href='../S/853.html#L1580'>sslsock</a>          1580 ext/openssl/xp_ssl.c 		if (SSL_CTX_set_cipher_list(sslsock-&gt;ctx, cipherlist) != 1) {</span>
<span class='curline'><a href='../S/853.html#L1594'>sslsock</a>          1594 ext/openssl/xp_ssl.c 				SSL_CTX_free(sslsock-&gt;ctx);</span>
<span class='curline'><a href='../S/853.html#L1595'>sslsock</a>          1595 ext/openssl/xp_ssl.c 				sslsock-&gt;ctx = NULL;</span>
<span class='curline'><a href='../S/853.html#L1598'>sslsock</a>          1598 ext/openssl/xp_ssl.c 			if (sslsock-&gt;is_client) {</span>
<span class='curline'><a href='../S/853.html#L1599'>sslsock</a>          1599 ext/openssl/xp_ssl.c 				SSL_CTX_set_alpn_protos(sslsock-&gt;ctx, alpn, alpn_len);</span>
<span class='curline'><a href='../S/853.html#L1601'>sslsock</a>          1601 ext/openssl/xp_ssl.c 				sslsock-&gt;alpn_ctx = (php_openssl_alpn_ctx *) emalloc(sizeof(php_openssl_alpn_ctx));</span>
<span class='curline'><a href='../S/853.html#L1602'>sslsock</a>          1602 ext/openssl/xp_ssl.c 				sslsock-&gt;alpn_ctx-&gt;data = (unsigned char*)estrndup((const char*)alpn, alpn_len);</span>
<span class='curline'><a href='../S/853.html#L1603'>sslsock</a>          1603 ext/openssl/xp_ssl.c 				sslsock-&gt;alpn_ctx-&gt;len = alpn_len;</span>
<span class='curline'><a href='../S/853.html#L1604'>sslsock</a>          1604 ext/openssl/xp_ssl.c 				SSL_CTX_set_alpn_select_cb(sslsock-&gt;ctx, server_alpn_callback, sslsock);</span>
<span class='curline'><a href='../S/853.html#L1615'>sslsock</a>          1615 ext/openssl/xp_ssl.c 	if (FAILURE == set_local_cert(sslsock-&gt;ctx, stream)) {</span>
<span class='curline'><a href='../S/853.html#L1619'>sslsock</a>          1619 ext/openssl/xp_ssl.c 	SSL_CTX_set_options(sslsock-&gt;ctx, ssl_ctx_options);</span>
<span class='curline'><a href='../S/853.html#L1621'>sslsock</a>          1621 ext/openssl/xp_ssl.c 	if (sslsock-&gt;is_client == 0 &amp;&amp;</span>
<span class='curline'><a href='../S/853.html#L1623'>sslsock</a>          1623 ext/openssl/xp_ssl.c 		FAILURE == set_server_specific_opts(stream, sslsock-&gt;ctx)</span>
<span class='curline'><a href='../S/853.html#L1628'>sslsock</a>          1628 ext/openssl/xp_ssl.c 	sslsock-&gt;ssl_handle = SSL_new(sslsock-&gt;ctx);</span>
<span class='curline'><a href='../S/853.html#L1630'>sslsock</a>          1630 ext/openssl/xp_ssl.c 	if (sslsock-&gt;ssl_handle == NULL) {</span>
<span class='curline'><a href='../S/853.html#L1632'>sslsock</a>          1632 ext/openssl/xp_ssl.c 		SSL_CTX_free(sslsock-&gt;ctx);</span>
<span class='curline'><a href='../S/853.html#L1633'>sslsock</a>          1633 ext/openssl/xp_ssl.c 		sslsock-&gt;ctx = NULL;</span>
<span class='curline'><a href='../S/853.html#L1636'>sslsock</a>          1636 ext/openssl/xp_ssl.c 		SSL_set_ex_data(sslsock-&gt;ssl_handle, php_openssl_get_ssl_stream_data_index(), stream);</span>
<span class='curline'><a href='../S/853.html#L1639'>sslsock</a>          1639 ext/openssl/xp_ssl.c 	if (!SSL_set_fd(sslsock-&gt;ssl_handle, sslsock-&gt;s.socket)) {</span>
<span class='curline'><a href='../S/853.html#L1645'>sslsock</a>          1645 ext/openssl/xp_ssl.c 	if (!sslsock-&gt;is_client &amp;&amp; enable_server_sni(stream, sslsock) == FAILURE) {</span>
<span class='curline'><a href='../S/853.html#L1651'>sslsock</a>          1651 ext/openssl/xp_ssl.c 	if (!sslsock-&gt;is_client) {</span>
<span class='curline'><a href='../S/853.html#L1652'>sslsock</a>          1652 ext/openssl/xp_ssl.c 		init_server_reneg_limit(stream, sslsock);</span>
<span class='curline'><a href='../S/853.html#L1657'>sslsock</a>          1657 ext/openssl/xp_ssl.c 		long mode = SSL_get_mode(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1658'>sslsock</a>          1658 ext/openssl/xp_ssl.c 		SSL_set_mode(sslsock-&gt;ssl_handle, mode | SSL_MODE_RELEASE_BUFFERS);</span>
<span class='curline'><a href='../S/853.html#L1668'>sslsock</a>          1668 ext/openssl/xp_ssl.c 			SSL_copy_session_id(sslsock-&gt;ssl_handle, ((php_openssl_netstream_data_t*)cparam-&gt;inputs.session-&gt;abstract)-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1720'>sslsock</a>          1720 ext/openssl/xp_ssl.c static int capture_peer_certs(php_stream *stream, php_openssl_netstream_data_t *sslsock, X509 *peer_cert) /* {{{ */</span>
<span class='curline'><a href='../S/853.html#L1742'>sslsock</a>          1742 ext/openssl/xp_ssl.c 		chain = SSL_get_peer_cert_chain(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1767'>sslsock</a>          1767 ext/openssl/xp_ssl.c 		php_openssl_netstream_data_t *sslsock,</span>
<span class='curline'><a href='../S/853.html#L1776'>sslsock</a>          1776 ext/openssl/xp_ssl.c 	if (cparam-&gt;inputs.activate &amp;&amp; !sslsock-&gt;ssl_active) {</span>
<span class='curline'><a href='../S/853.html#L1779'>sslsock</a>          1779 ext/openssl/xp_ssl.c 		int				blocked		= sslsock-&gt;s.is_blocked,</span>
<span class='curline'><a href='../S/853.html#L1783'>sslsock</a>          1783 ext/openssl/xp_ssl.c 		if (sslsock-&gt;is_client) {</span>
<span class='curline'><a href='../S/853.html#L1784'>sslsock</a>          1784 ext/openssl/xp_ssl.c 			enable_client_sni(stream, sslsock);</span>
<span class='curline'><a href='../S/853.html#L1788'>sslsock</a>          1788 ext/openssl/xp_ssl.c 		if (!sslsock-&gt;state_set) {</span>
<span class='curline'><a href='../S/853.html#L1789'>sslsock</a>          1789 ext/openssl/xp_ssl.c 			if (sslsock-&gt;is_client) {</span>
<span class='curline'><a href='../S/853.html#L1790'>sslsock</a>          1790 ext/openssl/xp_ssl.c 				SSL_set_connect_state(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1792'>sslsock</a>          1792 ext/openssl/xp_ssl.c 				SSL_set_accept_state(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1794'>sslsock</a>          1794 ext/openssl/xp_ssl.c 			sslsock-&gt;state_set = 1;</span>
<span class='curline'><a href='../S/853.html#L1797'>sslsock</a>          1797 ext/openssl/xp_ssl.c 		if (SUCCESS == php_set_sock_blocking(sslsock-&gt;s.socket, 0)) {</span>
<span class='curline'><a href='../S/853.html#L1798'>sslsock</a>          1798 ext/openssl/xp_ssl.c 			sslsock-&gt;s.is_blocked = 0;</span>
<span class='curline'><a href='../S/853.html#L1801'>sslsock</a>          1801 ext/openssl/xp_ssl.c 		timeout = sslsock-&gt;is_client ? &amp;sslsock-&gt;connect_timeout : &amp;sslsock-&gt;s.timeout;</span>
<span class='curline'><a href='../S/853.html#L1802'>sslsock</a>          1802 ext/openssl/xp_ssl.c 		has_timeout = !sslsock-&gt;s.is_blocked &amp;&amp; (timeout-&gt;tv_sec || timeout-&gt;tv_usec);</span>
<span class='curline'><a href='../S/853.html#L1812'>sslsock</a>          1812 ext/openssl/xp_ssl.c 			if (sslsock-&gt;is_client) {</span>
<span class='curline'><a href='../S/853.html#L1813'>sslsock</a>          1813 ext/openssl/xp_ssl.c 				n = SSL_connect(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1815'>sslsock</a>          1815 ext/openssl/xp_ssl.c 				n = SSL_accept(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1834'>sslsock</a>          1834 ext/openssl/xp_ssl.c 					int err = SSL_get_error(sslsock-&gt;ssl_handle, n);</span>
<span class='curline'><a href='../S/853.html#L1840'>sslsock</a>          1840 ext/openssl/xp_ssl.c 					php_pollfd_for(sslsock-&gt;s.socket, (err == SSL_ERROR_WANT_READ) ?</span>
<span class='curline'><a href='../S/853.html#L1848'>sslsock</a>          1848 ext/openssl/xp_ssl.c 		if (sslsock-&gt;s.is_blocked != blocked &amp;&amp; SUCCESS == php_set_sock_blocking(sslsock-&gt;s.socket, blocked)) {</span>
<span class='curline'><a href='../S/853.html#L1849'>sslsock</a>          1849 ext/openssl/xp_ssl.c 			sslsock-&gt;s.is_blocked = blocked;</span>
<span class='curline'><a href='../S/853.html#L1853'>sslsock</a>          1853 ext/openssl/xp_ssl.c 			peer_cert = SSL_get_peer_certificate(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1855'>sslsock</a>          1855 ext/openssl/xp_ssl.c 				cert_captured = capture_peer_certs(stream, sslsock, peer_cert);</span>
<span class='curline'><a href='../S/853.html#L1858'>sslsock</a>          1858 ext/openssl/xp_ssl.c 			if (FAILURE == apply_peer_verification_policy(sslsock-&gt;ssl_handle, peer_cert, stream)) {</span>
<span class='curline'><a href='../S/853.html#L1859'>sslsock</a>          1859 ext/openssl/xp_ssl.c 				SSL_shutdown(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1862'>sslsock</a>          1862 ext/openssl/xp_ssl.c 				sslsock-&gt;ssl_active = 1;</span>
<span class='curline'><a href='../S/853.html#L1876'>sslsock</a>          1876 ext/openssl/xp_ssl.c 						ZVAL_ARR(&amp;meta_arr, capture_session_meta(sslsock-&gt;ssl_handle));</span>
<span class='curline'><a href='../S/853.html#L1887'>sslsock</a>          1887 ext/openssl/xp_ssl.c 			peer_cert = SSL_get_peer_certificate(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1889'>sslsock</a>          1889 ext/openssl/xp_ssl.c 				cert_captured = capture_peer_certs(stream, sslsock, peer_cert);</span>
<span class='curline'><a href='../S/853.html#L1899'>sslsock</a>          1899 ext/openssl/xp_ssl.c 	} else if (!cparam-&gt;inputs.activate &amp;&amp; sslsock-&gt;ssl_active) {</span>
<span class='curline'><a href='../S/853.html#L1901'>sslsock</a>          1901 ext/openssl/xp_ssl.c 		SSL_shutdown(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L1902'>sslsock</a>          1902 ext/openssl/xp_ssl.c 		sslsock-&gt;ssl_active = 0;</span>
<span class='curline'><a href='../S/853.html#L1929'>sslsock</a>          1929 ext/openssl/xp_ssl.c 	php_openssl_netstream_data_t *sslsock = (php_openssl_netstream_data_t*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/853.html#L1932'>sslsock</a>          1932 ext/openssl/xp_ssl.c 	if (sslsock-&gt;ssl_active) {</span>
<span class='curline'><a href='../S/853.html#L1936'>sslsock</a>          1936 ext/openssl/xp_ssl.c 		int began_blocked = sslsock-&gt;s.is_blocked;</span>
<span class='curline'><a href='../S/853.html#L1946'>sslsock</a>          1946 ext/openssl/xp_ssl.c 		if (began_blocked &amp;&amp; &amp;sslsock-&gt;s.timeout) {</span>
<span class='curline'><a href='../S/853.html#L1947'>sslsock</a>          1947 ext/openssl/xp_ssl.c 			timeout = &amp;sslsock-&gt;s.timeout;</span>
<span class='curline'><a href='../S/853.html#L1950'>sslsock</a>          1950 ext/openssl/xp_ssl.c 		if (timeout &amp;&amp; php_set_sock_blocking(sslsock-&gt;s.socket, 0) == SUCCESS) {</span>
<span class='curline'><a href='../S/853.html#L1951'>sslsock</a>          1951 ext/openssl/xp_ssl.c 			sslsock-&gt;s.is_blocked = 0;</span>
<span class='curline'><a href='../S/853.html#L1954'>sslsock</a>          1954 ext/openssl/xp_ssl.c 		if (!sslsock-&gt;s.is_blocked &amp;&amp; timeout &amp;&amp; (timeout-&gt;tv_sec || timeout-&gt;tv_usec)) {</span>
<span class='curline'><a href='../S/853.html#L1975'>sslsock</a>          1975 ext/openssl/xp_ssl.c 						php_set_sock_blocking(sslsock-&gt;s.socket, 1);</span>
<span class='curline'><a href='../S/853.html#L1976'>sslsock</a>          1976 ext/openssl/xp_ssl.c 						sslsock-&gt;s.is_blocked = 1;</span>
<span class='curline'><a href='../S/853.html#L1978'>sslsock</a>          1978 ext/openssl/xp_ssl.c 					sslsock-&gt;s.timeout_event = 1;</span>
<span class='curline'><a href='../S/853.html#L1985'>sslsock</a>          1985 ext/openssl/xp_ssl.c 				nr_bytes = SSL_read(sslsock-&gt;ssl_handle, buf, (int)count);</span>
<span class='curline'><a href='../S/853.html#L1987'>sslsock</a>          1987 ext/openssl/xp_ssl.c 				if (sslsock-&gt;reneg &amp;&amp; sslsock-&gt;reneg-&gt;should_close) {</span>
<span class='curline'><a href='../S/853.html#L1995'>sslsock</a>          1995 ext/openssl/xp_ssl.c 				nr_bytes = SSL_write(sslsock-&gt;ssl_handle, buf, (int)count);</span>
<span class='curline'><a href='../S/853.html#L2007'>sslsock</a>          2007 ext/openssl/xp_ssl.c 				int err = SSL_get_error(sslsock-&gt;ssl_handle, nr_bytes );</span>
<span class='curline'><a href='../S/853.html#L2020'>sslsock</a>          2020 ext/openssl/xp_ssl.c 					stream-&gt;eof = (retry == 0 &amp;&amp; errno != EAGAIN &amp;&amp; !SSL_pending(sslsock-&gt;ssl_handle));</span>
<span class='curline'><a href='../S/853.html#L2033'>sslsock</a>          2033 ext/openssl/xp_ssl.c 						php_pollfd_for(sslsock-&gt;s.socket, (err == SSL_ERROR_WANT_WRITE) ?</span>
<span class='curline'><a href='../S/853.html#L2036'>sslsock</a>          2036 ext/openssl/xp_ssl.c 						php_pollfd_for(sslsock-&gt;s.socket, (err == SSL_ERROR_WANT_READ) ?</span>
<span class='curline'><a href='../S/853.html#L2042'>sslsock</a>          2042 ext/openssl/xp_ssl.c 				int err = SSL_get_error(sslsock-&gt;ssl_handle, nr_bytes);</span>
<span class='curline'><a href='../S/853.html#L2052'>sslsock</a>          2052 ext/openssl/xp_ssl.c 						php_pollfd_for(sslsock-&gt;s.socket, (err == SSL_ERROR_WANT_WRITE) ?</span>
<span class='curline'><a href='../S/853.html#L2055'>sslsock</a>          2055 ext/openssl/xp_ssl.c 						php_pollfd_for(sslsock-&gt;s.socket, (err == SSL_ERROR_WANT_READ) ?</span>
<span class='curline'><a href='../S/853.html#L2070'>sslsock</a>          2070 ext/openssl/xp_ssl.c 		if (began_blocked &amp;&amp; php_set_sock_blocking(sslsock-&gt;s.socket, 1) == SUCCESS) {</span>
<span class='curline'><a href='../S/853.html#L2071'>sslsock</a>          2071 ext/openssl/xp_ssl.c 			sslsock-&gt;s.is_blocked = 1;</span>
<span class='curline'><a href='../S/853.html#L2120'>sslsock</a>          2120 ext/openssl/xp_ssl.c 	php_openssl_netstream_data_t *sslsock = (php_openssl_netstream_data_t*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/853.html#L2127'>sslsock</a>          2127 ext/openssl/xp_ssl.c 		if (sslsock-&gt;ssl_active) {</span>
<span class='curline'><a href='../S/853.html#L2128'>sslsock</a>          2128 ext/openssl/xp_ssl.c 			SSL_shutdown(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L2129'>sslsock</a>          2129 ext/openssl/xp_ssl.c 			sslsock-&gt;ssl_active = 0;</span>
<span class='curline'><a href='../S/853.html#L2131'>sslsock</a>          2131 ext/openssl/xp_ssl.c 		if (sslsock-&gt;ssl_handle) {</span>
<span class='curline'><a href='../S/853.html#L2132'>sslsock</a>          2132 ext/openssl/xp_ssl.c 			SSL_free(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L2133'>sslsock</a>          2133 ext/openssl/xp_ssl.c 			sslsock-&gt;ssl_handle = NULL;</span>
<span class='curline'><a href='../S/853.html#L2135'>sslsock</a>          2135 ext/openssl/xp_ssl.c 		if (sslsock-&gt;ctx) {</span>
<span class='curline'><a href='../S/853.html#L2136'>sslsock</a>          2136 ext/openssl/xp_ssl.c 			SSL_CTX_free(sslsock-&gt;ctx);</span>
<span class='curline'><a href='../S/853.html#L2137'>sslsock</a>          2137 ext/openssl/xp_ssl.c 			sslsock-&gt;ctx = NULL;</span>
<span class='curline'><a href='../S/853.html#L2140'>sslsock</a>          2140 ext/openssl/xp_ssl.c 		if (sslsock-&gt;s.socket == -1)</span>
<span class='curline'><a href='../S/853.html#L2141'>sslsock</a>          2141 ext/openssl/xp_ssl.c 			sslsock-&gt;s.socket = SOCK_ERR;</span>
<span class='curline'><a href='../S/853.html#L2143'>sslsock</a>          2143 ext/openssl/xp_ssl.c 		if (sslsock-&gt;s.socket != SOCK_ERR) {</span>
<span class='curline'><a href='../S/853.html#L2146'>sslsock</a>          2146 ext/openssl/xp_ssl.c 			shutdown(sslsock-&gt;s.socket, SHUT_RD);</span>
<span class='curline'><a href='../S/853.html#L2155'>sslsock</a>          2155 ext/openssl/xp_ssl.c 				n = php_pollfd_for_ms(sslsock-&gt;s.socket, POLLOUT, 500);</span>
<span class='curline'><a href='../S/853.html#L2158'>sslsock</a>          2158 ext/openssl/xp_ssl.c 			closesocket(sslsock-&gt;s.socket);</span>
<span class='curline'><a href='../S/853.html#L2159'>sslsock</a>          2159 ext/openssl/xp_ssl.c 			sslsock-&gt;s.socket = SOCK_ERR;</span>
<span class='curline'><a href='../S/853.html#L2163'>sslsock</a>          2163 ext/openssl/xp_ssl.c 	if (sslsock-&gt;sni_certs) {</span>
<span class='curline'><a href='../S/853.html#L2164'>sslsock</a>          2164 ext/openssl/xp_ssl.c 		for (i=0; i&lt;sslsock-&gt;sni_cert_count; i++) {</span>
<span class='curline'><a href='../S/853.html#L2165'>sslsock</a>          2165 ext/openssl/xp_ssl.c 			SSL_CTX_free(sslsock-&gt;sni_certs[i].ctx);</span>
<span class='curline'><a href='../S/853.html#L2166'>sslsock</a>          2166 ext/openssl/xp_ssl.c 			pefree(sslsock-&gt;sni_certs[i].name, php_stream_is_persistent(stream));</span>
<span class='curline'><a href='../S/853.html#L2168'>sslsock</a>          2168 ext/openssl/xp_ssl.c 		pefree(sslsock-&gt;sni_certs, php_stream_is_persistent(stream));</span>
<span class='curline'><a href='../S/853.html#L2169'>sslsock</a>          2169 ext/openssl/xp_ssl.c 		sslsock-&gt;sni_certs = NULL;</span>
<span class='curline'><a href='../S/853.html#L2172'>sslsock</a>          2172 ext/openssl/xp_ssl.c 	if (sslsock-&gt;url_name) {</span>
<span class='curline'><a href='../S/853.html#L2173'>sslsock</a>          2173 ext/openssl/xp_ssl.c 		pefree(sslsock-&gt;url_name, php_stream_is_persistent(stream));</span>
<span class='curline'><a href='../S/853.html#L2176'>sslsock</a>          2176 ext/openssl/xp_ssl.c 	if (sslsock-&gt;reneg) {</span>
<span class='curline'><a href='../S/853.html#L2177'>sslsock</a>          2177 ext/openssl/xp_ssl.c 		pefree(sslsock-&gt;reneg, php_stream_is_persistent(stream));</span>
<span class='curline'><a href='../S/853.html#L2180'>sslsock</a>          2180 ext/openssl/xp_ssl.c 	pefree(sslsock, php_stream_is_persistent(stream));</span>
<span class='curline'><a href='../S/853.html#L2263'>sslsock</a>          2263 ext/openssl/xp_ssl.c 	php_openssl_netstream_data_t *sslsock = (php_openssl_netstream_data_t*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/853.html#L2269'>sslsock</a>          2269 ext/openssl/xp_ssl.c 			if (sslsock-&gt;ssl_active) {</span>
<span class='curline'><a href='../S/853.html#L2276'>sslsock</a>          2276 ext/openssl/xp_ssl.c 				switch (SSL_version(sslsock-&gt;ssl_handle)) {</span>
<span class='curline'><a href='../S/853.html#L2293'>sslsock</a>          2293 ext/openssl/xp_ssl.c 				cipher = SSL_get_current_cipher(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/853.html#L2305'>sslsock</a>          2305 ext/openssl/xp_ssl.c 					SSL_get0_alpn_selected(sslsock-&gt;ssl_handle, &amp;alpn_proto, &amp;alpn_proto_len);</span>
<span class='curline'><a href='../S/853.html#L2314'>sslsock</a>          2314 ext/openssl/xp_ssl.c 			add_assoc_bool((zval *)ptrparam, "timed_out", sslsock-&gt;s.timeout_event);</span>
<span class='curline'><a href='../S/853.html#L2315'>sslsock</a>          2315 ext/openssl/xp_ssl.c 			add_assoc_bool((zval *)ptrparam, "blocked", sslsock-&gt;s.is_blocked);</span>
<span class='curline'><a href='../S/853.html#L2327'>sslsock</a>          2327 ext/openssl/xp_ssl.c 					if (sslsock-&gt;s.timeout.tv_sec == -1) {</span>
<span class='curline'><a href='../S/853.html#L2335'>sslsock</a>          2335 ext/openssl/xp_ssl.c 						tv = sslsock-&gt;connect_timeout;</span>
<span class='curline'><a href='../S/853.html#L2342'>sslsock</a>          2342 ext/openssl/xp_ssl.c 				if (sslsock-&gt;s.socket == -1) {</span>
<span class='curline'><a href='../S/853.html#L2344'>sslsock</a>          2344 ext/openssl/xp_ssl.c 				} else if (php_pollfd_for(sslsock-&gt;s.socket, PHP_POLLREADABLE|POLLPRI, &amp;tv) &gt; 0) {</span>
<span class='curline'><a href='../S/853.html#L2345'>sslsock</a>          2345 ext/openssl/xp_ssl.c 					if (sslsock-&gt;ssl_active) {</span>
<span class='curline'><a href='../S/853.html#L2349'>sslsock</a>          2349 ext/openssl/xp_ssl.c 							n = SSL_peek(sslsock-&gt;ssl_handle, &amp;buf, sizeof(buf));</span>
<span class='curline'><a href='../S/853.html#L2351'>sslsock</a>          2351 ext/openssl/xp_ssl.c 								int err = SSL_get_error(sslsock-&gt;ssl_handle, n);</span>
<span class='curline'><a href='../S/853.html#L2370'>sslsock</a>          2370 ext/openssl/xp_ssl.c 					} else if (0 == recv(sslsock-&gt;s.socket, &amp;buf, sizeof(buf), MSG_PEEK) &amp;&amp; php_socket_errno() != EAGAIN) {</span>
<span class='curline'><a href='../S/853.html#L2382'>sslsock</a>          2382 ext/openssl/xp_ssl.c 					cparam-&gt;outputs.returncode = php_openssl_setup_crypto(stream, sslsock, cparam);</span>
<span class='curline'><a href='../S/853.html#L2386'>sslsock</a>          2386 ext/openssl/xp_ssl.c 					cparam-&gt;outputs.returncode = php_openssl_enable_crypto(stream, sslsock, cparam);</span>
<span class='curline'><a href='../S/853.html#L2405'>sslsock</a>          2405 ext/openssl/xp_ssl.c 					if ((sslsock-&gt;enable_on_connect) &amp;&amp;</span>
<span class='curline'><a href='../S/853.html#L2410'>sslsock</a>          2410 ext/openssl/xp_ssl.c 						if (php_stream_xport_crypto_setup(stream, sslsock-&gt;method, NULL) &lt; 0 ||</span>
<span class='curline'><a href='../S/853.html#L2421'>sslsock</a>          2421 ext/openssl/xp_ssl.c 					xparam-&gt;outputs.returncode = php_openssl_tcp_sockop_accept(stream, sslsock, xparam STREAMS_CC);</span>
<span class='curline'><a href='../S/853.html#L2437'>sslsock</a>          2437 ext/openssl/xp_ssl.c 	php_openssl_netstream_data_t *sslsock = (php_openssl_netstream_data_t*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/853.html#L2441'>sslsock</a>          2441 ext/openssl/xp_ssl.c 			if (sslsock-&gt;ssl_active) {</span>
<span class='curline'><a href='../S/853.html#L2445'>sslsock</a>          2445 ext/openssl/xp_ssl.c 				*ret = fdopen(sslsock-&gt;s.socket, stream-&gt;mode);</span>
<span class='curline'><a href='../S/853.html#L2457'>sslsock</a>          2457 ext/openssl/xp_ssl.c 					&amp;&amp; sslsock-&gt;ssl_active</span>
<span class='curline'><a href='../S/853.html#L2458'>sslsock</a>          2458 ext/openssl/xp_ssl.c 					&amp;&amp; (pending = (size_t)SSL_pending(sslsock-&gt;ssl_handle)) &gt; 0) {</span>
<span class='curline'><a href='../S/853.html#L2464'>sslsock</a>          2464 ext/openssl/xp_ssl.c 				*(php_socket_t *)ret = sslsock-&gt;s.socket;</span>
<span class='curline'><a href='../S/853.html#L2470'>sslsock</a>          2470 ext/openssl/xp_ssl.c 			if (sslsock-&gt;ssl_active) {</span>
<span class='curline'><a href='../S/853.html#L2474'>sslsock</a>          2474 ext/openssl/xp_ssl.c 				*(php_socket_t *)ret = sslsock-&gt;s.socket;</span>
<span class='curline'><a href='../S/853.html#L2547'>sslsock</a>          2547 ext/openssl/xp_ssl.c 	php_openssl_netstream_data_t *sslsock = NULL;</span>
<span class='curline'><a href='../S/853.html#L2549'>sslsock</a>          2549 ext/openssl/xp_ssl.c 	sslsock = pemalloc(sizeof(php_openssl_netstream_data_t), persistent_id ? 1 : 0);</span>
<span class='curline'><a href='../S/853.html#L2550'>sslsock</a>          2550 ext/openssl/xp_ssl.c 	memset(sslsock, 0, sizeof(*sslsock));</span>
<span class='curline'><a href='../S/853.html#L2552'>sslsock</a>          2552 ext/openssl/xp_ssl.c 	sslsock-&gt;s.is_blocked = 1;</span>
<span class='curline'><a href='../S/853.html#L2555'>sslsock</a>          2555 ext/openssl/xp_ssl.c 	sslsock-&gt;s.timeout.tv_sec = (long)FG(default_socket_timeout);</span>
<span class='curline'><a href='../S/853.html#L2557'>sslsock</a>          2557 ext/openssl/xp_ssl.c 	sslsock-&gt;s.timeout.tv_sec = (time_t)FG(default_socket_timeout);</span>
<span class='curline'><a href='../S/853.html#L2559'>sslsock</a>          2559 ext/openssl/xp_ssl.c 	sslsock-&gt;s.timeout.tv_usec = 0;</span>
<span class='curline'><a href='../S/853.html#L2562'>sslsock</a>          2562 ext/openssl/xp_ssl.c 	sslsock-&gt;connect_timeout.tv_sec = timeout-&gt;tv_sec;</span>
<span class='curline'><a href='../S/853.html#L2563'>sslsock</a>          2563 ext/openssl/xp_ssl.c 	sslsock-&gt;connect_timeout.tv_usec = timeout-&gt;tv_usec;</span>
<span class='curline'><a href='../S/853.html#L2567'>sslsock</a>          2567 ext/openssl/xp_ssl.c 	sslsock-&gt;s.socket = -1;</span>
<span class='curline'><a href='../S/853.html#L2570'>sslsock</a>          2570 ext/openssl/xp_ssl.c 	sslsock-&gt;ctx = NULL;</span>
<span class='curline'><a href='../S/853.html#L2572'>sslsock</a>          2572 ext/openssl/xp_ssl.c 	stream = php_stream_alloc_rel(&amp;php_openssl_socket_ops, sslsock, persistent_id, "r+");</span>
<span class='curline'><a href='../S/853.html#L2575'>sslsock</a>          2575 ext/openssl/xp_ssl.c 		pefree(sslsock, persistent_id ? 1 : 0);</span>
<span class='curline'><a href='../S/853.html#L2580'>sslsock</a>          2580 ext/openssl/xp_ssl.c 		sslsock-&gt;enable_on_connect = 1;</span>
<span class='curline'><a href='../S/853.html#L2581'>sslsock</a>          2581 ext/openssl/xp_ssl.c 		sslsock-&gt;method = get_crypto_method(context, STREAM_CRYPTO_METHOD_ANY_CLIENT);</span>
<span class='curline'><a href='../S/853.html#L2584'>sslsock</a>          2584 ext/openssl/xp_ssl.c 		sslsock-&gt;enable_on_connect = 1;</span>
<span class='curline'><a href='../S/853.html#L2585'>sslsock</a>          2585 ext/openssl/xp_ssl.c 		sslsock-&gt;method = STREAM_CRYPTO_METHOD_SSLv2_CLIENT;</span>
<span class='curline'><a href='../S/853.html#L2593'>sslsock</a>          2593 ext/openssl/xp_ssl.c 		sslsock-&gt;enable_on_connect = 1;</span>
<span class='curline'><a href='../S/853.html#L2594'>sslsock</a>          2594 ext/openssl/xp_ssl.c 		sslsock-&gt;method = STREAM_CRYPTO_METHOD_SSLv3_CLIENT;</span>
<span class='curline'><a href='../S/853.html#L2601'>sslsock</a>          2601 ext/openssl/xp_ssl.c 		sslsock-&gt;enable_on_connect = 1;</span>
<span class='curline'><a href='../S/853.html#L2602'>sslsock</a>          2602 ext/openssl/xp_ssl.c 		sslsock-&gt;method = get_crypto_method(context, STREAM_CRYPTO_METHOD_TLS_CLIENT);</span>
<span class='curline'><a href='../S/853.html#L2604'>sslsock</a>          2604 ext/openssl/xp_ssl.c 		sslsock-&gt;enable_on_connect = 1;</span>
<span class='curline'><a href='../S/853.html#L2605'>sslsock</a>          2605 ext/openssl/xp_ssl.c 		sslsock-&gt;method = STREAM_CRYPTO_METHOD_TLSv1_0_CLIENT;</span>
<span class='curline'><a href='../S/853.html#L2608'>sslsock</a>          2608 ext/openssl/xp_ssl.c 		sslsock-&gt;enable_on_connect = 1;</span>
<span class='curline'><a href='../S/853.html#L2609'>sslsock</a>          2609 ext/openssl/xp_ssl.c 		sslsock-&gt;method = STREAM_CRYPTO_METHOD_TLSv1_1_CLIENT;</span>
<span class='curline'><a href='../S/853.html#L2617'>sslsock</a>          2617 ext/openssl/xp_ssl.c 		sslsock-&gt;enable_on_connect = 1;</span>
<span class='curline'><a href='../S/853.html#L2618'>sslsock</a>          2618 ext/openssl/xp_ssl.c 		sslsock-&gt;method = STREAM_CRYPTO_METHOD_TLSv1_2_CLIENT;</span>
<span class='curline'><a href='../S/853.html#L2626'>sslsock</a>          2626 ext/openssl/xp_ssl.c 	sslsock-&gt;url_name = get_url_name(resourcename, resourcenamelen, !!persistent_id);</span>
</pre>
</body>
</html>
