<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>packet</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/801.html#L35'>packet</a>             35 ext/mysqlnd/mysqlnd_wireprotocol.c #define	PACKET_READ_HEADER_AND_BODY(packet, conn, buf, buf_size, packet_type_as_text, packet_type) \</span>
<span class='curline'><a href='../S/801.html#L38'>packet</a>             38 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (FAIL == mysqlnd_read_header((conn)-&gt;net, &amp;((packet)-&gt;header), (conn)-&gt;stats, ((conn)-&gt;error_info))) {\</span>
<span class='curline'><a href='../S/801.html#L45'>packet</a>             45 ext/mysqlnd/mysqlnd_wireprotocol.c 		if ((buf_size) &lt; (packet)-&gt;header.size) { \</span>
<span class='curline'><a href='../S/801.html#L47'>packet</a>             47 ext/mysqlnd/mysqlnd_wireprotocol.c 						(buf_size), (packet)-&gt;header.size, (packet)-&gt;header.size - (buf_size)); \</span>
<span class='curline'><a href='../S/801.html#L50'>packet</a>             50 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (FAIL == conn-&gt;net-&gt;data-&gt;m.receive_ex((conn)-&gt;net, (buf), (packet)-&gt;header.size, (conn)-&gt;stats, ((conn)-&gt;error_info))) { \</span>
<span class='curline'><a href='../S/801.html#L58'>packet</a>             58 ext/mysqlnd/mysqlnd_wireprotocol.c 											MYSQLND_HEADER_SIZE + (packet)-&gt;header.size, \</span>
<span class='curline'><a href='../S/801.html#L65'>packet</a>             65 ext/mysqlnd/mysqlnd_wireprotocol.c 	if ((size_t)(p - begin) &gt; packet-&gt;header.size) { \</span>
<span class='curline'><a href='../S/801.html#L130'>packet</a>            130 ext/mysqlnd/mysqlnd_wireprotocol.c php_mysqlnd_net_field_length(zend_uchar **packet)</span>
<span class='curline'><a href='../S/801.html#L132'>packet</a>            132 ext/mysqlnd/mysqlnd_wireprotocol.c 	register zend_uchar *p= (zend_uchar *)*packet;</span>
<span class='curline'><a href='../S/801.html#L135'>packet</a>            135 ext/mysqlnd/mysqlnd_wireprotocol.c 		(*packet)++;</span>
<span class='curline'><a href='../S/801.html#L141'>packet</a>            141 ext/mysqlnd/mysqlnd_wireprotocol.c 			(*packet)++;</span>
<span class='curline'><a href='../S/801.html#L144'>packet</a>            144 ext/mysqlnd/mysqlnd_wireprotocol.c 			(*packet) += 3;</span>
<span class='curline'><a href='../S/801.html#L147'>packet</a>            147 ext/mysqlnd/mysqlnd_wireprotocol.c 			(*packet) += 4;</span>
<span class='curline'><a href='../S/801.html#L150'>packet</a>            150 ext/mysqlnd/mysqlnd_wireprotocol.c 			(*packet) += 9;</span>
<span class='curline'><a href='../S/801.html#L160'>packet</a>            160 ext/mysqlnd/mysqlnd_wireprotocol.c php_mysqlnd_net_field_length_ll(zend_uchar **packet)</span>
<span class='curline'><a href='../S/801.html#L162'>packet</a>            162 ext/mysqlnd/mysqlnd_wireprotocol.c 	register zend_uchar *p = (zend_uchar *)*packet;</span>
<span class='curline'><a href='../S/801.html#L165'>packet</a>            165 ext/mysqlnd/mysqlnd_wireprotocol.c 		(*packet)++;</span>
<span class='curline'><a href='../S/801.html#L171'>packet</a>            171 ext/mysqlnd/mysqlnd_wireprotocol.c 			(*packet)++;</span>
<span class='curline'><a href='../S/801.html#L174'>packet</a>            174 ext/mysqlnd/mysqlnd_wireprotocol.c 			(*packet) += 3;</span>
<span class='curline'><a href='../S/801.html#L177'>packet</a>            177 ext/mysqlnd/mysqlnd_wireprotocol.c 			(*packet) += 4;</span>
<span class='curline'><a href='../S/801.html#L180'>packet</a>            180 ext/mysqlnd/mysqlnd_wireprotocol.c 			(*packet) += 9;</span>
<span class='curline'><a href='../S/801.html#L189'>packet</a>            189 ext/mysqlnd/mysqlnd_wireprotocol.c php_mysqlnd_net_store_length(zend_uchar *packet, uint64_t length)</span>
<span class='curline'><a href='../S/801.html#L192'>packet</a>            192 ext/mysqlnd/mysqlnd_wireprotocol.c 		*packet = (zend_uchar) length;</span>
<span class='curline'><a href='../S/801.html#L193'>packet</a>            193 ext/mysqlnd/mysqlnd_wireprotocol.c 		return packet + 1;</span>
<span class='curline'><a href='../S/801.html#L197'>packet</a>            197 ext/mysqlnd/mysqlnd_wireprotocol.c 		*packet++ = 252;</span>
<span class='curline'><a href='../S/801.html#L198'>packet</a>            198 ext/mysqlnd/mysqlnd_wireprotocol.c 		int2store(packet,(unsigned int) length);</span>
<span class='curline'><a href='../S/801.html#L199'>packet</a>            199 ext/mysqlnd/mysqlnd_wireprotocol.c 		return packet + 2;</span>
<span class='curline'><a href='../S/801.html#L203'>packet</a>            203 ext/mysqlnd/mysqlnd_wireprotocol.c 		*packet++ = 253;</span>
<span class='curline'><a href='../S/801.html#L204'>packet</a>            204 ext/mysqlnd/mysqlnd_wireprotocol.c 		int3store(packet,(zend_ulong) length);</span>
<span class='curline'><a href='../S/801.html#L205'>packet</a>            205 ext/mysqlnd/mysqlnd_wireprotocol.c 		return packet + 3;</span>
<span class='curline'><a href='../S/801.html#L207'>packet</a>            207 ext/mysqlnd/mysqlnd_wireprotocol.c 	*packet++ = 254;</span>
<span class='curline'><a href='../S/801.html#L208'>packet</a>            208 ext/mysqlnd/mysqlnd_wireprotocol.c 	int8store(packet, length);</span>
<span class='curline'><a href='../S/801.html#L209'>packet</a>            209 ext/mysqlnd/mysqlnd_wireprotocol.c 	return packet + 8;</span>
<span class='curline'><a href='../S/801.html#L327'>packet</a>            327 ext/mysqlnd/mysqlnd_wireprotocol.c 	MYSQLND_PACKET_GREET *packet= (MYSQLND_PACKET_GREET *) _packet;</span>
<span class='curline'><a href='../S/801.html#L331'>packet</a>            331 ext/mysqlnd/mysqlnd_wireprotocol.c 	PACKET_READ_HEADER_AND_BODY(packet, conn, buf, sizeof(buf), "greeting", PROT_GREET_PACKET);</span>
<span class='curline'><a href='../S/801.html#L334'>packet</a>            334 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;auth_plugin_data = packet-&gt;intern_auth_plugin_data;</span>
<span class='curline'><a href='../S/801.html#L335'>packet</a>            335 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;auth_plugin_data_len = sizeof(packet-&gt;intern_auth_plugin_data);</span>
<span class='curline'><a href='../S/801.html#L337'>packet</a>            337 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet-&gt;header.size &lt; sizeof(buf)) {</span>
<span class='curline'><a href='../S/801.html#L342'>packet</a>            342 ext/mysqlnd/mysqlnd_wireprotocol.c 		buf[packet-&gt;header.size] = '\0';</span>
<span class='curline'><a href='../S/801.html#L345'>packet</a>            345 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;protocol_version = uint1korr(p);</span>
<span class='curline'><a href='../S/801.html#L349'>packet</a>            349 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (ERROR_MARKER == packet-&gt;protocol_version) {</span>
<span class='curline'><a href='../S/801.html#L350'>packet</a>            350 ext/mysqlnd/mysqlnd_wireprotocol.c 		php_mysqlnd_read_error_from_line(p, packet-&gt;header.size - 1,</span>
<span class='curline'><a href='../S/801.html#L351'>packet</a>            351 ext/mysqlnd/mysqlnd_wireprotocol.c 										 packet-&gt;error, sizeof(packet-&gt;error),</span>
<span class='curline'><a href='../S/801.html#L352'>packet</a>            352 ext/mysqlnd/mysqlnd_wireprotocol.c 										 &amp;packet-&gt;error_no, packet-&gt;sqlstate</span>
<span class='curline'><a href='../S/801.html#L359'>packet</a>            359 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (packet-&gt;error_no == 1040) {</span>
<span class='curline'><a href='../S/801.html#L360'>packet</a>            360 ext/mysqlnd/mysqlnd_wireprotocol.c 			memcpy(packet-&gt;sqlstate, "08004", MYSQLND_SQLSTATE_LENGTH);</span>
<span class='curline'><a href='../S/801.html#L365'>packet</a>            365 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;server_version = estrdup((char *)p);</span>
<span class='curline'><a href='../S/801.html#L366'>packet</a>            366 ext/mysqlnd/mysqlnd_wireprotocol.c 	p+= strlen(packet-&gt;server_version) + 1; /* eat the '\0' */</span>
<span class='curline'><a href='../S/801.html#L369'>packet</a>            369 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;thread_id = uint4korr(p);</span>
<span class='curline'><a href='../S/801.html#L373'>packet</a>            373 ext/mysqlnd/mysqlnd_wireprotocol.c 	memcpy(packet-&gt;auth_plugin_data, p, SCRAMBLE_LENGTH_323);</span>
<span class='curline'><a href='../S/801.html#L381'>packet</a>            381 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;server_capabilities = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L385'>packet</a>            385 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;charset_no = uint1korr(p);</span>
<span class='curline'><a href='../S/801.html#L389'>packet</a>            389 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;server_status = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L398'>packet</a>            398 ext/mysqlnd/mysqlnd_wireprotocol.c 	if ((size_t) (p - buf) &lt; packet-&gt;header.size) {</span>
<span class='curline'><a href='../S/801.html#L400'>packet</a>            400 ext/mysqlnd/mysqlnd_wireprotocol.c 		memcpy(packet-&gt;auth_plugin_data + SCRAMBLE_LENGTH_323, p, SCRAMBLE_LENGTH - SCRAMBLE_LENGTH_323);</span>
<span class='curline'><a href='../S/801.html#L404'>packet</a>            404 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;pre41 = TRUE;</span>
<span class='curline'><a href='../S/801.html#L408'>packet</a>            408 ext/mysqlnd/mysqlnd_wireprotocol.c 	if ((size_t) (p - buf) &lt; packet-&gt;header.size) {</span>
<span class='curline'><a href='../S/801.html#L413'>packet</a>            413 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;server_capabilities |= uint2korr(pad_start) &lt;&lt; 16;</span>
<span class='curline'><a href='../S/801.html#L415'>packet</a>            415 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;auth_plugin_data_len = uint1korr(pad_start + 2);</span>
<span class='curline'><a href='../S/801.html#L416'>packet</a>            416 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (packet-&gt;auth_plugin_data_len &gt; SCRAMBLE_LENGTH) {</span>
<span class='curline'><a href='../S/801.html#L418'>packet</a>            418 ext/mysqlnd/mysqlnd_wireprotocol.c 			zend_uchar * new_auth_plugin_data = emalloc(packet-&gt;auth_plugin_data_len);</span>
<span class='curline'><a href='../S/801.html#L423'>packet</a>            423 ext/mysqlnd/mysqlnd_wireprotocol.c 			memcpy(new_auth_plugin_data, packet-&gt;auth_plugin_data, SCRAMBLE_LENGTH);</span>
<span class='curline'><a href='../S/801.html#L425'>packet</a>            425 ext/mysqlnd/mysqlnd_wireprotocol.c 			memcpy(new_auth_plugin_data + SCRAMBLE_LENGTH, p, packet-&gt;auth_plugin_data_len - SCRAMBLE_LENGTH);</span>
<span class='curline'><a href='../S/801.html#L426'>packet</a>            426 ext/mysqlnd/mysqlnd_wireprotocol.c 			p+= (packet-&gt;auth_plugin_data_len - SCRAMBLE_LENGTH);</span>
<span class='curline'><a href='../S/801.html#L427'>packet</a>            427 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;auth_plugin_data = new_auth_plugin_data;</span>
<span class='curline'><a href='../S/801.html#L431'>packet</a>            431 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet-&gt;server_capabilities &amp; CLIENT_PLUGIN_AUTH) {</span>
<span class='curline'><a href='../S/801.html#L434'>packet</a>            434 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;auth_protocol = estrdup((char *)p);</span>
<span class='curline'><a href='../S/801.html#L435'>packet</a>            435 ext/mysqlnd/mysqlnd_wireprotocol.c 		p+= strlen(packet-&gt;auth_protocol) + 1; /* eat the '\0' */</span>
<span class='curline'><a href='../S/801.html#L439'>packet</a>            439 ext/mysqlnd/mysqlnd_wireprotocol.c 				packet-&gt;protocol_version, packet-&gt;server_version, packet-&gt;thread_id);</span>
<span class='curline'><a href='../S/801.html#L442'>packet</a>            442 ext/mysqlnd/mysqlnd_wireprotocol.c 				packet-&gt;server_capabilities, packet-&gt;charset_no, packet-&gt;server_status,</span>
<span class='curline'><a href='../S/801.html#L443'>packet</a>            443 ext/mysqlnd/mysqlnd_wireprotocol.c 				packet-&gt;auth_protocol? packet-&gt;auth_protocol:"n/a", packet-&gt;auth_plugin_data_len);</span>
<span class='curline'><a href='../S/801.html#L447'>packet</a>            447 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_ERR_FMT("GREET packet %d bytes shorter than expected", p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L449'>packet</a>            449 ext/mysqlnd/mysqlnd_wireprotocol.c 					 p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L488'>packet</a>            488 ext/mysqlnd/mysqlnd_wireprotocol.c 	MYSQLND_PACKET_AUTH * packet= (MYSQLND_PACKET_AUTH *) _packet;</span>
<span class='curline'><a href='../S/801.html#L492'>packet</a>            492 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (!packet-&gt;is_change_user_packet) {</span>
<span class='curline'><a href='../S/801.html#L493'>packet</a>            493 ext/mysqlnd/mysqlnd_wireprotocol.c 		int4store(p, packet-&gt;client_flags);</span>
<span class='curline'><a href='../S/801.html#L496'>packet</a>            496 ext/mysqlnd/mysqlnd_wireprotocol.c 		int4store(p, packet-&gt;max_packet_size);</span>
<span class='curline'><a href='../S/801.html#L499'>packet</a>            499 ext/mysqlnd/mysqlnd_wireprotocol.c 		int1store(p, packet-&gt;charset_no);</span>
<span class='curline'><a href='../S/801.html#L506'>packet</a>            506 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet-&gt;send_auth_data || packet-&gt;is_change_user_packet) {</span>
<span class='curline'><a href='../S/801.html#L507'>packet</a>            507 ext/mysqlnd/mysqlnd_wireprotocol.c 		len = MIN(strlen(packet-&gt;user), MYSQLND_MAX_ALLOWED_USER_LEN);</span>
<span class='curline'><a href='../S/801.html#L508'>packet</a>            508 ext/mysqlnd/mysqlnd_wireprotocol.c 		memcpy(p, packet-&gt;user, len);</span>
<span class='curline'><a href='../S/801.html#L513'>packet</a>            513 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (packet-&gt;auth_data == NULL) {</span>
<span class='curline'><a href='../S/801.html#L514'>packet</a>            514 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;auth_data_len = 0;</span>
<span class='curline'><a href='../S/801.html#L516'>packet</a>            516 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (packet-&gt;auth_data_len &gt; 0xFF) {</span>
<span class='curline'><a href='../S/801.html#L524'>packet</a>            524 ext/mysqlnd/mysqlnd_wireprotocol.c 		int1store(p, packet-&gt;auth_data_len);</span>
<span class='curline'><a href='../S/801.html#L527'>packet</a>            527 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (sizeof(buffer) &lt; (packet-&gt;auth_data_len + (p - buffer))) {</span>
<span class='curline'><a href='../S/801.html#L531'>packet</a>            531 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (packet-&gt;auth_data_len) {</span>
<span class='curline'><a href='../S/801.html#L532'>packet</a>            532 ext/mysqlnd/mysqlnd_wireprotocol.c 			memcpy(p, packet-&gt;auth_data, packet-&gt;auth_data_len);</span>
<span class='curline'><a href='../S/801.html#L533'>packet</a>            533 ext/mysqlnd/mysqlnd_wireprotocol.c 			p+= packet-&gt;auth_data_len;</span>
<span class='curline'><a href='../S/801.html#L536'>packet</a>            536 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (packet-&gt;db) {</span>
<span class='curline'><a href='../S/801.html#L538'>packet</a>            538 ext/mysqlnd/mysqlnd_wireprotocol.c 			size_t real_db_len = MIN(MYSQLND_MAX_ALLOWED_DB_LEN, packet-&gt;db_len);</span>
<span class='curline'><a href='../S/801.html#L539'>packet</a>            539 ext/mysqlnd/mysqlnd_wireprotocol.c 			memcpy(p, packet-&gt;db, real_db_len);</span>
<span class='curline'><a href='../S/801.html#L542'>packet</a>            542 ext/mysqlnd/mysqlnd_wireprotocol.c 		} else if (packet-&gt;is_change_user_packet) {</span>
<span class='curline'><a href='../S/801.html#L547'>packet</a>            547 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (packet-&gt;is_change_user_packet) {</span>
<span class='curline'><a href='../S/801.html#L548'>packet</a>            548 ext/mysqlnd/mysqlnd_wireprotocol.c 			if (packet-&gt;charset_no) {</span>
<span class='curline'><a href='../S/801.html#L549'>packet</a>            549 ext/mysqlnd/mysqlnd_wireprotocol.c 				int2store(p, packet-&gt;charset_no);</span>
<span class='curline'><a href='../S/801.html#L554'>packet</a>            554 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (packet-&gt;auth_plugin_name) {</span>
<span class='curline'><a href='../S/801.html#L555'>packet</a>            555 ext/mysqlnd/mysqlnd_wireprotocol.c 			size_t len = MIN(strlen(packet-&gt;auth_plugin_name), sizeof(buffer) - (p - buffer) - 1);</span>
<span class='curline'><a href='../S/801.html#L556'>packet</a>            556 ext/mysqlnd/mysqlnd_wireprotocol.c 			memcpy(p, packet-&gt;auth_plugin_name, len);</span>
<span class='curline'><a href='../S/801.html#L561'>packet</a>            561 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (packet-&gt;connect_attr &amp;&amp; zend_hash_num_elements(packet-&gt;connect_attr)) {</span>
<span class='curline'><a href='../S/801.html#L566'>packet</a>            566 ext/mysqlnd/mysqlnd_wireprotocol.c 			zend_hash_internal_pointer_reset_ex(packet-&gt;connect_attr, &amp;pos_value);</span>
<span class='curline'><a href='../S/801.html#L567'>packet</a>            567 ext/mysqlnd/mysqlnd_wireprotocol.c 			while (SUCCESS == zend_hash_get_current_data_ex(packet-&gt;connect_attr, (void **)&amp;entry_value, &amp;pos_value)) {</span>
<span class='curline'><a href='../S/801.html#L573'>packet</a>            573 ext/mysqlnd/mysqlnd_wireprotocol.c 				if (HASH_KEY_IS_STRING == zend_hash_get_current_key_ex(packet-&gt;connect_attr, &amp;s_key, &amp;s_len, &amp;num_key, &amp;pos_value)) {</span>
<span class='curline'><a href='../S/801.html#L586'>packet</a>            586 ext/mysqlnd/mysqlnd_wireprotocol.c 				ZEND_HASH_FOREACH_STR_KEY_VAL(packet-&gt;connect_attr, key, entry_value) {</span>
<span class='curline'><a href='../S/801.html#L602'>packet</a>            602 ext/mysqlnd/mysqlnd_wireprotocol.c 				zend_hash_internal_pointer_reset_ex(packet-&gt;connect_attr, &amp;pos_value);</span>
<span class='curline'><a href='../S/801.html#L603'>packet</a>            603 ext/mysqlnd/mysqlnd_wireprotocol.c 				while (SUCCESS == zend_hash_get_current_data_ex(packet-&gt;connect_attr, (void **)&amp;entry_value, &amp;pos_value)) {</span>
<span class='curline'><a href='../S/801.html#L608'>packet</a>            608 ext/mysqlnd/mysqlnd_wireprotocol.c 					if (HASH_KEY_IS_STRING == zend_hash_get_current_key_ex(packet-&gt;connect_attr, &amp;s_key, &amp;s_len, &amp;num_key, &amp;pos_value)) {</span>
<span class='curline'><a href='../S/801.html#L624'>packet</a>            624 ext/mysqlnd/mysqlnd_wireprotocol.c 					ZEND_HASH_FOREACH_STR_KEY_VAL(packet-&gt;connect_attr, key, entry_value) {</span>
<span class='curline'><a href='../S/801.html#L645'>packet</a>            645 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet-&gt;is_change_user_packet) {</span>
<span class='curline'><a href='../S/801.html#L648'>packet</a>            648 ext/mysqlnd/mysqlnd_wireprotocol.c 										   packet-&gt;silent, TRUE)) {</span>
<span class='curline'><a href='../S/801.html#L687'>packet</a>            687 ext/mysqlnd/mysqlnd_wireprotocol.c 	register MYSQLND_PACKET_AUTH_RESPONSE * packet= (MYSQLND_PACKET_AUTH_RESPONSE *) _packet;</span>
<span class='curline'><a href='../S/801.html#L693'>packet</a>            693 ext/mysqlnd/mysqlnd_wireprotocol.c 	PACKET_READ_HEADER_AND_BODY(packet, conn, buf, buf_len, "OK", PROT_OK_PACKET);</span>
<span class='curline'><a href='../S/801.html#L700'>packet</a>            700 ext/mysqlnd/mysqlnd_wireprotocol.c 	buf[packet-&gt;header.size] = '\0';</span>
<span class='curline'><a href='../S/801.html#L703'>packet</a>            703 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;response_code = uint1korr(p);</span>
<span class='curline'><a href='../S/801.html#L707'>packet</a>            707 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (ERROR_MARKER == packet-&gt;response_code) {</span>
<span class='curline'><a href='../S/801.html#L708'>packet</a>            708 ext/mysqlnd/mysqlnd_wireprotocol.c 		php_mysqlnd_read_error_from_line(p, packet-&gt;header.size - 1,</span>
<span class='curline'><a href='../S/801.html#L709'>packet</a>            709 ext/mysqlnd/mysqlnd_wireprotocol.c 										 packet-&gt;error, sizeof(packet-&gt;error),</span>
<span class='curline'><a href='../S/801.html#L710'>packet</a>            710 ext/mysqlnd/mysqlnd_wireprotocol.c 										 &amp;packet-&gt;error_no, packet-&gt;sqlstate</span>
<span class='curline'><a href='../S/801.html#L714'>packet</a>            714 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (0xFE == packet-&gt;response_code) {</span>
<span class='curline'><a href='../S/801.html#L716'>packet</a>            716 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (packet-&gt;header.size &gt; (size_t) (p - buf)) {</span>
<span class='curline'><a href='../S/801.html#L717'>packet</a>            717 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;new_auth_protocol = mnd_pestrdup((char *)p, FALSE);</span>
<span class='curline'><a href='../S/801.html#L718'>packet</a>            718 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;new_auth_protocol_len = strlen(packet-&gt;new_auth_protocol);</span>
<span class='curline'><a href='../S/801.html#L719'>packet</a>            719 ext/mysqlnd/mysqlnd_wireprotocol.c 			p+= packet-&gt;new_auth_protocol_len + 1; /* +1 for the \0 */</span>
<span class='curline'><a href='../S/801.html#L721'>packet</a>            721 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;new_auth_protocol_data_len = packet-&gt;header.size - (size_t) (p - buf);</span>
<span class='curline'><a href='../S/801.html#L722'>packet</a>            722 ext/mysqlnd/mysqlnd_wireprotocol.c 			if (packet-&gt;new_auth_protocol_data_len) {</span>
<span class='curline'><a href='../S/801.html#L723'>packet</a>            723 ext/mysqlnd/mysqlnd_wireprotocol.c 				packet-&gt;new_auth_protocol_data = mnd_emalloc(packet-&gt;new_auth_protocol_data_len);</span>
<span class='curline'><a href='../S/801.html#L724'>packet</a>            724 ext/mysqlnd/mysqlnd_wireprotocol.c 				memcpy(packet-&gt;new_auth_protocol_data, p, packet-&gt;new_auth_protocol_data_len);</span>
<span class='curline'><a href='../S/801.html#L726'>packet</a>            726 ext/mysqlnd/mysqlnd_wireprotocol.c 			DBG_INF_FMT("The server requested switching auth plugin to : %s", packet-&gt;new_auth_protocol);</span>
<span class='curline'><a href='../S/801.html#L727'>packet</a>            727 ext/mysqlnd/mysqlnd_wireprotocol.c 			DBG_INF_FMT("Server salt : [%d][%.*s]", packet-&gt;new_auth_protocol_data_len, packet-&gt;new_auth_protocol_data_len, packet-&gt;new_auth_protocol_data);</span>
<span class='curline'><a href='../S/801.html#L731'>packet</a>            731 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;affected_rows  = php_mysqlnd_net_field_length_ll(&amp;p);</span>
<span class='curline'><a href='../S/801.html#L734'>packet</a>            734 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;last_insert_id = php_mysqlnd_net_field_length_ll(&amp;p);</span>
<span class='curline'><a href='../S/801.html#L737'>packet</a>            737 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;server_status = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L741'>packet</a>            741 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;warning_count = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L746'>packet</a>            746 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (packet-&gt;header.size &gt; (size_t) (p - buf) &amp;&amp; (i = php_mysqlnd_net_field_length(&amp;p))) {</span>
<span class='curline'><a href='../S/801.html#L747'>packet</a>            747 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;message_len = MIN(i, buf_len - (p - begin));</span>
<span class='curline'><a href='../S/801.html#L748'>packet</a>            748 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;message = mnd_pestrndup((char *)p, packet-&gt;message_len, FALSE);</span>
<span class='curline'><a href='../S/801.html#L750'>packet</a>            750 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;message = NULL;</span>
<span class='curline'><a href='../S/801.html#L751'>packet</a>            751 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;message_len = 0;</span>
<span class='curline'><a href='../S/801.html#L755'>packet</a>            755 ext/mysqlnd/mysqlnd_wireprotocol.c 					packet-&gt;affected_rows, packet-&gt;last_insert_id, packet-&gt;server_status,</span>
<span class='curline'><a href='../S/801.html#L756'>packet</a>            756 ext/mysqlnd/mysqlnd_wireprotocol.c 					packet-&gt;warning_count);</span>
<span class='curline'><a href='../S/801.html#L761'>packet</a>            761 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_ERR_FMT("OK packet %d bytes shorter than expected", p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L763'>packet</a>            763 ext/mysqlnd/mysqlnd_wireprotocol.c 					 p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L801'>packet</a>            801 ext/mysqlnd/mysqlnd_wireprotocol.c 	MYSQLND_PACKET_CHANGE_AUTH_RESPONSE *packet= (MYSQLND_PACKET_CHANGE_AUTH_RESPONSE *) _packet;</span>
<span class='curline'><a href='../S/801.html#L802'>packet</a>            802 ext/mysqlnd/mysqlnd_wireprotocol.c 	zend_uchar * buffer = conn-&gt;net-&gt;cmd_buffer.length &gt;= packet-&gt;auth_data_len? conn-&gt;net-&gt;cmd_buffer.buffer : mnd_emalloc(packet-&gt;auth_data_len);</span>
<span class='curline'><a href='../S/801.html#L807'>packet</a>            807 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet-&gt;auth_data_len) {</span>
<span class='curline'><a href='../S/801.html#L808'>packet</a>            808 ext/mysqlnd/mysqlnd_wireprotocol.c 		memcpy(p, packet-&gt;auth_data, packet-&gt;auth_data_len);</span>
<span class='curline'><a href='../S/801.html#L809'>packet</a>            809 ext/mysqlnd/mysqlnd_wireprotocol.c 		p+= packet-&gt;auth_data_len;</span>
<span class='curline'><a href='../S/801.html#L850'>packet</a>            850 ext/mysqlnd/mysqlnd_wireprotocol.c 	register MYSQLND_PACKET_OK *packet= (MYSQLND_PACKET_OK *) _packet;</span>
<span class='curline'><a href='../S/801.html#L854'>packet</a>            854 ext/mysqlnd/mysqlnd_wireprotocol.c 	PACKET_READ_HEADER_AND_BODY(packet, conn, buf, buf_len, "OK", PROT_OK_PACKET);</span>
<span class='curline'><a href='../S/801.html#L858'>packet</a>            858 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;field_count = uint1korr(p);</span>
<span class='curline'><a href='../S/801.html#L862'>packet</a>            862 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (ERROR_MARKER == packet-&gt;field_count) {</span>
<span class='curline'><a href='../S/801.html#L863'>packet</a>            863 ext/mysqlnd/mysqlnd_wireprotocol.c 		php_mysqlnd_read_error_from_line(p, packet-&gt;header.size - 1,</span>
<span class='curline'><a href='../S/801.html#L864'>packet</a>            864 ext/mysqlnd/mysqlnd_wireprotocol.c 										 packet-&gt;error, sizeof(packet-&gt;error),</span>
<span class='curline'><a href='../S/801.html#L865'>packet</a>            865 ext/mysqlnd/mysqlnd_wireprotocol.c 										 &amp;packet-&gt;error_no, packet-&gt;sqlstate</span>
<span class='curline'><a href='../S/801.html#L871'>packet</a>            871 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;affected_rows  = php_mysqlnd_net_field_length_ll(&amp;p);</span>
<span class='curline'><a href='../S/801.html#L874'>packet</a>            874 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;last_insert_id = php_mysqlnd_net_field_length_ll(&amp;p);</span>
<span class='curline'><a href='../S/801.html#L877'>packet</a>            877 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;server_status = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L881'>packet</a>            881 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;warning_count = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L886'>packet</a>            886 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet-&gt;header.size &gt; (size_t) (p - buf) &amp;&amp; (i = php_mysqlnd_net_field_length(&amp;p))) {</span>
<span class='curline'><a href='../S/801.html#L887'>packet</a>            887 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;message_len = MIN(i, buf_len - (p - begin));</span>
<span class='curline'><a href='../S/801.html#L888'>packet</a>            888 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;message = mnd_pestrndup((char *)p, packet-&gt;message_len, FALSE);</span>
<span class='curline'><a href='../S/801.html#L890'>packet</a>            890 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;message = NULL;</span>
<span class='curline'><a href='../S/801.html#L891'>packet</a>            891 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;message_len = 0;</span>
<span class='curline'><a href='../S/801.html#L895'>packet</a>            895 ext/mysqlnd/mysqlnd_wireprotocol.c 				packet-&gt;affected_rows, packet-&gt;last_insert_id, packet-&gt;server_status,</span>
<span class='curline'><a href='../S/801.html#L896'>packet</a>            896 ext/mysqlnd/mysqlnd_wireprotocol.c 				packet-&gt;warning_count);</span>
<span class='curline'><a href='../S/801.html#L902'>packet</a>            902 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_ERR_FMT("OK packet %d bytes shorter than expected", p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L904'>packet</a>            904 ext/mysqlnd/mysqlnd_wireprotocol.c 					 p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L936'>packet</a>            936 ext/mysqlnd/mysqlnd_wireprotocol.c 	MYSQLND_PACKET_EOF *packet= (MYSQLND_PACKET_EOF *) _packet;</span>
<span class='curline'><a href='../S/801.html#L944'>packet</a>            944 ext/mysqlnd/mysqlnd_wireprotocol.c 	PACKET_READ_HEADER_AND_BODY(packet, conn, buf, buf_len, "EOF", PROT_EOF_PACKET);</span>
<span class='curline'><a href='../S/801.html#L948'>packet</a>            948 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;field_count = uint1korr(p);</span>
<span class='curline'><a href='../S/801.html#L952'>packet</a>            952 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (ERROR_MARKER == packet-&gt;field_count) {</span>
<span class='curline'><a href='../S/801.html#L953'>packet</a>            953 ext/mysqlnd/mysqlnd_wireprotocol.c 		php_mysqlnd_read_error_from_line(p, packet-&gt;header.size - 1,</span>
<span class='curline'><a href='../S/801.html#L954'>packet</a>            954 ext/mysqlnd/mysqlnd_wireprotocol.c 										 packet-&gt;error, sizeof(packet-&gt;error),</span>
<span class='curline'><a href='../S/801.html#L955'>packet</a>            955 ext/mysqlnd/mysqlnd_wireprotocol.c 										 &amp;packet-&gt;error_no, packet-&gt;sqlstate</span>
<span class='curline'><a href='../S/801.html#L965'>packet</a>            965 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet-&gt;header.size &gt; 1) {</span>
<span class='curline'><a href='../S/801.html#L966'>packet</a>            966 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;warning_count = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L970'>packet</a>            970 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;server_status = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L974'>packet</a>            974 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;warning_count = 0;</span>
<span class='curline'><a href='../S/801.html#L975'>packet</a>            975 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;server_status = 0;</span>
<span class='curline'><a href='../S/801.html#L981'>packet</a>            981 ext/mysqlnd/mysqlnd_wireprotocol.c 				packet-&gt;field_count, packet-&gt;server_status, packet-&gt;warning_count);</span>
<span class='curline'><a href='../S/801.html#L985'>packet</a>            985 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_ERR_FMT("EOF packet %d bytes shorter than expected", p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L987'>packet</a>            987 ext/mysqlnd/mysqlnd_wireprotocol.c 					 p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L1008'>packet</a>           1008 ext/mysqlnd/mysqlnd_wireprotocol.c 	MYSQLND_PACKET_COMMAND * packet= (MYSQLND_PACKET_COMMAND *) _packet;</span>
<span class='curline'><a href='../S/801.html#L1028'>packet</a>           1028 ext/mysqlnd/mysqlnd_wireprotocol.c 	net-&gt;data-&gt;m.consume_uneaten_data(net, packet-&gt;command);</span>
<span class='curline'><a href='../S/801.html#L1031'>packet</a>           1031 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (!packet-&gt;argument || !packet-&gt;arg_len) {</span>
<span class='curline'><a href='../S/801.html#L1034'>packet</a>           1034 ext/mysqlnd/mysqlnd_wireprotocol.c 		int1store(buffer + MYSQLND_HEADER_SIZE, packet-&gt;command);</span>
<span class='curline'><a href='../S/801.html#L1037'>packet</a>           1037 ext/mysqlnd/mysqlnd_wireprotocol.c 		size_t tmp_len = packet-&gt;arg_len + 1 + MYSQLND_HEADER_SIZE;</span>
<span class='curline'><a href='../S/801.html#L1045'>packet</a>           1045 ext/mysqlnd/mysqlnd_wireprotocol.c 		int1store(p, packet-&gt;command);</span>
<span class='curline'><a href='../S/801.html#L1048'>packet</a>           1048 ext/mysqlnd/mysqlnd_wireprotocol.c 		memcpy(p, packet-&gt;argument, packet-&gt;arg_len);</span>
<span class='curline'><a href='../S/801.html#L1091'>packet</a>           1091 ext/mysqlnd/mysqlnd_wireprotocol.c 	MYSQLND_PACKET_RSET_HEADER *packet= (MYSQLND_PACKET_RSET_HEADER *) _packet;</span>
<span class='curline'><a href='../S/801.html#L1095'>packet</a>           1095 ext/mysqlnd/mysqlnd_wireprotocol.c 	PACKET_READ_HEADER_AND_BODY(packet, conn, buf, buf_len, "resultset header", PROT_RSET_HEADER_PACKET);</span>
<span class='curline'><a href='../S/801.html#L1106'>packet</a>           1106 ext/mysqlnd/mysqlnd_wireprotocol.c 		php_mysqlnd_read_error_from_line(p, packet-&gt;header.size - 1,</span>
<span class='curline'><a href='../S/801.html#L1107'>packet</a>           1107 ext/mysqlnd/mysqlnd_wireprotocol.c 										 packet-&gt;error_info.error, sizeof(packet-&gt;error_info.error),</span>
<span class='curline'><a href='../S/801.html#L1108'>packet</a>           1108 ext/mysqlnd/mysqlnd_wireprotocol.c 										 &amp;packet-&gt;error_info.error_no, packet-&gt;error_info.sqlstate</span>
<span class='curline'><a href='../S/801.html#L1114'>packet</a>           1114 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;field_count = php_mysqlnd_net_field_length(&amp;p);</span>
<span class='curline'><a href='../S/801.html#L1117'>packet</a>           1117 ext/mysqlnd/mysqlnd_wireprotocol.c 	switch (packet-&gt;field_count) {</span>
<span class='curline'><a href='../S/801.html#L1127'>packet</a>           1127 ext/mysqlnd/mysqlnd_wireprotocol.c 			len = packet-&gt;header.size - 1;</span>
<span class='curline'><a href='../S/801.html#L1128'>packet</a>           1128 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;info_or_local_file = mnd_emalloc(len + 1);</span>
<span class='curline'><a href='../S/801.html#L1129'>packet</a>           1129 ext/mysqlnd/mysqlnd_wireprotocol.c 			if (packet-&gt;info_or_local_file) {</span>
<span class='curline'><a href='../S/801.html#L1130'>packet</a>           1130 ext/mysqlnd/mysqlnd_wireprotocol.c 				memcpy(packet-&gt;info_or_local_file, p, len);</span>
<span class='curline'><a href='../S/801.html#L1131'>packet</a>           1131 ext/mysqlnd/mysqlnd_wireprotocol.c 				packet-&gt;info_or_local_file[len] = '\0';</span>
<span class='curline'><a href='../S/801.html#L1132'>packet</a>           1132 ext/mysqlnd/mysqlnd_wireprotocol.c 				packet-&gt;info_or_local_file_len = len;</span>
<span class='curline'><a href='../S/801.html#L1140'>packet</a>           1140 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;affected_rows = php_mysqlnd_net_field_length_ll(&amp;p);</span>
<span class='curline'><a href='../S/801.html#L1143'>packet</a>           1143 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;last_insert_id = php_mysqlnd_net_field_length_ll(&amp;p);</span>
<span class='curline'><a href='../S/801.html#L1146'>packet</a>           1146 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;server_status = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L1150'>packet</a>           1150 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;warning_count = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L1154'>packet</a>           1154 ext/mysqlnd/mysqlnd_wireprotocol.c 			if (packet-&gt;header.size  &gt; (size_t) (p - buf) &amp;&amp; (len = php_mysqlnd_net_field_length(&amp;p))) {</span>
<span class='curline'><a href='../S/801.html#L1155'>packet</a>           1155 ext/mysqlnd/mysqlnd_wireprotocol.c 				packet-&gt;info_or_local_file = mnd_emalloc(len + 1);</span>
<span class='curline'><a href='../S/801.html#L1156'>packet</a>           1156 ext/mysqlnd/mysqlnd_wireprotocol.c 				if (packet-&gt;info_or_local_file) {</span>
<span class='curline'><a href='../S/801.html#L1157'>packet</a>           1157 ext/mysqlnd/mysqlnd_wireprotocol.c 					memcpy(packet-&gt;info_or_local_file, p, len);</span>
<span class='curline'><a href='../S/801.html#L1158'>packet</a>           1158 ext/mysqlnd/mysqlnd_wireprotocol.c 					packet-&gt;info_or_local_file[len] = '\0';</span>
<span class='curline'><a href='../S/801.html#L1159'>packet</a>           1159 ext/mysqlnd/mysqlnd_wireprotocol.c 					packet-&gt;info_or_local_file_len = len;</span>
<span class='curline'><a href='../S/801.html#L1166'>packet</a>           1166 ext/mysqlnd/mysqlnd_wireprotocol.c 						packet-&gt;affected_rows, packet-&gt;last_insert_id,</span>
<span class='curline'><a href='../S/801.html#L1167'>packet</a>           1167 ext/mysqlnd/mysqlnd_wireprotocol.c 						packet-&gt;server_status, packet-&gt;warning_count);</span>
<span class='curline'><a href='../S/801.html#L1178'>packet</a>           1178 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_ERR_FMT("RSET_HEADER packet %d bytes shorter than expected", p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L1180'>packet</a>           1180 ext/mysqlnd/mysqlnd_wireprotocol.c 					 p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L1225'>packet</a>           1225 ext/mysqlnd/mysqlnd_wireprotocol.c 	MYSQLND_PACKET_RES_FIELD *packet = (MYSQLND_PACKET_RES_FIELD *) _packet;</span>
<span class='curline'><a href='../S/801.html#L1237'>packet</a>           1237 ext/mysqlnd/mysqlnd_wireprotocol.c 	PACKET_READ_HEADER_AND_BODY(packet, conn, buf, buf_len, "field", PROT_RSET_FLD_PACKET);</span>
<span class='curline'><a href='../S/801.html#L1239'>packet</a>           1239 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet-&gt;skip_parsing) {</span>
<span class='curline'><a href='../S/801.html#L1248'>packet</a>           1248 ext/mysqlnd/mysqlnd_wireprotocol.c 		php_mysqlnd_read_error_from_line(p, packet-&gt;header.size - 1,</span>
<span class='curline'><a href='../S/801.html#L1249'>packet</a>           1249 ext/mysqlnd/mysqlnd_wireprotocol.c 										 packet-&gt;error_info.error, sizeof(packet-&gt;error_info.error),</span>
<span class='curline'><a href='../S/801.html#L1250'>packet</a>           1250 ext/mysqlnd/mysqlnd_wireprotocol.c 										 &amp;packet-&gt;error_info.error_no, packet-&gt;error_info.sqlstate</span>
<span class='curline'><a href='../S/801.html#L1252'>packet</a>           1252 ext/mysqlnd/mysqlnd_wireprotocol.c 		DBG_ERR_FMT("Server error : (%u) %s", packet-&gt;error_info.error_no, packet-&gt;error_info.error);</span>
<span class='curline'><a href='../S/801.html#L1254'>packet</a>           1254 ext/mysqlnd/mysqlnd_wireprotocol.c 	} else if (EODATA_MARKER == *p &amp;&amp; packet-&gt;header.size &lt; 8) {</span>
<span class='curline'><a href='../S/801.html#L1257'>packet</a>           1257 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;stupid_list_fields_eof = TRUE;</span>
<span class='curline'><a href='../S/801.html#L1261'>packet</a>           1261 ext/mysqlnd/mysqlnd_wireprotocol.c 	meta = packet-&gt;metadata;</span>
<span class='curline'><a href='../S/801.html#L1331'>packet</a>           1331 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet-&gt;header.size &gt; (size_t) (p - buf) &amp;&amp;</span>
<span class='curline'><a href='../S/801.html#L1336'>packet</a>           1336 ext/mysqlnd/mysqlnd_wireprotocol.c 		DBG_INF_FMT("Def found, length %lu, persistent=%u", len, packet-&gt;persistent_alloc);</span>
<span class='curline'><a href='../S/801.html#L1337'>packet</a>           1337 ext/mysqlnd/mysqlnd_wireprotocol.c 		meta-&gt;def = mnd_pemalloc(len + 1, packet-&gt;persistent_alloc);</span>
<span class='curline'><a href='../S/801.html#L1348'>packet</a>           1348 ext/mysqlnd/mysqlnd_wireprotocol.c 	root_ptr = meta-&gt;root = mnd_pemalloc(total_len, packet-&gt;persistent_alloc);</span>
<span class='curline'><a href='../S/801.html#L1357'>packet</a>           1357 ext/mysqlnd/mysqlnd_wireprotocol.c 		meta-&gt;sname = zend_string_init(meta-&gt;name, meta-&gt;name_length, packet-&gt;persistent_alloc);</span>
<span class='curline'><a href='../S/801.html#L1400'>packet</a>           1400 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_INF_FMT("allocing root. persistent=%u", packet-&gt;persistent_alloc);</span>
<span class='curline'><a href='../S/801.html#L1413'>packet</a>           1413 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_ERR_FMT("RSET field packet %d bytes shorter than expected", p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L1415'>packet</a>           1415 ext/mysqlnd/mysqlnd_wireprotocol.c 			 		"shorter than expected", p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L1792'>packet</a>           1792 ext/mysqlnd/mysqlnd_wireprotocol.c 	MYSQLND_PACKET_ROW *packet= (MYSQLND_PACKET_ROW *) _packet;</span>
<span class='curline'><a href='../S/801.html#L1798'>packet</a>           1798 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (!packet-&gt;binary_protocol &amp;&amp; packet-&gt;bit_fields_count) {</span>
<span class='curline'><a href='../S/801.html#L1800'>packet</a>           1800 ext/mysqlnd/mysqlnd_wireprotocol.c 		post_alloc_for_bit_fields = packet-&gt;bit_fields_total_len + packet-&gt;bit_fields_count;</span>
<span class='curline'><a href='../S/801.html#L1803'>packet</a>           1803 ext/mysqlnd/mysqlnd_wireprotocol.c 	ret = php_mysqlnd_read_row_ex(conn, packet-&gt;result_set_memory_pool, &amp;packet-&gt;row_buffer, &amp;data_size,</span>
<span class='curline'><a href='../S/801.html#L1804'>packet</a>           1804 ext/mysqlnd/mysqlnd_wireprotocol.c 								  packet-&gt;persistent_alloc, post_alloc_for_bit_fields</span>
<span class='curline'><a href='../S/801.html#L1810'>packet</a>           1810 ext/mysqlnd/mysqlnd_wireprotocol.c 										MYSQLND_HEADER_SIZE + packet-&gt;header.size,</span>
<span class='curline'><a href='../S/801.html#L1815'>packet</a>           1815 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;header.size = data_size;</span>
<span class='curline'><a href='../S/801.html#L1816'>packet</a>           1816 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;row_buffer-&gt;app = data_size;</span>
<span class='curline'><a href='../S/801.html#L1818'>packet</a>           1818 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (ERROR_MARKER == (*(p = packet-&gt;row_buffer-&gt;ptr))) {</span>
<span class='curline'><a href='../S/801.html#L1826'>packet</a>           1826 ext/mysqlnd/mysqlnd_wireprotocol.c 										 packet-&gt;error_info.error,</span>
<span class='curline'><a href='../S/801.html#L1827'>packet</a>           1827 ext/mysqlnd/mysqlnd_wireprotocol.c 										 sizeof(packet-&gt;error_info.error),</span>
<span class='curline'><a href='../S/801.html#L1828'>packet</a>           1828 ext/mysqlnd/mysqlnd_wireprotocol.c 										 &amp;packet-&gt;error_info.error_no,</span>
<span class='curline'><a href='../S/801.html#L1829'>packet</a>           1829 ext/mysqlnd/mysqlnd_wireprotocol.c 										 packet-&gt;error_info.sqlstate</span>
<span class='curline'><a href='../S/801.html#L1832'>packet</a>           1832 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;eof = TRUE;</span>
<span class='curline'><a href='../S/801.html#L1835'>packet</a>           1835 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;warning_count = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L1837'>packet</a>           1837 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;server_status = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L1839'>packet</a>           1839 ext/mysqlnd/mysqlnd_wireprotocol.c 			DBG_INF_FMT("server_status=%u warning_count=%u", packet-&gt;server_status, packet-&gt;warning_count);</span>
<span class='curline'><a href='../S/801.html#L1843'>packet</a>           1843 ext/mysqlnd/mysqlnd_wireprotocol.c 									packet-&gt;binary_protocol? STAT_ROWS_FETCHED_FROM_SERVER_PS:</span>
<span class='curline'><a href='../S/801.html#L1846'>packet</a>           1846 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;eof = FALSE;</span>
<span class='curline'><a href='../S/801.html#L1849'>packet</a>           1849 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (!packet-&gt;skip_extraction) {</span>
<span class='curline'><a href='../S/801.html#L1850'>packet</a>           1850 ext/mysqlnd/mysqlnd_wireprotocol.c 			if (!packet-&gt;fields) {</span>
<span class='curline'><a href='../S/801.html#L1862'>packet</a>           1862 ext/mysqlnd/mysqlnd_wireprotocol.c 				packet-&gt;fields = mnd_pecalloc(packet-&gt;field_count, sizeof(zval),</span>
<span class='curline'><a href='../S/801.html#L1863'>packet</a>           1863 ext/mysqlnd/mysqlnd_wireprotocol.c 														packet-&gt;persistent_alloc);</span>
<span class='curline'><a href='../S/801.html#L1867'>packet</a>           1867 ext/mysqlnd/mysqlnd_wireprotocol.c 										packet-&gt;binary_protocol? STAT_ROWS_SKIPPED_PS:</span>
<span class='curline'><a href='../S/801.html#L1910'>packet</a>           1910 ext/mysqlnd/mysqlnd_wireprotocol.c 	MYSQLND_PACKET_STATS *packet= (MYSQLND_PACKET_STATS *) _packet;</span>
<span class='curline'><a href='../S/801.html#L1916'>packet</a>           1916 ext/mysqlnd/mysqlnd_wireprotocol.c 	PACKET_READ_HEADER_AND_BODY(packet, conn, buf, buf_len, "statistics", PROT_STATS_PACKET);</span>
<span class='curline'><a href='../S/801.html#L1918'>packet</a>           1918 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;message = mnd_emalloc(packet-&gt;header.size + 1);</span>
<span class='curline'><a href='../S/801.html#L1919'>packet</a>           1919 ext/mysqlnd/mysqlnd_wireprotocol.c 	memcpy(packet-&gt;message, buf, packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L1920'>packet</a>           1920 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;message[packet-&gt;header.size] = '\0';</span>
<span class='curline'><a href='../S/801.html#L1921'>packet</a>           1921 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;message_len = packet-&gt;header.size;</span>
<span class='curline'><a href='../S/801.html#L1958'>packet</a>           1958 ext/mysqlnd/mysqlnd_wireprotocol.c 	MYSQLND_PACKET_PREPARE_RESPONSE *packet= (MYSQLND_PACKET_PREPARE_RESPONSE *) _packet;</span>
<span class='curline'><a href='../S/801.html#L1962'>packet</a>           1962 ext/mysqlnd/mysqlnd_wireprotocol.c 	PACKET_READ_HEADER_AND_BODY(packet, conn, buf, buf_len, "prepare", PROT_PREPARE_RESP_PACKET);</span>
<span class='curline'><a href='../S/801.html#L1965'>packet</a>           1965 ext/mysqlnd/mysqlnd_wireprotocol.c 	data_size = packet-&gt;header.size;</span>
<span class='curline'><a href='../S/801.html#L1966'>packet</a>           1966 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;error_code = uint1korr(p);</span>
<span class='curline'><a href='../S/801.html#L1970'>packet</a>           1970 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (ERROR_MARKER == packet-&gt;error_code) {</span>
<span class='curline'><a href='../S/801.html#L1972'>packet</a>           1972 ext/mysqlnd/mysqlnd_wireprotocol.c 										 packet-&gt;error_info.error,</span>
<span class='curline'><a href='../S/801.html#L1973'>packet</a>           1973 ext/mysqlnd/mysqlnd_wireprotocol.c 										 sizeof(packet-&gt;error_info.error),</span>
<span class='curline'><a href='../S/801.html#L1974'>packet</a>           1974 ext/mysqlnd/mysqlnd_wireprotocol.c 										 &amp;packet-&gt;error_info.error_no,</span>
<span class='curline'><a href='../S/801.html#L1975'>packet</a>           1975 ext/mysqlnd/mysqlnd_wireprotocol.c 										 packet-&gt;error_info.sqlstate</span>
<span class='curline'><a href='../S/801.html#L1988'>packet</a>           1988 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;stmt_id = uint4korr(p);</span>
<span class='curline'><a href='../S/801.html#L1993'>packet</a>           1993 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;field_count = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L1997'>packet</a>           1997 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;param_count = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L2006'>packet</a>           2006 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;warning_count = uint2korr(p);</span>
<span class='curline'><a href='../S/801.html#L2010'>packet</a>           2010 ext/mysqlnd/mysqlnd_wireprotocol.c 				packet-&gt;stmt_id, packet-&gt;field_count, packet-&gt;param_count);</span>
<span class='curline'><a href='../S/801.html#L2016'>packet</a>           2016 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_ERR_FMT("PREPARE packet %d bytes shorter than expected", p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L2018'>packet</a>           2018 ext/mysqlnd/mysqlnd_wireprotocol.c 					 p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L2045'>packet</a>           2045 ext/mysqlnd/mysqlnd_wireprotocol.c 	MYSQLND_PACKET_CHG_USER_RESPONSE *packet= (MYSQLND_PACKET_CHG_USER_RESPONSE *) _packet;</span>
<span class='curline'><a href='../S/801.html#L2049'>packet</a>           2049 ext/mysqlnd/mysqlnd_wireprotocol.c 	PACKET_READ_HEADER_AND_BODY(packet, conn, buf, buf_len, "change user response", PROT_CHG_USER_RESP_PACKET);</span>
<span class='curline'><a href='../S/801.html#L2058'>packet</a>           2058 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;response_code = uint1korr(p);</span>
<span class='curline'><a href='../S/801.html#L2061'>packet</a>           2061 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet-&gt;header.size == 1 &amp;&amp; buf[0] == EODATA_MARKER &amp;&amp; packet-&gt;server_capabilities &amp; CLIENT_SECURE_CONNECTION) {</span>
<span class='curline'><a href='../S/801.html#L2063'>packet</a>           2063 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;server_asked_323_auth = TRUE;</span>
<span class='curline'><a href='../S/801.html#L2067'>packet</a>           2067 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (ERROR_MARKER == packet-&gt;response_code) {</span>
<span class='curline'><a href='../S/801.html#L2068'>packet</a>           2068 ext/mysqlnd/mysqlnd_wireprotocol.c 		php_mysqlnd_read_error_from_line(p, packet-&gt;header.size - 1,</span>
<span class='curline'><a href='../S/801.html#L2069'>packet</a>           2069 ext/mysqlnd/mysqlnd_wireprotocol.c 										 packet-&gt;error_info.error,</span>
<span class='curline'><a href='../S/801.html#L2070'>packet</a>           2070 ext/mysqlnd/mysqlnd_wireprotocol.c 										 sizeof(packet-&gt;error_info.error),</span>
<span class='curline'><a href='../S/801.html#L2071'>packet</a>           2071 ext/mysqlnd/mysqlnd_wireprotocol.c 										 &amp;packet-&gt;error_info.error_no,</span>
<span class='curline'><a href='../S/801.html#L2072'>packet</a>           2072 ext/mysqlnd/mysqlnd_wireprotocol.c 										 packet-&gt;error_info.sqlstate</span>
<span class='curline'><a href='../S/801.html#L2076'>packet</a>           2076 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet-&gt;response_code == 0xFE &amp;&amp; packet-&gt;header.size &gt; (size_t) (p - buf)) {</span>
<span class='curline'><a href='../S/801.html#L2077'>packet</a>           2077 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;new_auth_protocol = mnd_pestrdup((char *)p, FALSE);</span>
<span class='curline'><a href='../S/801.html#L2078'>packet</a>           2078 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;new_auth_protocol_len = strlen(packet-&gt;new_auth_protocol);</span>
<span class='curline'><a href='../S/801.html#L2079'>packet</a>           2079 ext/mysqlnd/mysqlnd_wireprotocol.c 		p+= packet-&gt;new_auth_protocol_len + 1; /* +1 for the \0 */</span>
<span class='curline'><a href='../S/801.html#L2080'>packet</a>           2080 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;new_auth_protocol_data_len = packet-&gt;header.size - (size_t) (p - buf);</span>
<span class='curline'><a href='../S/801.html#L2081'>packet</a>           2081 ext/mysqlnd/mysqlnd_wireprotocol.c 		if (packet-&gt;new_auth_protocol_data_len) {</span>
<span class='curline'><a href='../S/801.html#L2082'>packet</a>           2082 ext/mysqlnd/mysqlnd_wireprotocol.c 			packet-&gt;new_auth_protocol_data = mnd_emalloc(packet-&gt;new_auth_protocol_data_len);</span>
<span class='curline'><a href='../S/801.html#L2083'>packet</a>           2083 ext/mysqlnd/mysqlnd_wireprotocol.c 			memcpy(packet-&gt;new_auth_protocol_data, p, packet-&gt;new_auth_protocol_data_len);</span>
<span class='curline'><a href='../S/801.html#L2085'>packet</a>           2085 ext/mysqlnd/mysqlnd_wireprotocol.c 		DBG_INF_FMT("The server requested switching auth plugin to : %s", packet-&gt;new_auth_protocol);</span>
<span class='curline'><a href='../S/801.html#L2086'>packet</a>           2086 ext/mysqlnd/mysqlnd_wireprotocol.c 		DBG_INF_FMT("Server salt : [%*s]", packet-&gt;new_auth_protocol_data_len, packet-&gt;new_auth_protocol_data);</span>
<span class='curline'><a href='../S/801.html#L2091'>packet</a>           2091 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_ERR_FMT("CHANGE_USER packet %d bytes shorter than expected", p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L2093'>packet</a>           2093 ext/mysqlnd/mysqlnd_wireprotocol.c 						 p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L2162'>packet</a>           2162 ext/mysqlnd/mysqlnd_wireprotocol.c 	MYSQLND_PACKET_SHA256_PK_REQUEST_RESPONSE * packet= (MYSQLND_PACKET_SHA256_PK_REQUEST_RESPONSE *) _packet;</span>
<span class='curline'><a href='../S/801.html#L2167'>packet</a>           2167 ext/mysqlnd/mysqlnd_wireprotocol.c 	PACKET_READ_HEADER_AND_BODY(packet, conn, buf, sizeof(buf), "SHA256_PK_REQUEST_RESPONSE", PROT_SHA256_PK_REQUEST_RESPONSE_PACKET);</span>
<span class='curline'><a href='../S/801.html#L2173'>packet</a>           2173 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;public_key_len = packet-&gt;header.size - (p - buf);</span>
<span class='curline'><a href='../S/801.html#L2174'>packet</a>           2174 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;public_key = mnd_emalloc(packet-&gt;public_key_len + 1);</span>
<span class='curline'><a href='../S/801.html#L2175'>packet</a>           2175 ext/mysqlnd/mysqlnd_wireprotocol.c 	memcpy(packet-&gt;public_key, p, packet-&gt;public_key_len);</span>
<span class='curline'><a href='../S/801.html#L2176'>packet</a>           2176 ext/mysqlnd/mysqlnd_wireprotocol.c 	packet-&gt;public_key[packet-&gt;public_key_len] = '\0';</span>
<span class='curline'><a href='../S/801.html#L2181'>packet</a>           2181 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_ERR_FMT("OK packet %d bytes shorter than expected", p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L2183'>packet</a>           2183 ext/mysqlnd/mysqlnd_wireprotocol.c 					 p - begin - packet-&gt;header.size);</span>
<span class='curline'><a href='../S/801.html#L2309'>packet</a>           2309 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_greet * packet = mnd_pecalloc(1, packet_methods[PROT_GREET_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2311'>packet</a>           2311 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2312'>packet</a>           2312 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_GREET_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2313'>packet</a>           2313 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2315'>packet</a>           2315 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/801.html#L2324'>packet</a>           2324 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_auth * packet = mnd_pecalloc(1, packet_methods[PROT_AUTH_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2326'>packet</a>           2326 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2327'>packet</a>           2327 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_AUTH_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2328'>packet</a>           2328 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2330'>packet</a>           2330 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/801.html#L2339'>packet</a>           2339 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_auth_response * packet = mnd_pecalloc(1, packet_methods[PROT_AUTH_RESP_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2341'>packet</a>           2341 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2342'>packet</a>           2342 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_AUTH_RESP_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2343'>packet</a>           2343 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2345'>packet</a>           2345 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/801.html#L2354'>packet</a>           2354 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_change_auth_response * packet = mnd_pecalloc(1, packet_methods[PROT_CHANGE_AUTH_RESP_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2356'>packet</a>           2356 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2357'>packet</a>           2357 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_CHANGE_AUTH_RESP_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2358'>packet</a>           2358 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2360'>packet</a>           2360 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/801.html#L2369'>packet</a>           2369 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_ok * packet = mnd_pecalloc(1, packet_methods[PROT_OK_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2371'>packet</a>           2371 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2372'>packet</a>           2372 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_OK_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2373'>packet</a>           2373 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2375'>packet</a>           2375 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/801.html#L2384'>packet</a>           2384 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_eof * packet = mnd_pecalloc(1, packet_methods[PROT_EOF_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2386'>packet</a>           2386 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2387'>packet</a>           2387 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_EOF_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2388'>packet</a>           2388 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2390'>packet</a>           2390 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/801.html#L2399'>packet</a>           2399 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_command * packet = mnd_pecalloc(1, packet_methods[PROT_CMD_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2401'>packet</a>           2401 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2402'>packet</a>           2402 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_CMD_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2403'>packet</a>           2403 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2405'>packet</a>           2405 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/801.html#L2414'>packet</a>           2414 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_rset_header * packet = mnd_pecalloc(1, packet_methods[PROT_RSET_HEADER_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2416'>packet</a>           2416 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2417'>packet</a>           2417 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_RSET_HEADER_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2418'>packet</a>           2418 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2420'>packet</a>           2420 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/801.html#L2429'>packet</a>           2429 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_res_field * packet = mnd_pecalloc(1, packet_methods[PROT_RSET_FLD_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2431'>packet</a>           2431 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2432'>packet</a>           2432 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_RSET_FLD_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2433'>packet</a>           2433 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2435'>packet</a>           2435 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/801.html#L2444'>packet</a>           2444 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_row * packet = mnd_pecalloc(1, packet_methods[PROT_ROW_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2446'>packet</a>           2446 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2447'>packet</a>           2447 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_ROW_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2448'>packet</a>           2448 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2450'>packet</a>           2450 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/801.html#L2459'>packet</a>           2459 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_stats * packet = mnd_pecalloc(1, packet_methods[PROT_STATS_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2461'>packet</a>           2461 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2462'>packet</a>           2462 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_STATS_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2463'>packet</a>           2463 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2465'>packet</a>           2465 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/801.html#L2474'>packet</a>           2474 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_prepare_response * packet = mnd_pecalloc(1, packet_methods[PROT_PREPARE_RESP_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2476'>packet</a>           2476 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2477'>packet</a>           2477 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_PREPARE_RESP_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2478'>packet</a>           2478 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2480'>packet</a>           2480 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/801.html#L2489'>packet</a>           2489 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_chg_user_resp * packet = mnd_pecalloc(1, packet_methods[PROT_CHG_USER_RESP_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2491'>packet</a>           2491 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2492'>packet</a>           2492 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_CHG_USER_RESP_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2493'>packet</a>           2493 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2495'>packet</a>           2495 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/801.html#L2504'>packet</a>           2504 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_sha256_pk_request * packet = mnd_pecalloc(1, packet_methods[PROT_SHA256_PK_REQUEST_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2506'>packet</a>           2506 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2507'>packet</a>           2507 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_SHA256_PK_REQUEST_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2508'>packet</a>           2508 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2510'>packet</a>           2510 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/801.html#L2519'>packet</a>           2519 ext/mysqlnd/mysqlnd_wireprotocol.c 	struct st_mysqlnd_packet_sha256_pk_request_response * packet = mnd_pecalloc(1, packet_methods[PROT_SHA256_PK_REQUEST_RESPONSE_PACKET].struct_size, persistent);</span>
<span class='curline'><a href='../S/801.html#L2521'>packet</a>           2521 ext/mysqlnd/mysqlnd_wireprotocol.c 	if (packet) {</span>
<span class='curline'><a href='../S/801.html#L2522'>packet</a>           2522 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.m = &amp;packet_methods[PROT_SHA256_PK_REQUEST_RESPONSE_PACKET];</span>
<span class='curline'><a href='../S/801.html#L2523'>packet</a>           2523 ext/mysqlnd/mysqlnd_wireprotocol.c 		packet-&gt;header.persistent = persistent;</span>
<span class='curline'><a href='../S/801.html#L2525'>packet</a>           2525 ext/mysqlnd/mysqlnd_wireprotocol.c 	DBG_RETURN(packet);</span>
<span class='curline'><a href='../S/802.html#L39'>packet</a>             39 ext/mysqlnd/mysqlnd_wireprotocol.h #define PACKET_WRITE(packet, conn)	((packet)-&gt;header.m-&gt;write_to_net((packet), (conn)))</span>
<span class='curline'><a href='../S/802.html#L40'>packet</a>             40 ext/mysqlnd/mysqlnd_wireprotocol.h #define PACKET_READ(packet, conn)	((packet)-&gt;header.m-&gt;read_from_net((packet), (conn)))</span>
<span class='curline'><a href='../S/802.html#L41'>packet</a>             41 ext/mysqlnd/mysqlnd_wireprotocol.h #define PACKET_FREE(packet) \</span>
<span class='curline'><a href='../S/802.html#L43'>packet</a>             43 ext/mysqlnd/mysqlnd_wireprotocol.h 		DBG_INF_FMT("PACKET_FREE(%p)", packet); \</span>
<span class='curline'><a href='../S/802.html#L44'>packet</a>             44 ext/mysqlnd/mysqlnd_wireprotocol.h 		if ((packet)) { \</span>
<span class='curline'><a href='../S/802.html#L45'>packet</a>             45 ext/mysqlnd/mysqlnd_wireprotocol.h 			((packet)-&gt;header.m-&gt;free_mem((packet), FALSE)); \</span>
<span class='curline'><a href='../S/802.html#L54'>packet</a>             54 ext/mysqlnd/mysqlnd_wireprotocol.h 	enum_func_status	(*read_from_net)(void * packet, MYSQLND_CONN_DATA * conn);</span>
<span class='curline'><a href='../S/802.html#L55'>packet</a>             55 ext/mysqlnd/mysqlnd_wireprotocol.h 	size_t				(*write_to_net)(void * packet, MYSQLND_CONN_DATA * conn);</span>
<span class='curline'><a href='../S/802.html#L56'>packet</a>             56 ext/mysqlnd/mysqlnd_wireprotocol.h 	void				(*free_mem)(void *packet, zend_bool stack_allocation);</span>
<span class='curline'><a href='../S/802.html#L303'>packet</a>            303 ext/mysqlnd/mysqlnd_wireprotocol.h zend_ulong	php_mysqlnd_net_field_length(zend_uchar **packet);</span>
<span class='curline'><a href='../S/802.html#L304'>packet</a>            304 ext/mysqlnd/mysqlnd_wireprotocol.h zend_uchar *	php_mysqlnd_net_store_length(zend_uchar *packet, uint64_t length);</span>
<span class='curline'><a href='../S/1206.html#L51'>packet</a>             51 ext/wddx/php_wddx_api.h #define php_wddx_add_chunk(packet, str)	smart_str_appends(packet, str)</span>
<span class='curline'><a href='../S/1206.html#L52'>packet</a>             52 ext/wddx/php_wddx_api.h #define php_wddx_add_chunk_ex(packet, str, len)	smart_str_appendl(packet, str, len)</span>
<span class='curline'><a href='../S/1206.html#L53'>packet</a>             53 ext/wddx/php_wddx_api.h #define php_wddx_add_chunk_static(packet, str) smart_str_appendl(packet, str, sizeof(str)-1)</span>
<span class='curline'><a href='../S/1206.html#L58'>packet</a>             58 ext/wddx/php_wddx_api.h void		 php_wddx_destructor(wddx_packet *packet);</span>
<span class='curline'><a href='../S/1206.html#L60'>packet</a>             60 ext/wddx/php_wddx_api.h void 		 php_wddx_packet_start(wddx_packet *packet, char *comment, size_t comment_len);</span>
<span class='curline'><a href='../S/1206.html#L61'>packet</a>             61 ext/wddx/php_wddx_api.h void 		 php_wddx_packet_end(wddx_packet *packet);</span>
<span class='curline'><a href='../S/1206.html#L63'>packet</a>             63 ext/wddx/php_wddx_api.h void 		 php_wddx_serialize_var(wddx_packet *packet, zval *var, zend_string *name);</span>
<span class='curline'><a href='../S/1206.html#L65'>packet</a>             65 ext/wddx/php_wddx_api.h #define php_wddx_gather(packet) estrndup(packet-&gt;c, packet-&gt;len)</span>
<span class='curline'><a href='../S/1207.html#L129'>packet</a>            129 ext/wddx/wddx.c 	ZEND_ARG_INFO(0, packet)</span>
<span class='curline'><a href='../S/1207.html#L262'>packet</a>            262 ext/wddx/wddx.c 	wddx_packet *packet;</span>
<span class='curline'><a href='../S/1207.html#L266'>packet</a>            266 ext/wddx/wddx.c 	packet = php_wddx_constructor();</span>
<span class='curline'><a href='../S/1207.html#L268'>packet</a>            268 ext/wddx/wddx.c 	php_wddx_packet_start(packet, NULL, 0);</span>
<span class='curline'><a href='../S/1207.html#L269'>packet</a>            269 ext/wddx/wddx.c 	php_wddx_add_chunk_static(packet, WDDX_STRUCT_S);</span>
<span class='curline'><a href='../S/1207.html#L272'>packet</a>            272 ext/wddx/wddx.c 		php_wddx_serialize_var(packet, struc, key);</span>
<span class='curline'><a href='../S/1207.html#L275'>packet</a>            275 ext/wddx/wddx.c 	php_wddx_add_chunk_static(packet, WDDX_STRUCT_E);</span>
<span class='curline'><a href='../S/1207.html#L276'>packet</a>            276 ext/wddx/wddx.c 	php_wddx_packet_end(packet);</span>
<span class='curline'><a href='../S/1207.html#L277'>packet</a>            277 ext/wddx/wddx.c 	smart_str_0(packet);</span>
<span class='curline'><a href='../S/1207.html#L278'>packet</a>            278 ext/wddx/wddx.c 	str = zend_string_copy(packet-&gt;s);</span>
<span class='curline'><a href='../S/1207.html#L279'>packet</a>            279 ext/wddx/wddx.c 	php_wddx_destructor(packet);</span>
<span class='curline'><a href='../S/1207.html#L359'>packet</a>            359 ext/wddx/wddx.c void php_wddx_packet_start(wddx_packet *packet, char *comment, size_t comment_len)</span>
<span class='curline'><a href='../S/1207.html#L361'>packet</a>            361 ext/wddx/wddx.c 	php_wddx_add_chunk_static(packet, WDDX_PACKET_S);</span>
<span class='curline'><a href='../S/1207.html#L363'>packet</a>            363 ext/wddx/wddx.c 		php_wddx_add_chunk_static(packet, WDDX_HEADER_S);</span>
<span class='curline'><a href='../S/1207.html#L364'>packet</a>            364 ext/wddx/wddx.c 		php_wddx_add_chunk_static(packet, WDDX_COMMENT_S);</span>
<span class='curline'><a href='../S/1207.html#L365'>packet</a>            365 ext/wddx/wddx.c 		php_wddx_add_chunk_ex(packet, comment, comment_len);</span>
<span class='curline'><a href='../S/1207.html#L366'>packet</a>            366 ext/wddx/wddx.c 		php_wddx_add_chunk_static(packet, WDDX_COMMENT_E);</span>
<span class='curline'><a href='../S/1207.html#L367'>packet</a>            367 ext/wddx/wddx.c 		php_wddx_add_chunk_static(packet, WDDX_HEADER_E);</span>
<span class='curline'><a href='../S/1207.html#L369'>packet</a>            369 ext/wddx/wddx.c 		php_wddx_add_chunk_static(packet, WDDX_HEADER);</span>
<span class='curline'><a href='../S/1207.html#L371'>packet</a>            371 ext/wddx/wddx.c 	php_wddx_add_chunk_static(packet, WDDX_DATA_S);</span>
<span class='curline'><a href='../S/1207.html#L377'>packet</a>            377 ext/wddx/wddx.c void php_wddx_packet_end(wddx_packet *packet)</span>
<span class='curline'><a href='../S/1207.html#L379'>packet</a>            379 ext/wddx/wddx.c 	php_wddx_add_chunk_static(packet, WDDX_DATA_E);</span>
<span class='curline'><a href='../S/1207.html#L380'>packet</a>            380 ext/wddx/wddx.c 	php_wddx_add_chunk_static(packet, WDDX_PACKET_E);</span>
<span class='curline'><a href='../S/1207.html#L386'>packet</a>            386 ext/wddx/wddx.c 		php_wddx_add_chunk_ex(packet, buf, l);    \</span>
<span class='curline'><a href='../S/1207.html#L392'>packet</a>            392 ext/wddx/wddx.c static void php_wddx_serialize_string(wddx_packet *packet, zval *var)</span>
<span class='curline'><a href='../S/1207.html#L394'>packet</a>            394 ext/wddx/wddx.c 	php_wddx_add_chunk_static(packet, WDDX_STRING_S);</span>
<span class='curline'><a href='../S/1207.html#L400'>packet</a>            400 ext/wddx/wddx.c 		php_wddx_add_chunk_ex(packet, ZSTR_VAL(buf), ZSTR_LEN(buf));</span>
<span class='curline'><a href='../S/1207.html#L404'>packet</a>            404 ext/wddx/wddx.c 	php_wddx_add_chunk_static(packet, WDDX_STRING_E);</span>
<span class='curline'><a href='../S/1207.html#L410'>packet</a>            410 ext/wddx/wddx.c static void php_wddx_serialize_number(wddx_packet *packet, zval *var)</span>
<span class='curline'><a href='../S/1207.html#L417'>packet</a>            417 ext/wddx/wddx.c 	php_wddx_add_chunk(packet, tmp_buf);</span>
<span class='curline'><a href='../S/1207.html#L423'>packet</a>            423 ext/wddx/wddx.c static void php_wddx_serialize_boolean(wddx_packet *packet, zval *var)</span>
<span class='curline'><a href='../S/1207.html#L425'>packet</a>            425 ext/wddx/wddx.c 	php_wddx_add_chunk(packet, Z_TYPE_P(var) == IS_TRUE ? WDDX_BOOLEAN_TRUE : WDDX_BOOLEAN_FALSE);</span>
<span class='curline'><a href='../S/1207.html#L431'>packet</a>            431 ext/wddx/wddx.c static void php_wddx_serialize_unset(wddx_packet *packet)</span>
<span class='curline'><a href='../S/1207.html#L433'>packet</a>            433 ext/wddx/wddx.c 	php_wddx_add_chunk_static(packet, WDDX_NULL);</span>
<span class='curline'><a href='../S/1207.html#L439'>packet</a>            439 ext/wddx/wddx.c static void php_wddx_serialize_object(wddx_packet *packet, zval *obj)</span>
<span class='curline'><a href='../S/1207.html#L460'>packet</a>            460 ext/wddx/wddx.c 			php_wddx_add_chunk_static(packet, WDDX_STRUCT_S);</span>
<span class='curline'><a href='../S/1207.html#L462'>packet</a>            462 ext/wddx/wddx.c 			php_wddx_add_chunk(packet, tmp_buf);</span>
<span class='curline'><a href='../S/1207.html#L463'>packet</a>            463 ext/wddx/wddx.c 			php_wddx_add_chunk_static(packet, WDDX_STRING_S);</span>
<span class='curline'><a href='../S/1207.html#L464'>packet</a>            464 ext/wddx/wddx.c 			php_wddx_add_chunk_ex(packet, ZSTR_VAL(class_name), ZSTR_LEN(class_name));</span>
<span class='curline'><a href='../S/1207.html#L465'>packet</a>            465 ext/wddx/wddx.c 			php_wddx_add_chunk_static(packet, WDDX_STRING_E);</span>
<span class='curline'><a href='../S/1207.html#L466'>packet</a>            466 ext/wddx/wddx.c 			php_wddx_add_chunk_static(packet, WDDX_VAR_E);</span>
<span class='curline'><a href='../S/1207.html#L479'>packet</a>            479 ext/wddx/wddx.c 					php_wddx_serialize_var(packet, ent, Z_STR_P(varname));</span>
<span class='curline'><a href='../S/1207.html#L483'>packet</a>            483 ext/wddx/wddx.c 			php_wddx_add_chunk_static(packet, WDDX_STRUCT_E);</span>
<span class='curline'><a href='../S/1207.html#L490'>packet</a>            490 ext/wddx/wddx.c 		php_wddx_add_chunk_static(packet, WDDX_STRUCT_S);</span>
<span class='curline'><a href='../S/1207.html#L492'>packet</a>            492 ext/wddx/wddx.c 		php_wddx_add_chunk(packet, tmp_buf);</span>
<span class='curline'><a href='../S/1207.html#L493'>packet</a>            493 ext/wddx/wddx.c 		php_wddx_add_chunk_static(packet, WDDX_STRING_S);</span>
<span class='curline'><a href='../S/1207.html#L494'>packet</a>            494 ext/wddx/wddx.c 		php_wddx_add_chunk_ex(packet, ZSTR_VAL(class_name), ZSTR_LEN(class_name));</span>
<span class='curline'><a href='../S/1207.html#L495'>packet</a>            495 ext/wddx/wddx.c 		php_wddx_add_chunk_static(packet, WDDX_STRING_E);</span>
<span class='curline'><a href='../S/1207.html#L496'>packet</a>            496 ext/wddx/wddx.c 		php_wddx_add_chunk_static(packet, WDDX_VAR_E);</span>
<span class='curline'><a href='../S/1207.html#L512'>packet</a>            512 ext/wddx/wddx.c 				php_wddx_serialize_var(packet, ent, tmp);</span>
<span class='curline'><a href='../S/1207.html#L516'>packet</a>            516 ext/wddx/wddx.c 				php_wddx_serialize_var(packet, ent, key);</span>
<span class='curline'><a href='../S/1207.html#L520'>packet</a>            520 ext/wddx/wddx.c 		php_wddx_add_chunk_static(packet, WDDX_STRUCT_E);</span>
<span class='curline'><a href='../S/1207.html#L530'>packet</a>            530 ext/wddx/wddx.c static void php_wddx_serialize_array(wddx_packet *packet, zval *arr)</span>
<span class='curline'><a href='../S/1207.html#L555'>packet</a>            555 ext/wddx/wddx.c 		php_wddx_add_chunk_static(packet, WDDX_STRUCT_S);</span>
<span class='curline'><a href='../S/1207.html#L558'>packet</a>            558 ext/wddx/wddx.c 		php_wddx_add_chunk(packet, tmp_buf);</span>
<span class='curline'><a href='../S/1207.html#L568'>packet</a>            568 ext/wddx/wddx.c 				php_wddx_serialize_var(packet, ent, key);</span>
<span class='curline'><a href='../S/1207.html#L571'>packet</a>            571 ext/wddx/wddx.c 				php_wddx_serialize_var(packet, ent, key);</span>
<span class='curline'><a href='../S/1207.html#L575'>packet</a>            575 ext/wddx/wddx.c 			php_wddx_serialize_var(packet, ent, NULL);</span>
<span class='curline'><a href='../S/1207.html#L580'>packet</a>            580 ext/wddx/wddx.c 		php_wddx_add_chunk_static(packet, WDDX_STRUCT_E);</span>
<span class='curline'><a href='../S/1207.html#L582'>packet</a>            582 ext/wddx/wddx.c 		php_wddx_add_chunk_static(packet, WDDX_ARRAY_E);</span>
<span class='curline'><a href='../S/1207.html#L589'>packet</a>            589 ext/wddx/wddx.c void php_wddx_serialize_var(wddx_packet *packet, zval *var, zend_string *name)</span>
<span class='curline'><a href='../S/1207.html#L598'>packet</a>            598 ext/wddx/wddx.c 		php_wddx_add_chunk(packet, tmp_buf);</span>
<span class='curline'><a href='../S/1207.html#L609'>packet</a>            609 ext/wddx/wddx.c 			php_wddx_serialize_string(packet, var);</span>
<span class='curline'><a href='../S/1207.html#L614'>packet</a>            614 ext/wddx/wddx.c 			php_wddx_serialize_number(packet, var);</span>
<span class='curline'><a href='../S/1207.html#L619'>packet</a>            619 ext/wddx/wddx.c 			php_wddx_serialize_boolean(packet, var);</span>
<span class='curline'><a href='../S/1207.html#L623'>packet</a>            623 ext/wddx/wddx.c 			php_wddx_serialize_unset(packet);</span>
<span class='curline'><a href='../S/1207.html#L635'>packet</a>            635 ext/wddx/wddx.c 			php_wddx_serialize_array(packet, var);</span>
<span class='curline'><a href='../S/1207.html#L648'>packet</a>            648 ext/wddx/wddx.c  			php_wddx_serialize_object(packet, var);</span>
<span class='curline'><a href='../S/1207.html#L654'>packet</a>            654 ext/wddx/wddx.c 		php_wddx_add_chunk_static(packet, WDDX_VAR_E);</span>
<span class='curline'><a href='../S/1207.html#L661'>packet</a>            661 ext/wddx/wddx.c static void php_wddx_add_var(wddx_packet *packet, zval *name_var)</span>
<span class='curline'><a href='../S/1207.html#L672'>packet</a>            672 ext/wddx/wddx.c 			php_wddx_serialize_var(packet, val, Z_STR_P(name_var));</span>
<span class='curline'><a href='../S/1207.html#L686'>packet</a>            686 ext/wddx/wddx.c 				php_wddx_add_var(packet, val);</span>
<span class='curline'><a href='../S/1207.html#L695'>packet</a>            695 ext/wddx/wddx.c 				php_wddx_add_var(packet, val);</span>
<span class='curline'><a href='../S/1207.html#L1092'>packet</a>           1092 ext/wddx/wddx.c 	wddx_packet *packet;</span>
<span class='curline'><a href='../S/1207.html#L1098'>packet</a>           1098 ext/wddx/wddx.c 	packet = php_wddx_constructor();</span>
<span class='curline'><a href='../S/1207.html#L1100'>packet</a>           1100 ext/wddx/wddx.c 	php_wddx_packet_start(packet, comment, comment_len);</span>
<span class='curline'><a href='../S/1207.html#L1101'>packet</a>           1101 ext/wddx/wddx.c 	php_wddx_serialize_var(packet, var, NULL);</span>
<span class='curline'><a href='../S/1207.html#L1102'>packet</a>           1102 ext/wddx/wddx.c 	php_wddx_packet_end(packet);</span>
<span class='curline'><a href='../S/1207.html#L1103'>packet</a>           1103 ext/wddx/wddx.c 	smart_str_0(packet);</span>
<span class='curline'><a href='../S/1207.html#L1105'>packet</a>           1105 ext/wddx/wddx.c 	RETVAL_STR_COPY(packet-&gt;s);</span>
<span class='curline'><a href='../S/1207.html#L1106'>packet</a>           1106 ext/wddx/wddx.c 	php_wddx_destructor(packet);</span>
<span class='curline'><a href='../S/1207.html#L1115'>packet</a>           1115 ext/wddx/wddx.c 	wddx_packet *packet;</span>
<span class='curline'><a href='../S/1207.html#L1122'>packet</a>           1122 ext/wddx/wddx.c 	packet = php_wddx_constructor();</span>
<span class='curline'><a href='../S/1207.html#L1124'>packet</a>           1124 ext/wddx/wddx.c 	php_wddx_packet_start(packet, NULL, 0);</span>
<span class='curline'><a href='../S/1207.html#L1125'>packet</a>           1125 ext/wddx/wddx.c 	php_wddx_add_chunk_static(packet, WDDX_STRUCT_S);</span>
<span class='curline'><a href='../S/1207.html#L1137'>packet</a>           1137 ext/wddx/wddx.c 		php_wddx_add_var(packet, arg);</span>
<span class='curline'><a href='../S/1207.html#L1140'>packet</a>           1140 ext/wddx/wddx.c 	php_wddx_add_chunk_static(packet, WDDX_STRUCT_E);</span>
<span class='curline'><a href='../S/1207.html#L1141'>packet</a>           1141 ext/wddx/wddx.c 	php_wddx_packet_end(packet);</span>
<span class='curline'><a href='../S/1207.html#L1142'>packet</a>           1142 ext/wddx/wddx.c 	smart_str_0(packet);</span>
<span class='curline'><a href='../S/1207.html#L1144'>packet</a>           1144 ext/wddx/wddx.c 	RETVAL_STR_COPY(packet-&gt;s);</span>
<span class='curline'><a href='../S/1207.html#L1145'>packet</a>           1145 ext/wddx/wddx.c 	php_wddx_destructor(packet);</span>
<span class='curline'><a href='../S/1207.html#L1153'>packet</a>           1153 ext/wddx/wddx.c 	smart_str *packet;</span>
<span class='curline'><a href='../S/1207.html#L1155'>packet</a>           1155 ext/wddx/wddx.c 	packet = ecalloc(1, sizeof(smart_str));</span>
<span class='curline'><a href='../S/1207.html#L1157'>packet</a>           1157 ext/wddx/wddx.c 	return packet;</span>
<span class='curline'><a href='../S/1207.html#L1163'>packet</a>           1163 ext/wddx/wddx.c void php_wddx_destructor(wddx_packet *packet)</span>
<span class='curline'><a href='../S/1207.html#L1165'>packet</a>           1165 ext/wddx/wddx.c 	smart_str_free(packet);</span>
<span class='curline'><a href='../S/1207.html#L1166'>packet</a>           1166 ext/wddx/wddx.c 	efree(packet);</span>
<span class='curline'><a href='../S/1207.html#L1176'>packet</a>           1176 ext/wddx/wddx.c 	wddx_packet *packet;</span>
<span class='curline'><a href='../S/1207.html#L1184'>packet</a>           1184 ext/wddx/wddx.c 	packet = php_wddx_constructor();</span>
<span class='curline'><a href='../S/1207.html#L1186'>packet</a>           1186 ext/wddx/wddx.c 	php_wddx_packet_start(packet, comment, comment_len);</span>
<span class='curline'><a href='../S/1207.html#L1187'>packet</a>           1187 ext/wddx/wddx.c 	php_wddx_add_chunk_static(packet, WDDX_STRUCT_S);</span>
<span class='curline'><a href='../S/1207.html#L1189'>packet</a>           1189 ext/wddx/wddx.c 	RETURN_RES(zend_register_resource(packet, le_wddx));</span>
<span class='curline'><a href='../S/1207.html#L1198'>packet</a>           1198 ext/wddx/wddx.c 	wddx_packet *packet = NULL;</span>
<span class='curline'><a href='../S/1207.html#L1204'>packet</a>           1204 ext/wddx/wddx.c 	if ((packet = (wddx_packet *)zend_fetch_resource(Z_RES_P(packet_id), "WDDX packet ID", le_wddx)) == NULL) {</span>
<span class='curline'><a href='../S/1207.html#L1208'>packet</a>           1208 ext/wddx/wddx.c 	php_wddx_add_chunk_static(packet, WDDX_STRUCT_E);</span>
<span class='curline'><a href='../S/1207.html#L1210'>packet</a>           1210 ext/wddx/wddx.c 	php_wddx_packet_end(packet);</span>
<span class='curline'><a href='../S/1207.html#L1211'>packet</a>           1211 ext/wddx/wddx.c 	smart_str_0(packet);</span>
<span class='curline'><a href='../S/1207.html#L1213'>packet</a>           1213 ext/wddx/wddx.c 	RETVAL_STR_COPY(packet-&gt;s);</span>
<span class='curline'><a href='../S/1207.html#L1226'>packet</a>           1226 ext/wddx/wddx.c 	wddx_packet *packet = NULL;</span>
<span class='curline'><a href='../S/1207.html#L1232'>packet</a>           1232 ext/wddx/wddx.c 	if ((packet = (wddx_packet *)zend_fetch_resource(Z_RES_P(packet_id), "WDDX packet ID", le_wddx)) == NULL) {</span>
<span class='curline'><a href='../S/1207.html#L1246'>packet</a>           1246 ext/wddx/wddx.c 		php_wddx_add_var(packet, arg);</span>
<span class='curline'><a href='../S/1207.html#L1257'>packet</a>           1257 ext/wddx/wddx.c 	zval *packet;</span>
<span class='curline'><a href='../S/1207.html#L1261'>packet</a>           1261 ext/wddx/wddx.c 	if (zend_parse_parameters(ZEND_NUM_ARGS(), "z", &amp;packet) == FAILURE) {</span>
<span class='curline'><a href='../S/1207.html#L1265'>packet</a>           1265 ext/wddx/wddx.c 	if (Z_TYPE_P(packet) == IS_STRING) {</span>
<span class='curline'><a href='../S/1207.html#L1266'>packet</a>           1266 ext/wddx/wddx.c 		payload = Z_STR_P(packet);</span>
<span class='curline'><a href='../S/1207.html#L1267'>packet</a>           1267 ext/wddx/wddx.c 	} else if (Z_TYPE_P(packet) == IS_RESOURCE) {</span>
<span class='curline'><a href='../S/1207.html#L1268'>packet</a>           1268 ext/wddx/wddx.c 		php_stream_from_zval(stream, packet);</span>
</pre>
</body>
</html>
