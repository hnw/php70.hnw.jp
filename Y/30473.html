<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>pFile</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/1054.html#L16650'>pFile</a>            16650 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_file *pFile, </span>
<span class='curline'><a href='../S/1054.html#L16660'>pFile</a>            16660 ext/sqlite3/libsqlite/sqlite3.c   rc = pVfs-&gt;xOpen(pVfs, zPath, pFile, flags &amp; 0x87f7f, pFlagsOut);</span>
<span class='curline'><a href='../S/1054.html#L16661'>pFile</a>            16661 ext/sqlite3/libsqlite/sqlite3.c   assert( rc==SQLITE_OK || pFile-&gt;pMethods==0 );</span>
<span class='curline'><a href='../S/1054.html#L16734'>pFile</a>            16734 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_file *pFile;</span>
<span class='curline'><a href='../S/1054.html#L16735'>pFile</a>            16735 ext/sqlite3/libsqlite/sqlite3.c   pFile = (sqlite3_file *)sqlite3MallocZero(pVfs-&gt;szOsFile);</span>
<span class='curline'><a href='../S/1054.html#L16736'>pFile</a>            16736 ext/sqlite3/libsqlite/sqlite3.c   if( pFile ){</span>
<span class='curline'><a href='../S/1054.html#L16737'>pFile</a>            16737 ext/sqlite3/libsqlite/sqlite3.c     rc = sqlite3OsOpen(pVfs, zFile, pFile, flags, pOutFlags);</span>
<span class='curline'><a href='../S/1054.html#L16739'>pFile</a>            16739 ext/sqlite3/libsqlite/sqlite3.c       sqlite3_free(pFile);</span>
<span class='curline'><a href='../S/1054.html#L16741'>pFile</a>            16741 ext/sqlite3/libsqlite/sqlite3.c       *ppFile = pFile;</span>
<span class='curline'><a href='../S/1054.html#L16746'>pFile</a>            16746 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3OsCloseFree(sqlite3_file *pFile){</span>
<span class='curline'><a href='../S/1054.html#L16748'>pFile</a>            16748 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L16749'>pFile</a>            16749 ext/sqlite3/libsqlite/sqlite3.c   rc = sqlite3OsClose(pFile);</span>
<span class='curline'><a href='../S/1054.html#L16750'>pFile</a>            16750 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_free(pFile);</span>
<span class='curline'><a href='../S/1054.html#L26623'>pFile</a>            26623 ext/sqlite3/libsqlite/sqlite3.c static void robust_close(unixFile *pFile, int h, int lineno){</span>
<span class='curline'><a href='../S/1054.html#L26626'>pFile</a>            26626 ext/sqlite3/libsqlite/sqlite3.c                        pFile ? pFile-&gt;zPath : 0, lineno);</span>
<span class='curline'><a href='../S/1054.html#L26634'>pFile</a>            26634 ext/sqlite3/libsqlite/sqlite3.c static void storeLastErrno(unixFile *pFile, int error){</span>
<span class='curline'><a href='../S/1054.html#L26635'>pFile</a>            26635 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;lastErrno = error;</span>
<span class='curline'><a href='../S/1054.html#L26641'>pFile</a>            26641 ext/sqlite3/libsqlite/sqlite3.c static void closePendingFds(unixFile *pFile){</span>
<span class='curline'><a href='../S/1054.html#L26642'>pFile</a>            26642 ext/sqlite3/libsqlite/sqlite3.c   unixInodeInfo *pInode = pFile-&gt;pInode;</span>
<span class='curline'><a href='../S/1054.html#L26647'>pFile</a>            26647 ext/sqlite3/libsqlite/sqlite3.c     robust_close(pFile, p-&gt;fd, __LINE__);</span>
<span class='curline'><a href='../S/1054.html#L26659'>pFile</a>            26659 ext/sqlite3/libsqlite/sqlite3.c static void releaseInodeInfo(unixFile *pFile){</span>
<span class='curline'><a href='../S/1054.html#L26660'>pFile</a>            26660 ext/sqlite3/libsqlite/sqlite3.c   unixInodeInfo *pInode = pFile-&gt;pInode;</span>
<span class='curline'><a href='../S/1054.html#L26666'>pFile</a>            26666 ext/sqlite3/libsqlite/sqlite3.c       closePendingFds(pFile);</span>
<span class='curline'><a href='../S/1054.html#L26694'>pFile</a>            26694 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile,               /* Unix file with file desc used in the key */</span>
<span class='curline'><a href='../S/1054.html#L26708'>pFile</a>            26708 ext/sqlite3/libsqlite/sqlite3.c   fd = pFile-&gt;h;</span>
<span class='curline'><a href='../S/1054.html#L26711'>pFile</a>            26711 ext/sqlite3/libsqlite/sqlite3.c     storeLastErrno(pFile, errno);</span>
<span class='curline'><a href='../S/1054.html#L26713'>pFile</a>            26713 ext/sqlite3/libsqlite/sqlite3.c     if( pFile-&gt;lastErrno==EOVERFLOW ) return SQLITE_NOLFS;</span>
<span class='curline'><a href='../S/1054.html#L26729'>pFile</a>            26729 ext/sqlite3/libsqlite/sqlite3.c   if( statbuf.st_size==0 &amp;&amp; (pFile-&gt;fsFlags &amp; SQLITE_FSFLAGS_IS_MSDOS)!=0 ){</span>
<span class='curline'><a href='../S/1054.html#L26732'>pFile</a>            26732 ext/sqlite3/libsqlite/sqlite3.c       storeLastErrno(pFile, errno);</span>
<span class='curline'><a href='../S/1054.html#L26737'>pFile</a>            26737 ext/sqlite3/libsqlite/sqlite3.c       storeLastErrno(pFile, errno);</span>
<span class='curline'><a href='../S/1054.html#L26746'>pFile</a>            26746 ext/sqlite3/libsqlite/sqlite3.c   fileId.pId = pFile-&gt;pId;</span>
<span class='curline'><a href='../S/1054.html#L26776'>pFile</a>            26776 ext/sqlite3/libsqlite/sqlite3.c static int fileHasMoved(unixFile *pFile){</span>
<span class='curline'><a href='../S/1054.html#L26778'>pFile</a>            26778 ext/sqlite3/libsqlite/sqlite3.c   return pFile-&gt;pInode!=0 &amp;&amp; pFile-&gt;pId!=pFile-&gt;pInode-&gt;fileId.pId;</span>
<span class='curline'><a href='../S/1054.html#L26781'>pFile</a>            26781 ext/sqlite3/libsqlite/sqlite3.c   return pFile-&gt;pInode!=0 &amp;&amp;</span>
<span class='curline'><a href='../S/1054.html#L26782'>pFile</a>            26782 ext/sqlite3/libsqlite/sqlite3.c       (osStat(pFile-&gt;zPath, &amp;buf)!=0 || buf.st_ino!=pFile-&gt;pInode-&gt;fileId.ino);</span>
<span class='curline'><a href='../S/1054.html#L26796'>pFile</a>            26796 ext/sqlite3/libsqlite/sqlite3.c static void verifyDbFile(unixFile *pFile){</span>
<span class='curline'><a href='../S/1054.html#L26799'>pFile</a>            26799 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;ctrlFlags &amp; UNIXFILE_WARNED ){</span>
<span class='curline'><a href='../S/1054.html#L26804'>pFile</a>            26804 ext/sqlite3/libsqlite/sqlite3.c   rc = osFstat(pFile-&gt;h, &amp;buf);</span>
<span class='curline'><a href='../S/1054.html#L26806'>pFile</a>            26806 ext/sqlite3/libsqlite/sqlite3.c     sqlite3_log(SQLITE_WARNING, "cannot fstat db file %s", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L26807'>pFile</a>            26807 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;ctrlFlags |= UNIXFILE_WARNED;</span>
<span class='curline'><a href='../S/1054.html#L26810'>pFile</a>            26810 ext/sqlite3/libsqlite/sqlite3.c   if( buf.st_nlink==0 &amp;&amp; (pFile-&gt;ctrlFlags &amp; UNIXFILE_DELETE)==0 ){</span>
<span class='curline'><a href='../S/1054.html#L26811'>pFile</a>            26811 ext/sqlite3/libsqlite/sqlite3.c     sqlite3_log(SQLITE_WARNING, "file unlinked while open: %s", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L26812'>pFile</a>            26812 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;ctrlFlags |= UNIXFILE_WARNED;</span>
<span class='curline'><a href='../S/1054.html#L26816'>pFile</a>            26816 ext/sqlite3/libsqlite/sqlite3.c     sqlite3_log(SQLITE_WARNING, "multiple links to file: %s", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L26817'>pFile</a>            26817 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;ctrlFlags |= UNIXFILE_WARNED;</span>
<span class='curline'><a href='../S/1054.html#L26820'>pFile</a>            26820 ext/sqlite3/libsqlite/sqlite3.c   if( fileHasMoved(pFile) ){</span>
<span class='curline'><a href='../S/1054.html#L26821'>pFile</a>            26821 ext/sqlite3/libsqlite/sqlite3.c     sqlite3_log(SQLITE_WARNING, "file renamed while open: %s", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L26822'>pFile</a>            26822 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;ctrlFlags |= UNIXFILE_WARNED;</span>
<span class='curline'><a href='../S/1054.html#L26837'>pFile</a>            26837 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L26841'>pFile</a>            26841 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L26845'>pFile</a>            26845 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;pInode-&gt;eFileLock&gt;SHARED_LOCK ){</span>
<span class='curline'><a href='../S/1054.html#L26852'>pFile</a>            26852 ext/sqlite3/libsqlite/sqlite3.c   if( !reserved &amp;&amp; !pFile-&gt;pInode-&gt;bProcessLock ){</span>
<span class='curline'><a href='../S/1054.html#L26858'>pFile</a>            26858 ext/sqlite3/libsqlite/sqlite3.c     if( osFcntl(pFile-&gt;h, F_GETLK, &amp;lock) ){</span>
<span class='curline'><a href='../S/1054.html#L26860'>pFile</a>            26860 ext/sqlite3/libsqlite/sqlite3.c       storeLastErrno(pFile, errno);</span>
<span class='curline'><a href='../S/1054.html#L26868'>pFile</a>            26868 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("TEST WR-LOCK %d %d %d (unix)\n", pFile-&gt;h, rc, reserved));</span>
<span class='curline'><a href='../S/1054.html#L26893'>pFile</a>            26893 ext/sqlite3/libsqlite/sqlite3.c static int unixFileLock(unixFile *pFile, struct flock *pLock){</span>
<span class='curline'><a href='../S/1054.html#L26895'>pFile</a>            26895 ext/sqlite3/libsqlite/sqlite3.c   unixInodeInfo *pInode = pFile-&gt;pInode;</span>
<span class='curline'><a href='../S/1054.html#L26898'>pFile</a>            26898 ext/sqlite3/libsqlite/sqlite3.c   if( ((pFile-&gt;ctrlFlags &amp; UNIXFILE_EXCL)!=0 || pInode-&gt;bProcessLock)</span>
<span class='curline'><a href='../S/1054.html#L26899'>pFile</a>            26899 ext/sqlite3/libsqlite/sqlite3.c    &amp;&amp; ((pFile-&gt;ctrlFlags &amp; UNIXFILE_RDONLY)==0)</span>
<span class='curline'><a href='../S/1054.html#L26908'>pFile</a>            26908 ext/sqlite3/libsqlite/sqlite3.c       rc = osFcntl(pFile-&gt;h, F_SETLK, &amp;lock);</span>
<span class='curline'><a href='../S/1054.html#L26916'>pFile</a>            26916 ext/sqlite3/libsqlite/sqlite3.c     rc = osFcntl(pFile-&gt;h, F_SETLK, pLock);</span>
<span class='curline'><a href='../S/1054.html#L26985'>pFile</a>            26985 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L26990'>pFile</a>            26990 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L26991'>pFile</a>            26991 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("LOCK    %d %s was %s(%s,%d) pid=%d (unix)\n", pFile-&gt;h,</span>
<span class='curline'><a href='../S/1054.html#L26992'>pFile</a>            26992 ext/sqlite3/libsqlite/sqlite3.c       azFileLock(eFileLock), azFileLock(pFile-&gt;eFileLock),</span>
<span class='curline'><a href='../S/1054.html#L26993'>pFile</a>            26993 ext/sqlite3/libsqlite/sqlite3.c       azFileLock(pFile-&gt;pInode-&gt;eFileLock), pFile-&gt;pInode-&gt;nShared,</span>
<span class='curline'><a href='../S/1054.html#L27000'>pFile</a>            27000 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock&gt;=eFileLock ){</span>
<span class='curline'><a href='../S/1054.html#L27001'>pFile</a>            27001 ext/sqlite3/libsqlite/sqlite3.c     OSTRACE(("LOCK    %d %s ok (already held) (unix)\n", pFile-&gt;h,</span>
<span class='curline'><a href='../S/1054.html#L27011'>pFile</a>            27011 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile-&gt;eFileLock!=NO_LOCK || eFileLock==SHARED_LOCK );</span>
<span class='curline'><a href='../S/1054.html#L27013'>pFile</a>            27013 ext/sqlite3/libsqlite/sqlite3.c   assert( eFileLock!=RESERVED_LOCK || pFile-&gt;eFileLock==SHARED_LOCK );</span>
<span class='curline'><a href='../S/1054.html#L27018'>pFile</a>            27018 ext/sqlite3/libsqlite/sqlite3.c   pInode = pFile-&gt;pInode;</span>
<span class='curline'><a href='../S/1054.html#L27023'>pFile</a>            27023 ext/sqlite3/libsqlite/sqlite3.c   if( (pFile-&gt;eFileLock!=pInode-&gt;eFileLock &amp;&amp; </span>
<span class='curline'><a href='../S/1054.html#L27037'>pFile</a>            27037 ext/sqlite3/libsqlite/sqlite3.c     assert( pFile-&gt;eFileLock==0 );</span>
<span class='curline'><a href='../S/1054.html#L27039'>pFile</a>            27039 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;eFileLock = SHARED_LOCK;</span>
<span class='curline'><a href='../S/1054.html#L27053'>pFile</a>            27053 ext/sqlite3/libsqlite/sqlite3.c       || (eFileLock==EXCLUSIVE_LOCK &amp;&amp; pFile-&gt;eFileLock&lt;PENDING_LOCK)</span>
<span class='curline'><a href='../S/1054.html#L27057'>pFile</a>            27057 ext/sqlite3/libsqlite/sqlite3.c     if( unixFileLock(pFile, &amp;lock) ){</span>
<span class='curline'><a href='../S/1054.html#L27061'>pFile</a>            27061 ext/sqlite3/libsqlite/sqlite3.c         storeLastErrno(pFile, tErrno);</span>
<span class='curline'><a href='../S/1054.html#L27079'>pFile</a>            27079 ext/sqlite3/libsqlite/sqlite3.c     if( unixFileLock(pFile, &amp;lock) ){</span>
<span class='curline'><a href='../S/1054.html#L27088'>pFile</a>            27088 ext/sqlite3/libsqlite/sqlite3.c     if( unixFileLock(pFile, &amp;lock) &amp;&amp; rc==SQLITE_OK ){</span>
<span class='curline'><a href='../S/1054.html#L27096'>pFile</a>            27096 ext/sqlite3/libsqlite/sqlite3.c         storeLastErrno(pFile, tErrno);</span>
<span class='curline'><a href='../S/1054.html#L27100'>pFile</a>            27100 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;eFileLock = SHARED_LOCK;</span>
<span class='curline'><a href='../S/1054.html#L27113'>pFile</a>            27113 ext/sqlite3/libsqlite/sqlite3.c     assert( 0!=pFile-&gt;eFileLock );</span>
<span class='curline'><a href='../S/1054.html#L27125'>pFile</a>            27125 ext/sqlite3/libsqlite/sqlite3.c     if( unixFileLock(pFile, &amp;lock) ){</span>
<span class='curline'><a href='../S/1054.html#L27129'>pFile</a>            27129 ext/sqlite3/libsqlite/sqlite3.c         storeLastErrno(pFile, tErrno);</span>
<span class='curline'><a href='../S/1054.html#L27142'>pFile</a>            27142 ext/sqlite3/libsqlite/sqlite3.c    &amp;&amp; pFile-&gt;eFileLock&lt;=SHARED_LOCK</span>
<span class='curline'><a href='../S/1054.html#L27145'>pFile</a>            27145 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;transCntrChng = 0;</span>
<span class='curline'><a href='../S/1054.html#L27146'>pFile</a>            27146 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;dbUpdate = 0;</span>
<span class='curline'><a href='../S/1054.html#L27147'>pFile</a>            27147 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;inNormalWrite = 1;</span>
<span class='curline'><a href='../S/1054.html#L27153'>pFile</a>            27153 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;eFileLock = eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L27156'>pFile</a>            27156 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;eFileLock = PENDING_LOCK;</span>
<span class='curline'><a href='../S/1054.html#L27162'>pFile</a>            27162 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("LOCK    %d %s %s (unix)\n", pFile-&gt;h, azFileLock(eFileLock), </span>
<span class='curline'><a href='../S/1054.html#L27171'>pFile</a>            27171 ext/sqlite3/libsqlite/sqlite3.c static void setPendingFd(unixFile *pFile){</span>
<span class='curline'><a href='../S/1054.html#L27172'>pFile</a>            27172 ext/sqlite3/libsqlite/sqlite3.c   unixInodeInfo *pInode = pFile-&gt;pInode;</span>
<span class='curline'><a href='../S/1054.html#L27173'>pFile</a>            27173 ext/sqlite3/libsqlite/sqlite3.c   UnixUnusedFd *p = pFile-&gt;pUnused;</span>
<span class='curline'><a href='../S/1054.html#L27176'>pFile</a>            27176 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;h = -1;</span>
<span class='curline'><a href='../S/1054.html#L27177'>pFile</a>            27177 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;pUnused = 0;</span>
<span class='curline'><a href='../S/1054.html#L27194'>pFile</a>            27194 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L27199'>pFile</a>            27199 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L27200'>pFile</a>            27200 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("UNLOCK  %d %d was %d(%d,%d) pid=%d (unix)\n", pFile-&gt;h, eFileLock,</span>
<span class='curline'><a href='../S/1054.html#L27201'>pFile</a>            27201 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;eFileLock, pFile-&gt;pInode-&gt;eFileLock, pFile-&gt;pInode-&gt;nShared,</span>
<span class='curline'><a href='../S/1054.html#L27205'>pFile</a>            27205 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock&lt;=eFileLock ){</span>
<span class='curline'><a href='../S/1054.html#L27209'>pFile</a>            27209 ext/sqlite3/libsqlite/sqlite3.c   pInode = pFile-&gt;pInode;</span>
<span class='curline'><a href='../S/1054.html#L27211'>pFile</a>            27211 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock&gt;SHARED_LOCK ){</span>
<span class='curline'><a href='../S/1054.html#L27212'>pFile</a>            27212 ext/sqlite3/libsqlite/sqlite3.c     assert( pInode-&gt;eFileLock==pFile-&gt;eFileLock );</span>
<span class='curline'><a href='../S/1054.html#L27223'>pFile</a>            27223 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;inNormalWrite = 0;</span>
<span class='curline'><a href='../S/1054.html#L27249'>pFile</a>            27249 ext/sqlite3/libsqlite/sqlite3.c         if( unixFileLock(pFile, &amp;lock)==(-1) ){</span>
<span class='curline'><a href='../S/1054.html#L27253'>pFile</a>            27253 ext/sqlite3/libsqlite/sqlite3.c             storeLastErrno(pFile, tErrno);</span>
<span class='curline'><a href='../S/1054.html#L27261'>pFile</a>            27261 ext/sqlite3/libsqlite/sqlite3.c         if( unixFileLock(pFile, &amp;lock)==(-1) ){</span>
<span class='curline'><a href='../S/1054.html#L27265'>pFile</a>            27265 ext/sqlite3/libsqlite/sqlite3.c             storeLastErrno(pFile, tErrno);</span>
<span class='curline'><a href='../S/1054.html#L27273'>pFile</a>            27273 ext/sqlite3/libsqlite/sqlite3.c         if( unixFileLock(pFile, &amp;lock)==(-1) ){</span>
<span class='curline'><a href='../S/1054.html#L27277'>pFile</a>            27277 ext/sqlite3/libsqlite/sqlite3.c             storeLastErrno(pFile, tErrno);</span>
<span class='curline'><a href='../S/1054.html#L27288'>pFile</a>            27288 ext/sqlite3/libsqlite/sqlite3.c         if( unixFileLock(pFile, &amp;lock) ){</span>
<span class='curline'><a href='../S/1054.html#L27296'>pFile</a>            27296 ext/sqlite3/libsqlite/sqlite3.c           storeLastErrno(pFile, errno);</span>
<span class='curline'><a href='../S/1054.html#L27305'>pFile</a>            27305 ext/sqlite3/libsqlite/sqlite3.c     if( unixFileLock(pFile, &amp;lock)==0 ){</span>
<span class='curline'><a href='../S/1054.html#L27309'>pFile</a>            27309 ext/sqlite3/libsqlite/sqlite3.c       storeLastErrno(pFile, errno);</span>
<span class='curline'><a href='../S/1054.html#L27323'>pFile</a>            27323 ext/sqlite3/libsqlite/sqlite3.c       if( unixFileLock(pFile, &amp;lock)==0 ){</span>
<span class='curline'><a href='../S/1054.html#L27327'>pFile</a>            27327 ext/sqlite3/libsqlite/sqlite3.c         storeLastErrno(pFile, errno);</span>
<span class='curline'><a href='../S/1054.html#L27329'>pFile</a>            27329 ext/sqlite3/libsqlite/sqlite3.c         pFile-&gt;eFileLock = NO_LOCK;</span>
<span class='curline'><a href='../S/1054.html#L27340'>pFile</a>            27340 ext/sqlite3/libsqlite/sqlite3.c       closePendingFds(pFile);</span>
<span class='curline'><a href='../S/1054.html#L27346'>pFile</a>            27346 ext/sqlite3/libsqlite/sqlite3.c   if( rc==SQLITE_OK ) pFile-&gt;eFileLock = eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L27380'>pFile</a>            27380 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L27382'>pFile</a>            27382 ext/sqlite3/libsqlite/sqlite3.c   unixUnmapfile(pFile);</span>
<span class='curline'><a href='../S/1054.html#L27384'>pFile</a>            27384 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;h&gt;=0 ){</span>
<span class='curline'><a href='../S/1054.html#L27385'>pFile</a>            27385 ext/sqlite3/libsqlite/sqlite3.c     robust_close(pFile, pFile-&gt;h, __LINE__);</span>
<span class='curline'><a href='../S/1054.html#L27386'>pFile</a>            27386 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;h = -1;</span>
<span class='curline'><a href='../S/1054.html#L27389'>pFile</a>            27389 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;pId ){</span>
<span class='curline'><a href='../S/1054.html#L27390'>pFile</a>            27390 ext/sqlite3/libsqlite/sqlite3.c     if( pFile-&gt;ctrlFlags &amp; UNIXFILE_DELETE ){</span>
<span class='curline'><a href='../S/1054.html#L27391'>pFile</a>            27391 ext/sqlite3/libsqlite/sqlite3.c       osUnlink(pFile-&gt;pId-&gt;zCanonicalName);</span>
<span class='curline'><a href='../S/1054.html#L27393'>pFile</a>            27393 ext/sqlite3/libsqlite/sqlite3.c     vxworksReleaseFileId(pFile-&gt;pId);</span>
<span class='curline'><a href='../S/1054.html#L27394'>pFile</a>            27394 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;pId = 0;</span>
<span class='curline'><a href='../S/1054.html#L27398'>pFile</a>            27398 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;ctrlFlags &amp; UNIXFILE_DELETE ){</span>
<span class='curline'><a href='../S/1054.html#L27399'>pFile</a>            27399 ext/sqlite3/libsqlite/sqlite3.c     osUnlink(pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L27400'>pFile</a>            27400 ext/sqlite3/libsqlite/sqlite3.c     sqlite3_free(*(char**)&amp;pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L27401'>pFile</a>            27401 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;zPath = 0;</span>
<span class='curline'><a href='../S/1054.html#L27404'>pFile</a>            27404 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("CLOSE   %-3d\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L27406'>pFile</a>            27406 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_free(pFile-&gt;pUnused);</span>
<span class='curline'><a href='../S/1054.html#L27407'>pFile</a>            27407 ext/sqlite3/libsqlite/sqlite3.c   memset(pFile, 0, sizeof(unixFile));</span>
<span class='curline'><a href='../S/1054.html#L27416'>pFile</a>            27416 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile *)id;</span>
<span class='curline'><a href='../S/1054.html#L27417'>pFile</a>            27417 ext/sqlite3/libsqlite/sqlite3.c   verifyDbFile(pFile);</span>
<span class='curline'><a href='../S/1054.html#L27424'>pFile</a>            27424 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile-&gt;pInode-&gt;nLock&gt;0 || pFile-&gt;pInode-&gt;bProcessLock==0 );</span>
<span class='curline'><a href='../S/1054.html#L27425'>pFile</a>            27425 ext/sqlite3/libsqlite/sqlite3.c   if( ALWAYS(pFile-&gt;pInode) &amp;&amp; pFile-&gt;pInode-&gt;nLock ){</span>
<span class='curline'><a href='../S/1054.html#L27431'>pFile</a>            27431 ext/sqlite3/libsqlite/sqlite3.c     setPendingFd(pFile);</span>
<span class='curline'><a href='../S/1054.html#L27433'>pFile</a>            27433 ext/sqlite3/libsqlite/sqlite3.c   releaseInodeInfo(pFile);</span>
<span class='curline'><a href='../S/1054.html#L27524'>pFile</a>            27524 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L27528'>pFile</a>            27528 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L27531'>pFile</a>            27531 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock&gt;SHARED_LOCK ){</span>
<span class='curline'><a href='../S/1054.html#L27537'>pFile</a>            27537 ext/sqlite3/libsqlite/sqlite3.c     const char *zLockFile = (const char*)pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L27540'>pFile</a>            27540 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("TEST WR-LOCK %d %d %d (dotlock)\n", pFile-&gt;h, rc, reserved));</span>
<span class='curline'><a href='../S/1054.html#L27573'>pFile</a>            27573 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L27574'>pFile</a>            27574 ext/sqlite3/libsqlite/sqlite3.c   char *zLockFile = (char *)pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L27581'>pFile</a>            27581 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock &gt; NO_LOCK ){</span>
<span class='curline'><a href='../S/1054.html#L27582'>pFile</a>            27582 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;eFileLock = eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L27602'>pFile</a>            27602 ext/sqlite3/libsqlite/sqlite3.c         storeLastErrno(pFile, tErrno);</span>
<span class='curline'><a href='../S/1054.html#L27609'>pFile</a>            27609 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;eFileLock = eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L27623'>pFile</a>            27623 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L27624'>pFile</a>            27624 ext/sqlite3/libsqlite/sqlite3.c   char *zLockFile = (char *)pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L27627'>pFile</a>            27627 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L27628'>pFile</a>            27628 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("UNLOCK  %d %d was %d pid=%d (dotlock)\n", pFile-&gt;h, eFileLock,</span>
<span class='curline'><a href='../S/1054.html#L27629'>pFile</a>            27629 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;eFileLock, osGetpid(0)));</span>
<span class='curline'><a href='../S/1054.html#L27633'>pFile</a>            27633 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock==eFileLock ){</span>
<span class='curline'><a href='../S/1054.html#L27641'>pFile</a>            27641 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;eFileLock = SHARED_LOCK;</span>
<span class='curline'><a href='../S/1054.html#L27656'>pFile</a>            27656 ext/sqlite3/libsqlite/sqlite3.c       storeLastErrno(pFile, tErrno);</span>
<span class='curline'><a href='../S/1054.html#L27660'>pFile</a>            27660 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;eFileLock = NO_LOCK;</span>
<span class='curline'><a href='../S/1054.html#L27670'>pFile</a>            27670 ext/sqlite3/libsqlite/sqlite3.c     unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L27672'>pFile</a>            27672 ext/sqlite3/libsqlite/sqlite3.c     sqlite3_free(pFile-&gt;lockingContext);</span>
<span class='curline'><a href='../S/1054.html#L27719'>pFile</a>            27719 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L27723'>pFile</a>            27723 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L27726'>pFile</a>            27726 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock&gt;SHARED_LOCK ){</span>
<span class='curline'><a href='../S/1054.html#L27733'>pFile</a>            27733 ext/sqlite3/libsqlite/sqlite3.c     int lrc = robust_flock(pFile-&gt;h, LOCK_EX | LOCK_NB);</span>
<span class='curline'><a href='../S/1054.html#L27736'>pFile</a>            27736 ext/sqlite3/libsqlite/sqlite3.c       lrc = robust_flock(pFile-&gt;h, LOCK_UN);</span>
<span class='curline'><a href='../S/1054.html#L27742'>pFile</a>            27742 ext/sqlite3/libsqlite/sqlite3.c           storeLastErrno(pFile, tErrno);</span>
<span class='curline'><a href='../S/1054.html#L27752'>pFile</a>            27752 ext/sqlite3/libsqlite/sqlite3.c         storeLastErrno(pFile, tErrno);</span>
<span class='curline'><a href='../S/1054.html#L27757'>pFile</a>            27757 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("TEST WR-LOCK %d %d %d (flock)\n", pFile-&gt;h, rc, reserved));</span>
<span class='curline'><a href='../S/1054.html#L27800'>pFile</a>            27800 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L27802'>pFile</a>            27802 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L27806'>pFile</a>            27806 ext/sqlite3/libsqlite/sqlite3.c   if (pFile-&gt;eFileLock &gt; NO_LOCK) {</span>
<span class='curline'><a href='../S/1054.html#L27807'>pFile</a>            27807 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;eFileLock = eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L27813'>pFile</a>            27813 ext/sqlite3/libsqlite/sqlite3.c   if (robust_flock(pFile-&gt;h, LOCK_EX | LOCK_NB)) {</span>
<span class='curline'><a href='../S/1054.html#L27818'>pFile</a>            27818 ext/sqlite3/libsqlite/sqlite3.c       storeLastErrno(pFile, tErrno);</span>
<span class='curline'><a href='../S/1054.html#L27822'>pFile</a>            27822 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;eFileLock = eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L27824'>pFile</a>            27824 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("LOCK    %d %s %s (flock)\n", pFile-&gt;h, azFileLock(eFileLock), </span>
<span class='curline'><a href='../S/1054.html#L27843'>pFile</a>            27843 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L27845'>pFile</a>            27845 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L27846'>pFile</a>            27846 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("UNLOCK  %d %d was %d pid=%d (flock)\n", pFile-&gt;h, eFileLock,</span>
<span class='curline'><a href='../S/1054.html#L27847'>pFile</a>            27847 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;eFileLock, osGetpid(0)));</span>
<span class='curline'><a href='../S/1054.html#L27851'>pFile</a>            27851 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock==eFileLock ){</span>
<span class='curline'><a href='../S/1054.html#L27857'>pFile</a>            27857 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;eFileLock = eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L27862'>pFile</a>            27862 ext/sqlite3/libsqlite/sqlite3.c   if( robust_flock(pFile-&gt;h, LOCK_UN) ){</span>
<span class='curline'><a href='../S/1054.html#L27868'>pFile</a>            27868 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;eFileLock = NO_LOCK;</span>
<span class='curline'><a href='../S/1054.html#L27911'>pFile</a>            27911 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L27915'>pFile</a>            27915 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L27918'>pFile</a>            27918 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock&gt;SHARED_LOCK ){</span>
<span class='curline'><a href='../S/1054.html#L27924'>pFile</a>            27924 ext/sqlite3/libsqlite/sqlite3.c     sem_t *pSem = pFile-&gt;pInode-&gt;pSem;</span>
<span class='curline'><a href='../S/1054.html#L27930'>pFile</a>            27930 ext/sqlite3/libsqlite/sqlite3.c         storeLastErrno(pFile, tErrno);</span>
<span class='curline'><a href='../S/1054.html#L27933'>pFile</a>            27933 ext/sqlite3/libsqlite/sqlite3.c         reserved = (pFile-&gt;eFileLock &lt; SHARED_LOCK);</span>
<span class='curline'><a href='../S/1054.html#L27940'>pFile</a>            27940 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("TEST WR-LOCK %d %d %d (sem)\n", pFile-&gt;h, rc, reserved));</span>
<span class='curline'><a href='../S/1054.html#L27976'>pFile</a>            27976 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L27977'>pFile</a>            27977 ext/sqlite3/libsqlite/sqlite3.c   sem_t *pSem = pFile-&gt;pInode-&gt;pSem;</span>
<span class='curline'><a href='../S/1054.html#L27982'>pFile</a>            27982 ext/sqlite3/libsqlite/sqlite3.c   if (pFile-&gt;eFileLock &gt; NO_LOCK) {</span>
<span class='curline'><a href='../S/1054.html#L27983'>pFile</a>            27983 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;eFileLock = eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L27995'>pFile</a>            27995 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;eFileLock = eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L28009'>pFile</a>            28009 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L28010'>pFile</a>            28010 ext/sqlite3/libsqlite/sqlite3.c   sem_t *pSem = pFile-&gt;pInode-&gt;pSem;</span>
<span class='curline'><a href='../S/1054.html#L28012'>pFile</a>            28012 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L28014'>pFile</a>            28014 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("UNLOCK  %d %d was %d pid=%d (sem)\n", pFile-&gt;h, eFileLock,</span>
<span class='curline'><a href='../S/1054.html#L28015'>pFile</a>            28015 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;eFileLock, osGetpid(0)));</span>
<span class='curline'><a href='../S/1054.html#L28019'>pFile</a>            28019 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock==eFileLock ){</span>
<span class='curline'><a href='../S/1054.html#L28025'>pFile</a>            28025 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;eFileLock = eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L28034'>pFile</a>            28034 ext/sqlite3/libsqlite/sqlite3.c       storeLastErrno(pFile, tErrno);</span>
<span class='curline'><a href='../S/1054.html#L28038'>pFile</a>            28038 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;eFileLock = NO_LOCK;</span>
<span class='curline'><a href='../S/1054.html#L28047'>pFile</a>            28047 ext/sqlite3/libsqlite/sqlite3.c     unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L28049'>pFile</a>            28049 ext/sqlite3/libsqlite/sqlite3.c     assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L28051'>pFile</a>            28051 ext/sqlite3/libsqlite/sqlite3.c     releaseInodeInfo(pFile);</span>
<span class='curline'><a href='../S/1054.html#L28106'>pFile</a>            28106 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile,               /* Open file descriptor on path */</span>
<span class='curline'><a href='../S/1054.html#L28118'>pFile</a>            28118 ext/sqlite3/libsqlite/sqlite3.c   pb.fd = pFile-&gt;h;</span>
<span class='curline'><a href='../S/1054.html#L28121'>pFile</a>            28121 ext/sqlite3/libsqlite/sqlite3.c     (setLockFlag?"ON":"OFF"), pFile-&gt;h, (pb.fd==-1?"[testval-1]":""),</span>
<span class='curline'><a href='../S/1054.html#L28136'>pFile</a>            28136 ext/sqlite3/libsqlite/sqlite3.c       storeLastErrno(pFile, tErrno);</span>
<span class='curline'><a href='../S/1054.html#L28153'>pFile</a>            28153 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L28158'>pFile</a>            28158 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L28159'>pFile</a>            28159 ext/sqlite3/libsqlite/sqlite3.c   context = (afpLockingContext *) pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L28167'>pFile</a>            28167 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;pInode-&gt;eFileLock&gt;SHARED_LOCK ){</span>
<span class='curline'><a href='../S/1054.html#L28175'>pFile</a>            28175 ext/sqlite3/libsqlite/sqlite3.c     int lrc = afpSetLock(context-&gt;dbPath, pFile, RESERVED_BYTE, 1,1);  </span>
<span class='curline'><a href='../S/1054.html#L28179'>pFile</a>            28179 ext/sqlite3/libsqlite/sqlite3.c       lrc = afpSetLock(context-&gt;dbPath, pFile, RESERVED_BYTE, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L28190'>pFile</a>            28190 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("TEST WR-LOCK %d %d %d (afp)\n", pFile-&gt;h, rc, reserved));</span>
<span class='curline'><a href='../S/1054.html#L28222'>pFile</a>            28222 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L28223'>pFile</a>            28223 ext/sqlite3/libsqlite/sqlite3.c   unixInodeInfo *pInode = pFile-&gt;pInode;</span>
<span class='curline'><a href='../S/1054.html#L28224'>pFile</a>            28224 ext/sqlite3/libsqlite/sqlite3.c   afpLockingContext *context = (afpLockingContext *) pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L28226'>pFile</a>            28226 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L28227'>pFile</a>            28227 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("LOCK    %d %s was %s(%s,%d) pid=%d (afp)\n", pFile-&gt;h,</span>
<span class='curline'><a href='../S/1054.html#L28228'>pFile</a>            28228 ext/sqlite3/libsqlite/sqlite3.c            azFileLock(eFileLock), azFileLock(pFile-&gt;eFileLock),</span>
<span class='curline'><a href='../S/1054.html#L28235'>pFile</a>            28235 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock&gt;=eFileLock ){</span>
<span class='curline'><a href='../S/1054.html#L28236'>pFile</a>            28236 ext/sqlite3/libsqlite/sqlite3.c     OSTRACE(("LOCK    %d %s ok (already held) (afp)\n", pFile-&gt;h,</span>
<span class='curline'><a href='../S/1054.html#L28246'>pFile</a>            28246 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile-&gt;eFileLock!=NO_LOCK || eFileLock==SHARED_LOCK );</span>
<span class='curline'><a href='../S/1054.html#L28248'>pFile</a>            28248 ext/sqlite3/libsqlite/sqlite3.c   assert( eFileLock!=RESERVED_LOCK || pFile-&gt;eFileLock==SHARED_LOCK );</span>
<span class='curline'><a href='../S/1054.html#L28253'>pFile</a>            28253 ext/sqlite3/libsqlite/sqlite3.c   pInode = pFile-&gt;pInode;</span>
<span class='curline'><a href='../S/1054.html#L28258'>pFile</a>            28258 ext/sqlite3/libsqlite/sqlite3.c   if( (pFile-&gt;eFileLock!=pInode-&gt;eFileLock &amp;&amp; </span>
<span class='curline'><a href='../S/1054.html#L28272'>pFile</a>            28272 ext/sqlite3/libsqlite/sqlite3.c     assert( pFile-&gt;eFileLock==0 );</span>
<span class='curline'><a href='../S/1054.html#L28274'>pFile</a>            28274 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;eFileLock = SHARED_LOCK;</span>
<span class='curline'><a href='../S/1054.html#L28285'>pFile</a>            28285 ext/sqlite3/libsqlite/sqlite3.c       || (eFileLock==EXCLUSIVE_LOCK &amp;&amp; pFile-&gt;eFileLock&lt;PENDING_LOCK)</span>
<span class='curline'><a href='../S/1054.html#L28288'>pFile</a>            28288 ext/sqlite3/libsqlite/sqlite3.c     failed = afpSetLock(context-&gt;dbPath, pFile, PENDING_BYTE, 1, 1);</span>
<span class='curline'><a href='../S/1054.html#L28310'>pFile</a>            28310 ext/sqlite3/libsqlite/sqlite3.c     lrc1 = afpSetLock(context-&gt;dbPath, pFile, </span>
<span class='curline'><a href='../S/1054.html#L28313'>pFile</a>            28313 ext/sqlite3/libsqlite/sqlite3.c       lrc1Errno = pFile-&gt;lastErrno;</span>
<span class='curline'><a href='../S/1054.html#L28316'>pFile</a>            28316 ext/sqlite3/libsqlite/sqlite3.c     lrc2 = afpSetLock(context-&gt;dbPath, pFile, PENDING_BYTE, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L28319'>pFile</a>            28319 ext/sqlite3/libsqlite/sqlite3.c       storeLastErrno(pFile, lrc1Errno);</span>
<span class='curline'><a href='../S/1054.html#L28328'>pFile</a>            28328 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;eFileLock = SHARED_LOCK;</span>
<span class='curline'><a href='../S/1054.html#L28342'>pFile</a>            28342 ext/sqlite3/libsqlite/sqlite3.c     assert( 0!=pFile-&gt;eFileLock );</span>
<span class='curline'><a href='../S/1054.html#L28343'>pFile</a>            28343 ext/sqlite3/libsqlite/sqlite3.c     if (eFileLock &gt;= RESERVED_LOCK &amp;&amp; pFile-&gt;eFileLock &lt; RESERVED_LOCK) {</span>
<span class='curline'><a href='../S/1054.html#L28345'>pFile</a>            28345 ext/sqlite3/libsqlite/sqlite3.c         failed = afpSetLock(context-&gt;dbPath, pFile, RESERVED_BYTE, 1,1);</span>
<span class='curline'><a href='../S/1054.html#L28356'>pFile</a>            28356 ext/sqlite3/libsqlite/sqlite3.c       if( !(failed = afpSetLock(context-&gt;dbPath, pFile, SHARED_FIRST +</span>
<span class='curline'><a href='../S/1054.html#L28360'>pFile</a>            28360 ext/sqlite3/libsqlite/sqlite3.c         failed = afpSetLock(context-&gt;dbPath, pFile, SHARED_FIRST, </span>
<span class='curline'><a href='../S/1054.html#L28362'>pFile</a>            28362 ext/sqlite3/libsqlite/sqlite3.c         if( failed &amp;&amp; (failed2 = afpSetLock(context-&gt;dbPath, pFile, </span>
<span class='curline'><a href='../S/1054.html#L28381'>pFile</a>            28381 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;eFileLock = eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L28384'>pFile</a>            28384 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;eFileLock = PENDING_LOCK;</span>
<span class='curline'><a href='../S/1054.html#L28390'>pFile</a>            28390 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("LOCK    %d %s %s (afp)\n", pFile-&gt;h, azFileLock(eFileLock), </span>
<span class='curline'><a href='../S/1054.html#L28404'>pFile</a>            28404 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L28406'>pFile</a>            28406 ext/sqlite3/libsqlite/sqlite3.c   afpLockingContext *context = (afpLockingContext *) pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L28409'>pFile</a>            28409 ext/sqlite3/libsqlite/sqlite3.c   int h = pFile-&gt;h;</span>
<span class='curline'><a href='../S/1054.html#L28412'>pFile</a>            28412 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L28413'>pFile</a>            28413 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("UNLOCK  %d %d was %d(%d,%d) pid=%d (afp)\n", pFile-&gt;h, eFileLock,</span>
<span class='curline'><a href='../S/1054.html#L28414'>pFile</a>            28414 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;eFileLock, pFile-&gt;pInode-&gt;eFileLock, pFile-&gt;pInode-&gt;nShared,</span>
<span class='curline'><a href='../S/1054.html#L28418'>pFile</a>            28418 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock&lt;=eFileLock ){</span>
<span class='curline'><a href='../S/1054.html#L28422'>pFile</a>            28422 ext/sqlite3/libsqlite/sqlite3.c   pInode = pFile-&gt;pInode;</span>
<span class='curline'><a href='../S/1054.html#L28424'>pFile</a>            28424 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock&gt;SHARED_LOCK ){</span>
<span class='curline'><a href='../S/1054.html#L28425'>pFile</a>            28425 ext/sqlite3/libsqlite/sqlite3.c     assert( pInode-&gt;eFileLock==pFile-&gt;eFileLock );</span>
<span class='curline'><a href='../S/1054.html#L28439'>pFile</a>            28439 ext/sqlite3/libsqlite/sqlite3.c     assert( pFile-&gt;inNormalWrite==0</span>
<span class='curline'><a href='../S/1054.html#L28440'>pFile</a>            28440 ext/sqlite3/libsqlite/sqlite3.c            || pFile-&gt;dbUpdate==0</span>
<span class='curline'><a href='../S/1054.html#L28441'>pFile</a>            28441 ext/sqlite3/libsqlite/sqlite3.c            || pFile-&gt;transCntrChng==1 );</span>
<span class='curline'><a href='../S/1054.html#L28442'>pFile</a>            28442 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;inNormalWrite = 0;</span>
<span class='curline'><a href='../S/1054.html#L28445'>pFile</a>            28445 ext/sqlite3/libsqlite/sqlite3.c     if( pFile-&gt;eFileLock==EXCLUSIVE_LOCK ){</span>
<span class='curline'><a href='../S/1054.html#L28446'>pFile</a>            28446 ext/sqlite3/libsqlite/sqlite3.c       rc = afpSetLock(context-&gt;dbPath, pFile, SHARED_FIRST, SHARED_SIZE, 0);</span>
<span class='curline'><a href='../S/1054.html#L28450'>pFile</a>            28450 ext/sqlite3/libsqlite/sqlite3.c         rc = afpSetLock(context-&gt;dbPath, pFile, sharedLockByte, 1, 1);</span>
<span class='curline'><a href='../S/1054.html#L28455'>pFile</a>            28455 ext/sqlite3/libsqlite/sqlite3.c     if( rc==SQLITE_OK &amp;&amp; pFile-&gt;eFileLock&gt;=PENDING_LOCK ){</span>
<span class='curline'><a href='../S/1054.html#L28456'>pFile</a>            28456 ext/sqlite3/libsqlite/sqlite3.c       rc = afpSetLock(context-&gt;dbPath, pFile, PENDING_BYTE, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L28458'>pFile</a>            28458 ext/sqlite3/libsqlite/sqlite3.c     if( rc==SQLITE_OK &amp;&amp; pFile-&gt;eFileLock&gt;=RESERVED_LOCK &amp;&amp; context-&gt;reserved ){</span>
<span class='curline'><a href='../S/1054.html#L28459'>pFile</a>            28459 ext/sqlite3/libsqlite/sqlite3.c       rc = afpSetLock(context-&gt;dbPath, pFile, RESERVED_BYTE, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L28481'>pFile</a>            28481 ext/sqlite3/libsqlite/sqlite3.c         rc = afpSetLock(context-&gt;dbPath, pFile, sharedLockByte, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L28485'>pFile</a>            28485 ext/sqlite3/libsqlite/sqlite3.c         pFile-&gt;eFileLock = NO_LOCK;</span>
<span class='curline'><a href='../S/1054.html#L28492'>pFile</a>            28492 ext/sqlite3/libsqlite/sqlite3.c         closePendingFds(pFile);</span>
<span class='curline'><a href='../S/1054.html#L28498'>pFile</a>            28498 ext/sqlite3/libsqlite/sqlite3.c   if( rc==SQLITE_OK ) pFile-&gt;eFileLock = eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L28508'>pFile</a>            28508 ext/sqlite3/libsqlite/sqlite3.c     unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L28511'>pFile</a>            28511 ext/sqlite3/libsqlite/sqlite3.c     if( pFile-&gt;pInode &amp;&amp; pFile-&gt;pInode-&gt;nLock ){</span>
<span class='curline'><a href='../S/1054.html#L28517'>pFile</a>            28517 ext/sqlite3/libsqlite/sqlite3.c       setPendingFd(pFile);</span>
<span class='curline'><a href='../S/1054.html#L28519'>pFile</a>            28519 ext/sqlite3/libsqlite/sqlite3.c     releaseInodeInfo(pFile);</span>
<span class='curline'><a href='../S/1054.html#L28520'>pFile</a>            28520 ext/sqlite3/libsqlite/sqlite3.c     sqlite3_free(pFile-&gt;lockingContext);</span>
<span class='curline'><a href='../S/1054.html#L28644'>pFile</a>            28644 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile *)id;</span>
<span class='curline'><a href='../S/1054.html#L28653'>pFile</a>            28653 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile-&gt;pUnused==0</span>
<span class='curline'><a href='../S/1054.html#L28662'>pFile</a>            28662 ext/sqlite3/libsqlite/sqlite3.c   if( offset&lt;pFile-&gt;mmapSize ){</span>
<span class='curline'><a href='../S/1054.html#L28663'>pFile</a>            28663 ext/sqlite3/libsqlite/sqlite3.c     if( offset+amt &lt;= pFile-&gt;mmapSize ){</span>
<span class='curline'><a href='../S/1054.html#L28664'>pFile</a>            28664 ext/sqlite3/libsqlite/sqlite3.c       memcpy(pBuf, &amp;((u8 *)(pFile-&gt;pMapRegion))[offset], amt);</span>
<span class='curline'><a href='../S/1054.html#L28667'>pFile</a>            28667 ext/sqlite3/libsqlite/sqlite3.c       int nCopy = pFile-&gt;mmapSize - offset;</span>
<span class='curline'><a href='../S/1054.html#L28668'>pFile</a>            28668 ext/sqlite3/libsqlite/sqlite3.c       memcpy(pBuf, &amp;((u8 *)(pFile-&gt;pMapRegion))[offset], nCopy);</span>
<span class='curline'><a href='../S/1054.html#L28676'>pFile</a>            28676 ext/sqlite3/libsqlite/sqlite3.c   got = seekAndRead(pFile, offset, pBuf, amt);</span>
<span class='curline'><a href='../S/1054.html#L28683'>pFile</a>            28683 ext/sqlite3/libsqlite/sqlite3.c     storeLastErrno(pFile, 0);   /* not a system error */</span>
<span class='curline'><a href='../S/1054.html#L28758'>pFile</a>            28758 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L28766'>pFile</a>            28766 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile-&gt;pUnused==0</span>
<span class='curline'><a href='../S/1054.html#L28779'>pFile</a>            28779 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;inNormalWrite ){</span>
<span class='curline'><a href='../S/1054.html#L28780'>pFile</a>            28780 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;dbUpdate = 1;  /* The database has been modified */</span>
<span class='curline'><a href='../S/1054.html#L28785'>pFile</a>            28785 ext/sqlite3/libsqlite/sqlite3.c       rc = seekAndRead(pFile, 24, oldCntr, 4);</span>
<span class='curline'><a href='../S/1054.html#L28788'>pFile</a>            28788 ext/sqlite3/libsqlite/sqlite3.c         pFile-&gt;transCntrChng = 1;  /* The transaction counter has changed */</span>
<span class='curline'><a href='../S/1054.html#L28797'>pFile</a>            28797 ext/sqlite3/libsqlite/sqlite3.c   if( offset&lt;pFile-&gt;mmapSize ){</span>
<span class='curline'><a href='../S/1054.html#L28798'>pFile</a>            28798 ext/sqlite3/libsqlite/sqlite3.c     if( offset+amt &lt;= pFile-&gt;mmapSize ){</span>
<span class='curline'><a href='../S/1054.html#L28799'>pFile</a>            28799 ext/sqlite3/libsqlite/sqlite3.c       memcpy(&amp;((u8 *)(pFile-&gt;pMapRegion))[offset], pBuf, amt);</span>
<span class='curline'><a href='../S/1054.html#L28802'>pFile</a>            28802 ext/sqlite3/libsqlite/sqlite3.c       int nCopy = pFile-&gt;mmapSize - offset;</span>
<span class='curline'><a href='../S/1054.html#L28803'>pFile</a>            28803 ext/sqlite3/libsqlite/sqlite3.c       memcpy(&amp;((u8 *)(pFile-&gt;pMapRegion))[offset], pBuf, nCopy);</span>
<span class='curline'><a href='../S/1054.html#L28811'>pFile</a>            28811 ext/sqlite3/libsqlite/sqlite3.c   while( amt&gt;0 &amp;&amp; (wrote = seekAndWrite(pFile, offset, pBuf, amt))&gt;0 ){</span>
<span class='curline'><a href='../S/1054.html#L28820'>pFile</a>            28820 ext/sqlite3/libsqlite/sqlite3.c     if( wrote&lt;0 &amp;&amp; pFile-&gt;lastErrno!=ENOSPC ){</span>
<span class='curline'><a href='../S/1054.html#L28824'>pFile</a>            28824 ext/sqlite3/libsqlite/sqlite3.c       storeLastErrno(pFile, 0); /* not a system error */</span>
<span class='curline'><a href='../S/1054.html#L29013'>pFile</a>            29013 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L29028'>pFile</a>            29028 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L29029'>pFile</a>            29029 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("SYNC    %-3d\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L29030'>pFile</a>            29030 ext/sqlite3/libsqlite/sqlite3.c   rc = full_fsync(pFile-&gt;h, isFullsync, isDataOnly);</span>
<span class='curline'><a href='../S/1054.html#L29033'>pFile</a>            29033 ext/sqlite3/libsqlite/sqlite3.c     storeLastErrno(pFile, errno);</span>
<span class='curline'><a href='../S/1054.html#L29034'>pFile</a>            29034 ext/sqlite3/libsqlite/sqlite3.c     return unixLogError(SQLITE_IOERR_FSYNC, "full_fsync", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L29041'>pFile</a>            29041 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;ctrlFlags &amp; UNIXFILE_DIRSYNC ){</span>
<span class='curline'><a href='../S/1054.html#L29043'>pFile</a>            29043 ext/sqlite3/libsqlite/sqlite3.c     OSTRACE(("DIRSYNC %s (have_fullfsync=%d fullsync=%d)\n", pFile-&gt;zPath,</span>
<span class='curline'><a href='../S/1054.html#L29045'>pFile</a>            29045 ext/sqlite3/libsqlite/sqlite3.c     rc = osOpenDirectory(pFile-&gt;zPath, &amp;dirfd);</span>
<span class='curline'><a href='../S/1054.html#L29048'>pFile</a>            29048 ext/sqlite3/libsqlite/sqlite3.c       robust_close(pFile, dirfd, __LINE__);</span>
<span class='curline'><a href='../S/1054.html#L29052'>pFile</a>            29052 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;ctrlFlags &amp;= ~UNIXFILE_DIRSYNC;</span>
<span class='curline'><a href='../S/1054.html#L29061'>pFile</a>            29061 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile *)id;</span>
<span class='curline'><a href='../S/1054.html#L29063'>pFile</a>            29063 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L29071'>pFile</a>            29071 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;szChunk&gt;0 ){</span>
<span class='curline'><a href='../S/1054.html#L29072'>pFile</a>            29072 ext/sqlite3/libsqlite/sqlite3.c     nByte = ((nByte + pFile-&gt;szChunk - 1)/pFile-&gt;szChunk) * pFile-&gt;szChunk;</span>
<span class='curline'><a href='../S/1054.html#L29075'>pFile</a>            29075 ext/sqlite3/libsqlite/sqlite3.c   rc = robust_ftruncate(pFile-&gt;h, nByte);</span>
<span class='curline'><a href='../S/1054.html#L29077'>pFile</a>            29077 ext/sqlite3/libsqlite/sqlite3.c     storeLastErrno(pFile, errno);</span>
<span class='curline'><a href='../S/1054.html#L29078'>pFile</a>            29078 ext/sqlite3/libsqlite/sqlite3.c     return unixLogError(SQLITE_IOERR_TRUNCATE, "ftruncate", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L29088'>pFile</a>            29088 ext/sqlite3/libsqlite/sqlite3.c     if( pFile-&gt;inNormalWrite &amp;&amp; nByte==0 ){</span>
<span class='curline'><a href='../S/1054.html#L29089'>pFile</a>            29089 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;transCntrChng = 1;</span>
<span class='curline'><a href='../S/1054.html#L29098'>pFile</a>            29098 ext/sqlite3/libsqlite/sqlite3.c     if( nByte&lt;pFile-&gt;mmapSize ){</span>
<span class='curline'><a href='../S/1054.html#L29099'>pFile</a>            29099 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;mmapSize = nByte;</span>
<span class='curline'><a href='../S/1054.html#L29148'>pFile</a>            29148 ext/sqlite3/libsqlite/sqlite3.c static int fcntlSizeHint(unixFile *pFile, i64 nByte){</span>
<span class='curline'><a href='../S/1054.html#L29149'>pFile</a>            29149 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;szChunk&gt;0 ){</span>
<span class='curline'><a href='../S/1054.html#L29153'>pFile</a>            29153 ext/sqlite3/libsqlite/sqlite3.c     if( osFstat(pFile-&gt;h, &amp;buf) ){</span>
<span class='curline'><a href='../S/1054.html#L29157'>pFile</a>            29157 ext/sqlite3/libsqlite/sqlite3.c     nSize = ((nByte+pFile-&gt;szChunk-1) / pFile-&gt;szChunk) * pFile-&gt;szChunk;</span>
<span class='curline'><a href='../S/1054.html#L29166'>pFile</a>            29166 ext/sqlite3/libsqlite/sqlite3.c         err = osFallocate(pFile-&gt;h, buf.st_size, nSize-buf.st_size);</span>
<span class='curline'><a href='../S/1054.html#L29186'>pFile</a>            29186 ext/sqlite3/libsqlite/sqlite3.c         nWrite = seekAndWrite(pFile, iWrite, "", 1);</span>
<span class='curline'><a href='../S/1054.html#L29190'>pFile</a>            29190 ext/sqlite3/libsqlite/sqlite3.c         nWrite = seekAndWrite(pFile, nSize-1, "", 1);</span>
<span class='curline'><a href='../S/1054.html#L29198'>pFile</a>            29198 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;mmapSizeMax&gt;0 &amp;&amp; nByte&gt;pFile-&gt;mmapSize ){</span>
<span class='curline'><a href='../S/1054.html#L29200'>pFile</a>            29200 ext/sqlite3/libsqlite/sqlite3.c     if( pFile-&gt;szChunk&lt;=0 ){</span>
<span class='curline'><a href='../S/1054.html#L29201'>pFile</a>            29201 ext/sqlite3/libsqlite/sqlite3.c       if( robust_ftruncate(pFile-&gt;h, nByte) ){</span>
<span class='curline'><a href='../S/1054.html#L29202'>pFile</a>            29202 ext/sqlite3/libsqlite/sqlite3.c         storeLastErrno(pFile, errno);</span>
<span class='curline'><a href='../S/1054.html#L29203'>pFile</a>            29203 ext/sqlite3/libsqlite/sqlite3.c         return unixLogError(SQLITE_IOERR_TRUNCATE, "ftruncate", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L29207'>pFile</a>            29207 ext/sqlite3/libsqlite/sqlite3.c     rc = unixMapfile(pFile, nByte);</span>
<span class='curline'><a href='../S/1054.html#L29221'>pFile</a>            29221 ext/sqlite3/libsqlite/sqlite3.c static void unixModeBit(unixFile *pFile, unsigned char mask, int *pArg){</span>
<span class='curline'><a href='../S/1054.html#L29223'>pFile</a>            29223 ext/sqlite3/libsqlite/sqlite3.c     *pArg = (pFile-&gt;ctrlFlags &amp; mask)!=0;</span>
<span class='curline'><a href='../S/1054.html#L29225'>pFile</a>            29225 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;ctrlFlags &amp;= ~mask;</span>
<span class='curline'><a href='../S/1054.html#L29227'>pFile</a>            29227 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;ctrlFlags |= mask;</span>
<span class='curline'><a href='../S/1054.html#L29238'>pFile</a>            29238 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L29245'>pFile</a>            29245 ext/sqlite3/libsqlite/sqlite3.c       *(int*)pArg = pFile-&gt;eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L29249'>pFile</a>            29249 ext/sqlite3/libsqlite/sqlite3.c       *(int*)pArg = pFile-&gt;lastErrno;</span>
<span class='curline'><a href='../S/1054.html#L29253'>pFile</a>            29253 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;szChunk = *(int *)pArg;</span>
<span class='curline'><a href='../S/1054.html#L29259'>pFile</a>            29259 ext/sqlite3/libsqlite/sqlite3.c       rc = fcntlSizeHint(pFile, *(i64 *)pArg);</span>
<span class='curline'><a href='../S/1054.html#L29264'>pFile</a>            29264 ext/sqlite3/libsqlite/sqlite3.c       unixModeBit(pFile, UNIXFILE_PERSIST_WAL, (int*)pArg);</span>
<span class='curline'><a href='../S/1054.html#L29268'>pFile</a>            29268 ext/sqlite3/libsqlite/sqlite3.c       unixModeBit(pFile, UNIXFILE_PSOW, (int*)pArg);</span>
<span class='curline'><a href='../S/1054.html#L29272'>pFile</a>            29272 ext/sqlite3/libsqlite/sqlite3.c       *(char**)pArg = sqlite3_mprintf("%s", pFile-&gt;pVfs-&gt;zName);</span>
<span class='curline'><a href='../S/1054.html#L29276'>pFile</a>            29276 ext/sqlite3/libsqlite/sqlite3.c       char *zTFile = sqlite3_malloc64( pFile-&gt;pVfs-&gt;mxPathname );</span>
<span class='curline'><a href='../S/1054.html#L29278'>pFile</a>            29278 ext/sqlite3/libsqlite/sqlite3.c         unixGetTempname(pFile-&gt;pVfs-&gt;mxPathname, zTFile);</span>
<span class='curline'><a href='../S/1054.html#L29284'>pFile</a>            29284 ext/sqlite3/libsqlite/sqlite3.c       *(int*)pArg = fileHasMoved(pFile);</span>
<span class='curline'><a href='../S/1054.html#L29294'>pFile</a>            29294 ext/sqlite3/libsqlite/sqlite3.c       *(i64*)pArg = pFile-&gt;mmapSizeMax;</span>
<span class='curline'><a href='../S/1054.html#L29295'>pFile</a>            29295 ext/sqlite3/libsqlite/sqlite3.c       if( newLimit&gt;=0 &amp;&amp; newLimit!=pFile-&gt;mmapSizeMax &amp;&amp; pFile-&gt;nFetchOut==0 ){</span>
<span class='curline'><a href='../S/1054.html#L29296'>pFile</a>            29296 ext/sqlite3/libsqlite/sqlite3.c         pFile-&gt;mmapSizeMax = newLimit;</span>
<span class='curline'><a href='../S/1054.html#L29297'>pFile</a>            29297 ext/sqlite3/libsqlite/sqlite3.c         if( pFile-&gt;mmapSize&gt;0 ){</span>
<span class='curline'><a href='../S/1054.html#L29298'>pFile</a>            29298 ext/sqlite3/libsqlite/sqlite3.c           unixUnmapfile(pFile);</span>
<span class='curline'><a href='../S/1054.html#L29299'>pFile</a>            29299 ext/sqlite3/libsqlite/sqlite3.c           rc = unixMapfile(pFile, -1);</span>
<span class='curline'><a href='../S/1054.html#L29350'>pFile</a>            29350 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L29351'>pFile</a>            29351 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;sectorSize == 0 ){</span>
<span class='curline'><a href='../S/1054.html#L29355'>pFile</a>            29355 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;sectorSize = SQLITE_DEFAULT_SECTOR_SIZE;</span>
<span class='curline'><a href='../S/1054.html#L29356'>pFile</a>            29356 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;deviceCharacteristics = 0;</span>
<span class='curline'><a href='../S/1054.html#L29357'>pFile</a>            29357 ext/sqlite3/libsqlite/sqlite3.c     if( fstatvfs(pFile-&gt;h, &amp;fsInfo) == -1 ) {</span>
<span class='curline'><a href='../S/1054.html#L29358'>pFile</a>            29358 ext/sqlite3/libsqlite/sqlite3.c       return pFile-&gt;sectorSize;</span>
<span class='curline'><a href='../S/1054.html#L29362'>pFile</a>            29362 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;sectorSize = fsInfo.f_bsize;</span>
<span class='curline'><a href='../S/1054.html#L29363'>pFile</a>            29363 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;deviceCharacteristics =</span>
<span class='curline'><a href='../S/1054.html#L29371'>pFile</a>            29371 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;sectorSize = fsInfo.f_bsize;</span>
<span class='curline'><a href='../S/1054.html#L29372'>pFile</a>            29372 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;deviceCharacteristics =</span>
<span class='curline'><a href='../S/1054.html#L29374'>pFile</a>            29374 ext/sqlite3/libsqlite/sqlite3.c         (pFile-&gt;sectorSize / 512 * SQLITE_IOCAP_ATOMIC512) |</span>
<span class='curline'><a href='../S/1054.html#L29381'>pFile</a>            29381 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;sectorSize = fsInfo.f_bsize;</span>
<span class='curline'><a href='../S/1054.html#L29382'>pFile</a>            29382 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;deviceCharacteristics =</span>
<span class='curline'><a href='../S/1054.html#L29390'>pFile</a>            29390 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;sectorSize = fsInfo.f_bsize;</span>
<span class='curline'><a href='../S/1054.html#L29391'>pFile</a>            29391 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;deviceCharacteristics =</span>
<span class='curline'><a href='../S/1054.html#L29393'>pFile</a>            29393 ext/sqlite3/libsqlite/sqlite3.c         ((pFile-&gt;sectorSize / 512 * SQLITE_IOCAP_ATOMIC512) &lt;&lt; 1) - 2 |</span>
<span class='curline'><a href='../S/1054.html#L29398'>pFile</a>            29398 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;sectorSize = fsInfo.f_bsize;</span>
<span class='curline'><a href='../S/1054.html#L29399'>pFile</a>            29399 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;deviceCharacteristics =</span>
<span class='curline'><a href='../S/1054.html#L29401'>pFile</a>            29401 ext/sqlite3/libsqlite/sqlite3.c         ((pFile-&gt;sectorSize / 512 * SQLITE_IOCAP_ATOMIC512) &lt;&lt; 1) - 2 |</span>
<span class='curline'><a href='../S/1054.html#L29406'>pFile</a>            29406 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;deviceCharacteristics =</span>
<span class='curline'><a href='../S/1054.html#L29415'>pFile</a>            29415 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;sectorSize % 512 != 0 ){</span>
<span class='curline'><a href='../S/1054.html#L29416'>pFile</a>            29416 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;deviceCharacteristics = 0;</span>
<span class='curline'><a href='../S/1054.html#L29417'>pFile</a>            29417 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;sectorSize = SQLITE_DEFAULT_SECTOR_SIZE;</span>
<span class='curline'><a href='../S/1054.html#L29419'>pFile</a>            29419 ext/sqlite3/libsqlite/sqlite3.c   return pFile-&gt;sectorSize;</span>
<span class='curline'><a href='../S/1054.html#L29553'>pFile</a>            29553 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile,       /* Open connection to the WAL file */</span>
<span class='curline'><a href='../S/1054.html#L29563'>pFile</a>            29563 ext/sqlite3/libsqlite/sqlite3.c   pShmNode = pFile-&gt;pInode-&gt;pShmNode;</span>
<span class='curline'><a href='../S/1054.html#L29581'>pFile</a>            29581 ext/sqlite3/libsqlite/sqlite3.c     lkType = (pFile-&gt;ctrlFlags &amp; UNIXFILE_BLOCK)!=0 ? F_SETLKW : F_SETLK;</span>
<span class='curline'><a href='../S/1054.html#L29584'>pFile</a>            29584 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;ctrlFlags &amp;= ~UNIXFILE_BLOCK;</span>
<span class='curline'><a href='../S/1054.html#L31118'>pFile</a>            31118 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_file *pFile,         /* The file descriptor to be filled in */</span>
<span class='curline'><a href='../S/1054.html#L31122'>pFile</a>            31122 ext/sqlite3/libsqlite/sqlite3.c   unixFile *p = (unixFile *)pFile;</span>
<span class='curline'><a href='../S/1054.html#L31311'>pFile</a>            31311 ext/sqlite3/libsqlite/sqlite3.c     ((unixFile*)pFile)-&gt;fsFlags |= SQLITE_FSFLAGS_IS_MSDOS;</span>
<span class='curline'><a href='../S/1054.html#L31314'>pFile</a>            31314 ext/sqlite3/libsqlite/sqlite3.c     ((unixFile*)pFile)-&gt;fsFlags |= SQLITE_FSFLAGS_IS_MSDOS;</span>
<span class='curline'><a href='../S/1054.html#L31341'>pFile</a>            31341 ext/sqlite3/libsqlite/sqlite3.c       rc = fillInUnixFile(pVfs, fd, pFile, zPath, ctrlFlags);</span>
<span class='curline'><a href='../S/1054.html#L31343'>pFile</a>            31343 ext/sqlite3/libsqlite/sqlite3.c         rc = proxyTransformUnixFile((unixFile*)pFile, ":auto:");</span>
<span class='curline'><a href='../S/1054.html#L31349'>pFile</a>            31349 ext/sqlite3/libsqlite/sqlite3.c           unixClose(pFile);</span>
<span class='curline'><a href='../S/1054.html#L31358'>pFile</a>            31358 ext/sqlite3/libsqlite/sqlite3.c   rc = fillInUnixFile(pVfs, fd, pFile, zPath, ctrlFlags);</span>
<span class='curline'><a href='../S/1054.html#L32108'>pFile</a>            32108 ext/sqlite3/libsqlite/sqlite3.c static int proxyBreakConchLock(unixFile *pFile, uuid_t myHostID){</span>
<span class='curline'><a href='../S/1054.html#L32109'>pFile</a>            32109 ext/sqlite3/libsqlite/sqlite3.c   proxyLockingContext *pCtx = (proxyLockingContext *)pFile-&gt;lockingContext; </span>
<span class='curline'><a href='../S/1054.html#L32150'>pFile</a>            32150 ext/sqlite3/libsqlite/sqlite3.c   robust_close(pFile, conchFile-&gt;h, __LINE__);</span>
<span class='curline'><a href='../S/1054.html#L32158'>pFile</a>            32158 ext/sqlite3/libsqlite/sqlite3.c       robust_close(pFile, fd, __LINE__);</span>
<span class='curline'><a href='../S/1054.html#L32168'>pFile</a>            32168 ext/sqlite3/libsqlite/sqlite3.c static int proxyConchLock(unixFile *pFile, uuid_t myHostID, int lockType){</span>
<span class='curline'><a href='../S/1054.html#L32169'>pFile</a>            32169 ext/sqlite3/libsqlite/sqlite3.c   proxyLockingContext *pCtx = (proxyLockingContext *)pFile-&gt;lockingContext; </span>
<span class='curline'><a href='../S/1054.html#L32188'>pFile</a>            32188 ext/sqlite3/libsqlite/sqlite3.c         storeLastErrno(pFile, errno);</span>
<span class='curline'><a href='../S/1054.html#L32208'>pFile</a>            32208 ext/sqlite3/libsqlite/sqlite3.c           storeLastErrno(pFile, errno);</span>
<span class='curline'><a href='../S/1054.html#L32225'>pFile</a>            32225 ext/sqlite3/libsqlite/sqlite3.c       if( 0==proxyBreakConchLock(pFile, myHostID) ){</span>
<span class='curline'><a href='../S/1054.html#L32246'>pFile</a>            32246 ext/sqlite3/libsqlite/sqlite3.c static int proxyTakeConch(unixFile *pFile){</span>
<span class='curline'><a href='../S/1054.html#L32247'>pFile</a>            32247 ext/sqlite3/libsqlite/sqlite3.c   proxyLockingContext *pCtx = (proxyLockingContext *)pFile-&gt;lockingContext; </span>
<span class='curline'><a href='../S/1054.html#L32271'>pFile</a>            32271 ext/sqlite3/libsqlite/sqlite3.c       storeLastErrno(pFile, pError);</span>
<span class='curline'><a href='../S/1054.html#L32274'>pFile</a>            32274 ext/sqlite3/libsqlite/sqlite3.c     rc = proxyConchLock(pFile, myHostID, SHARED_LOCK);</span>
<span class='curline'><a href='../S/1054.html#L32282'>pFile</a>            32282 ext/sqlite3/libsqlite/sqlite3.c       storeLastErrno(pFile, conchFile-&gt;lastErrno);</span>
<span class='curline'><a href='../S/1054.html#L32352'>pFile</a>            32352 ext/sqlite3/libsqlite/sqlite3.c           rc = proxyConchLock(pFile, myHostID, EXCLUSIVE_LOCK);</span>
<span class='curline'><a href='../S/1054.html#L32355'>pFile</a>            32355 ext/sqlite3/libsqlite/sqlite3.c         rc = proxyConchLock(pFile, myHostID, EXCLUSIVE_LOCK);</span>
<span class='curline'><a href='../S/1054.html#L32378'>pFile</a>            32378 ext/sqlite3/libsqlite/sqlite3.c           int err = osFstat(pFile-&gt;h, &amp;buf);</span>
<span class='curline'><a href='../S/1054.html#L32407'>pFile</a>            32407 ext/sqlite3/libsqlite/sqlite3.c       OSTRACE(("TRANSPROXY: CLOSE  %d\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L32408'>pFile</a>            32408 ext/sqlite3/libsqlite/sqlite3.c       if( rc==SQLITE_OK &amp;&amp; pFile-&gt;openFlags ){</span>
<span class='curline'><a href='../S/1054.html#L32410'>pFile</a>            32410 ext/sqlite3/libsqlite/sqlite3.c         if( pFile-&gt;h&gt;=0 ){</span>
<span class='curline'><a href='../S/1054.html#L32411'>pFile</a>            32411 ext/sqlite3/libsqlite/sqlite3.c           robust_close(pFile, pFile-&gt;h, __LINE__);</span>
<span class='curline'><a href='../S/1054.html#L32413'>pFile</a>            32413 ext/sqlite3/libsqlite/sqlite3.c         pFile-&gt;h = -1;</span>
<span class='curline'><a href='../S/1054.html#L32414'>pFile</a>            32414 ext/sqlite3/libsqlite/sqlite3.c         fd = robust_open(pCtx-&gt;dbPath, pFile-&gt;openFlags, 0);</span>
<span class='curline'><a href='../S/1054.html#L32417'>pFile</a>            32417 ext/sqlite3/libsqlite/sqlite3.c           pFile-&gt;h = fd;</span>
<span class='curline'><a href='../S/1054.html#L32468'>pFile</a>            32468 ext/sqlite3/libsqlite/sqlite3.c static int proxyReleaseConch(unixFile *pFile){</span>
<span class='curline'><a href='../S/1054.html#L32473'>pFile</a>            32473 ext/sqlite3/libsqlite/sqlite3.c   pCtx = (proxyLockingContext *)pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L32535'>pFile</a>            32535 ext/sqlite3/libsqlite/sqlite3.c static int switchLockProxyPath(unixFile *pFile, const char *path) {</span>
<span class='curline'><a href='../S/1054.html#L32536'>pFile</a>            32536 ext/sqlite3/libsqlite/sqlite3.c   proxyLockingContext *pCtx = (proxyLockingContext*)pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L32540'>pFile</a>            32540 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock!=NO_LOCK ){</span>
<span class='curline'><a href='../S/1054.html#L32571'>pFile</a>            32571 ext/sqlite3/libsqlite/sqlite3.c static int proxyGetDbPathForUnixFile(unixFile *pFile, char *dbPath){</span>
<span class='curline'><a href='../S/1054.html#L32573'>pFile</a>            32573 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;pMethod == &amp;afpIoMethods ){</span>
<span class='curline'><a href='../S/1054.html#L32576'>pFile</a>            32576 ext/sqlite3/libsqlite/sqlite3.c     assert( (int)strlen((char*)pFile-&gt;lockingContext)&lt;=MAXPATHLEN );</span>
<span class='curline'><a href='../S/1054.html#L32577'>pFile</a>            32577 ext/sqlite3/libsqlite/sqlite3.c     strlcpy(dbPath, ((afpLockingContext *)pFile-&gt;lockingContext)-&gt;dbPath,</span>
<span class='curline'><a href='../S/1054.html#L32581'>pFile</a>            32581 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;pMethod == &amp;dotlockIoMethods ){</span>
<span class='curline'><a href='../S/1054.html#L32584'>pFile</a>            32584 ext/sqlite3/libsqlite/sqlite3.c     int len = strlen((char *)pFile-&gt;lockingContext) - strlen(DOTLOCK_SUFFIX);</span>
<span class='curline'><a href='../S/1054.html#L32585'>pFile</a>            32585 ext/sqlite3/libsqlite/sqlite3.c     memcpy(dbPath, (char *)pFile-&gt;lockingContext, len + 1);</span>
<span class='curline'><a href='../S/1054.html#L32588'>pFile</a>            32588 ext/sqlite3/libsqlite/sqlite3.c     assert( strlen((char*)pFile-&gt;lockingContext)&lt;=MAXPATHLEN );</span>
<span class='curline'><a href='../S/1054.html#L32589'>pFile</a>            32589 ext/sqlite3/libsqlite/sqlite3.c     strlcpy(dbPath, (char *)pFile-&gt;lockingContext, MAXPATHLEN);</span>
<span class='curline'><a href='../S/1054.html#L32602'>pFile</a>            32602 ext/sqlite3/libsqlite/sqlite3.c static int proxyTransformUnixFile(unixFile *pFile, const char *path) {</span>
<span class='curline'><a href='../S/1054.html#L32608'>pFile</a>            32608 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;eFileLock!=NO_LOCK ){</span>
<span class='curline'><a href='../S/1054.html#L32611'>pFile</a>            32611 ext/sqlite3/libsqlite/sqlite3.c   proxyGetDbPathForUnixFile(pFile, dbPath);</span>
<span class='curline'><a href='../S/1054.html#L32618'>pFile</a>            32618 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("TRANSPROXY  %d for %s pid=%d\n", pFile-&gt;h,</span>
<span class='curline'><a href='../S/1054.html#L32630'>pFile</a>            32630 ext/sqlite3/libsqlite/sqlite3.c     if( rc==SQLITE_CANTOPEN &amp;&amp; ((pFile-&gt;openFlags&amp;O_RDWR) == 0) ){</span>
<span class='curline'><a href='../S/1054.html#L32666'>pFile</a>            32666 ext/sqlite3/libsqlite/sqlite3.c     pCtx-&gt;oldLockingContext = pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L32667'>pFile</a>            32667 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;lockingContext = pCtx;</span>
<span class='curline'><a href='../S/1054.html#L32668'>pFile</a>            32668 ext/sqlite3/libsqlite/sqlite3.c     pCtx-&gt;pOldMethod = pFile-&gt;pMethod;</span>
<span class='curline'><a href='../S/1054.html#L32669'>pFile</a>            32669 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;pMethod = &amp;proxyIoMethods;</span>
<span class='curline'><a href='../S/1054.html#L32679'>pFile</a>            32679 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("TRANSPROXY  %d %s\n", pFile-&gt;h,</span>
<span class='curline'><a href='../S/1054.html#L32692'>pFile</a>            32692 ext/sqlite3/libsqlite/sqlite3.c       unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L32693'>pFile</a>            32693 ext/sqlite3/libsqlite/sqlite3.c       if( pFile-&gt;pMethod == &amp;proxyIoMethods ){</span>
<span class='curline'><a href='../S/1054.html#L32694'>pFile</a>            32694 ext/sqlite3/libsqlite/sqlite3.c         proxyLockingContext *pCtx = (proxyLockingContext*)pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L32695'>pFile</a>            32695 ext/sqlite3/libsqlite/sqlite3.c         proxyTakeConch(pFile);</span>
<span class='curline'><a href='../S/1054.html#L32707'>pFile</a>            32707 ext/sqlite3/libsqlite/sqlite3.c       unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L32709'>pFile</a>            32709 ext/sqlite3/libsqlite/sqlite3.c       int isProxyStyle = (pFile-&gt;pMethod == &amp;proxyIoMethods);</span>
<span class='curline'><a href='../S/1054.html#L32725'>pFile</a>            32725 ext/sqlite3/libsqlite/sqlite3.c             (proxyLockingContext*)pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L32732'>pFile</a>            32732 ext/sqlite3/libsqlite/sqlite3.c             rc = switchLockProxyPath(pFile, proxyPath);</span>
<span class='curline'><a href='../S/1054.html#L32736'>pFile</a>            32736 ext/sqlite3/libsqlite/sqlite3.c           rc = proxyTransformUnixFile(pFile, proxyPath);</span>
<span class='curline'><a href='../S/1054.html#L32763'>pFile</a>            32763 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L32764'>pFile</a>            32764 ext/sqlite3/libsqlite/sqlite3.c   int rc = proxyTakeConch(pFile);</span>
<span class='curline'><a href='../S/1054.html#L32766'>pFile</a>            32766 ext/sqlite3/libsqlite/sqlite3.c     proxyLockingContext *pCtx = (proxyLockingContext *)pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L32802'>pFile</a>            32802 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L32803'>pFile</a>            32803 ext/sqlite3/libsqlite/sqlite3.c   int rc = proxyTakeConch(pFile);</span>
<span class='curline'><a href='../S/1054.html#L32805'>pFile</a>            32805 ext/sqlite3/libsqlite/sqlite3.c     proxyLockingContext *pCtx = (proxyLockingContext *)pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L32809'>pFile</a>            32809 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;eFileLock = proxy-&gt;eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L32826'>pFile</a>            32826 ext/sqlite3/libsqlite/sqlite3.c   unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L32827'>pFile</a>            32827 ext/sqlite3/libsqlite/sqlite3.c   int rc = proxyTakeConch(pFile);</span>
<span class='curline'><a href='../S/1054.html#L32829'>pFile</a>            32829 ext/sqlite3/libsqlite/sqlite3.c     proxyLockingContext *pCtx = (proxyLockingContext *)pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L32833'>pFile</a>            32833 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;eFileLock = proxy-&gt;eFileLock;</span>
<span class='curline'><a href='../S/1054.html#L32846'>pFile</a>            32846 ext/sqlite3/libsqlite/sqlite3.c     unixFile *pFile = (unixFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L32847'>pFile</a>            32847 ext/sqlite3/libsqlite/sqlite3.c     proxyLockingContext *pCtx = (proxyLockingContext *)pFile-&gt;lockingContext;</span>
<span class='curline'><a href='../S/1054.html#L32862'>pFile</a>            32862 ext/sqlite3/libsqlite/sqlite3.c         rc = proxyReleaseConch(pFile);</span>
<span class='curline'><a href='../S/1054.html#L32873'>pFile</a>            32873 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;lockingContext = pCtx-&gt;oldLockingContext;</span>
<span class='curline'><a href='../S/1054.html#L32874'>pFile</a>            32874 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;pMethod = pCtx-&gt;pOldMethod;</span>
<span class='curline'><a href='../S/1054.html#L32876'>pFile</a>            32876 ext/sqlite3/libsqlite/sqlite3.c     return pFile-&gt;pMethod-&gt;xClose(id);</span>
<span class='curline'><a href='../S/1054.html#L35250'>pFile</a>            35250 ext/sqlite3/libsqlite/sqlite3.c static int winceCreateLock(const char *zFilename, winFile *pFile){</span>
<span class='curline'><a href='../S/1054.html#L35264'>pFile</a>            35264 ext/sqlite3/libsqlite/sqlite3.c   memset(&amp;pFile-&gt;local, 0, sizeof(pFile-&gt;local));</span>
<span class='curline'><a href='../S/1054.html#L35274'>pFile</a>            35274 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;hMutex = osCreateMutexW(NULL, FALSE, zName);</span>
<span class='curline'><a href='../S/1054.html#L35275'>pFile</a>            35275 ext/sqlite3/libsqlite/sqlite3.c   if (!pFile-&gt;hMutex){</span>
<span class='curline'><a href='../S/1054.html#L35276'>pFile</a>            35276 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;lastErrno = osGetLastError();</span>
<span class='curline'><a href='../S/1054.html#L35278'>pFile</a>            35278 ext/sqlite3/libsqlite/sqlite3.c     return winLogError(SQLITE_IOERR, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L35283'>pFile</a>            35283 ext/sqlite3/libsqlite/sqlite3.c   winceMutexAcquire(pFile-&gt;hMutex);</span>
<span class='curline'><a href='../S/1054.html#L35290'>pFile</a>            35290 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;hShared = osCreateFileMappingW(INVALID_HANDLE_VALUE, NULL,</span>
<span class='curline'><a href='../S/1054.html#L35304'>pFile</a>            35304 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;hShared ){</span>
<span class='curline'><a href='../S/1054.html#L35305'>pFile</a>            35305 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;shared = (winceLock*)osMapViewOfFile(pFile-&gt;hShared,</span>
<span class='curline'><a href='../S/1054.html#L35308'>pFile</a>            35308 ext/sqlite3/libsqlite/sqlite3.c     if( !pFile-&gt;shared ){</span>
<span class='curline'><a href='../S/1054.html#L35309'>pFile</a>            35309 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;lastErrno = osGetLastError();</span>
<span class='curline'><a href='../S/1054.html#L35310'>pFile</a>            35310 ext/sqlite3/libsqlite/sqlite3.c       winLogError(SQLITE_IOERR, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L35313'>pFile</a>            35313 ext/sqlite3/libsqlite/sqlite3.c       osCloseHandle(pFile-&gt;hShared);</span>
<span class='curline'><a href='../S/1054.html#L35314'>pFile</a>            35314 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;hShared = NULL;</span>
<span class='curline'><a href='../S/1054.html#L35319'>pFile</a>            35319 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;hShared==NULL ){</span>
<span class='curline'><a href='../S/1054.html#L35321'>pFile</a>            35321 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;lastErrno = lastErrno;</span>
<span class='curline'><a href='../S/1054.html#L35322'>pFile</a>            35322 ext/sqlite3/libsqlite/sqlite3.c       winLogError(SQLITE_IOERR, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L35326'>pFile</a>            35326 ext/sqlite3/libsqlite/sqlite3.c     winceMutexRelease(pFile-&gt;hMutex);</span>
<span class='curline'><a href='../S/1054.html#L35327'>pFile</a>            35327 ext/sqlite3/libsqlite/sqlite3.c     osCloseHandle(pFile-&gt;hMutex);</span>
<span class='curline'><a href='../S/1054.html#L35328'>pFile</a>            35328 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;hMutex = NULL;</span>
<span class='curline'><a href='../S/1054.html#L35334'>pFile</a>            35334 ext/sqlite3/libsqlite/sqlite3.c     memset(pFile-&gt;shared, 0, sizeof(winceLock));</span>
<span class='curline'><a href='../S/1054.html#L35337'>pFile</a>            35337 ext/sqlite3/libsqlite/sqlite3.c   winceMutexRelease(pFile-&gt;hMutex);</span>
<span class='curline'><a href='../S/1054.html#L35344'>pFile</a>            35344 ext/sqlite3/libsqlite/sqlite3.c static void winceDestroyLock(winFile *pFile){</span>
<span class='curline'><a href='../S/1054.html#L35345'>pFile</a>            35345 ext/sqlite3/libsqlite/sqlite3.c   if (pFile-&gt;hMutex){</span>
<span class='curline'><a href='../S/1054.html#L35347'>pFile</a>            35347 ext/sqlite3/libsqlite/sqlite3.c     winceMutexAcquire(pFile-&gt;hMutex);</span>
<span class='curline'><a href='../S/1054.html#L35351'>pFile</a>            35351 ext/sqlite3/libsqlite/sqlite3.c     if (pFile-&gt;local.nReaders){</span>
<span class='curline'><a href='../S/1054.html#L35352'>pFile</a>            35352 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;shared-&gt;nReaders --;</span>
<span class='curline'><a href='../S/1054.html#L35354'>pFile</a>            35354 ext/sqlite3/libsqlite/sqlite3.c     if (pFile-&gt;local.bReserved){</span>
<span class='curline'><a href='../S/1054.html#L35355'>pFile</a>            35355 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;shared-&gt;bReserved = FALSE;</span>
<span class='curline'><a href='../S/1054.html#L35357'>pFile</a>            35357 ext/sqlite3/libsqlite/sqlite3.c     if (pFile-&gt;local.bPending){</span>
<span class='curline'><a href='../S/1054.html#L35358'>pFile</a>            35358 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;shared-&gt;bPending = FALSE;</span>
<span class='curline'><a href='../S/1054.html#L35360'>pFile</a>            35360 ext/sqlite3/libsqlite/sqlite3.c     if (pFile-&gt;local.bExclusive){</span>
<span class='curline'><a href='../S/1054.html#L35361'>pFile</a>            35361 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;shared-&gt;bExclusive = FALSE;</span>
<span class='curline'><a href='../S/1054.html#L35365'>pFile</a>            35365 ext/sqlite3/libsqlite/sqlite3.c     osUnmapViewOfFile(pFile-&gt;shared);</span>
<span class='curline'><a href='../S/1054.html#L35366'>pFile</a>            35366 ext/sqlite3/libsqlite/sqlite3.c     osCloseHandle(pFile-&gt;hShared);</span>
<span class='curline'><a href='../S/1054.html#L35369'>pFile</a>            35369 ext/sqlite3/libsqlite/sqlite3.c     winceMutexRelease(pFile-&gt;hMutex);</span>
<span class='curline'><a href='../S/1054.html#L35370'>pFile</a>            35370 ext/sqlite3/libsqlite/sqlite3.c     osCloseHandle(pFile-&gt;hMutex);</span>
<span class='curline'><a href='../S/1054.html#L35371'>pFile</a>            35371 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;hMutex = NULL;</span>
<span class='curline'><a href='../S/1054.html#L35385'>pFile</a>            35385 ext/sqlite3/libsqlite/sqlite3.c   winFile *pFile = HANDLE_TO_WINFILE(phFile);</span>
<span class='curline'><a href='../S/1054.html#L35391'>pFile</a>            35391 ext/sqlite3/libsqlite/sqlite3.c   if (!pFile-&gt;hMutex) return TRUE;</span>
<span class='curline'><a href='../S/1054.html#L35392'>pFile</a>            35392 ext/sqlite3/libsqlite/sqlite3.c   winceMutexAcquire(pFile-&gt;hMutex);</span>
<span class='curline'><a href='../S/1054.html#L35397'>pFile</a>            35397 ext/sqlite3/libsqlite/sqlite3.c     if (pFile-&gt;shared-&gt;nReaders == 0 &amp;&amp; pFile-&gt;shared-&gt;bExclusive == 0){</span>
<span class='curline'><a href='../S/1054.html#L35398'>pFile</a>            35398 ext/sqlite3/libsqlite/sqlite3.c        pFile-&gt;shared-&gt;bExclusive = TRUE;</span>
<span class='curline'><a href='../S/1054.html#L35399'>pFile</a>            35399 ext/sqlite3/libsqlite/sqlite3.c        pFile-&gt;local.bExclusive = TRUE;</span>
<span class='curline'><a href='../S/1054.html#L35407'>pFile</a>            35407 ext/sqlite3/libsqlite/sqlite3.c     if (pFile-&gt;shared-&gt;bExclusive == 0){</span>
<span class='curline'><a href='../S/1054.html#L35408'>pFile</a>            35408 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;local.nReaders ++;</span>
<span class='curline'><a href='../S/1054.html#L35409'>pFile</a>            35409 ext/sqlite3/libsqlite/sqlite3.c       if (pFile-&gt;local.nReaders == 1){</span>
<span class='curline'><a href='../S/1054.html#L35410'>pFile</a>            35410 ext/sqlite3/libsqlite/sqlite3.c         pFile-&gt;shared-&gt;nReaders ++;</span>
<span class='curline'><a href='../S/1054.html#L35420'>pFile</a>            35420 ext/sqlite3/libsqlite/sqlite3.c     if (pFile-&gt;shared-&gt;bPending == 0) {</span>
<span class='curline'><a href='../S/1054.html#L35421'>pFile</a>            35421 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;shared-&gt;bPending = TRUE;</span>
<span class='curline'><a href='../S/1054.html#L35422'>pFile</a>            35422 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;local.bPending = TRUE;</span>
<span class='curline'><a href='../S/1054.html#L35430'>pFile</a>            35430 ext/sqlite3/libsqlite/sqlite3.c     if (pFile-&gt;shared-&gt;bReserved == 0) {</span>
<span class='curline'><a href='../S/1054.html#L35431'>pFile</a>            35431 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;shared-&gt;bReserved = TRUE;</span>
<span class='curline'><a href='../S/1054.html#L35432'>pFile</a>            35432 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;local.bReserved = TRUE;</span>
<span class='curline'><a href='../S/1054.html#L35437'>pFile</a>            35437 ext/sqlite3/libsqlite/sqlite3.c   winceMutexRelease(pFile-&gt;hMutex);</span>
<span class='curline'><a href='../S/1054.html#L35451'>pFile</a>            35451 ext/sqlite3/libsqlite/sqlite3.c   winFile *pFile = HANDLE_TO_WINFILE(phFile);</span>
<span class='curline'><a href='../S/1054.html#L35457'>pFile</a>            35457 ext/sqlite3/libsqlite/sqlite3.c   if (!pFile-&gt;hMutex) return TRUE;</span>
<span class='curline'><a href='../S/1054.html#L35458'>pFile</a>            35458 ext/sqlite3/libsqlite/sqlite3.c   winceMutexAcquire(pFile-&gt;hMutex);</span>
<span class='curline'><a href='../S/1054.html#L35463'>pFile</a>            35463 ext/sqlite3/libsqlite/sqlite3.c     if (pFile-&gt;local.bExclusive){</span>
<span class='curline'><a href='../S/1054.html#L35465'>pFile</a>            35465 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;local.bExclusive = FALSE;</span>
<span class='curline'><a href='../S/1054.html#L35466'>pFile</a>            35466 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;shared-&gt;bExclusive = FALSE;</span>
<span class='curline'><a href='../S/1054.html#L35471'>pFile</a>            35471 ext/sqlite3/libsqlite/sqlite3.c     else if (pFile-&gt;local.nReaders){</span>
<span class='curline'><a href='../S/1054.html#L35474'>pFile</a>            35474 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;local.nReaders --;</span>
<span class='curline'><a href='../S/1054.html#L35475'>pFile</a>            35475 ext/sqlite3/libsqlite/sqlite3.c       if (pFile-&gt;local.nReaders == 0)</span>
<span class='curline'><a href='../S/1054.html#L35477'>pFile</a>            35477 ext/sqlite3/libsqlite/sqlite3.c         pFile-&gt;shared-&gt;nReaders --;</span>
<span class='curline'><a href='../S/1054.html#L35486'>pFile</a>            35486 ext/sqlite3/libsqlite/sqlite3.c     if (pFile-&gt;local.bPending){</span>
<span class='curline'><a href='../S/1054.html#L35487'>pFile</a>            35487 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;local.bPending = FALSE;</span>
<span class='curline'><a href='../S/1054.html#L35488'>pFile</a>            35488 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;shared-&gt;bPending = FALSE;</span>
<span class='curline'><a href='../S/1054.html#L35495'>pFile</a>            35495 ext/sqlite3/libsqlite/sqlite3.c     if (pFile-&gt;local.bReserved) {</span>
<span class='curline'><a href='../S/1054.html#L35496'>pFile</a>            35496 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;local.bReserved = FALSE;</span>
<span class='curline'><a href='../S/1054.html#L35497'>pFile</a>            35497 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;shared-&gt;bReserved = FALSE;</span>
<span class='curline'><a href='../S/1054.html#L35502'>pFile</a>            35502 ext/sqlite3/libsqlite/sqlite3.c   winceMutexRelease(pFile-&gt;hMutex);</span>
<span class='curline'><a href='../S/1054.html#L35590'>pFile</a>            35590 ext/sqlite3/libsqlite/sqlite3.c static int winSeekFile(winFile *pFile, sqlite3_int64 iOffset){</span>
<span class='curline'><a href='../S/1054.html#L35597'>pFile</a>            35597 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("SEEK file=%p, offset=%lld\n", pFile-&gt;h, iOffset));</span>
<span class='curline'><a href='../S/1054.html#L35609'>pFile</a>            35609 ext/sqlite3/libsqlite/sqlite3.c   dwRet = osSetFilePointer(pFile-&gt;h, lowerBits, &amp;upperBits, FILE_BEGIN);</span>
<span class='curline'><a href='../S/1054.html#L35613'>pFile</a>            35613 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;lastErrno = lastErrno;</span>
<span class='curline'><a href='../S/1054.html#L35614'>pFile</a>            35614 ext/sqlite3/libsqlite/sqlite3.c     winLogError(SQLITE_IOERR_SEEK, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L35615'>pFile</a>            35615 ext/sqlite3/libsqlite/sqlite3.c                 "winSeekFile", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L35616'>pFile</a>            35616 ext/sqlite3/libsqlite/sqlite3.c     OSTRACE(("SEEK file=%p, rc=SQLITE_IOERR_SEEK\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L35620'>pFile</a>            35620 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("SEEK file=%p, rc=SQLITE_OK\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L35631'>pFile</a>            35631 ext/sqlite3/libsqlite/sqlite3.c   bRet = osSetFilePointerEx(pFile-&gt;h, x, 0, FILE_BEGIN);</span>
<span class='curline'><a href='../S/1054.html#L35634'>pFile</a>            35634 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;lastErrno = osGetLastError();</span>
<span class='curline'><a href='../S/1054.html#L35635'>pFile</a>            35635 ext/sqlite3/libsqlite/sqlite3.c     winLogError(SQLITE_IOERR_SEEK, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L35636'>pFile</a>            35636 ext/sqlite3/libsqlite/sqlite3.c                 "winSeekFile", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L35637'>pFile</a>            35637 ext/sqlite3/libsqlite/sqlite3.c     OSTRACE(("SEEK file=%p, rc=SQLITE_IOERR_SEEK\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L35641'>pFile</a>            35641 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("SEEK file=%p, rc=SQLITE_OK\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L35665'>pFile</a>            35665 ext/sqlite3/libsqlite/sqlite3.c   winFile *pFile = (winFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L35669'>pFile</a>            35669 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile-&gt;pShm==0 );</span>
<span class='curline'><a href='../S/1054.html#L35671'>pFile</a>            35671 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile-&gt;h!=NULL &amp;&amp; pFile-&gt;h!=INVALID_HANDLE_VALUE );</span>
<span class='curline'><a href='../S/1054.html#L35673'>pFile</a>            35673 ext/sqlite3/libsqlite/sqlite3.c            osGetCurrentProcessId(), pFile, pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L35676'>pFile</a>            35676 ext/sqlite3/libsqlite/sqlite3.c   winUnmapfile(pFile);</span>
<span class='curline'><a href='../S/1054.html#L35680'>pFile</a>            35680 ext/sqlite3/libsqlite/sqlite3.c     rc = osCloseHandle(pFile-&gt;h);</span>
<span class='curline'><a href='../S/1054.html#L35685'>pFile</a>            35685 ext/sqlite3/libsqlite/sqlite3.c   winceDestroyLock(pFile);</span>
<span class='curline'><a href='../S/1054.html#L35686'>pFile</a>            35686 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;zDeleteOnClose ){</span>
<span class='curline'><a href='../S/1054.html#L35689'>pFile</a>            35689 ext/sqlite3/libsqlite/sqlite3.c            osDeleteFileW(pFile-&gt;zDeleteOnClose)==0</span>
<span class='curline'><a href='../S/1054.html#L35690'>pFile</a>            35690 ext/sqlite3/libsqlite/sqlite3.c         &amp;&amp; osGetFileAttributesW(pFile-&gt;zDeleteOnClose)!=0xffffffff</span>
<span class='curline'><a href='../S/1054.html#L35695'>pFile</a>            35695 ext/sqlite3/libsqlite/sqlite3.c     sqlite3_free(pFile-&gt;zDeleteOnClose);</span>
<span class='curline'><a href='../S/1054.html#L35699'>pFile</a>            35699 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;h = NULL;</span>
<span class='curline'><a href='../S/1054.html#L35703'>pFile</a>            35703 ext/sqlite3/libsqlite/sqlite3.c            osGetCurrentProcessId(), pFile, pFile-&gt;h, rc ? "ok" : "failed"));</span>
<span class='curline'><a href='../S/1054.html#L35706'>pFile</a>            35706 ext/sqlite3/libsqlite/sqlite3.c                           "winClose", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L35723'>pFile</a>            35723 ext/sqlite3/libsqlite/sqlite3.c   winFile *pFile = (winFile*)id;  /* file handle */</span>
<span class='curline'><a href='../S/1054.html#L35732'>pFile</a>            35732 ext/sqlite3/libsqlite/sqlite3.c            "offset=%lld, lock=%d\n", osGetCurrentProcessId(), pFile,</span>
<span class='curline'><a href='../S/1054.html#L35733'>pFile</a>            35733 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;h, pBuf, amt, offset, pFile-&gt;locktype));</span>
<span class='curline'><a href='../S/1054.html#L35738'>pFile</a>            35738 ext/sqlite3/libsqlite/sqlite3.c   if( offset&lt;pFile-&gt;mmapSize ){</span>
<span class='curline'><a href='../S/1054.html#L35739'>pFile</a>            35739 ext/sqlite3/libsqlite/sqlite3.c     if( offset+amt &lt;= pFile-&gt;mmapSize ){</span>
<span class='curline'><a href='../S/1054.html#L35740'>pFile</a>            35740 ext/sqlite3/libsqlite/sqlite3.c       memcpy(pBuf, &amp;((u8 *)(pFile-&gt;pMapRegion))[offset], amt);</span>
<span class='curline'><a href='../S/1054.html#L35742'>pFile</a>            35742 ext/sqlite3/libsqlite/sqlite3.c                osGetCurrentProcessId(), pFile, pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L35745'>pFile</a>            35745 ext/sqlite3/libsqlite/sqlite3.c       int nCopy = (int)(pFile-&gt;mmapSize - offset);</span>
<span class='curline'><a href='../S/1054.html#L35746'>pFile</a>            35746 ext/sqlite3/libsqlite/sqlite3.c       memcpy(pBuf, &amp;((u8 *)(pFile-&gt;pMapRegion))[offset], nCopy);</span>
<span class='curline'><a href='../S/1054.html#L35755'>pFile</a>            35755 ext/sqlite3/libsqlite/sqlite3.c   if( winSeekFile(pFile, offset) ){</span>
<span class='curline'><a href='../S/1054.html#L35757'>pFile</a>            35757 ext/sqlite3/libsqlite/sqlite3.c              osGetCurrentProcessId(), pFile, pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L35760'>pFile</a>            35760 ext/sqlite3/libsqlite/sqlite3.c   while( !osReadFile(pFile-&gt;h, pBuf, amt, &amp;nRead, 0) ){</span>
<span class='curline'><a href='../S/1054.html#L35765'>pFile</a>            35765 ext/sqlite3/libsqlite/sqlite3.c   while( !osReadFile(pFile-&gt;h, pBuf, amt, &amp;nRead, &amp;overlapped) &amp;&amp;</span>
<span class='curline'><a href='../S/1054.html#L35770'>pFile</a>            35770 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;lastErrno = lastErrno;</span>
<span class='curline'><a href='../S/1054.html#L35772'>pFile</a>            35772 ext/sqlite3/libsqlite/sqlite3.c              osGetCurrentProcessId(), pFile, pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L35773'>pFile</a>            35773 ext/sqlite3/libsqlite/sqlite3.c     return winLogError(SQLITE_IOERR_READ, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L35774'>pFile</a>            35774 ext/sqlite3/libsqlite/sqlite3.c                        "winRead", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L35781'>pFile</a>            35781 ext/sqlite3/libsqlite/sqlite3.c              osGetCurrentProcessId(), pFile, pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L35786'>pFile</a>            35786 ext/sqlite3/libsqlite/sqlite3.c            osGetCurrentProcessId(), pFile, pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L35801'>pFile</a>            35801 ext/sqlite3/libsqlite/sqlite3.c   winFile *pFile = (winFile*)id;  /* File handle */</span>
<span class='curline'><a href='../S/1054.html#L35805'>pFile</a>            35805 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L35810'>pFile</a>            35810 ext/sqlite3/libsqlite/sqlite3.c            "offset=%lld, lock=%d\n", osGetCurrentProcessId(), pFile,</span>
<span class='curline'><a href='../S/1054.html#L35811'>pFile</a>            35811 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;h, pBuf, amt, offset, pFile-&gt;locktype));</span>
<span class='curline'><a href='../S/1054.html#L35816'>pFile</a>            35816 ext/sqlite3/libsqlite/sqlite3.c   if( offset&lt;pFile-&gt;mmapSize ){</span>
<span class='curline'><a href='../S/1054.html#L35817'>pFile</a>            35817 ext/sqlite3/libsqlite/sqlite3.c     if( offset+amt &lt;= pFile-&gt;mmapSize ){</span>
<span class='curline'><a href='../S/1054.html#L35818'>pFile</a>            35818 ext/sqlite3/libsqlite/sqlite3.c       memcpy(&amp;((u8 *)(pFile-&gt;pMapRegion))[offset], pBuf, amt);</span>
<span class='curline'><a href='../S/1054.html#L35820'>pFile</a>            35820 ext/sqlite3/libsqlite/sqlite3.c                osGetCurrentProcessId(), pFile, pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L35823'>pFile</a>            35823 ext/sqlite3/libsqlite/sqlite3.c       int nCopy = (int)(pFile-&gt;mmapSize - offset);</span>
<span class='curline'><a href='../S/1054.html#L35824'>pFile</a>            35824 ext/sqlite3/libsqlite/sqlite3.c       memcpy(&amp;((u8 *)(pFile-&gt;pMapRegion))[offset], pBuf, nCopy);</span>
<span class='curline'><a href='../S/1054.html#L35833'>pFile</a>            35833 ext/sqlite3/libsqlite/sqlite3.c   rc = winSeekFile(pFile, offset);</span>
<span class='curline'><a href='../S/1054.html#L35854'>pFile</a>            35854 ext/sqlite3/libsqlite/sqlite3.c       if( !osWriteFile(pFile-&gt;h, aRem, nRem, &amp;nWrite, 0) ){</span>
<span class='curline'><a href='../S/1054.html#L35856'>pFile</a>            35856 ext/sqlite3/libsqlite/sqlite3.c       if( !osWriteFile(pFile-&gt;h, aRem, nRem, &amp;nWrite, &amp;overlapped) ){</span>
<span class='curline'><a href='../S/1054.html#L35875'>pFile</a>            35875 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;lastErrno = lastErrno;</span>
<span class='curline'><a href='../S/1054.html#L35881'>pFile</a>            35881 ext/sqlite3/libsqlite/sqlite3.c     if(   ( pFile-&gt;lastErrno==ERROR_HANDLE_DISK_FULL )</span>
<span class='curline'><a href='../S/1054.html#L35882'>pFile</a>            35882 ext/sqlite3/libsqlite/sqlite3.c        || ( pFile-&gt;lastErrno==ERROR_DISK_FULL )){</span>
<span class='curline'><a href='../S/1054.html#L35884'>pFile</a>            35884 ext/sqlite3/libsqlite/sqlite3.c                osGetCurrentProcessId(), pFile, pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L35885'>pFile</a>            35885 ext/sqlite3/libsqlite/sqlite3.c       return winLogError(SQLITE_FULL, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L35886'>pFile</a>            35886 ext/sqlite3/libsqlite/sqlite3.c                          "winWrite1", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L35889'>pFile</a>            35889 ext/sqlite3/libsqlite/sqlite3.c              osGetCurrentProcessId(), pFile, pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L35890'>pFile</a>            35890 ext/sqlite3/libsqlite/sqlite3.c     return winLogError(SQLITE_IOERR_WRITE, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L35891'>pFile</a>            35891 ext/sqlite3/libsqlite/sqlite3.c                        "winWrite2", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L35896'>pFile</a>            35896 ext/sqlite3/libsqlite/sqlite3.c            osGetCurrentProcessId(), pFile, pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L35904'>pFile</a>            35904 ext/sqlite3/libsqlite/sqlite3.c   winFile *pFile = (winFile*)id;  /* File handle object */</span>
<span class='curline'><a href='../S/1054.html#L35908'>pFile</a>            35908 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L35911'>pFile</a>            35911 ext/sqlite3/libsqlite/sqlite3.c            osGetCurrentProcessId(), pFile, pFile-&gt;h, nByte, pFile-&gt;locktype));</span>
<span class='curline'><a href='../S/1054.html#L35918'>pFile</a>            35918 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;szChunk&gt;0 ){</span>
<span class='curline'><a href='../S/1054.html#L35919'>pFile</a>            35919 ext/sqlite3/libsqlite/sqlite3.c     nByte = ((nByte + pFile-&gt;szChunk - 1)/pFile-&gt;szChunk) * pFile-&gt;szChunk;</span>
<span class='curline'><a href='../S/1054.html#L35923'>pFile</a>            35923 ext/sqlite3/libsqlite/sqlite3.c   if( winSeekFile(pFile, nByte) ){</span>
<span class='curline'><a href='../S/1054.html#L35924'>pFile</a>            35924 ext/sqlite3/libsqlite/sqlite3.c     rc = winLogError(SQLITE_IOERR_TRUNCATE, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L35925'>pFile</a>            35925 ext/sqlite3/libsqlite/sqlite3.c                      "winTruncate1", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L35926'>pFile</a>            35926 ext/sqlite3/libsqlite/sqlite3.c   }else if( 0==osSetEndOfFile(pFile-&gt;h) &amp;&amp;</span>
<span class='curline'><a href='../S/1054.html#L35928'>pFile</a>            35928 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;lastErrno = lastErrno;</span>
<span class='curline'><a href='../S/1054.html#L35929'>pFile</a>            35929 ext/sqlite3/libsqlite/sqlite3.c     rc = winLogError(SQLITE_IOERR_TRUNCATE, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L35930'>pFile</a>            35930 ext/sqlite3/libsqlite/sqlite3.c                      "winTruncate2", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L35938'>pFile</a>            35938 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;pMapRegion &amp;&amp; nByte&lt;pFile-&gt;mmapSize ){</span>
<span class='curline'><a href='../S/1054.html#L35939'>pFile</a>            35939 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;mmapSize = nByte;</span>
<span class='curline'><a href='../S/1054.html#L35944'>pFile</a>            35944 ext/sqlite3/libsqlite/sqlite3.c            osGetCurrentProcessId(), pFile, pFile-&gt;h, sqlite3ErrName(rc)));</span>
<span class='curline'><a href='../S/1054.html#L35973'>pFile</a>            35973 ext/sqlite3/libsqlite/sqlite3.c   winFile *pFile = (winFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L35978'>pFile</a>            35978 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L35990'>pFile</a>            35990 ext/sqlite3/libsqlite/sqlite3.c            osGetCurrentProcessId(), pFile, pFile-&gt;h, flags,</span>
<span class='curline'><a href='../S/1054.html#L35991'>pFile</a>            35991 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;locktype));</span>
<span class='curline'><a href='../S/1054.html#L36007'>pFile</a>            36007 ext/sqlite3/libsqlite/sqlite3.c            osGetCurrentProcessId(), pFile, pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L36011'>pFile</a>            36011 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;pMapRegion ){</span>
<span class='curline'><a href='../S/1054.html#L36012'>pFile</a>            36012 ext/sqlite3/libsqlite/sqlite3.c     if( osFlushViewOfFile(pFile-&gt;pMapRegion, 0) ){</span>
<span class='curline'><a href='../S/1054.html#L36015'>pFile</a>            36015 ext/sqlite3/libsqlite/sqlite3.c                pFile, pFile-&gt;pMapRegion));</span>
<span class='curline'><a href='../S/1054.html#L36017'>pFile</a>            36017 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;lastErrno = osGetLastError();</span>
<span class='curline'><a href='../S/1054.html#L36020'>pFile</a>            36020 ext/sqlite3/libsqlite/sqlite3.c                pFile, pFile-&gt;pMapRegion));</span>
<span class='curline'><a href='../S/1054.html#L36021'>pFile</a>            36021 ext/sqlite3/libsqlite/sqlite3.c       return winLogError(SQLITE_IOERR_MMAP, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L36022'>pFile</a>            36022 ext/sqlite3/libsqlite/sqlite3.c                          "winSync1", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L36026'>pFile</a>            36026 ext/sqlite3/libsqlite/sqlite3.c   rc = osFlushFileBuffers(pFile-&gt;h);</span>
<span class='curline'><a href='../S/1054.html#L36030'>pFile</a>            36030 ext/sqlite3/libsqlite/sqlite3.c              osGetCurrentProcessId(), pFile, pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L36033'>pFile</a>            36033 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;lastErrno = osGetLastError();</span>
<span class='curline'><a href='../S/1054.html#L36035'>pFile</a>            36035 ext/sqlite3/libsqlite/sqlite3.c              osGetCurrentProcessId(), pFile, pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L36036'>pFile</a>            36036 ext/sqlite3/libsqlite/sqlite3.c     return winLogError(SQLITE_IOERR_FSYNC, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L36037'>pFile</a>            36037 ext/sqlite3/libsqlite/sqlite3.c                        "winSync2", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L36046'>pFile</a>            36046 ext/sqlite3/libsqlite/sqlite3.c   winFile *pFile = (winFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L36052'>pFile</a>            36052 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("SIZE file=%p, pSize=%p\n", pFile-&gt;h, pSize));</span>
<span class='curline'><a href='../S/1054.html#L36057'>pFile</a>            36057 ext/sqlite3/libsqlite/sqlite3.c     if( osGetFileInformationByHandleEx(pFile-&gt;h, FileStandardInfo,</span>
<span class='curline'><a href='../S/1054.html#L36061'>pFile</a>            36061 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;lastErrno = osGetLastError();</span>
<span class='curline'><a href='../S/1054.html#L36062'>pFile</a>            36062 ext/sqlite3/libsqlite/sqlite3.c       rc = winLogError(SQLITE_IOERR_FSTAT, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L36063'>pFile</a>            36063 ext/sqlite3/libsqlite/sqlite3.c                        "winFileSize", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L36072'>pFile</a>            36072 ext/sqlite3/libsqlite/sqlite3.c     lowerBits = osGetFileSize(pFile-&gt;h, &amp;upperBits);</span>
<span class='curline'><a href='../S/1054.html#L36076'>pFile</a>            36076 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;lastErrno = lastErrno;</span>
<span class='curline'><a href='../S/1054.html#L36077'>pFile</a>            36077 ext/sqlite3/libsqlite/sqlite3.c       rc = winLogError(SQLITE_IOERR_FSTAT, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L36078'>pFile</a>            36078 ext/sqlite3/libsqlite/sqlite3.c                        "winFileSize", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L36083'>pFile</a>            36083 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;h, pSize, *pSize, sqlite3ErrName(rc)));</span>
<span class='curline'><a href='../S/1054.html#L36123'>pFile</a>            36123 ext/sqlite3/libsqlite/sqlite3.c static int winGetReadLock(winFile *pFile){</span>
<span class='curline'><a href='../S/1054.html#L36125'>pFile</a>            36125 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("READ-LOCK file=%p, lock=%d\n", pFile-&gt;h, pFile-&gt;locktype));</span>
<span class='curline'><a href='../S/1054.html#L36132'>pFile</a>            36132 ext/sqlite3/libsqlite/sqlite3.c     res = winceLockFile(&amp;pFile-&gt;h, SHARED_FIRST, 0, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L36134'>pFile</a>            36134 ext/sqlite3/libsqlite/sqlite3.c     res = winLockFile(&amp;pFile-&gt;h, SQLITE_LOCKFILEEX_FLAGS, SHARED_FIRST, 0,</span>
<span class='curline'><a href='../S/1054.html#L36142'>pFile</a>            36142 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;sharedLockByte = (short)((lk &amp; 0x7fffffff)%(SHARED_SIZE - 1));</span>
<span class='curline'><a href='../S/1054.html#L36143'>pFile</a>            36143 ext/sqlite3/libsqlite/sqlite3.c     res = winLockFile(&amp;pFile-&gt;h, SQLITE_LOCKFILE_FLAGS,</span>
<span class='curline'><a href='../S/1054.html#L36144'>pFile</a>            36144 ext/sqlite3/libsqlite/sqlite3.c                       SHARED_FIRST+pFile-&gt;sharedLockByte, 0, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L36148'>pFile</a>            36148 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;lastErrno = osGetLastError();</span>
<span class='curline'><a href='../S/1054.html#L36151'>pFile</a>            36151 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("READ-LOCK file=%p, result=%d\n", pFile-&gt;h, res));</span>
<span class='curline'><a href='../S/1054.html#L36158'>pFile</a>            36158 ext/sqlite3/libsqlite/sqlite3.c static int winUnlockReadLock(winFile *pFile){</span>
<span class='curline'><a href='../S/1054.html#L36161'>pFile</a>            36161 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("READ-UNLOCK file=%p, lock=%d\n", pFile-&gt;h, pFile-&gt;locktype));</span>
<span class='curline'><a href='../S/1054.html#L36163'>pFile</a>            36163 ext/sqlite3/libsqlite/sqlite3.c     res = winUnlockFile(&amp;pFile-&gt;h, SHARED_FIRST, 0, SHARED_SIZE, 0);</span>
<span class='curline'><a href='../S/1054.html#L36167'>pFile</a>            36167 ext/sqlite3/libsqlite/sqlite3.c     res = winUnlockFile(&amp;pFile-&gt;h, SHARED_FIRST+pFile-&gt;sharedLockByte, 0, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L36171'>pFile</a>            36171 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;lastErrno = lastErrno;</span>
<span class='curline'><a href='../S/1054.html#L36172'>pFile</a>            36172 ext/sqlite3/libsqlite/sqlite3.c     winLogError(SQLITE_IOERR_UNLOCK, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L36173'>pFile</a>            36173 ext/sqlite3/libsqlite/sqlite3.c                 "winUnlockReadLock", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L36175'>pFile</a>            36175 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("READ-UNLOCK file=%p, result=%d\n", pFile-&gt;h, res));</span>
<span class='curline'><a href='../S/1054.html#L36210'>pFile</a>            36210 ext/sqlite3/libsqlite/sqlite3.c   winFile *pFile = (winFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L36215'>pFile</a>            36215 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;h, pFile-&gt;locktype, pFile-&gt;sharedLockByte, locktype));</span>
<span class='curline'><a href='../S/1054.html#L36221'>pFile</a>            36221 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;locktype&gt;=locktype ){</span>
<span class='curline'><a href='../S/1054.html#L36222'>pFile</a>            36222 ext/sqlite3/libsqlite/sqlite3.c     OSTRACE(("LOCK-HELD file=%p, rc=SQLITE_OK\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L36228'>pFile</a>            36228 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile-&gt;locktype!=NO_LOCK || locktype==SHARED_LOCK );</span>
<span class='curline'><a href='../S/1054.html#L36230'>pFile</a>            36230 ext/sqlite3/libsqlite/sqlite3.c   assert( locktype!=RESERVED_LOCK || pFile-&gt;locktype==SHARED_LOCK );</span>
<span class='curline'><a href='../S/1054.html#L36236'>pFile</a>            36236 ext/sqlite3/libsqlite/sqlite3.c   newLocktype = pFile-&gt;locktype;</span>
<span class='curline'><a href='../S/1054.html#L36237'>pFile</a>            36237 ext/sqlite3/libsqlite/sqlite3.c   if(   (pFile-&gt;locktype==NO_LOCK)</span>
<span class='curline'><a href='../S/1054.html#L36239'>pFile</a>            36239 ext/sqlite3/libsqlite/sqlite3.c          &amp;&amp; (pFile-&gt;locktype==RESERVED_LOCK))</span>
<span class='curline'><a href='../S/1054.html#L36242'>pFile</a>            36242 ext/sqlite3/libsqlite/sqlite3.c     while( cnt--&gt;0 &amp;&amp; (res = winLockFile(&amp;pFile-&gt;h, SQLITE_LOCKFILE_FLAGS,</span>
<span class='curline'><a href='../S/1054.html#L36252'>pFile</a>            36252 ext/sqlite3/libsqlite/sqlite3.c                pFile-&gt;h, cnt, res));</span>
<span class='curline'><a href='../S/1054.html#L36254'>pFile</a>            36254 ext/sqlite3/libsqlite/sqlite3.c         pFile-&gt;lastErrno = lastErrno;</span>
<span class='curline'><a href='../S/1054.html#L36257'>pFile</a>            36257 ext/sqlite3/libsqlite/sqlite3.c                  pFile-&gt;h, cnt, sqlite3ErrName(rc)));</span>
<span class='curline'><a href='../S/1054.html#L36271'>pFile</a>            36271 ext/sqlite3/libsqlite/sqlite3.c     assert( pFile-&gt;locktype==NO_LOCK );</span>
<span class='curline'><a href='../S/1054.html#L36272'>pFile</a>            36272 ext/sqlite3/libsqlite/sqlite3.c     res = winGetReadLock(pFile);</span>
<span class='curline'><a href='../S/1054.html#L36283'>pFile</a>            36283 ext/sqlite3/libsqlite/sqlite3.c     assert( pFile-&gt;locktype==SHARED_LOCK );</span>
<span class='curline'><a href='../S/1054.html#L36284'>pFile</a>            36284 ext/sqlite3/libsqlite/sqlite3.c     res = winLockFile(&amp;pFile-&gt;h, SQLITE_LOCKFILE_FLAGS, RESERVED_BYTE, 0, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L36302'>pFile</a>            36302 ext/sqlite3/libsqlite/sqlite3.c     assert( pFile-&gt;locktype&gt;=SHARED_LOCK );</span>
<span class='curline'><a href='../S/1054.html#L36303'>pFile</a>            36303 ext/sqlite3/libsqlite/sqlite3.c     res = winUnlockReadLock(pFile);</span>
<span class='curline'><a href='../S/1054.html#L36304'>pFile</a>            36304 ext/sqlite3/libsqlite/sqlite3.c     res = winLockFile(&amp;pFile-&gt;h, SQLITE_LOCKFILE_FLAGS, SHARED_FIRST, 0,</span>
<span class='curline'><a href='../S/1054.html#L36310'>pFile</a>            36310 ext/sqlite3/libsqlite/sqlite3.c       winGetReadLock(pFile);</span>
<span class='curline'><a href='../S/1054.html#L36318'>pFile</a>            36318 ext/sqlite3/libsqlite/sqlite3.c     winUnlockFile(&amp;pFile-&gt;h, PENDING_BYTE, 0, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L36327'>pFile</a>            36327 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;lastErrno = lastErrno;</span>
<span class='curline'><a href='../S/1054.html#L36330'>pFile</a>            36330 ext/sqlite3/libsqlite/sqlite3.c              pFile-&gt;h, locktype, newLocktype));</span>
<span class='curline'><a href='../S/1054.html#L36332'>pFile</a>            36332 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;locktype = (u8)newLocktype;</span>
<span class='curline'><a href='../S/1054.html#L36334'>pFile</a>            36334 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;h, pFile-&gt;locktype, sqlite3ErrName(rc)));</span>
<span class='curline'><a href='../S/1054.html#L36345'>pFile</a>            36345 ext/sqlite3/libsqlite/sqlite3.c   winFile *pFile = (winFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L36348'>pFile</a>            36348 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("TEST-WR-LOCK file=%p, pResOut=%p\n", pFile-&gt;h, pResOut));</span>
<span class='curline'><a href='../S/1054.html#L36351'>pFile</a>            36351 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;locktype&gt;=RESERVED_LOCK ){</span>
<span class='curline'><a href='../S/1054.html#L36353'>pFile</a>            36353 ext/sqlite3/libsqlite/sqlite3.c     OSTRACE(("TEST-WR-LOCK file=%p, result=%d (local)\n", pFile-&gt;h, res));</span>
<span class='curline'><a href='../S/1054.html#L36355'>pFile</a>            36355 ext/sqlite3/libsqlite/sqlite3.c     res = winLockFile(&amp;pFile-&gt;h, SQLITE_LOCKFILEEX_FLAGS,RESERVED_BYTE, 0, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L36357'>pFile</a>            36357 ext/sqlite3/libsqlite/sqlite3.c       winUnlockFile(&amp;pFile-&gt;h, RESERVED_BYTE, 0, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L36360'>pFile</a>            36360 ext/sqlite3/libsqlite/sqlite3.c     OSTRACE(("TEST-WR-LOCK file=%p, result=%d (remote)\n", pFile-&gt;h, res));</span>
<span class='curline'><a href='../S/1054.html#L36364'>pFile</a>            36364 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;h, pResOut, *pResOut));</span>
<span class='curline'><a href='../S/1054.html#L36381'>pFile</a>            36381 ext/sqlite3/libsqlite/sqlite3.c   winFile *pFile = (winFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L36383'>pFile</a>            36383 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile!=0 );</span>
<span class='curline'><a href='../S/1054.html#L36386'>pFile</a>            36386 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;h, pFile-&gt;locktype, pFile-&gt;sharedLockByte, locktype));</span>
<span class='curline'><a href='../S/1054.html#L36387'>pFile</a>            36387 ext/sqlite3/libsqlite/sqlite3.c   type = pFile-&gt;locktype;</span>
<span class='curline'><a href='../S/1054.html#L36389'>pFile</a>            36389 ext/sqlite3/libsqlite/sqlite3.c     winUnlockFile(&amp;pFile-&gt;h, SHARED_FIRST, 0, SHARED_SIZE, 0);</span>
<span class='curline'><a href='../S/1054.html#L36390'>pFile</a>            36390 ext/sqlite3/libsqlite/sqlite3.c     if( locktype==SHARED_LOCK &amp;&amp; !winGetReadLock(pFile) ){</span>
<span class='curline'><a href='../S/1054.html#L36394'>pFile</a>            36394 ext/sqlite3/libsqlite/sqlite3.c                        "winUnlock", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L36398'>pFile</a>            36398 ext/sqlite3/libsqlite/sqlite3.c     winUnlockFile(&amp;pFile-&gt;h, RESERVED_BYTE, 0, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L36401'>pFile</a>            36401 ext/sqlite3/libsqlite/sqlite3.c     winUnlockReadLock(pFile);</span>
<span class='curline'><a href='../S/1054.html#L36404'>pFile</a>            36404 ext/sqlite3/libsqlite/sqlite3.c     winUnlockFile(&amp;pFile-&gt;h, PENDING_BYTE, 0, 1, 0);</span>
<span class='curline'><a href='../S/1054.html#L36406'>pFile</a>            36406 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;locktype = (u8)locktype;</span>
<span class='curline'><a href='../S/1054.html#L36408'>pFile</a>            36408 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;h, pFile-&gt;locktype, sqlite3ErrName(rc)));</span>
<span class='curline'><a href='../S/1054.html#L36418'>pFile</a>            36418 ext/sqlite3/libsqlite/sqlite3.c static void winModeBit(winFile *pFile, unsigned char mask, int *pArg){</span>
<span class='curline'><a href='../S/1054.html#L36420'>pFile</a>            36420 ext/sqlite3/libsqlite/sqlite3.c     *pArg = (pFile-&gt;ctrlFlags &amp; mask)!=0;</span>
<span class='curline'><a href='../S/1054.html#L36422'>pFile</a>            36422 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;ctrlFlags &amp;= ~mask;</span>
<span class='curline'><a href='../S/1054.html#L36424'>pFile</a>            36424 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;ctrlFlags |= mask;</span>
<span class='curline'><a href='../S/1054.html#L36437'>pFile</a>            36437 ext/sqlite3/libsqlite/sqlite3.c   winFile *pFile = (winFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L36438'>pFile</a>            36438 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("FCNTL file=%p, op=%d, pArg=%p\n", pFile-&gt;h, op, pArg));</span>
<span class='curline'><a href='../S/1054.html#L36441'>pFile</a>            36441 ext/sqlite3/libsqlite/sqlite3.c       *(int*)pArg = pFile-&gt;locktype;</span>
<span class='curline'><a href='../S/1054.html#L36442'>pFile</a>            36442 ext/sqlite3/libsqlite/sqlite3.c       OSTRACE(("FCNTL file=%p, rc=SQLITE_OK\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L36446'>pFile</a>            36446 ext/sqlite3/libsqlite/sqlite3.c       *(int*)pArg = (int)pFile-&gt;lastErrno;</span>
<span class='curline'><a href='../S/1054.html#L36447'>pFile</a>            36447 ext/sqlite3/libsqlite/sqlite3.c       OSTRACE(("FCNTL file=%p, rc=SQLITE_OK\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L36451'>pFile</a>            36451 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;szChunk = *(int *)pArg;</span>
<span class='curline'><a href='../S/1054.html#L36452'>pFile</a>            36452 ext/sqlite3/libsqlite/sqlite3.c       OSTRACE(("FCNTL file=%p, rc=SQLITE_OK\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L36456'>pFile</a>            36456 ext/sqlite3/libsqlite/sqlite3.c       if( pFile-&gt;szChunk&gt;0 ){</span>
<span class='curline'><a href='../S/1054.html#L36467'>pFile</a>            36467 ext/sqlite3/libsqlite/sqlite3.c         OSTRACE(("FCNTL file=%p, rc=%s\n", pFile-&gt;h, sqlite3ErrName(rc)));</span>
<span class='curline'><a href='../S/1054.html#L36470'>pFile</a>            36470 ext/sqlite3/libsqlite/sqlite3.c       OSTRACE(("FCNTL file=%p, rc=SQLITE_OK\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L36474'>pFile</a>            36474 ext/sqlite3/libsqlite/sqlite3.c       winModeBit(pFile, WINFILE_PERSIST_WAL, (int*)pArg);</span>
<span class='curline'><a href='../S/1054.html#L36475'>pFile</a>            36475 ext/sqlite3/libsqlite/sqlite3.c       OSTRACE(("FCNTL file=%p, rc=SQLITE_OK\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L36479'>pFile</a>            36479 ext/sqlite3/libsqlite/sqlite3.c       winModeBit(pFile, WINFILE_PSOW, (int*)pArg);</span>
<span class='curline'><a href='../S/1054.html#L36480'>pFile</a>            36480 ext/sqlite3/libsqlite/sqlite3.c       OSTRACE(("FCNTL file=%p, rc=SQLITE_OK\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L36484'>pFile</a>            36484 ext/sqlite3/libsqlite/sqlite3.c       *(char**)pArg = sqlite3_mprintf("%s", pFile-&gt;pVfs-&gt;zName);</span>
<span class='curline'><a href='../S/1054.html#L36485'>pFile</a>            36485 ext/sqlite3/libsqlite/sqlite3.c       OSTRACE(("FCNTL file=%p, rc=SQLITE_OK\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L36500'>pFile</a>            36500 ext/sqlite3/libsqlite/sqlite3.c       OSTRACE(("FCNTL file=%p, rc=SQLITE_OK\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L36506'>pFile</a>            36506 ext/sqlite3/libsqlite/sqlite3.c       HANDLE hOldFile = pFile-&gt;h;</span>
<span class='curline'><a href='../S/1054.html#L36507'>pFile</a>            36507 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;h = *phFile;</span>
<span class='curline'><a href='../S/1054.html#L36510'>pFile</a>            36510 ext/sqlite3/libsqlite/sqlite3.c                hOldFile, pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L36516'>pFile</a>            36516 ext/sqlite3/libsqlite/sqlite3.c       int rc = winGetTempname(pFile-&gt;pVfs, &amp;zTFile);</span>
<span class='curline'><a href='../S/1054.html#L36520'>pFile</a>            36520 ext/sqlite3/libsqlite/sqlite3.c       OSTRACE(("FCNTL file=%p, rc=%s\n", pFile-&gt;h, sqlite3ErrName(rc)));</span>
<span class='curline'><a href='../S/1054.html#L36530'>pFile</a>            36530 ext/sqlite3/libsqlite/sqlite3.c       *(i64*)pArg = pFile-&gt;mmapSizeMax;</span>
<span class='curline'><a href='../S/1054.html#L36531'>pFile</a>            36531 ext/sqlite3/libsqlite/sqlite3.c       if( newLimit&gt;=0 &amp;&amp; newLimit!=pFile-&gt;mmapSizeMax &amp;&amp; pFile-&gt;nFetchOut==0 ){</span>
<span class='curline'><a href='../S/1054.html#L36532'>pFile</a>            36532 ext/sqlite3/libsqlite/sqlite3.c         pFile-&gt;mmapSizeMax = newLimit;</span>
<span class='curline'><a href='../S/1054.html#L36533'>pFile</a>            36533 ext/sqlite3/libsqlite/sqlite3.c         if( pFile-&gt;mmapSize&gt;0 ){</span>
<span class='curline'><a href='../S/1054.html#L36534'>pFile</a>            36534 ext/sqlite3/libsqlite/sqlite3.c           winUnmapfile(pFile);</span>
<span class='curline'><a href='../S/1054.html#L36535'>pFile</a>            36535 ext/sqlite3/libsqlite/sqlite3.c           rc = winMapfile(pFile, -1);</span>
<span class='curline'><a href='../S/1054.html#L36538'>pFile</a>            36538 ext/sqlite3/libsqlite/sqlite3.c       OSTRACE(("FCNTL file=%p, rc=%s\n", pFile-&gt;h, sqlite3ErrName(rc)));</span>
<span class='curline'><a href='../S/1054.html#L36543'>pFile</a>            36543 ext/sqlite3/libsqlite/sqlite3.c   OSTRACE(("FCNTL file=%p, rc=SQLITE_NOTFOUND\n", pFile-&gt;h));</span>
<span class='curline'><a href='../S/1054.html#L36694'>pFile</a>            36694 ext/sqlite3/libsqlite/sqlite3.c   winShmNode *pFile,    /* Apply locks to this open shared-memory segment */</span>
<span class='curline'><a href='../S/1054.html#L36702'>pFile</a>            36702 ext/sqlite3/libsqlite/sqlite3.c   assert( sqlite3_mutex_held(pFile-&gt;mutex) || pFile-&gt;nRef==0 );</span>
<span class='curline'><a href='../S/1054.html#L36705'>pFile</a>            36705 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;hFile.h, lockType, ofst, nByte));</span>
<span class='curline'><a href='../S/1054.html#L36709'>pFile</a>            36709 ext/sqlite3/libsqlite/sqlite3.c     rc = winUnlockFile(&amp;pFile-&gt;hFile.h, ofst, 0, nByte, 0);</span>
<span class='curline'><a href='../S/1054.html#L36714'>pFile</a>            36714 ext/sqlite3/libsqlite/sqlite3.c     rc = winLockFile(&amp;pFile-&gt;hFile.h, dwFlags, ofst, 0, nByte, 0);</span>
<span class='curline'><a href='../S/1054.html#L36720'>pFile</a>            36720 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;lastErrno =  osGetLastError();</span>
<span class='curline'><a href='../S/1054.html#L36725'>pFile</a>            36725 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;hFile.h, (lockType == _SHM_UNLCK) ? "winUnlockFile" :</span>
<span class='curline'><a href='../S/1054.html#L36726'>pFile</a>            36726 ext/sqlite3/libsqlite/sqlite3.c            "winLockFile", pFile-&gt;lastErrno, sqlite3ErrName(rc)));</span>
<span class='curline'><a href='../S/1054.html#L37219'>pFile</a>            37219 ext/sqlite3/libsqlite/sqlite3.c static int winUnmapfile(winFile *pFile){</span>
<span class='curline'><a href='../S/1054.html#L37220'>pFile</a>            37220 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile!=0 );</span>
<span class='curline'><a href='../S/1054.html#L37223'>pFile</a>            37223 ext/sqlite3/libsqlite/sqlite3.c            osGetCurrentProcessId(), pFile, pFile-&gt;hMap, pFile-&gt;pMapRegion,</span>
<span class='curline'><a href='../S/1054.html#L37224'>pFile</a>            37224 ext/sqlite3/libsqlite/sqlite3.c            pFile-&gt;mmapSize, pFile-&gt;mmapSizeActual, pFile-&gt;mmapSizeMax));</span>
<span class='curline'><a href='../S/1054.html#L37225'>pFile</a>            37225 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;pMapRegion ){</span>
<span class='curline'><a href='../S/1054.html#L37226'>pFile</a>            37226 ext/sqlite3/libsqlite/sqlite3.c     if( !osUnmapViewOfFile(pFile-&gt;pMapRegion) ){</span>
<span class='curline'><a href='../S/1054.html#L37227'>pFile</a>            37227 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;lastErrno = osGetLastError();</span>
<span class='curline'><a href='../S/1054.html#L37229'>pFile</a>            37229 ext/sqlite3/libsqlite/sqlite3.c                "rc=SQLITE_IOERR_MMAP\n", osGetCurrentProcessId(), pFile,</span>
<span class='curline'><a href='../S/1054.html#L37230'>pFile</a>            37230 ext/sqlite3/libsqlite/sqlite3.c                pFile-&gt;pMapRegion));</span>
<span class='curline'><a href='../S/1054.html#L37231'>pFile</a>            37231 ext/sqlite3/libsqlite/sqlite3.c       return winLogError(SQLITE_IOERR_MMAP, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L37232'>pFile</a>            37232 ext/sqlite3/libsqlite/sqlite3.c                          "winUnmapfile1", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L37234'>pFile</a>            37234 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;pMapRegion = 0;</span>
<span class='curline'><a href='../S/1054.html#L37235'>pFile</a>            37235 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;mmapSize = 0;</span>
<span class='curline'><a href='../S/1054.html#L37236'>pFile</a>            37236 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;mmapSizeActual = 0;</span>
<span class='curline'><a href='../S/1054.html#L37238'>pFile</a>            37238 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;hMap!=NULL ){</span>
<span class='curline'><a href='../S/1054.html#L37239'>pFile</a>            37239 ext/sqlite3/libsqlite/sqlite3.c     if( !osCloseHandle(pFile-&gt;hMap) ){</span>
<span class='curline'><a href='../S/1054.html#L37240'>pFile</a>            37240 ext/sqlite3/libsqlite/sqlite3.c       pFile-&gt;lastErrno = osGetLastError();</span>
<span class='curline'><a href='../S/1054.html#L37242'>pFile</a>            37242 ext/sqlite3/libsqlite/sqlite3.c                osGetCurrentProcessId(), pFile, pFile-&gt;hMap));</span>
<span class='curline'><a href='../S/1054.html#L37243'>pFile</a>            37243 ext/sqlite3/libsqlite/sqlite3.c       return winLogError(SQLITE_IOERR_MMAP, pFile-&gt;lastErrno,</span>
<span class='curline'><a href='../S/1054.html#L37244'>pFile</a>            37244 ext/sqlite3/libsqlite/sqlite3.c                          "winUnmapfile2", pFile-&gt;zPath);</span>
<span class='curline'><a href='../S/1054.html#L37246'>pFile</a>            37246 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;hMap = NULL;</span>
<span class='curline'><a href='../S/1054.html#L37249'>pFile</a>            37249 ext/sqlite3/libsqlite/sqlite3.c            osGetCurrentProcessId(), pFile));</span>
<span class='curline'><a href='../S/1054.html#L37819'>pFile</a>            37819 ext/sqlite3/libsqlite/sqlite3.c   winFile *pFile = (winFile*)id;</span>
<span class='curline'><a href='../S/1054.html#L37877'>pFile</a>            37877 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile!=0 );</span>
<span class='curline'><a href='../S/1054.html#L37878'>pFile</a>            37878 ext/sqlite3/libsqlite/sqlite3.c   memset(pFile, 0, sizeof(winFile));</span>
<span class='curline'><a href='../S/1054.html#L37879'>pFile</a>            37879 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;h = INVALID_HANDLE_VALUE;</span>
<span class='curline'><a href='../S/1054.html#L38014'>pFile</a>            38014 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;lastErrno = lastErrno;</span>
<span class='curline'><a href='../S/1054.html#L38015'>pFile</a>            38015 ext/sqlite3/libsqlite/sqlite3.c     winLogError(SQLITE_CANTOPEN, pFile-&gt;lastErrno, "winOpen", zUtf8Name);</span>
<span class='curline'><a href='../S/1054.html#L38042'>pFile</a>            38042 ext/sqlite3/libsqlite/sqlite3.c        &amp;&amp; (rc = winceCreateLock(zName, pFile))!=SQLITE_OK</span>
<span class='curline'><a href='../S/1054.html#L38051'>pFile</a>            38051 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;zDeleteOnClose = zConverted;</span>
<span class='curline'><a href='../S/1054.html#L38059'>pFile</a>            38059 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;pMethod = &amp;winIoMethod;</span>
<span class='curline'><a href='../S/1054.html#L38060'>pFile</a>            38060 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;pVfs = pVfs;</span>
<span class='curline'><a href='../S/1054.html#L38061'>pFile</a>            38061 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;h = h;</span>
<span class='curline'><a href='../S/1054.html#L38063'>pFile</a>            38063 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;ctrlFlags |= WINFILE_RDONLY;</span>
<span class='curline'><a href='../S/1054.html#L38066'>pFile</a>            38066 ext/sqlite3/libsqlite/sqlite3.c     pFile-&gt;ctrlFlags |= WINFILE_PSOW;</span>
<span class='curline'><a href='../S/1054.html#L38068'>pFile</a>            38068 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;lastErrno = NO_ERROR;</span>
<span class='curline'><a href='../S/1054.html#L38069'>pFile</a>            38069 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;zPath = zName;</span>
<span class='curline'><a href='../S/1054.html#L38071'>pFile</a>            38071 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;hMap = NULL;</span>
<span class='curline'><a href='../S/1054.html#L38072'>pFile</a>            38072 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;pMapRegion = 0;</span>
<span class='curline'><a href='../S/1054.html#L38073'>pFile</a>            38073 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;mmapSize = 0;</span>
<span class='curline'><a href='../S/1054.html#L38074'>pFile</a>            38074 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;mmapSizeActual = 0;</span>
<span class='curline'><a href='../S/1054.html#L38075'>pFile</a>            38075 ext/sqlite3/libsqlite/sqlite3.c   pFile-&gt;mmapSizeMax = sqlite3GlobalConfig.szMmap;</span>
<span class='curline'><a href='../S/1054.html#L44194'>pFile</a>            44194 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE int sqlite3SectorSize(sqlite3_file *pFile){</span>
<span class='curline'><a href='../S/1054.html#L44195'>pFile</a>            44195 ext/sqlite3/libsqlite/sqlite3.c   int iRet = sqlite3OsSectorSize(pFile);</span>
<span class='curline'><a href='../S/1054.html#L45151'>pFile</a>            45151 ext/sqlite3/libsqlite/sqlite3.c   sqlite3_file *pFile,  /* Write the file descriptor here */</span>
<span class='curline'><a href='../S/1054.html#L45162'>pFile</a>            45162 ext/sqlite3/libsqlite/sqlite3.c   rc = sqlite3OsOpen(pPager-&gt;pVfs, 0, pFile, vfsFlags, 0);</span>
<span class='curline'><a href='../S/1054.html#L45163'>pFile</a>            45163 ext/sqlite3/libsqlite/sqlite3.c   assert( rc!=SQLITE_OK || isOpen(pFile) );</span>
<span class='curline'><a href='../S/1054.html#L62628'>pFile</a>            62628 ext/sqlite3/libsqlite/sqlite3.c static int backupTruncateFile(sqlite3_file *pFile, i64 iSize){</span>
<span class='curline'><a href='../S/1054.html#L62630'>pFile</a>            62630 ext/sqlite3/libsqlite/sqlite3.c   int rc = sqlite3OsFileSize(pFile, &amp;iCurrent);</span>
<span class='curline'><a href='../S/1054.html#L62632'>pFile</a>            62632 ext/sqlite3/libsqlite/sqlite3.c     rc = sqlite3OsTruncate(pFile, iSize);</span>
<span class='curline'><a href='../S/1054.html#L62798'>pFile</a>            62798 ext/sqlite3/libsqlite/sqlite3.c           sqlite3_file * const pFile = sqlite3PagerFile(pDestPager);</span>
<span class='curline'><a href='../S/1054.html#L62804'>pFile</a>            62804 ext/sqlite3/libsqlite/sqlite3.c           assert( pFile );</span>
<span class='curline'><a href='../S/1054.html#L62844'>pFile</a>            62844 ext/sqlite3/libsqlite/sqlite3.c               rc = sqlite3OsWrite(pFile, zData, pgszSrc, iOff);</span>
<span class='curline'><a href='../S/1054.html#L62849'>pFile</a>            62849 ext/sqlite3/libsqlite/sqlite3.c             rc = backupTruncateFile(pFile, iSize);</span>
<span class='curline'><a href='../S/1054.html#L78511'>pFile</a>            78511 ext/sqlite3/libsqlite/sqlite3.c static int vdbeSorterMapFile(SortSubtask *pTask, SorterFile *pFile, u8 **pp){</span>
<span class='curline'><a href='../S/1054.html#L78513'>pFile</a>            78513 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;iEof&lt;=(i64)(pTask-&gt;pSorter-&gt;db-&gt;nMaxSorterMmap) ){</span>
<span class='curline'><a href='../S/1054.html#L78514'>pFile</a>            78514 ext/sqlite3/libsqlite/sqlite3.c     sqlite3_file *pFd = pFile-&gt;pFd;</span>
<span class='curline'><a href='../S/1054.html#L78516'>pFile</a>            78516 ext/sqlite3/libsqlite/sqlite3.c       rc = sqlite3OsFetch(pFd, 0, (int)pFile-&gt;iEof, (void**)pp);</span>
<span class='curline'><a href='../S/1054.html#L78531'>pFile</a>            78531 ext/sqlite3/libsqlite/sqlite3.c   SorterFile *pFile,              /* Sorter file to read from */</span>
<span class='curline'><a href='../S/1054.html#L78544'>pFile</a>            78544 ext/sqlite3/libsqlite/sqlite3.c   pReadr-&gt;iEof = pFile-&gt;iEof;</span>
<span class='curline'><a href='../S/1054.html#L78545'>pFile</a>            78545 ext/sqlite3/libsqlite/sqlite3.c   pReadr-&gt;pFd = pFile-&gt;pFd;</span>
<span class='curline'><a href='../S/1054.html#L78547'>pFile</a>            78547 ext/sqlite3/libsqlite/sqlite3.c   rc = vdbeSorterMapFile(pTask, pFile, &amp;pReadr-&gt;aMap);</span>
<span class='curline'><a href='../S/1054.html#L78624'>pFile</a>            78624 ext/sqlite3/libsqlite/sqlite3.c   SorterFile *pFile,              /* Sorter file to read from */</span>
<span class='curline'><a href='../S/1054.html#L78631'>pFile</a>            78631 ext/sqlite3/libsqlite/sqlite3.c   assert( pFile-&gt;iEof&gt;iStart );</span>
<span class='curline'><a href='../S/1054.html#L78636'>pFile</a>            78636 ext/sqlite3/libsqlite/sqlite3.c   rc = vdbePmaReaderSeek(pTask, pReadr, pFile, iStart);</span>
<span class='curline'><a href='../S/1054.html#L104491'>pFile</a>            104491 ext/sqlite3/libsqlite/sqlite3.c       sqlite3_file *pFile = sqlite3PagerFile(pPager);</span>
<span class='curline'><a href='../S/1054.html#L104492'>pFile</a>            104492 ext/sqlite3/libsqlite/sqlite3.c       sqlite3OsFileControlHint(pFile, SQLITE_GET_LOCKPROXYFILE, </span>
<span class='curline'><a href='../S/1054.html#L104504'>pFile</a>            104504 ext/sqlite3/libsqlite/sqlite3.c       sqlite3_file *pFile = sqlite3PagerFile(pPager);</span>
<span class='curline'><a href='../S/1054.html#L104507'>pFile</a>            104507 ext/sqlite3/libsqlite/sqlite3.c         res=sqlite3OsFileControl(pFile, SQLITE_SET_LOCKPROXYFILE, </span>
<span class='curline'><a href='../S/1054.html#L104510'>pFile</a>            104510 ext/sqlite3/libsqlite/sqlite3.c         res=sqlite3OsFileControl(pFile, SQLITE_SET_LOCKPROXYFILE, </span>
</pre>
</body>
</html>
