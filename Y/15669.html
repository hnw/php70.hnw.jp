<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>dh</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/851.html#L3521'>dh</a>               3521 ext/openssl/openssl.c 			assert(pkey-&gt;pkey.dh != NULL);</span>
<span class='curline'><a href='../S/851.html#L3523'>dh</a>               3523 ext/openssl/openssl.c 			if (NULL == pkey-&gt;pkey.dh-&gt;p || NULL == pkey-&gt;pkey.dh-&gt;priv_key) {</span>
<span class='curline'><a href='../S/851.html#L3634'>dh</a>               3634 ext/openssl/openssl.c 				DH *dh = DH_new();</span>
<span class='curline'><a href='../S/851.html#L3635'>dh</a>               3635 ext/openssl/openssl.c 				if (dh) {</span>
<span class='curline'><a href='../S/851.html#L3636'>dh</a>               3636 ext/openssl/openssl.c 					OPENSSL_PKEY_SET_BN(Z_ARRVAL_P(data), dh, p);</span>
<span class='curline'><a href='../S/851.html#L3637'>dh</a>               3637 ext/openssl/openssl.c 					OPENSSL_PKEY_SET_BN(Z_ARRVAL_P(data), dh, g);</span>
<span class='curline'><a href='../S/851.html#L3638'>dh</a>               3638 ext/openssl/openssl.c 					OPENSSL_PKEY_SET_BN(Z_ARRVAL_P(data), dh, priv_key);</span>
<span class='curline'><a href='../S/851.html#L3639'>dh</a>               3639 ext/openssl/openssl.c 					OPENSSL_PKEY_SET_BN(Z_ARRVAL_P(data), dh, pub_key);</span>
<span class='curline'><a href='../S/851.html#L3640'>dh</a>               3640 ext/openssl/openssl.c 					if (dh-&gt;p &amp;&amp; dh-&gt;g &amp;&amp;</span>
<span class='curline'><a href='../S/851.html#L3641'>dh</a>               3641 ext/openssl/openssl.c 							(dh-&gt;pub_key || DH_generate_key(dh)) &amp;&amp;</span>
<span class='curline'><a href='../S/851.html#L3642'>dh</a>               3642 ext/openssl/openssl.c 							EVP_PKEY_assign_DH(pkey, dh)) {</span>
<span class='curline'><a href='../S/851.html#L3646'>dh</a>               3646 ext/openssl/openssl.c 					DH_free(dh);</span>
<span class='curline'><a href='../S/851.html#L3954'>dh</a>               3954 ext/openssl/openssl.c 			if (pkey-&gt;pkey.dh != NULL) {</span>
<span class='curline'><a href='../S/851.html#L3955'>dh</a>               3955 ext/openssl/openssl.c 				zval dh;</span>
<span class='curline'><a href='../S/851.html#L3957'>dh</a>               3957 ext/openssl/openssl.c 				array_init(&amp;dh);</span>
<span class='curline'><a href='../S/851.html#L3958'>dh</a>               3958 ext/openssl/openssl.c 				OPENSSL_PKEY_GET_BN(dh, p);</span>
<span class='curline'><a href='../S/851.html#L3959'>dh</a>               3959 ext/openssl/openssl.c 				OPENSSL_PKEY_GET_BN(dh, g);</span>
<span class='curline'><a href='../S/851.html#L3960'>dh</a>               3960 ext/openssl/openssl.c 				OPENSSL_PKEY_GET_BN(dh, priv_key);</span>
<span class='curline'><a href='../S/851.html#L3961'>dh</a>               3961 ext/openssl/openssl.c 				OPENSSL_PKEY_GET_BN(dh, pub_key);</span>
<span class='curline'><a href='../S/851.html#L3962'>dh</a>               3962 ext/openssl/openssl.c 				add_assoc_zval(return_value, "dh", &amp;dh);</span>
<span class='curline'><a href='../S/851.html#L5448'>dh</a>               5448 ext/openssl/openssl.c 	if (EVP_PKEY_type(pkey-&gt;type) != EVP_PKEY_DH || !pkey-&gt;pkey.dh) {</span>
<span class='curline'><a href='../S/851.html#L5455'>dh</a>               5455 ext/openssl/openssl.c 	data = zend_string_alloc(DH_size(pkey-&gt;pkey.dh), 0);</span>
<span class='curline'><a href='../S/851.html#L5456'>dh</a>               5456 ext/openssl/openssl.c 	len = DH_compute_key((unsigned char*)ZSTR_VAL(data), pub, pkey-&gt;pkey.dh);</span>
<span class='curline'><a href='../S/853.html#L1169'>dh</a>               1169 ext/openssl/xp_ssl.c 	DH *dh;</span>
<span class='curline'><a href='../S/853.html#L1192'>dh</a>               1192 ext/openssl/xp_ssl.c 	dh = PEM_read_bio_DHparams(bio, NULL, NULL, NULL);</span>
<span class='curline'><a href='../S/853.html#L1195'>dh</a>               1195 ext/openssl/xp_ssl.c 	if (dh == NULL) {</span>
<span class='curline'><a href='../S/853.html#L1200'>dh</a>               1200 ext/openssl/xp_ssl.c 	if (SSL_CTX_set_tmp_dh(ctx, dh) &lt; 0) {</span>
<span class='curline'><a href='../S/853.html#L1202'>dh</a>               1202 ext/openssl/xp_ssl.c 		DH_free(dh);</span>
<span class='curline'><a href='../S/853.html#L1206'>dh</a>               1206 ext/openssl/xp_ssl.c 	DH_free(dh);</span>
</pre>
</body>
</html>
