<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>pkey</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/851.html#L573'>pkey</a>              573 ext/openssl/openssl.c 	EVP_PKEY *pkey = (EVP_PKEY *)rsrc-&gt;ptr;</span>
<span class='curline'><a href='../S/851.html#L575'>pkey</a>              575 ext/openssl/openssl.c 	assert(pkey != NULL);</span>
<span class='curline'><a href='../S/851.html#L577'>pkey</a>              577 ext/openssl/openssl.c 	EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L646'>pkey</a>              646 ext/openssl/openssl.c static int php_openssl_is_private_key(EVP_PKEY* pkey);</span>
<span class='curline'><a href='../S/851.html#L1508'>pkey</a>             1508 ext/openssl/openssl.c 	EVP_PKEY * pkey = NULL;</span>
<span class='curline'><a href='../S/851.html#L1517'>pkey</a>             1517 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(zpkey, 0, challenge, 1, &amp;keyresource);</span>
<span class='curline'><a href='../S/851.html#L1519'>pkey</a>             1519 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/851.html#L1551'>pkey</a>             1551 ext/openssl/openssl.c 	if (!NETSCAPE_SPKI_set_pubkey(spki, pkey)) {</span>
<span class='curline'><a href='../S/851.html#L1556'>pkey</a>             1556 ext/openssl/openssl.c 	if (!NETSCAPE_SPKI_sign(spki, pkey, mdtype)) {</span>
<span class='curline'><a href='../S/851.html#L1579'>pkey</a>             1579 ext/openssl/openssl.c 	if (keyresource == NULL &amp;&amp; pkey != NULL) {</span>
<span class='curline'><a href='../S/851.html#L1580'>pkey</a>             1580 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L1604'>pkey</a>             1604 ext/openssl/openssl.c 	EVP_PKEY *pkey = NULL;</span>
<span class='curline'><a href='../S/851.html#L1631'>pkey</a>             1631 ext/openssl/openssl.c 	pkey = X509_PUBKEY_get(spki-&gt;spkac-&gt;pubkey);</span>
<span class='curline'><a href='../S/851.html#L1632'>pkey</a>             1632 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/851.html#L1637'>pkey</a>             1637 ext/openssl/openssl.c 	i = NETSCAPE_SPKI_verify(spki, pkey);</span>
<span class='curline'><a href='../S/851.html#L1644'>pkey</a>             1644 ext/openssl/openssl.c 	if (pkey != NULL) {</span>
<span class='curline'><a href='../S/851.html#L1645'>pkey</a>             1645 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L1665'>pkey</a>             1665 ext/openssl/openssl.c 	EVP_PKEY *pkey = NULL;</span>
<span class='curline'><a href='../S/851.html#L1693'>pkey</a>             1693 ext/openssl/openssl.c 	pkey = X509_PUBKEY_get(spki-&gt;spkac-&gt;pubkey);</span>
<span class='curline'><a href='../S/851.html#L1694'>pkey</a>             1694 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/851.html#L1700'>pkey</a>             1700 ext/openssl/openssl.c 	if (out &amp;&amp; PEM_write_bio_PUBKEY(out, pkey)) {</span>
<span class='curline'><a href='../S/851.html#L1716'>pkey</a>             1716 ext/openssl/openssl.c 	if (pkey != NULL) {</span>
<span class='curline'><a href='../S/851.html#L1717'>pkey</a>             1717 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L2562'>pkey</a>             2562 ext/openssl/openssl.c 	EVP_PKEY * pkey = NULL;</span>
<span class='curline'><a href='../S/851.html#L2581'>pkey</a>             2581 ext/openssl/openssl.c 		if(PKCS12_parse(p12, pass, &amp;pkey, &amp;cert, &amp;ca)) {</span>
<span class='curline'><a href='../S/851.html#L2597'>pkey</a>             2597 ext/openssl/openssl.c 			if (PEM_write_bio_PrivateKey(bio_out, pkey, NULL, NULL, 0, 0, NULL)) {</span>
<span class='curline'><a href='../S/851.html#L2649'>pkey</a>             2649 ext/openssl/openssl.c 	if (pkey) {</span>
<span class='curline'><a href='../S/851.html#L2650'>pkey</a>             2650 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L3492'>pkey</a>             3492 ext/openssl/openssl.c static int php_openssl_is_private_key(EVP_PKEY* pkey)</span>
<span class='curline'><a href='../S/851.html#L3494'>pkey</a>             3494 ext/openssl/openssl.c 	assert(pkey != NULL);</span>
<span class='curline'><a href='../S/851.html#L3496'>pkey</a>             3496 ext/openssl/openssl.c 	switch (pkey-&gt;type) {</span>
<span class='curline'><a href='../S/851.html#L3500'>pkey</a>             3500 ext/openssl/openssl.c 			assert(pkey-&gt;pkey.rsa != NULL);</span>
<span class='curline'><a href='../S/851.html#L3501'>pkey</a>             3501 ext/openssl/openssl.c 			if (pkey-&gt;pkey.rsa != NULL &amp;&amp; (NULL == pkey-&gt;pkey.rsa-&gt;p || NULL == pkey-&gt;pkey.rsa-&gt;q)) {</span>
<span class='curline'><a href='../S/851.html#L3512'>pkey</a>             3512 ext/openssl/openssl.c 			assert(pkey-&gt;pkey.dsa != NULL);</span>
<span class='curline'><a href='../S/851.html#L3514'>pkey</a>             3514 ext/openssl/openssl.c 			if (NULL == pkey-&gt;pkey.dsa-&gt;p || NULL == pkey-&gt;pkey.dsa-&gt;q || NULL == pkey-&gt;pkey.dsa-&gt;priv_key){</span>
<span class='curline'><a href='../S/851.html#L3521'>pkey</a>             3521 ext/openssl/openssl.c 			assert(pkey-&gt;pkey.dh != NULL);</span>
<span class='curline'><a href='../S/851.html#L3523'>pkey</a>             3523 ext/openssl/openssl.c 			if (NULL == pkey-&gt;pkey.dh-&gt;p || NULL == pkey-&gt;pkey.dh-&gt;priv_key) {</span>
<span class='curline'><a href='../S/851.html#L3530'>pkey</a>             3530 ext/openssl/openssl.c 			assert(pkey-&gt;pkey.ec != NULL);</span>
<span class='curline'><a href='../S/851.html#L3532'>pkey</a>             3532 ext/openssl/openssl.c 			if ( NULL == EC_KEY_get0_private_key(pkey-&gt;pkey.ec)) {</span>
<span class='curline'><a href='../S/851.html#L3546'>pkey</a>             3546 ext/openssl/openssl.c 		if (pkey-&gt;pkey._type-&gt;_name != NULL) {							\</span>
<span class='curline'><a href='../S/851.html#L3547'>pkey</a>             3547 ext/openssl/openssl.c 			int len = BN_num_bytes(pkey-&gt;pkey._type-&gt;_name);			\</span>
<span class='curline'><a href='../S/851.html#L3549'>pkey</a>             3549 ext/openssl/openssl.c 			BN_bn2bin(pkey-&gt;pkey._type-&gt;_name, (unsigned char*)ZSTR_VAL(str));	\</span>
<span class='curline'><a href='../S/851.html#L3580'>pkey</a>             3580 ext/openssl/openssl.c 		EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/851.html#L3584'>pkey</a>             3584 ext/openssl/openssl.c 			pkey = EVP_PKEY_new();</span>
<span class='curline'><a href='../S/851.html#L3585'>pkey</a>             3585 ext/openssl/openssl.c 			if (pkey) {</span>
<span class='curline'><a href='../S/851.html#L3597'>pkey</a>             3597 ext/openssl/openssl.c 						if (EVP_PKEY_assign_RSA(pkey, rsa)) {</span>
<span class='curline'><a href='../S/851.html#L3598'>pkey</a>             3598 ext/openssl/openssl.c 							RETURN_RES(zend_register_resource(pkey, le_key));</span>
<span class='curline'><a href='../S/851.html#L3603'>pkey</a>             3603 ext/openssl/openssl.c 				EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L3608'>pkey</a>             3608 ext/openssl/openssl.c 			pkey = EVP_PKEY_new();</span>
<span class='curline'><a href='../S/851.html#L3609'>pkey</a>             3609 ext/openssl/openssl.c 			if (pkey) {</span>
<span class='curline'><a href='../S/851.html#L3621'>pkey</a>             3621 ext/openssl/openssl.c 						if (EVP_PKEY_assign_DSA(pkey, dsa)) {</span>
<span class='curline'><a href='../S/851.html#L3622'>pkey</a>             3622 ext/openssl/openssl.c 							RETURN_RES(zend_register_resource(pkey, le_key));</span>
<span class='curline'><a href='../S/851.html#L3627'>pkey</a>             3627 ext/openssl/openssl.c 				EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L3632'>pkey</a>             3632 ext/openssl/openssl.c 			pkey = EVP_PKEY_new();</span>
<span class='curline'><a href='../S/851.html#L3633'>pkey</a>             3633 ext/openssl/openssl.c 			if (pkey) {</span>
<span class='curline'><a href='../S/851.html#L3642'>pkey</a>             3642 ext/openssl/openssl.c 							EVP_PKEY_assign_DH(pkey, dh)) {</span>
<span class='curline'><a href='../S/851.html#L3643'>pkey</a>             3643 ext/openssl/openssl.c 						ZVAL_COPY_VALUE(return_value, zend_list_insert(pkey, le_key));</span>
<span class='curline'><a href='../S/851.html#L3648'>pkey</a>             3648 ext/openssl/openssl.c 				EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L3828'>pkey</a>             3828 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/851.html#L3834'>pkey</a>             3834 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(cert, 1, NULL, 1, &amp;res);</span>
<span class='curline'><a href='../S/851.html#L3835'>pkey</a>             3835 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/851.html#L3848'>pkey</a>             3848 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/851.html#L3853'>pkey</a>             3853 ext/openssl/openssl.c 	if ((pkey = (EVP_PKEY *)zend_fetch_resource(Z_RES_P(key), "OpenSSL key", le_key)) == NULL) {</span>
<span class='curline'><a href='../S/851.html#L3865'>pkey</a>             3865 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/851.html#L3873'>pkey</a>             3873 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(cert, 0, passphrase, 1, &amp;res);</span>
<span class='curline'><a href='../S/851.html#L3875'>pkey</a>             3875 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/851.html#L3889'>pkey</a>             3889 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/851.html#L3898'>pkey</a>             3898 ext/openssl/openssl.c 	if ((pkey = (EVP_PKEY *)zend_fetch_resource(Z_RES_P(key), "OpenSSL key", le_key)) == NULL) {</span>
<span class='curline'><a href='../S/851.html#L3902'>pkey</a>             3902 ext/openssl/openssl.c 	PEM_write_bio_PUBKEY(out, pkey);</span>
<span class='curline'><a href='../S/851.html#L3906'>pkey</a>             3906 ext/openssl/openssl.c 	add_assoc_long(return_value, "bits", EVP_PKEY_bits(pkey));</span>
<span class='curline'><a href='../S/851.html#L3911'>pkey</a>             3911 ext/openssl/openssl.c 	switch (EVP_PKEY_type(pkey-&gt;type)) {</span>
<span class='curline'><a href='../S/851.html#L3916'>pkey</a>             3916 ext/openssl/openssl.c 			if (pkey-&gt;pkey.rsa != NULL) {</span>
<span class='curline'><a href='../S/851.html#L3938'>pkey</a>             3938 ext/openssl/openssl.c 			if (pkey-&gt;pkey.dsa != NULL) {</span>
<span class='curline'><a href='../S/851.html#L3954'>pkey</a>             3954 ext/openssl/openssl.c 			if (pkey-&gt;pkey.dh != NULL) {</span>
<span class='curline'><a href='../S/851.html#L3969'>pkey</a>             3969 ext/openssl/openssl.c 			if (pkey-&gt;pkey.ec != NULL) {</span>
<span class='curline'><a href='../S/851.html#L3978'>pkey</a>             3978 ext/openssl/openssl.c 				ec_group = EC_KEY_get0_group(EVP_PKEY_get1_EC_KEY(pkey));</span>
<span class='curline'><a href='../S/851.html#L4500'>pkey</a>             4500 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/851.html#L4514'>pkey</a>             4514 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(key, 0, "", 0, &amp;keyresource);</span>
<span class='curline'><a href='../S/851.html#L4516'>pkey</a>             4516 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/851.html#L4523'>pkey</a>             4523 ext/openssl/openssl.c 	cryptedlen = EVP_PKEY_size(pkey);</span>
<span class='curline'><a href='../S/851.html#L4526'>pkey</a>             4526 ext/openssl/openssl.c 	switch (pkey-&gt;type) {</span>
<span class='curline'><a href='../S/851.html#L4532'>pkey</a>             4532 ext/openssl/openssl.c 						pkey-&gt;pkey.rsa,</span>
<span class='curline'><a href='../S/851.html#L4550'>pkey</a>             4550 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L4560'>pkey</a>             4560 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/851.html#L4575'>pkey</a>             4575 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(key, 0, "", 0, &amp;keyresource);</span>
<span class='curline'><a href='../S/851.html#L4576'>pkey</a>             4576 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/851.html#L4583'>pkey</a>             4583 ext/openssl/openssl.c 	cryptedlen = EVP_PKEY_size(pkey);</span>
<span class='curline'><a href='../S/851.html#L4586'>pkey</a>             4586 ext/openssl/openssl.c 	switch (pkey-&gt;type) {</span>
<span class='curline'><a href='../S/851.html#L4592'>pkey</a>             4592 ext/openssl/openssl.c 					pkey-&gt;pkey.rsa,</span>
<span class='curline'><a href='../S/851.html#L4615'>pkey</a>             4615 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L4628'>pkey</a>             4628 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/851.html#L4641'>pkey</a>             4641 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(key, 1, NULL, 0, &amp;keyresource);</span>
<span class='curline'><a href='../S/851.html#L4642'>pkey</a>             4642 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/851.html#L4649'>pkey</a>             4649 ext/openssl/openssl.c 	cryptedlen = EVP_PKEY_size(pkey);</span>
<span class='curline'><a href='../S/851.html#L4652'>pkey</a>             4652 ext/openssl/openssl.c 	switch (pkey-&gt;type) {</span>
<span class='curline'><a href='../S/851.html#L4658'>pkey</a>             4658 ext/openssl/openssl.c 						pkey-&gt;pkey.rsa,</span>
<span class='curline'><a href='../S/851.html#L4674'>pkey</a>             4674 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L4687'>pkey</a>             4687 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/851.html#L4702'>pkey</a>             4702 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(key, 1, NULL, 0, &amp;keyresource);</span>
<span class='curline'><a href='../S/851.html#L4703'>pkey</a>             4703 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/851.html#L4710'>pkey</a>             4710 ext/openssl/openssl.c 	cryptedlen = EVP_PKEY_size(pkey);</span>
<span class='curline'><a href='../S/851.html#L4713'>pkey</a>             4713 ext/openssl/openssl.c 	switch (pkey-&gt;type) {</span>
<span class='curline'><a href='../S/851.html#L4719'>pkey</a>             4719 ext/openssl/openssl.c 					pkey-&gt;pkey.rsa,</span>
<span class='curline'><a href='../S/851.html#L4747'>pkey</a>             4747 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L4777'>pkey</a>             4777 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/851.html#L4791'>pkey</a>             4791 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(key, 0, "", 0, &amp;keyresource);</span>
<span class='curline'><a href='../S/851.html#L4792'>pkey</a>             4792 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/851.html#L4813'>pkey</a>             4813 ext/openssl/openssl.c 	siglen = EVP_PKEY_size(pkey);</span>
<span class='curline'><a href='../S/851.html#L4818'>pkey</a>             4818 ext/openssl/openssl.c 	if (EVP_SignFinal (&amp;md_ctx, (unsigned char*)ZSTR_VAL(sigbuf), &amp;siglen, pkey)) {</span>
<span class='curline'><a href='../S/851.html#L4830'>pkey</a>             4830 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L4840'>pkey</a>             4840 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/851.html#L4874'>pkey</a>             4874 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(key, 1, NULL, 0, &amp;keyresource);</span>
<span class='curline'><a href='../S/851.html#L4875'>pkey</a>             4875 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/851.html#L4882'>pkey</a>             4882 ext/openssl/openssl.c 	err = EVP_VerifyFinal(&amp;md_ctx, (unsigned char *)signature, (unsigned int)signature_len, pkey);</span>
<span class='curline'><a href='../S/851.html#L4886'>pkey</a>             4886 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L5026'>pkey</a>             5026 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/851.html#L5044'>pkey</a>             5044 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(privkey, 0, "", 0, &amp;keyresource);</span>
<span class='curline'><a href='../S/851.html#L5045'>pkey</a>             5045 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/851.html#L5081'>pkey</a>             5081 ext/openssl/openssl.c 	if (EVP_OpenInit(&amp;ctx, cipher, (unsigned char *)ekey, (int)ekey_len, iv_buf, pkey) &amp;&amp;</span>
<span class='curline'><a href='../S/851.html#L5098'>pkey</a>             5098 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/851.html#L5437'>pkey</a>             5437 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/851.html#L5445'>pkey</a>             5445 ext/openssl/openssl.c 	if ((pkey = (EVP_PKEY *)zend_fetch_resource(Z_RES_P(key), "OpenSSL key", le_key)) == NULL) {</span>
<span class='curline'><a href='../S/851.html#L5448'>pkey</a>             5448 ext/openssl/openssl.c 	if (EVP_PKEY_type(pkey-&gt;type) != EVP_PKEY_DH || !pkey-&gt;pkey.dh) {</span>
<span class='curline'><a href='../S/851.html#L5455'>pkey</a>             5455 ext/openssl/openssl.c 	data = zend_string_alloc(DH_size(pkey-&gt;pkey.dh), 0);</span>
<span class='curline'><a href='../S/851.html#L5456'>pkey</a>             5456 ext/openssl/openssl.c 	len = DH_compute_key((unsigned char*)ZSTR_VAL(data), pub, pkey-&gt;pkey.dh);</span>
</pre>
</body>
</html>
