<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>ms</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/160.html#L123'>ms</a>                123 ext/fileinfo/libmagic/apprentice.c private int getvalue(struct magic_set *ms, struct magic *, const char **, int);</span>
<span class='curline'><a href='../S/160.html#L404'>ms</a>                404 ext/fileinfo/libmagic/apprentice.c apprentice_1(struct magic_set *ms, const char *fn, int action)</span>
<span class='curline'><a href='../S/160.html#L411'>ms</a>                411 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "magic element size %lu != %lu",</span>
<span class='curline'><a href='../S/160.html#L418'>ms</a>                418 ext/fileinfo/libmagic/apprentice.c 		map = apprentice_load(ms, fn, action);</span>
<span class='curline'><a href='../S/160.html#L421'>ms</a>                421 ext/fileinfo/libmagic/apprentice.c 		return apprentice_compile(ms, map, fn);</span>
<span class='curline'><a href='../S/160.html#L424'>ms</a>                424 ext/fileinfo/libmagic/apprentice.c 	map = apprentice_map(ms, fn);</span>
<span class='curline'><a href='../S/160.html#L427'>ms</a>                427 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L428'>ms</a>                428 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "using regular magic file `%s'", fn);</span>
<span class='curline'><a href='../S/160.html#L429'>ms</a>                429 ext/fileinfo/libmagic/apprentice.c 			map = apprentice_load(ms, fn, action);</span>
<span class='curline'><a href='../S/160.html#L436'>ms</a>                436 ext/fileinfo/libmagic/apprentice.c 		if (add_mlist(ms-&gt;mlist[i], map, i) == -1) {</span>
<span class='curline'><a href='../S/160.html#L437'>ms</a>                437 ext/fileinfo/libmagic/apprentice.c 			file_oomem(ms, sizeof(*ml));</span>
<span class='curline'><a href='../S/160.html#L447'>ms</a>                447 ext/fileinfo/libmagic/apprentice.c 			apprentice_list(ms-&gt;mlist[i], BINTEST);</span>
<span class='curline'><a href='../S/160.html#L449'>ms</a>                449 ext/fileinfo/libmagic/apprentice.c 			apprentice_list(ms-&gt;mlist[i], TEXTTEST);</span>
<span class='curline'><a href='../S/160.html#L456'>ms</a>                456 ext/fileinfo/libmagic/apprentice.c file_ms_free(struct magic_set *ms)</span>
<span class='curline'><a href='../S/160.html#L459'>ms</a>                459 ext/fileinfo/libmagic/apprentice.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/160.html#L462'>ms</a>                462 ext/fileinfo/libmagic/apprentice.c 		mlist_free(ms-&gt;mlist[i]);</span>
<span class='curline'><a href='../S/160.html#L463'>ms</a>                463 ext/fileinfo/libmagic/apprentice.c 	if (ms-&gt;o.pbuf) {</span>
<span class='curline'><a href='../S/160.html#L464'>ms</a>                464 ext/fileinfo/libmagic/apprentice.c 		efree(ms-&gt;o.pbuf);</span>
<span class='curline'><a href='../S/160.html#L466'>ms</a>                466 ext/fileinfo/libmagic/apprentice.c 	if (ms-&gt;o.buf) {</span>
<span class='curline'><a href='../S/160.html#L467'>ms</a>                467 ext/fileinfo/libmagic/apprentice.c 		efree(ms-&gt;o.buf);</span>
<span class='curline'><a href='../S/160.html#L469'>ms</a>                469 ext/fileinfo/libmagic/apprentice.c 	if (ms-&gt;c.li) {</span>
<span class='curline'><a href='../S/160.html#L470'>ms</a>                470 ext/fileinfo/libmagic/apprentice.c 		efree(ms-&gt;c.li);</span>
<span class='curline'><a href='../S/160.html#L472'>ms</a>                472 ext/fileinfo/libmagic/apprentice.c 	efree(ms);</span>
<span class='curline'><a href='../S/160.html#L478'>ms</a>                478 ext/fileinfo/libmagic/apprentice.c 	struct magic_set *ms;</span>
<span class='curline'><a href='../S/160.html#L481'>ms</a>                481 ext/fileinfo/libmagic/apprentice.c 	if ((ms = CAST(struct magic_set *, ecalloc((size_t)1,</span>
<span class='curline'><a href='../S/160.html#L485'>ms</a>                485 ext/fileinfo/libmagic/apprentice.c 	if (magic_setflags(ms, flags) == -1) {</span>
<span class='curline'><a href='../S/160.html#L490'>ms</a>                490 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;o.buf = ms-&gt;o.pbuf = NULL;</span>
<span class='curline'><a href='../S/160.html#L491'>ms</a>                491 ext/fileinfo/libmagic/apprentice.c 	len = (ms-&gt;c.len = 10) * sizeof(*ms-&gt;c.li);</span>
<span class='curline'><a href='../S/160.html#L493'>ms</a>                493 ext/fileinfo/libmagic/apprentice.c 	if ((ms-&gt;c.li = CAST(struct level_info *, emalloc(len))) == NULL)</span>
<span class='curline'><a href='../S/160.html#L496'>ms</a>                496 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;event_flags = 0;</span>
<span class='curline'><a href='../S/160.html#L497'>ms</a>                497 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;error = -1;</span>
<span class='curline'><a href='../S/160.html#L499'>ms</a>                499 ext/fileinfo/libmagic/apprentice.c 		ms-&gt;mlist[i] = NULL;</span>
<span class='curline'><a href='../S/160.html#L500'>ms</a>                500 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;file = "unknown";</span>
<span class='curline'><a href='../S/160.html#L501'>ms</a>                501 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;line = 0;</span>
<span class='curline'><a href='../S/160.html#L502'>ms</a>                502 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;indir_max = FILE_INDIR_MAX;</span>
<span class='curline'><a href='../S/160.html#L503'>ms</a>                503 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;name_max = FILE_NAME_MAX;</span>
<span class='curline'><a href='../S/160.html#L504'>ms</a>                504 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;elf_shnum_max = FILE_ELF_SHNUM_MAX;</span>
<span class='curline'><a href='../S/160.html#L505'>ms</a>                505 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;elf_phnum_max = FILE_ELF_PHNUM_MAX;</span>
<span class='curline'><a href='../S/160.html#L506'>ms</a>                506 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;elf_notes_max = FILE_ELF_NOTES_MAX;</span>
<span class='curline'><a href='../S/160.html#L507'>ms</a>                507 ext/fileinfo/libmagic/apprentice.c 	return ms;</span>
<span class='curline'><a href='../S/160.html#L509'>ms</a>                509 ext/fileinfo/libmagic/apprentice.c 	efree(ms);</span>
<span class='curline'><a href='../S/160.html#L564'>ms</a>                564 ext/fileinfo/libmagic/apprentice.c file_apprentice(struct magic_set *ms, const char *fn, int action)</span>
<span class='curline'><a href='../S/160.html#L570'>ms</a>                570 ext/fileinfo/libmagic/apprentice.c 	if (ms-&gt;mlist[0] != NULL)</span>
<span class='curline'><a href='../S/160.html#L571'>ms</a>                571 ext/fileinfo/libmagic/apprentice.c 		file_reset(ms);</span>
<span class='curline'><a href='../S/160.html#L585'>ms</a>                585 ext/fileinfo/libmagic/apprentice.c 			mlist_free(ms-&gt;mlist[i]);</span>
<span class='curline'><a href='../S/160.html#L586'>ms</a>                586 ext/fileinfo/libmagic/apprentice.c 			if ((ms-&gt;mlist[i] = mlist_alloc()) == NULL) {</span>
<span class='curline'><a href='../S/160.html#L587'>ms</a>                587 ext/fileinfo/libmagic/apprentice.c 				file_oomem(ms, sizeof(*ms-&gt;mlist[i]));</span>
<span class='curline'><a href='../S/160.html#L591'>ms</a>                591 ext/fileinfo/libmagic/apprentice.c 		return apprentice_1(ms, fn, action);</span>
<span class='curline'><a href='../S/160.html#L595'>ms</a>                595 ext/fileinfo/libmagic/apprentice.c 		file_oomem(ms, strlen(fn));</span>
<span class='curline'><a href='../S/160.html#L600'>ms</a>                600 ext/fileinfo/libmagic/apprentice.c 		mlist_free(ms-&gt;mlist[i]);</span>
<span class='curline'><a href='../S/160.html#L601'>ms</a>                601 ext/fileinfo/libmagic/apprentice.c 		if ((ms-&gt;mlist[i] = mlist_alloc()) == NULL) {</span>
<span class='curline'><a href='../S/160.html#L602'>ms</a>                602 ext/fileinfo/libmagic/apprentice.c 			file_oomem(ms, sizeof(*ms-&gt;mlist[i]));</span>
<span class='curline'><a href='../S/160.html#L604'>ms</a>                604 ext/fileinfo/libmagic/apprentice.c 				mlist_free(ms-&gt;mlist[i]);</span>
<span class='curline'><a href='../S/160.html#L605'>ms</a>                605 ext/fileinfo/libmagic/apprentice.c 				ms-&gt;mlist[i] = NULL;</span>
<span class='curline'><a href='../S/160.html#L619'>ms</a>                619 ext/fileinfo/libmagic/apprentice.c 		file_err = apprentice_1(ms, fn, action);</span>
<span class='curline'><a href='../S/160.html#L628'>ms</a>                628 ext/fileinfo/libmagic/apprentice.c 			mlist_free(ms-&gt;mlist[i]);</span>
<span class='curline'><a href='../S/160.html#L629'>ms</a>                629 ext/fileinfo/libmagic/apprentice.c 			ms-&gt;mlist[i] = NULL;</span>
<span class='curline'><a href='../S/160.html#L631'>ms</a>                631 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "could not find any valid magic files!");</span>
<span class='curline'><a href='../S/160.html#L643'>ms</a>                643 ext/fileinfo/libmagic/apprentice.c 		mlist_free(ms-&gt;mlist[i]);</span>
<span class='curline'><a href='../S/160.html#L644'>ms</a>                644 ext/fileinfo/libmagic/apprentice.c 		ms-&gt;mlist[i] = NULL;</span>
<span class='curline'><a href='../S/160.html#L655'>ms</a>                655 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "Invalid action %d", action);</span>
<span class='curline'><a href='../S/160.html#L994'>ms</a>                994 ext/fileinfo/libmagic/apprentice.c addentry(struct magic_set *ms, struct magic_entry *me,</span>
<span class='curline'><a href='../S/160.html#L1005'>ms</a>               1005 ext/fileinfo/libmagic/apprentice.c 			file_oomem(ms, sizeof(*mp) * mset[i].max);</span>
<span class='curline'><a href='../S/160.html#L1021'>ms</a>               1021 ext/fileinfo/libmagic/apprentice.c load_1(struct magic_set *ms, int action, const char *fn, int *errs,</span>
<span class='curline'><a href='../S/160.html#L1033'>ms</a>               1033 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;file = fn;</span>
<span class='curline'><a href='../S/160.html#L1038'>ms</a>               1038 ext/fileinfo/libmagic/apprentice.c 			file_error(ms, errno, "cannot read magic file `%s'",</span>
<span class='curline'><a href='../S/160.html#L1046'>ms</a>               1046 ext/fileinfo/libmagic/apprentice.c 	for (ms-&gt;line = 1; (line = php_stream_get_line(stream, buffer , BUFSIZ, &amp;len)) != NULL; ms-&gt;line++) {</span>
<span class='curline'><a href='../S/160.html#L1068'>ms</a>               1068 ext/fileinfo/libmagic/apprentice.c 					file_error(ms, 0,</span>
<span class='curline'><a href='../S/160.html#L1074'>ms</a>               1074 ext/fileinfo/libmagic/apprentice.c 					file_error(ms, 0,</span>
<span class='curline'><a href='../S/160.html#L1080'>ms</a>               1080 ext/fileinfo/libmagic/apprentice.c 				if ((*bang[i].fun)(ms, &amp;me,</span>
<span class='curline'><a href='../S/160.html#L1090'>ms</a>               1090 ext/fileinfo/libmagic/apprentice.c 			switch (parse(ms, &amp;me, line, lineno, action)) {</span>
<span class='curline'><a href='../S/160.html#L1094'>ms</a>               1094 ext/fileinfo/libmagic/apprentice.c 				(void)addentry(ms, &amp;me, mset);</span>
<span class='curline'><a href='../S/160.html#L1103'>ms</a>               1103 ext/fileinfo/libmagic/apprentice.c 		(void)addentry(ms, &amp;me, mset);</span>
<span class='curline'><a href='../S/160.html#L1120'>ms</a>               1120 ext/fileinfo/libmagic/apprentice.c set_text_binary(struct magic_set *ms, struct magic_entry *me, uint32_t nme,</span>
<span class='curline'><a href='../S/160.html#L1131'>ms</a>               1131 ext/fileinfo/libmagic/apprentice.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) == 0)</span>
<span class='curline'><a href='../S/160.html#L1153'>ms</a>               1153 ext/fileinfo/libmagic/apprentice.c set_last_default(struct magic_set *ms, struct magic_entry *me, uint32_t nme)</span>
<span class='curline'><a href='../S/160.html#L1164'>ms</a>               1164 ext/fileinfo/libmagic/apprentice.c 				ms-&gt;line = me[i].mp-&gt;lineno;</span>
<span class='curline'><a href='../S/160.html#L1165'>ms</a>               1165 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms,</span>
<span class='curline'><a href='../S/160.html#L1174'>ms</a>               1174 ext/fileinfo/libmagic/apprentice.c coalesce_entries(struct magic_set *ms, struct magic_entry *me, uint32_t nme,</span>
<span class='curline'><a href='../S/160.html#L1185'>ms</a>               1185 ext/fileinfo/libmagic/apprentice.c 		file_oomem(ms, slen);</span>
<span class='curline'><a href='../S/160.html#L1211'>ms</a>               1211 ext/fileinfo/libmagic/apprentice.c apprentice_load(struct magic_set *ms, const char *fn, int action)</span>
<span class='curline'><a href='../S/160.html#L1225'>ms</a>               1225 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;flags |= MAGIC_CHECK;	/* Enable checks for parsed files */</span>
<span class='curline'><a href='../S/160.html#L1230'>ms</a>               1230 ext/fileinfo/libmagic/apprentice.c 		file_oomem(ms, sizeof(*map));</span>
<span class='curline'><a href='../S/160.html#L1252'>ms</a>               1252 ext/fileinfo/libmagic/apprentice.c 				file_oomem(ms,</span>
<span class='curline'><a href='../S/160.html#L1267'>ms</a>               1267 ext/fileinfo/libmagic/apprentice.c 					file_oomem(ms, mlen);</span>
<span class='curline'><a href='../S/160.html#L1278'>ms</a>               1278 ext/fileinfo/libmagic/apprentice.c 			load_1(ms, action, filearr[i], &amp;errs, mset);</span>
<span class='curline'><a href='../S/160.html#L1283'>ms</a>               1283 ext/fileinfo/libmagic/apprentice.c 		load_1(ms, action, fn, &amp;errs, mset);</span>
<span class='curline'><a href='../S/160.html#L1294'>ms</a>               1294 ext/fileinfo/libmagic/apprentice.c 			i = set_text_binary(ms, mset[j].me, mset[j].count, i);</span>
<span class='curline'><a href='../S/160.html#L1303'>ms</a>               1303 ext/fileinfo/libmagic/apprentice.c 		set_last_default(ms, mset[j].me, mset[j].count);</span>
<span class='curline'><a href='../S/160.html#L1306'>ms</a>               1306 ext/fileinfo/libmagic/apprentice.c 		if (coalesce_entries(ms, mset[j].me, mset[j].count,</span>
<span class='curline'><a href='../S/160.html#L1328'>ms</a>               1328 ext/fileinfo/libmagic/apprentice.c file_signextend(struct magic_set *ms, struct magic *m, uint64_t v)</span>
<span class='curline'><a href='../S/160.html#L1392'>ms</a>               1392 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L1393'>ms</a>               1393 ext/fileinfo/libmagic/apprentice.c 			    file_magwarn(ms, "cannot happen: m-&gt;type=%d\n",</span>
<span class='curline'><a href='../S/160.html#L1402'>ms</a>               1402 ext/fileinfo/libmagic/apprentice.c string_modifier_check(struct magic_set *ms, struct magic *m)</span>
<span class='curline'><a href='../S/160.html#L1404'>ms</a>               1404 ext/fileinfo/libmagic/apprentice.c 	if ((ms-&gt;flags &amp; MAGIC_CHECK) == 0)</span>
<span class='curline'><a href='../S/160.html#L1409'>ms</a>               1409 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms,</span>
<span class='curline'><a href='../S/160.html#L1417'>ms</a>               1417 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms,</span>
<span class='curline'><a href='../S/160.html#L1425'>ms</a>               1425 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms,</span>
<span class='curline'><a href='../S/160.html#L1433'>ms</a>               1433 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms,</span>
<span class='curline'><a href='../S/160.html#L1442'>ms</a>               1442 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "'/%c' not allowed on regex\n",</span>
<span class='curline'><a href='../S/160.html#L1447'>ms</a>               1447 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "'/%c' not allowed on regex\n",</span>
<span class='curline'><a href='../S/160.html#L1453'>ms</a>               1453 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "coding error: m-&gt;type=%d\n",</span>
<span class='curline'><a href='../S/160.html#L1513'>ms</a>               1513 ext/fileinfo/libmagic/apprentice.c check_cond(struct magic_set *ms, int cond, uint32_t cont_level)</span>
<span class='curline'><a href='../S/160.html#L1516'>ms</a>               1516 ext/fileinfo/libmagic/apprentice.c 	last_cond = ms-&gt;c.li[cont_level].last_cond;</span>
<span class='curline'><a href='../S/160.html#L1521'>ms</a>               1521 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L1522'>ms</a>               1522 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "syntax error: `if'");</span>
<span class='curline'><a href='../S/160.html#L1530'>ms</a>               1530 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L1531'>ms</a>               1531 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "syntax error: `elif'");</span>
<span class='curline'><a href='../S/160.html#L1539'>ms</a>               1539 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L1540'>ms</a>               1540 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "syntax error: `else'");</span>
<span class='curline'><a href='../S/160.html#L1551'>ms</a>               1551 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;c.li[cont_level].last_cond = last_cond;</span>
<span class='curline'><a href='../S/160.html#L1557'>ms</a>               1557 ext/fileinfo/libmagic/apprentice.c parse_indirect_modifier(struct magic_set *ms, struct magic *m, const char **lp)</span>
<span class='curline'><a href='../S/160.html#L1567'>ms</a>               1567 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L1568'>ms</a>               1568 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "indirect modifier `%c' "</span>
<span class='curline'><a href='../S/160.html#L1578'>ms</a>               1578 ext/fileinfo/libmagic/apprentice.c parse_op_modifier(struct magic_set *ms, struct magic *m, const char **lp,</span>
<span class='curline'><a href='../S/160.html#L1589'>ms</a>               1589 ext/fileinfo/libmagic/apprentice.c 	m-&gt;num_mask = file_signextend(ms, m, val);</span>
<span class='curline'><a href='../S/160.html#L1595'>ms</a>               1595 ext/fileinfo/libmagic/apprentice.c parse_string_modifier(struct magic_set *ms, struct magic *m, const char **lp)</span>
<span class='curline'><a href='../S/160.html#L1607'>ms</a>               1607 ext/fileinfo/libmagic/apprentice.c 			if (have_range &amp;&amp; (ms-&gt;flags &amp; MAGIC_CHECK))</span>
<span class='curline'><a href='../S/160.html#L1608'>ms</a>               1608 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "multiple ranges");</span>
<span class='curline'><a href='../S/160.html#L1612'>ms</a>               1612 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "zero range");</span>
<span class='curline'><a href='../S/160.html#L1677'>ms</a>               1677 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L1678'>ms</a>               1678 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "string modifier `%c' "</span>
<span class='curline'><a href='../S/160.html#L1686'>ms</a>               1686 ext/fileinfo/libmagic/apprentice.c 	if (string_modifier_check(ms, m) == -1)</span>
<span class='curline'><a href='../S/160.html#L1699'>ms</a>               1699 ext/fileinfo/libmagic/apprentice.c parse(struct magic_set *ms, struct magic_entry *me, const char *line,</span>
<span class='curline'><a href='../S/160.html#L1724'>ms</a>               1724 ext/fileinfo/libmagic/apprentice.c 		if (file_check_mem(ms, cont_level) == -1)</span>
<span class='curline'><a href='../S/160.html#L1730'>ms</a>               1730 ext/fileinfo/libmagic/apprentice.c 			file_magerror(ms, "No current entry for continuation");</span>
<span class='curline'><a href='../S/160.html#L1734'>ms</a>               1734 ext/fileinfo/libmagic/apprentice.c 			file_magerror(ms, "Continuations present with 0 count");</span>
<span class='curline'><a href='../S/160.html#L1740'>ms</a>               1740 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "New continuation level %u is more "</span>
<span class='curline'><a href='../S/160.html#L1748'>ms</a>               1748 ext/fileinfo/libmagic/apprentice.c 				file_oomem(ms, sizeof(*nm) * cnt);</span>
<span class='curline'><a href='../S/160.html#L1762'>ms</a>               1762 ext/fileinfo/libmagic/apprentice.c 			file_oomem(ms, len);</span>
<span class='curline'><a href='../S/160.html#L1791'>ms</a>               1791 ext/fileinfo/libmagic/apprentice.c 		if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L1792'>ms</a>               1792 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "relative offset at level 0");</span>
<span class='curline'><a href='../S/160.html#L1797'>ms</a>               1797 ext/fileinfo/libmagic/apprentice.c 		if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L1798'>ms</a>               1798 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "offset `%s' invalid", l);</span>
<span class='curline'><a href='../S/160.html#L1850'>ms</a>               1850 ext/fileinfo/libmagic/apprentice.c 				if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L1851'>ms</a>               1851 ext/fileinfo/libmagic/apprentice.c 					file_magwarn(ms,</span>
<span class='curline'><a href='../S/160.html#L1875'>ms</a>               1875 ext/fileinfo/libmagic/apprentice.c 				if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L1876'>ms</a>               1876 ext/fileinfo/libmagic/apprentice.c 					file_magwarn(ms,</span>
<span class='curline'><a href='../S/160.html#L1882'>ms</a>               1882 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L1883'>ms</a>               1883 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms,</span>
<span class='curline'><a href='../S/160.html#L1890'>ms</a>               1890 ext/fileinfo/libmagic/apprentice.c 	if (check_cond(ms, m-&gt;cond, cont_level) == -1)</span>
<span class='curline'><a href='../S/160.html#L1945'>ms</a>               1945 ext/fileinfo/libmagic/apprentice.c 		if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L1946'>ms</a>               1946 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "type `%s' invalid", l);</span>
<span class='curline'><a href='../S/160.html#L1957'>ms</a>               1957 ext/fileinfo/libmagic/apprentice.c 		else if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L1958'>ms</a>               1958 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "'~' invalid for string types");</span>
<span class='curline'><a href='../S/160.html#L1968'>ms</a>               1968 ext/fileinfo/libmagic/apprentice.c 				if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L1969'>ms</a>               1969 ext/fileinfo/libmagic/apprentice.c 					file_magwarn(ms,</span>
<span class='curline'><a href='../S/160.html#L1976'>ms</a>               1976 ext/fileinfo/libmagic/apprentice.c 				r = parse_indirect_modifier(ms, m, &amp;l);</span>
<span class='curline'><a href='../S/160.html#L1978'>ms</a>               1978 ext/fileinfo/libmagic/apprentice.c 				r = parse_string_modifier(ms, m, &amp;l);</span>
<span class='curline'><a href='../S/160.html#L1982'>ms</a>               1982 ext/fileinfo/libmagic/apprentice.c 			parse_op_modifier(ms, m, &amp;l, op);</span>
<span class='curline'><a href='../S/160.html#L1997'>ms</a>               1997 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK) {</span>
<span class='curline'><a href='../S/160.html#L1998'>ms</a>               1998 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "%c= not supported",</span>
<span class='curline'><a href='../S/160.html#L2032'>ms</a>               2032 ext/fileinfo/libmagic/apprentice.c 	if (m-&gt;reln != 'x' &amp;&amp; getvalue(ms, m, &amp;l, action))</span>
<span class='curline'><a href='../S/160.html#L2057'>ms</a>               2057 ext/fileinfo/libmagic/apprentice.c 		if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L2058'>ms</a>               2058 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "description `%s' truncated", m-&gt;desc);</span>
<span class='curline'><a href='../S/160.html#L2065'>ms</a>               2065 ext/fileinfo/libmagic/apprentice.c         if (ms-&gt;flags &amp; MAGIC_CHECK) {</span>
<span class='curline'><a href='../S/160.html#L2066'>ms</a>               2066 ext/fileinfo/libmagic/apprentice.c 		if (check_format(ms, m) == -1)</span>
<span class='curline'><a href='../S/160.html#L2078'>ms</a>               2078 ext/fileinfo/libmagic/apprentice.c parse_strength(struct magic_set *ms, struct magic_entry *me, const char *line)</span>
<span class='curline'><a href='../S/160.html#L2086'>ms</a>               2086 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms,</span>
<span class='curline'><a href='../S/160.html#L2092'>ms</a>               2092 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "%s: Strength setting is not supported in "</span>
<span class='curline'><a href='../S/160.html#L2106'>ms</a>               2106 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Unknown factor op `%c'", *l);</span>
<span class='curline'><a href='../S/160.html#L2112'>ms</a>               2112 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Too large factor `%lu'", factor);</span>
<span class='curline'><a href='../S/160.html#L2116'>ms</a>               2116 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Bad factor `%s'", l);</span>
<span class='curline'><a href='../S/160.html#L2121'>ms</a>               2121 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Cannot have factor op `%c' and factor %u",</span>
<span class='curline'><a href='../S/160.html#L2139'>ms</a>               2139 ext/fileinfo/libmagic/apprentice.c parse_extra(struct magic_set *ms, struct magic_entry *me, const char *line,</span>
<span class='curline'><a href='../S/160.html#L2149'>ms</a>               2149 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Current entry already has a %s type "</span>
<span class='curline'><a href='../S/160.html#L2155'>ms</a>               2155 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Current entry does not yet have a "</span>
<span class='curline'><a href='../S/160.html#L2167'>ms</a>               2167 ext/fileinfo/libmagic/apprentice.c 		if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L2168'>ms</a>               2168 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "%s type `%s' truncated %"</span>
<span class='curline'><a href='../S/160.html#L2172'>ms</a>               2172 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "%s type `%s' has bad char '%c'",</span>
<span class='curline'><a href='../S/160.html#L2181'>ms</a>               2181 ext/fileinfo/libmagic/apprentice.c 	file_magerror(ms, "Bad magic entry '%s'", line);</span>
<span class='curline'><a href='../S/160.html#L2190'>ms</a>               2190 ext/fileinfo/libmagic/apprentice.c parse_apple(struct magic_set *ms, struct magic_entry *me, const char *line)</span>
<span class='curline'><a href='../S/160.html#L2194'>ms</a>               2194 ext/fileinfo/libmagic/apprentice.c 	return parse_extra(ms, me, line,</span>
<span class='curline'><a href='../S/160.html#L2204'>ms</a>               2204 ext/fileinfo/libmagic/apprentice.c parse_mime(struct magic_set *ms, struct magic_entry *me, const char *line)</span>
<span class='curline'><a href='../S/160.html#L2208'>ms</a>               2208 ext/fileinfo/libmagic/apprentice.c 	return parse_extra(ms, me, line,</span>
<span class='curline'><a href='../S/160.html#L2388'>ms</a>               2388 ext/fileinfo/libmagic/apprentice.c check_format(struct magic_set *ms, struct magic *m)</span>
<span class='curline'><a href='../S/160.html#L2403'>ms</a>               2403 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Internal error inconsistency between "</span>
<span class='curline'><a href='../S/160.html#L2408'>ms</a>               2408 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "No format string for `%s' with description "</span>
<span class='curline'><a href='../S/160.html#L2419'>ms</a>               2419 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Printf format `%c' is not valid for type "</span>
<span class='curline'><a href='../S/160.html#L2427'>ms</a>               2427 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms,</span>
<span class='curline'><a href='../S/160.html#L2443'>ms</a>               2443 ext/fileinfo/libmagic/apprentice.c getvalue(struct magic_set *ms, struct magic *m, const char **p, int action)</span>
<span class='curline'><a href='../S/160.html#L2454'>ms</a>               2454 ext/fileinfo/libmagic/apprentice.c 		*p = getstr(ms, m, *p, action == FILE_COMPILE);</span>
<span class='curline'><a href='../S/160.html#L2456'>ms</a>               2456 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/160.html#L2457'>ms</a>               2457 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "cannot get string from `%s'",</span>
<span class='curline'><a href='../S/160.html#L2501'>ms</a>               2501 ext/fileinfo/libmagic/apprentice.c 			m-&gt;value.q = file_signextend(ms, m,</span>
<span class='curline'><a href='../S/160.html#L2517'>ms</a>               2517 ext/fileinfo/libmagic/apprentice.c getstr(struct magic_set *ms, struct magic *m, const char *s, int warn)</span>
<span class='curline'><a href='../S/160.html#L2531'>ms</a>               2531 ext/fileinfo/libmagic/apprentice.c 			file_error(ms, 0, "string too long: `%s'", origs);</span>
<span class='curline'><a href='../S/160.html#L2539'>ms</a>               2539 ext/fileinfo/libmagic/apprentice.c 					file_magwarn(ms, "incomplete escape");</span>
<span class='curline'><a href='../S/160.html#L2544'>ms</a>               2544 ext/fileinfo/libmagic/apprentice.c 					file_magwarn(ms,</span>
<span class='curline'><a href='../S/160.html#L2558'>ms</a>               2558 ext/fileinfo/libmagic/apprentice.c 							file_magwarn(ms, "no "</span>
<span class='curline'><a href='../S/160.html#L2563'>ms</a>               2563 ext/fileinfo/libmagic/apprentice.c 						file_magwarn(ms,</span>
<span class='curline'><a href='../S/160.html#L2778'>ms</a>               2778 ext/fileinfo/libmagic/apprentice.c apprentice_buf(struct magic_set *ms, struct magic *buf, size_t len)</span>
<span class='curline'><a href='../S/160.html#L2783'>ms</a>               2783 ext/fileinfo/libmagic/apprentice.c 		file_oomem(ms, sizeof(*map));</span>
<span class='curline'><a href='../S/160.html#L2789'>ms</a>               2789 ext/fileinfo/libmagic/apprentice.c 	if (check_buffer(ms, map, "buffer") != 0) {</span>
<span class='curline'><a href='../S/160.html#L2801'>ms</a>               2801 ext/fileinfo/libmagic/apprentice.c apprentice_map(struct magic_set *ms, const char *fn)</span>
<span class='curline'><a href='../S/160.html#L2815'>ms</a>               2815 ext/fileinfo/libmagic/apprentice.c 		file_oomem(ms, sizeof(*map));</span>
<span class='curline'><a href='../S/160.html#L2834'>ms</a>               2834 ext/fileinfo/libmagic/apprentice.c 	dbname = mkdbname(ms, fn, 0);</span>
<span class='curline'><a href='../S/160.html#L2845'>ms</a>               2845 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, errno, "cannot stat `%s'", dbname);</span>
<span class='curline'><a href='../S/160.html#L2849'>ms</a>               2849 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "file `%s' is too %s", dbname,</span>
<span class='curline'><a href='../S/160.html#L2856'>ms</a>               2856 ext/fileinfo/libmagic/apprentice.c 		file_oomem(ms, map-&gt;len);</span>
<span class='curline'><a href='../S/160.html#L2860'>ms</a>               2860 ext/fileinfo/libmagic/apprentice.c 		file_badread(ms);</span>
<span class='curline'><a href='../S/160.html#L2873'>ms</a>               2873 ext/fileinfo/libmagic/apprentice.c 			file_error(ms, 0, "bad magic in `%s'", dbname);</span>
<span class='curline'><a href='../S/160.html#L2884'>ms</a>               2884 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "File %d.%d supports only version %d magic "</span>
<span class='curline'><a href='../S/160.html#L2902'>ms</a>               2902 ext/fileinfo/libmagic/apprentice.c 			file_error(ms, 0, "Size of `%s' %llu is not a multiple of %zu",</span>
<span class='curline'><a href='../S/160.html#L2920'>ms</a>               2920 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "Inconsistent entries in `%s' %u != %u",</span>
<span class='curline'><a href='../S/160.html#L2945'>ms</a>               2945 ext/fileinfo/libmagic/apprentice.c check_buffer(struct magic_set *ms, struct magic_map *map, const char *dbname)</span>
<span class='curline'><a href='../S/160.html#L2955'>ms</a>               2955 ext/fileinfo/libmagic/apprentice.c 			file_error(ms, 0, "bad magic in `%s'", dbname);</span>
<span class='curline'><a href='../S/160.html#L2966'>ms</a>               2966 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "File %s supports only version %d magic "</span>
<span class='curline'><a href='../S/160.html#L2973'>ms</a>               2973 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "Size of `%s' %" SIZE_T_FORMAT "u is not "</span>
<span class='curline'><a href='../S/160.html#L2990'>ms</a>               2990 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "Inconsistent entries in `%s' %u != %u",</span>
<span class='curline'><a href='../S/160.html#L3004'>ms</a>               3004 ext/fileinfo/libmagic/apprentice.c apprentice_compile(struct magic_set *ms, struct magic_map *map, const char *fn)</span>
<span class='curline'><a href='../S/160.html#L3019'>ms</a>               3019 ext/fileinfo/libmagic/apprentice.c 	dbname = mkdbname(ms, fn, 0);</span>
<span class='curline'><a href='../S/160.html#L3028'>ms</a>               3028 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, errno, "cannot open `%s'", dbname);</span>
<span class='curline'><a href='../S/160.html#L3037'>ms</a>               3037 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, errno, "error writing `%s'", dbname);</span>
<span class='curline'><a href='../S/160.html#L3044'>ms</a>               3044 ext/fileinfo/libmagic/apprentice.c 			file_error(ms, errno, "error writing `%s'", dbname);</span>
<span class='curline'><a href='../S/160.html#L3063'>ms</a>               3063 ext/fileinfo/libmagic/apprentice.c mkdbname(struct magic_set *ms, const char *fn, int strip)</span>
<span class='curline'><a href='../S/160.html#L3087'>ms</a>               3087 ext/fileinfo/libmagic/apprentice.c 	if (ms-&gt;flags &amp; MAGIC_MIME) {</span>
<span class='curline'><a href='../S/160.html#L3094'>ms</a>               3094 ext/fileinfo/libmagic/apprentice.c 			ms-&gt;flags &amp;= MAGIC_MIME_TYPE;</span>
<span class='curline'><a href='../S/160.html#L3103'>ms</a>               3103 ext/fileinfo/libmagic/apprentice.c 		ms-&gt;flags &amp;= MAGIC_MIME_TYPE;</span>
<span class='curline'><a href='../S/160.html#L3248'>ms</a>               3248 ext/fileinfo/libmagic/apprentice.c file_magicfind(struct magic_set *ms, const char *name, struct mlist *v)</span>
<span class='curline'><a href='../S/160.html#L3253'>ms</a>               3253 ext/fileinfo/libmagic/apprentice.c 	mlist = ms-&gt;mlist[1];</span>
<span class='curline'><a href='../S/161.html#L45'>ms</a>                 45 ext/fileinfo/libmagic/apptype.c file_os2_apptype(struct magic_set *ms, const char *fn, const void *buf,</span>
<span class='curline'><a href='../S/161.html#L57'>ms</a>                 57 ext/fileinfo/libmagic/apptype.c 		file_error(ms, errno, "cannot create tempnam");</span>
<span class='curline'><a href='../S/161.html#L69'>ms</a>                 69 ext/fileinfo/libmagic/apptype.c 			file_error(ms, errno, "cannot open tmp file `%s'", path);</span>
<span class='curline'><a href='../S/161.html#L73'>ms</a>                 73 ext/fileinfo/libmagic/apptype.c 			file_error(ms, errno, "cannot write tmp file `%s'",</span>
<span class='curline'><a href='../S/161.html#L109'>ms</a>                109 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "32-bit ") == -1)</span>
<span class='curline'><a href='../S/161.html#L112'>ms</a>                112 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "physical device driver") == -1)</span>
<span class='curline'><a href='../S/161.html#L115'>ms</a>                115 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "virtual device driver") == -1)</span>
<span class='curline'><a href='../S/161.html#L119'>ms</a>                119 ext/fileinfo/libmagic/apptype.c 			if (file_printf(ms, "protected ") == -1)</span>
<span class='curline'><a href='../S/161.html#L121'>ms</a>                121 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "DLL") == -1)</span>
<span class='curline'><a href='../S/161.html#L124'>ms</a>                124 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "Windows executable") == -1)</span>
<span class='curline'><a href='../S/161.html#L134'>ms</a>                134 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "DOS executable") == -1)</span>
<span class='curline'><a href='../S/161.html#L138'>ms</a>                138 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, ", magic(4)-&gt; ") == -1)</span>
<span class='curline'><a href='../S/161.html#L143'>ms</a>                143 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "bound executable") == -1)</span>
<span class='curline'><a href='../S/161.html#L146'>ms</a>                146 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "PM executable") == -1)</span>
<span class='curline'><a href='../S/161.html#L148'>ms</a>                148 ext/fileinfo/libmagic/apptype.c 	} else if (file_printf(ms, "OS/2 executable") == -1)</span>
<span class='curline'><a href='../S/161.html#L155'>ms</a>                155 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, " [NOTWINDOWCOMPAT]") == -1)</span>
<span class='curline'><a href='../S/161.html#L159'>ms</a>                159 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, " [WINDOWCOMPAT]") == -1)</span>
<span class='curline'><a href='../S/161.html#L163'>ms</a>                163 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, " [WINDOWAPI]") == -1)</span>
<span class='curline'><a href='../S/162.html#L71'>ms</a>                 71 ext/fileinfo/libmagic/ascmagic.c file_ascmagic(struct magic_set *ms, const unsigned char *buf, size_t nbytes,</span>
<span class='curline'><a href='../S/162.html#L82'>ms</a>                 82 ext/fileinfo/libmagic/ascmagic.c 	if (ms-&gt;flags &amp; MAGIC_APPLE)</span>
<span class='curline'><a href='../S/162.html#L88'>ms</a>                 88 ext/fileinfo/libmagic/ascmagic.c 	if (file_encoding(ms, buf, nbytes, &amp;ubuf, &amp;ulen, &amp;code, &amp;code_mime,</span>
<span class='curline'><a href='../S/162.html#L92'>ms</a>                 92 ext/fileinfo/libmagic/ascmagic.c 		rv = file_ascmagic_with_encoding(ms, buf, nbytes, ubuf, ulen, code,</span>
<span class='curline'><a href='../S/162.html#L101'>ms</a>                101 ext/fileinfo/libmagic/ascmagic.c file_ascmagic_with_encoding(struct magic_set *ms, const unsigned char *buf,</span>
<span class='curline'><a href='../S/162.html#L108'>ms</a>                108 ext/fileinfo/libmagic/ascmagic.c 	int mime = ms-&gt;flags &amp; MAGIC_MIME;</span>
<span class='curline'><a href='../S/162.html#L126'>ms</a>                126 ext/fileinfo/libmagic/ascmagic.c 	if (ms-&gt;flags &amp; MAGIC_APPLE)</span>
<span class='curline'><a href='../S/162.html#L137'>ms</a>                137 ext/fileinfo/libmagic/ascmagic.c 	if (ulen &gt; 0 &amp;&amp; (ms-&gt;flags &amp; MAGIC_NO_CHECK_SOFT) == 0) {</span>
<span class='curline'><a href='../S/162.html#L143'>ms</a>                143 ext/fileinfo/libmagic/ascmagic.c 			file_oomem(ms, mlen);</span>
<span class='curline'><a href='../S/162.html#L149'>ms</a>                149 ext/fileinfo/libmagic/ascmagic.c 		if ((rv = file_softmagic(ms, utf8_buf,</span>
<span class='curline'><a href='../S/162.html#L197'>ms</a>                197 ext/fileinfo/libmagic/ascmagic.c 		if (!file_printedlen(ms) &amp;&amp; (mime &amp; MAGIC_MIME_TYPE) != 0) {</span>
<span class='curline'><a href='../S/162.html#L199'>ms</a>                199 ext/fileinfo/libmagic/ascmagic.c 				if (file_printf(ms, "%s", subtype_mime) == -1)</span>
<span class='curline'><a href='../S/162.html#L202'>ms</a>                202 ext/fileinfo/libmagic/ascmagic.c 				if (file_printf(ms, "text/plain") == -1)</span>
<span class='curline'><a href='../S/162.html#L207'>ms</a>                207 ext/fileinfo/libmagic/ascmagic.c 		if (file_printedlen(ms)) {</span>
<span class='curline'><a href='../S/162.html#L208'>ms</a>                208 ext/fileinfo/libmagic/ascmagic.c 			switch (file_replace(ms, " text$", ", ")) {</span>
<span class='curline'><a href='../S/162.html#L210'>ms</a>                210 ext/fileinfo/libmagic/ascmagic.c 				switch (file_replace(ms, " text executable$",</span>
<span class='curline'><a href='../S/162.html#L213'>ms</a>                213 ext/fileinfo/libmagic/ascmagic.c 					if (file_printf(ms, ", ") == -1)</span>
<span class='curline'><a href='../S/162.html#L230'>ms</a>                230 ext/fileinfo/libmagic/ascmagic.c 		if (file_printf(ms, "%s", code) == -1)</span>
<span class='curline'><a href='../S/162.html#L234'>ms</a>                234 ext/fileinfo/libmagic/ascmagic.c 			if (file_printf(ms, " %s", subtype) == -1)</span>
<span class='curline'><a href='../S/162.html#L238'>ms</a>                238 ext/fileinfo/libmagic/ascmagic.c 		if (file_printf(ms, " %s", type) == -1)</span>
<span class='curline'><a href='../S/162.html#L242'>ms</a>                242 ext/fileinfo/libmagic/ascmagic.c 			if (file_printf(ms, " executable") == -1)</span>
<span class='curline'><a href='../S/162.html#L246'>ms</a>                246 ext/fileinfo/libmagic/ascmagic.c 			if (file_printf(ms, ", with very long lines") == -1)</span>
<span class='curline'><a href='../S/162.html#L255'>ms</a>                255 ext/fileinfo/libmagic/ascmagic.c 			if (file_printf(ms, ", with") == -1)</span>
<span class='curline'><a href='../S/162.html#L259'>ms</a>                259 ext/fileinfo/libmagic/ascmagic.c 				if (file_printf(ms, " no") == -1)</span>
<span class='curline'><a href='../S/162.html#L263'>ms</a>                263 ext/fileinfo/libmagic/ascmagic.c 					if (file_printf(ms, " CRLF") == -1)</span>
<span class='curline'><a href='../S/162.html#L266'>ms</a>                266 ext/fileinfo/libmagic/ascmagic.c 						if (file_printf(ms, ",") == -1)</span>
<span class='curline'><a href='../S/162.html#L270'>ms</a>                270 ext/fileinfo/libmagic/ascmagic.c 					if (file_printf(ms, " CR") == -1)</span>
<span class='curline'><a href='../S/162.html#L273'>ms</a>                273 ext/fileinfo/libmagic/ascmagic.c 						if (file_printf(ms, ",") == -1)</span>
<span class='curline'><a href='../S/162.html#L277'>ms</a>                277 ext/fileinfo/libmagic/ascmagic.c 					if (file_printf(ms, " LF") == -1)</span>
<span class='curline'><a href='../S/162.html#L280'>ms</a>                280 ext/fileinfo/libmagic/ascmagic.c 						if (file_printf(ms, ",") == -1)</span>
<span class='curline'><a href='../S/162.html#L284'>ms</a>                284 ext/fileinfo/libmagic/ascmagic.c 					if (file_printf(ms, " NEL") == -1)</span>
<span class='curline'><a href='../S/162.html#L288'>ms</a>                288 ext/fileinfo/libmagic/ascmagic.c 			if (file_printf(ms, " line terminators") == -1)</span>
<span class='curline'><a href='../S/162.html#L293'>ms</a>                293 ext/fileinfo/libmagic/ascmagic.c 			if (file_printf(ms, ", with escape sequences") == -1)</span>
<span class='curline'><a href='../S/162.html#L296'>ms</a>                296 ext/fileinfo/libmagic/ascmagic.c 			if (file_printf(ms, ", with overstriking") == -1)</span>
<span class='curline'><a href='../S/166.html#L108'>ms</a>                108 ext/fileinfo/libmagic/compress.c file_zmagic(struct magic_set *ms, int fd, const char *name,</span>
<span class='curline'><a href='../S/166.html#L114'>ms</a>                114 ext/fileinfo/libmagic/compress.c 	int mime = ms-&gt;flags &amp; MAGIC_MIME;</span>
<span class='curline'><a href='../S/166.html#L119'>ms</a>                119 ext/fileinfo/libmagic/compress.c 	if ((ms-&gt;flags &amp; MAGIC_COMPRESS) == 0)</span>
<span class='curline'><a href='../S/166.html#L129'>ms</a>                129 ext/fileinfo/libmagic/compress.c 		    (nsz = uncompressbuf(ms, fd, i, buf, &amp;newbuf,</span>
<span class='curline'><a href='../S/166.html#L131'>ms</a>                131 ext/fileinfo/libmagic/compress.c 			ms-&gt;flags &amp;= ~MAGIC_COMPRESS;</span>
<span class='curline'><a href='../S/166.html#L133'>ms</a>                133 ext/fileinfo/libmagic/compress.c 			if (file_buffer(ms, -1, name, newbuf, nsz) == -1)</span>
<span class='curline'><a href='../S/166.html#L137'>ms</a>                137 ext/fileinfo/libmagic/compress.c 				if (file_printf(ms, mime ?</span>
<span class='curline'><a href='../S/166.html#L140'>ms</a>                140 ext/fileinfo/libmagic/compress.c 				if (file_buffer(ms, -1, NULL, buf, nbytes) == -1)</span>
<span class='curline'><a href='../S/166.html#L142'>ms</a>                142 ext/fileinfo/libmagic/compress.c 				if (!mime &amp;&amp; file_printf(ms, ")") == -1)</span>
<span class='curline'><a href='../S/166.html#L156'>ms</a>                156 ext/fileinfo/libmagic/compress.c 	ms-&gt;flags |= MAGIC_COMPRESS;</span>
<span class='curline'><a href='../S/166.html#L254'>ms</a>                254 ext/fileinfo/libmagic/compress.c file_pipe2file(struct magic_set *ms, int fd, const void *startbuf,</span>
<span class='curline'><a href='../S/166.html#L280'>ms</a>                280 ext/fileinfo/libmagic/compress.c 		file_error(ms, errno,</span>
<span class='curline'><a href='../S/166.html#L295'>ms</a>                295 ext/fileinfo/libmagic/compress.c 		file_error(ms, errno, "error copying from pipe to temp file");</span>
<span class='curline'><a href='../S/166.html#L300'>ms</a>                300 ext/fileinfo/libmagic/compress.c 		file_error(ms, errno, "error while writing to temp file");</span>
<span class='curline'><a href='../S/166.html#L310'>ms</a>                310 ext/fileinfo/libmagic/compress.c 		file_error(ms, errno, "could not dup descriptor for temp file");</span>
<span class='curline'><a href='../S/166.html#L315'>ms</a>                315 ext/fileinfo/libmagic/compress.c 		file_badseek(ms);</span>
<span class='curline'><a href='../S/166.html#L330'>ms</a>                330 ext/fileinfo/libmagic/compress.c uncompressgzipped(struct magic_set *ms, const unsigned char *old,</span>
<span class='curline'><a href='../S/166.html#L375'>ms</a>                375 ext/fileinfo/libmagic/compress.c 		file_error(ms, 0, "zlib: %s", z.msg);</span>
<span class='curline'><a href='../S/166.html#L381'>ms</a>                381 ext/fileinfo/libmagic/compress.c 		file_error(ms, 0, "zlib: %s", z.msg);</span>
<span class='curline'><a href='../S/166.html#L396'>ms</a>                396 ext/fileinfo/libmagic/compress.c uncompressbuf(struct magic_set *ms, int fd, size_t method,</span>
<span class='curline'><a href='../S/166.html#L406'>ms</a>                406 ext/fileinfo/libmagic/compress.c 		return uncompressgzipped(ms, old, newch, n);</span>
<span class='curline'><a href='../S/166.html#L412'>ms</a>                412 ext/fileinfo/libmagic/compress.c 		file_error(ms, errno, "cannot create pipe");	</span>
<span class='curline'><a href='../S/166.html#L445'>ms</a>                445 ext/fileinfo/libmagic/compress.c 		file_error(ms, errno, "could not fork");</span>
<span class='curline'><a href='../S/168.html#L35'>ms</a>                 35 ext/fileinfo/libmagic/elfclass.h 	notecount = ms-&gt;elf_notes_max;</span>
<span class='curline'><a href='../S/168.html#L40'>ms</a>                 40 ext/fileinfo/libmagic/elfclass.h 		if (phnum &gt; ms-&gt;elf_phnum_max)</span>
<span class='curline'><a href='../S/168.html#L41'>ms</a>                 41 ext/fileinfo/libmagic/elfclass.h 			return toomany(ms, "program headers", phnum);</span>
<span class='curline'><a href='../S/168.html#L43'>ms</a>                 43 ext/fileinfo/libmagic/elfclass.h 		if (dophn_core(ms, clazz, swap, fd,</span>
<span class='curline'><a href='../S/168.html#L53'>ms</a>                 53 ext/fileinfo/libmagic/elfclass.h 		if (phnum &gt; ms-&gt;elf_phnum_max)</span>
<span class='curline'><a href='../S/168.html#L54'>ms</a>                 54 ext/fileinfo/libmagic/elfclass.h 			return toomany(ms, "program", phnum);</span>
<span class='curline'><a href='../S/168.html#L56'>ms</a>                 56 ext/fileinfo/libmagic/elfclass.h 		if (shnum &gt; ms-&gt;elf_shnum_max)</span>
<span class='curline'><a href='../S/168.html#L57'>ms</a>                 57 ext/fileinfo/libmagic/elfclass.h 			return toomany(ms, "section", shnum);</span>
<span class='curline'><a href='../S/168.html#L58'>ms</a>                 58 ext/fileinfo/libmagic/elfclass.h 		if (dophn_exec(ms, clazz, swap, fd,</span>
<span class='curline'><a href='../S/168.html#L66'>ms</a>                 66 ext/fileinfo/libmagic/elfclass.h 		if (shnum &gt; ms-&gt;elf_shnum_max)</span>
<span class='curline'><a href='../S/168.html#L67'>ms</a>                 67 ext/fileinfo/libmagic/elfclass.h 			return toomany(ms, "section headers", shnum);</span>
<span class='curline'><a href='../S/168.html#L68'>ms</a>                 68 ext/fileinfo/libmagic/elfclass.h 		if (doshn(ms, clazz, swap, fd,</span>
<span class='curline'><a href='../S/168.html#L81'>ms</a>                 81 ext/fileinfo/libmagic/elfclass.h 		return toomany(ms, "notes", ms-&gt;elf_notes_max);</span>
<span class='curline'><a href='../S/169.html#L68'>ms</a>                 68 ext/fileinfo/libmagic/encoding.c file_encoding(struct magic_set *ms, const unsigned char *buf, size_t nbytes, unichar **ubuf, size_t *ulen, const char **code, const char **code_mime, const char **type)</span>
<span class='curline'><a href='../S/169.html#L81'>ms</a>                 81 ext/fileinfo/libmagic/encoding.c 		file_oomem(ms, mlen);</span>
<span class='curline'><a href='../S/169.html#L86'>ms</a>                 86 ext/fileinfo/libmagic/encoding.c 		file_oomem(ms, mlen);</span>
<span class='curline'><a href='../S/171.html#L82'>ms</a>                 82 ext/fileinfo/libmagic/fsmagic.c handle_mime(struct magic_set *ms, int mime, const char *str)</span>
<span class='curline'><a href='../S/171.html#L85'>ms</a>                 85 ext/fileinfo/libmagic/fsmagic.c 		if (file_printf(ms, "inode/%s", str) == -1)</span>
<span class='curline'><a href='../S/171.html#L87'>ms</a>                 87 ext/fileinfo/libmagic/fsmagic.c 		if ((mime &amp; MAGIC_MIME_ENCODING) &amp;&amp; file_printf(ms,</span>
<span class='curline'><a href='../S/171.html#L91'>ms</a>                 91 ext/fileinfo/libmagic/fsmagic.c 	if ((mime &amp; MAGIC_MIME_ENCODING) &amp;&amp; file_printf(ms, "binary") == -1)</span>
<span class='curline'><a href='../S/171.html#L97'>ms</a>                 97 ext/fileinfo/libmagic/fsmagic.c file_fsmagic(struct magic_set *ms, const char *fn, zend_stat_t *sb, php_stream *stream)</span>
<span class='curline'><a href='../S/171.html#L100'>ms</a>                100 ext/fileinfo/libmagic/fsmagic.c 	int mime = ms-&gt;flags &amp; MAGIC_MIME;</span>
<span class='curline'><a href='../S/171.html#L102'>ms</a>                102 ext/fileinfo/libmagic/fsmagic.c 	if (ms-&gt;flags &amp; MAGIC_APPLE)</span>
<span class='curline'><a href='../S/171.html#L114'>ms</a>                114 ext/fileinfo/libmagic/fsmagic.c 			if (ms-&gt;flags &amp; MAGIC_ERROR) {</span>
<span class='curline'><a href='../S/171.html#L115'>ms</a>                115 ext/fileinfo/libmagic/fsmagic.c 				file_error(ms, errno, "cannot stat `%s'", fn);</span>
<span class='curline'><a href='../S/171.html#L123'>ms</a>                123 ext/fileinfo/libmagic/fsmagic.c 			if (ms-&gt;flags &amp; MAGIC_ERROR) {</span>
<span class='curline'><a href='../S/171.html#L124'>ms</a>                124 ext/fileinfo/libmagic/fsmagic.c 				file_error(ms, errno, "cannot stat `%s'", fn);</span>
<span class='curline'><a href='../S/171.html#L135'>ms</a>                135 ext/fileinfo/libmagic/fsmagic.c 			if (file_printf(ms, "%ssetuid", COMMA) == -1)</span>
<span class='curline'><a href='../S/171.html#L140'>ms</a>                140 ext/fileinfo/libmagic/fsmagic.c 			if (file_printf(ms, "%ssetgid", COMMA) == -1)</span>
<span class='curline'><a href='../S/171.html#L145'>ms</a>                145 ext/fileinfo/libmagic/fsmagic.c 			if (file_printf(ms, "%ssticky", COMMA) == -1)</span>
<span class='curline'><a href='../S/171.html#L159'>ms</a>                159 ext/fileinfo/libmagic/fsmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEVICES) != 0) {</span>
<span class='curline'><a href='../S/171.html#L164'>ms</a>                164 ext/fileinfo/libmagic/fsmagic.c 				if (handle_mime(ms, mime, "chardevice") == -1)</span>
<span class='curline'><a href='../S/171.html#L169'>ms</a>                169 ext/fileinfo/libmagic/fsmagic.c 			if (file_printf(ms, "%scharacter special (%d/%d/%d)",</span>
<span class='curline'><a href='../S/171.html#L174'>ms</a>                174 ext/fileinfo/libmagic/fsmagic.c 			if (file_printf(ms, "%scharacter special (%ld/%ld)",</span>
<span class='curline'><a href='../S/171.html#L180'>ms</a>                180 ext/fileinfo/libmagic/fsmagic.c 			if (file_printf(ms, "%scharacter special", COMMA) == -1)</span>
<span class='curline'><a href='../S/171.html#L190'>ms</a>                190 ext/fileinfo/libmagic/fsmagic.c 		if((ms-&gt;flags &amp; MAGIC_DEVICES) != 0)</span>
<span class='curline'><a href='../S/171.html#L193'>ms</a>                193 ext/fileinfo/libmagic/fsmagic.c 			if (handle_mime(ms, mime, "fifo") == -1)</span>
<span class='curline'><a href='../S/171.html#L195'>ms</a>                195 ext/fileinfo/libmagic/fsmagic.c 		} else if (file_printf(ms, "%sfifo (named pipe)", COMMA) == -1)</span>
<span class='curline'><a href='../S/171.html#L202'>ms</a>                202 ext/fileinfo/libmagic/fsmagic.c 			if (handle_mime(ms, mime, "door") == -1)</span>
<span class='curline'><a href='../S/171.html#L204'>ms</a>                204 ext/fileinfo/libmagic/fsmagic.c 		} else if (file_printf(ms, "%sdoor", COMMA) == -1)</span>
<span class='curline'><a href='../S/171.html#L211'>ms</a>                211 ext/fileinfo/libmagic/fsmagic.c 			if (ms-&gt;flags &amp; MAGIC_ERROR) {</span>
<span class='curline'><a href='../S/171.html#L212'>ms</a>                212 ext/fileinfo/libmagic/fsmagic.c 			    file_error(ms, errno, "unreadable symlink `%s'", fn);</span>
<span class='curline'><a href='../S/171.html#L222'>ms</a>                222 ext/fileinfo/libmagic/fsmagic.c 			if (handle_mime(ms, mime, "socket") == -1)</span>
<span class='curline'><a href='../S/171.html#L224'>ms</a>                224 ext/fileinfo/libmagic/fsmagic.c 		} else if (file_printf(ms, "%ssocket", COMMA) == -1)</span>
<span class='curline'><a href='../S/171.html#L242'>ms</a>                242 ext/fileinfo/libmagic/fsmagic.c 	if ((ms-&gt;flags &amp; MAGIC_DEVICES) == 0 &amp;&amp; sb-&gt;st_size == 0) {</span>
<span class='curline'><a href='../S/171.html#L244'>ms</a>                244 ext/fileinfo/libmagic/fsmagic.c 			if (handle_mime(ms, mime, "x-empty") == -1)</span>
<span class='curline'><a href='../S/171.html#L246'>ms</a>                246 ext/fileinfo/libmagic/fsmagic.c 			} else if (file_printf(ms, "%sempty", COMMA) == -1)</span>
<span class='curline'><a href='../S/171.html#L254'>ms</a>                254 ext/fileinfo/libmagic/fsmagic.c 		file_error(ms, 0, "invalid mode 0%o", sb-&gt;st_mode);</span>
<span class='curline'><a href='../S/172.html#L62'>ms</a>                 62 ext/fileinfo/libmagic/funcs.c file_printf(struct magic_set *ms, const char *fmt, ...)</span>
<span class='curline'><a href='../S/172.html#L72'>ms</a>                 72 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;o.buf != NULL) {</span>
<span class='curline'><a href='../S/172.html#L73'>ms</a>                 73 ext/fileinfo/libmagic/funcs.c 		len = spprintf(&amp;newstr, 0, "%s%s", ms-&gt;o.buf, (buf ? buf : ""));</span>
<span class='curline'><a href='../S/172.html#L77'>ms</a>                 77 ext/fileinfo/libmagic/funcs.c 		efree(ms-&gt;o.buf);</span>
<span class='curline'><a href='../S/172.html#L78'>ms</a>                 78 ext/fileinfo/libmagic/funcs.c 		ms-&gt;o.buf = newstr;</span>
<span class='curline'><a href='../S/172.html#L80'>ms</a>                 80 ext/fileinfo/libmagic/funcs.c 		ms-&gt;o.buf = buf;</span>
<span class='curline'><a href='../S/172.html#L90'>ms</a>                 90 ext/fileinfo/libmagic/funcs.c file_error_core(struct magic_set *ms, int error, const char *f, va_list va,</span>
<span class='curline'><a href='../S/172.html#L96'>ms</a>                 96 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;event_flags &amp; EVENT_HAD_ERR)</span>
<span class='curline'><a href='../S/172.html#L99'>ms</a>                 99 ext/fileinfo/libmagic/funcs.c 		efree(ms-&gt;o.buf);</span>
<span class='curline'><a href='../S/172.html#L100'>ms</a>                100 ext/fileinfo/libmagic/funcs.c 		ms-&gt;o.buf = NULL;</span>
<span class='curline'><a href='../S/172.html#L101'>ms</a>                101 ext/fileinfo/libmagic/funcs.c 		file_printf(ms, "line %" SIZE_T_FORMAT "u: ", lineno);</span>
<span class='curline'><a href='../S/172.html#L108'>ms</a>                108 ext/fileinfo/libmagic/funcs.c 		file_printf(ms, "%s (%s)", (*buf ? buf : ""), strerror(error));</span>
<span class='curline'><a href='../S/172.html#L110'>ms</a>                110 ext/fileinfo/libmagic/funcs.c 		file_printf(ms, "%s", buf);</span>
<span class='curline'><a href='../S/172.html#L117'>ms</a>                117 ext/fileinfo/libmagic/funcs.c 	ms-&gt;event_flags |= EVENT_HAD_ERR;</span>
<span class='curline'><a href='../S/172.html#L118'>ms</a>                118 ext/fileinfo/libmagic/funcs.c 	ms-&gt;error = error;</span>
<span class='curline'><a href='../S/172.html#L123'>ms</a>                123 ext/fileinfo/libmagic/funcs.c file_error(struct magic_set *ms, int error, const char *f, ...)</span>
<span class='curline'><a href='../S/172.html#L127'>ms</a>                127 ext/fileinfo/libmagic/funcs.c 	file_error_core(ms, error, f, va, 0);</span>
<span class='curline'><a href='../S/172.html#L136'>ms</a>                136 ext/fileinfo/libmagic/funcs.c file_magerror(struct magic_set *ms, const char *f, ...)</span>
<span class='curline'><a href='../S/172.html#L140'>ms</a>                140 ext/fileinfo/libmagic/funcs.c 	file_error_core(ms, 0, f, va, ms-&gt;line);</span>
<span class='curline'><a href='../S/172.html#L145'>ms</a>                145 ext/fileinfo/libmagic/funcs.c file_oomem(struct magic_set *ms, size_t len)</span>
<span class='curline'><a href='../S/172.html#L147'>ms</a>                147 ext/fileinfo/libmagic/funcs.c 	file_error(ms, errno, "cannot allocate %" SIZE_T_FORMAT "u bytes",</span>
<span class='curline'><a href='../S/172.html#L152'>ms</a>                152 ext/fileinfo/libmagic/funcs.c file_badseek(struct magic_set *ms)</span>
<span class='curline'><a href='../S/172.html#L154'>ms</a>                154 ext/fileinfo/libmagic/funcs.c 	file_error(ms, errno, "error seeking");</span>
<span class='curline'><a href='../S/172.html#L158'>ms</a>                158 ext/fileinfo/libmagic/funcs.c file_badread(struct magic_set *ms)</span>
<span class='curline'><a href='../S/172.html#L160'>ms</a>                160 ext/fileinfo/libmagic/funcs.c 	file_error(ms, errno, "error reading");</span>
<span class='curline'><a href='../S/172.html#L164'>ms</a>                164 ext/fileinfo/libmagic/funcs.c file_buffer(struct magic_set *ms, php_stream *stream, const char *inname, const void *buf,</span>
<span class='curline'><a href='../S/172.html#L168'>ms</a>                168 ext/fileinfo/libmagic/funcs.c 	int mime = ms-&gt;flags &amp; MAGIC_MIME;</span>
<span class='curline'><a href='../S/172.html#L187'>ms</a>                187 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_ENCODING) == 0) {</span>
<span class='curline'><a href='../S/172.html#L188'>ms</a>                188 ext/fileinfo/libmagic/funcs.c 		looks_text = file_encoding(ms, ubuf, nb, &amp;u8buf, &amp;ulen,</span>
<span class='curline'><a href='../S/172.html#L193'>ms</a>                193 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_APPTYPE) == 0 &amp;&amp; inname) {</span>
<span class='curline'><a href='../S/172.html#L194'>ms</a>                194 ext/fileinfo/libmagic/funcs.c 		switch (file_os2_apptype(ms, inname, buf, nb)) {</span>
<span class='curline'><a href='../S/172.html#L206'>ms</a>                206 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_COMPRESS) == 0)</span>
<span class='curline'><a href='../S/172.html#L207'>ms</a>                207 ext/fileinfo/libmagic/funcs.c 		if ((m = file_zmagic(ms, stream, inname, ubuf, nb)) != 0) {</span>
<span class='curline'><a href='../S/172.html#L208'>ms</a>                208 ext/fileinfo/libmagic/funcs.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/172.html#L214'>ms</a>                214 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_TAR) == 0)</span>
<span class='curline'><a href='../S/172.html#L215'>ms</a>                215 ext/fileinfo/libmagic/funcs.c 		if ((m = file_is_tar(ms, ubuf, nb)) != 0) {</span>
<span class='curline'><a href='../S/172.html#L216'>ms</a>                216 ext/fileinfo/libmagic/funcs.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/172.html#L222'>ms</a>                222 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_CDF) == 0) {</span>
<span class='curline'><a href='../S/172.html#L225'>ms</a>                225 ext/fileinfo/libmagic/funcs.c 			if ((m = file_trycdf(ms, fd, ubuf, nb)) != 0) {</span>
<span class='curline'><a href='../S/172.html#L226'>ms</a>                226 ext/fileinfo/libmagic/funcs.c 				if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/172.html#L234'>ms</a>                234 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_SOFT) == 0)</span>
<span class='curline'><a href='../S/172.html#L235'>ms</a>                235 ext/fileinfo/libmagic/funcs.c 		if ((m = file_softmagic(ms, ubuf, nb, 0, NULL, BINTEST,</span>
<span class='curline'><a href='../S/172.html#L237'>ms</a>                237 ext/fileinfo/libmagic/funcs.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/172.html#L240'>ms</a>                240 ext/fileinfo/libmagic/funcs.c 			if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_ELF) == 0 &amp;&amp; m == 1 &amp;&amp;</span>
<span class='curline'><a href='../S/172.html#L251'>ms</a>                251 ext/fileinfo/libmagic/funcs.c 				if ((m = file_tryelf(ms, fd, ubuf, nb)) != 0)</span>
<span class='curline'><a href='../S/172.html#L252'>ms</a>                252 ext/fileinfo/libmagic/funcs.c 					if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/172.html#L261'>ms</a>                261 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_TEXT) == 0) {</span>
<span class='curline'><a href='../S/172.html#L263'>ms</a>                263 ext/fileinfo/libmagic/funcs.c 		if ((m = file_ascmagic(ms, ubuf, nb, looks_text)) != 0) {</span>
<span class='curline'><a href='../S/172.html#L264'>ms</a>                264 ext/fileinfo/libmagic/funcs.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/172.html#L274'>ms</a>                274 ext/fileinfo/libmagic/funcs.c 	    file_printf(ms, "%s", mime ? type : def) == -1) {</span>
<span class='curline'><a href='../S/172.html#L278'>ms</a>                278 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_MIME_ENCODING) != 0) {</span>
<span class='curline'><a href='../S/172.html#L279'>ms</a>                279 ext/fileinfo/libmagic/funcs.c 		if (ms-&gt;flags &amp; MAGIC_MIME_TYPE)</span>
<span class='curline'><a href='../S/172.html#L280'>ms</a>                280 ext/fileinfo/libmagic/funcs.c 			if (file_printf(ms, "; charset=") == -1)</span>
<span class='curline'><a href='../S/172.html#L282'>ms</a>                282 ext/fileinfo/libmagic/funcs.c 		if (file_printf(ms, "%s", code_mime) == -1)</span>
<span class='curline'><a href='../S/172.html#L296'>ms</a>                296 ext/fileinfo/libmagic/funcs.c file_reset(struct magic_set *ms)</span>
<span class='curline'><a href='../S/172.html#L298'>ms</a>                298 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;mlist[0] == NULL) {</span>
<span class='curline'><a href='../S/172.html#L299'>ms</a>                299 ext/fileinfo/libmagic/funcs.c 		file_error(ms, 0, "no magic files loaded");</span>
<span class='curline'><a href='../S/172.html#L302'>ms</a>                302 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;o.buf) {</span>
<span class='curline'><a href='../S/172.html#L303'>ms</a>                303 ext/fileinfo/libmagic/funcs.c 		efree(ms-&gt;o.buf);</span>
<span class='curline'><a href='../S/172.html#L304'>ms</a>                304 ext/fileinfo/libmagic/funcs.c 		ms-&gt;o.buf = NULL;</span>
<span class='curline'><a href='../S/172.html#L306'>ms</a>                306 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;o.pbuf) {</span>
<span class='curline'><a href='../S/172.html#L307'>ms</a>                307 ext/fileinfo/libmagic/funcs.c 		efree(ms-&gt;o.pbuf);</span>
<span class='curline'><a href='../S/172.html#L308'>ms</a>                308 ext/fileinfo/libmagic/funcs.c 		ms-&gt;o.pbuf = NULL;</span>
<span class='curline'><a href='../S/172.html#L310'>ms</a>                310 ext/fileinfo/libmagic/funcs.c 	ms-&gt;event_flags &amp;= ~EVENT_HAD_ERR;</span>
<span class='curline'><a href='../S/172.html#L311'>ms</a>                311 ext/fileinfo/libmagic/funcs.c 	ms-&gt;error = -1;</span>
<span class='curline'><a href='../S/172.html#L324'>ms</a>                324 ext/fileinfo/libmagic/funcs.c file_getbuffer(struct magic_set *ms)</span>
<span class='curline'><a href='../S/172.html#L329'>ms</a>                329 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;event_flags &amp; EVENT_HAD_ERR)</span>
<span class='curline'><a href='../S/172.html#L332'>ms</a>                332 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;flags &amp; MAGIC_RAW)</span>
<span class='curline'><a href='../S/172.html#L333'>ms</a>                333 ext/fileinfo/libmagic/funcs.c 		return ms-&gt;o.buf;</span>
<span class='curline'><a href='../S/172.html#L335'>ms</a>                335 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;o.buf == NULL)</span>
<span class='curline'><a href='../S/172.html#L339'>ms</a>                339 ext/fileinfo/libmagic/funcs.c 	len = strlen(ms-&gt;o.buf);</span>
<span class='curline'><a href='../S/172.html#L341'>ms</a>                341 ext/fileinfo/libmagic/funcs.c 		file_oomem(ms, len);</span>
<span class='curline'><a href='../S/172.html#L345'>ms</a>                345 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;o.pbuf = CAST(char *, erealloc(ms-&gt;o.pbuf, psize))) == NULL) {</span>
<span class='curline'><a href='../S/172.html#L346'>ms</a>                346 ext/fileinfo/libmagic/funcs.c 		file_oomem(ms, psize);</span>
<span class='curline'><a href='../S/172.html#L359'>ms</a>                359 ext/fileinfo/libmagic/funcs.c 		np = ms-&gt;o.pbuf;</span>
<span class='curline'><a href='../S/172.html#L360'>ms</a>                360 ext/fileinfo/libmagic/funcs.c 		op = ms-&gt;o.buf;</span>
<span class='curline'><a href='../S/172.html#L385'>ms</a>                385 ext/fileinfo/libmagic/funcs.c 			return ms-&gt;o.pbuf;</span>
<span class='curline'><a href='../S/172.html#L389'>ms</a>                389 ext/fileinfo/libmagic/funcs.c 	for (np = ms-&gt;o.pbuf, op = ms-&gt;o.buf; *op;) {</span>
<span class='curline'><a href='../S/172.html#L397'>ms</a>                397 ext/fileinfo/libmagic/funcs.c 	return ms-&gt;o.pbuf;</span>
<span class='curline'><a href='../S/172.html#L401'>ms</a>                401 ext/fileinfo/libmagic/funcs.c file_check_mem(struct magic_set *ms, unsigned int level)</span>
<span class='curline'><a href='../S/172.html#L405'>ms</a>                405 ext/fileinfo/libmagic/funcs.c 	if (level &gt;= ms-&gt;c.len) {</span>
<span class='curline'><a href='../S/172.html#L406'>ms</a>                406 ext/fileinfo/libmagic/funcs.c 		len = (ms-&gt;c.len += 20 + level) * sizeof(*ms-&gt;c.li);</span>
<span class='curline'><a href='../S/172.html#L407'>ms</a>                407 ext/fileinfo/libmagic/funcs.c 		ms-&gt;c.li = CAST(struct level_info *, (ms-&gt;c.li == NULL) ?</span>
<span class='curline'><a href='../S/172.html#L409'>ms</a>                409 ext/fileinfo/libmagic/funcs.c 		    erealloc(ms-&gt;c.li, len));</span>
<span class='curline'><a href='../S/172.html#L410'>ms</a>                410 ext/fileinfo/libmagic/funcs.c 		if (ms-&gt;c.li == NULL) {</span>
<span class='curline'><a href='../S/172.html#L411'>ms</a>                411 ext/fileinfo/libmagic/funcs.c 			file_oomem(ms, len);</span>
<span class='curline'><a href='../S/172.html#L415'>ms</a>                415 ext/fileinfo/libmagic/funcs.c 	ms-&gt;c.li[level].got_match = 0;</span>
<span class='curline'><a href='../S/172.html#L417'>ms</a>                417 ext/fileinfo/libmagic/funcs.c 	ms-&gt;c.li[level].last_match = 0;</span>
<span class='curline'><a href='../S/172.html#L418'>ms</a>                418 ext/fileinfo/libmagic/funcs.c 	ms-&gt;c.li[level].last_cond = COND_NONE;</span>
<span class='curline'><a href='../S/172.html#L424'>ms</a>                424 ext/fileinfo/libmagic/funcs.c file_printedlen(const struct magic_set *ms)</span>
<span class='curline'><a href='../S/172.html#L426'>ms</a>                426 ext/fileinfo/libmagic/funcs.c 	return ms-&gt;o.buf == NULL ? 0 : strlen(ms-&gt;o.buf);</span>
<span class='curline'><a href='../S/172.html#L430'>ms</a>                430 ext/fileinfo/libmagic/funcs.c file_replace(struct magic_set *ms, const char *pat, const char *rep)</span>
<span class='curline'><a href='../S/172.html#L451'>ms</a>                451 ext/fileinfo/libmagic/funcs.c 	res = php_pcre_replace_impl(pce, NULL, ms-&gt;o.buf, strlen(ms-&gt;o.buf), &amp;repl, 0, -1, &amp;rep_cnt);</span>
<span class='curline'><a href='../S/172.html#L459'>ms</a>                459 ext/fileinfo/libmagic/funcs.c 	strncpy(ms-&gt;o.buf, ZSTR_VAL(res), ZSTR_LEN(res));</span>
<span class='curline'><a href='../S/172.html#L460'>ms</a>                460 ext/fileinfo/libmagic/funcs.c 	ms-&gt;o.buf[ZSTR_LEN(res)] = '\0';</span>
<span class='curline'><a href='../S/172.html#L470'>ms</a>                470 ext/fileinfo/libmagic/funcs.c file_push_buffer(struct magic_set *ms)</span>
<span class='curline'><a href='../S/172.html#L474'>ms</a>                474 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;event_flags &amp; EVENT_HAD_ERR)</span>
<span class='curline'><a href='../S/172.html#L480'>ms</a>                480 ext/fileinfo/libmagic/funcs.c 	pb-&gt;buf = ms-&gt;o.buf;</span>
<span class='curline'><a href='../S/172.html#L481'>ms</a>                481 ext/fileinfo/libmagic/funcs.c 	pb-&gt;offset = ms-&gt;offset;</span>
<span class='curline'><a href='../S/172.html#L483'>ms</a>                483 ext/fileinfo/libmagic/funcs.c 	ms-&gt;o.buf = NULL;</span>
<span class='curline'><a href='../S/172.html#L484'>ms</a>                484 ext/fileinfo/libmagic/funcs.c 	ms-&gt;offset = 0;</span>
<span class='curline'><a href='../S/172.html#L490'>ms</a>                490 ext/fileinfo/libmagic/funcs.c file_pop_buffer(struct magic_set *ms, file_pushbuf_t *pb)</span>
<span class='curline'><a href='../S/172.html#L494'>ms</a>                494 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;event_flags &amp; EVENT_HAD_ERR) {</span>
<span class='curline'><a href='../S/172.html#L500'>ms</a>                500 ext/fileinfo/libmagic/funcs.c 	rbuf = ms-&gt;o.buf;</span>
<span class='curline'><a href='../S/172.html#L502'>ms</a>                502 ext/fileinfo/libmagic/funcs.c 	ms-&gt;o.buf = pb-&gt;buf;</span>
<span class='curline'><a href='../S/172.html#L503'>ms</a>                503 ext/fileinfo/libmagic/funcs.c 	ms-&gt;offset = pb-&gt;offset;</span>
<span class='curline'><a href='../S/173.html#L63'>ms</a>                 63 ext/fileinfo/libmagic/is_tar.c file_is_tar(struct magic_set *ms, const unsigned char *buf, size_t nbytes)</span>
<span class='curline'><a href='../S/173.html#L70'>ms</a>                 70 ext/fileinfo/libmagic/is_tar.c 	int mime = ms-&gt;flags &amp; MAGIC_MIME;</span>
<span class='curline'><a href='../S/173.html#L72'>ms</a>                 72 ext/fileinfo/libmagic/is_tar.c 	if ((ms-&gt;flags &amp; MAGIC_APPLE) != 0)</span>
<span class='curline'><a href='../S/173.html#L79'>ms</a>                 79 ext/fileinfo/libmagic/is_tar.c 	if (file_printf(ms, "%s", mime ? "application/x-tar" :</span>
<span class='curline'><a href='../S/174.html#L234'>ms</a>                234 ext/fileinfo/libmagic/magic.c unreadable_info(struct magic_set *ms, mode_t md, const char *file)</span>
<span class='curline'><a href='../S/174.html#L239'>ms</a>                239 ext/fileinfo/libmagic/magic.c 			if (file_printf(ms, "writable, ") == -1)</span>
<span class='curline'><a href='../S/174.html#L242'>ms</a>                242 ext/fileinfo/libmagic/magic.c 			if (file_printf(ms, "executable, ") == -1)</span>
<span class='curline'><a href='../S/174.html#L246'>ms</a>                246 ext/fileinfo/libmagic/magic.c 		if (file_printf(ms, "regular file, ") == -1)</span>
<span class='curline'><a href='../S/174.html#L248'>ms</a>                248 ext/fileinfo/libmagic/magic.c 	if (file_printf(ms, "no read permission") == -1)</span>
<span class='curline'><a href='../S/174.html#L254'>ms</a>                254 ext/fileinfo/libmagic/magic.c magic_close(struct magic_set *ms)</span>
<span class='curline'><a href='../S/174.html#L256'>ms</a>                256 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/174.html#L258'>ms</a>                258 ext/fileinfo/libmagic/magic.c 	file_ms_free(ms);</span>
<span class='curline'><a href='../S/174.html#L265'>ms</a>                265 ext/fileinfo/libmagic/magic.c magic_load(struct magic_set *ms, const char *magicfile)</span>
<span class='curline'><a href='../S/174.html#L267'>ms</a>                267 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/174.html#L269'>ms</a>                269 ext/fileinfo/libmagic/magic.c 	return file_apprentice(ms, magicfile, FILE_LOAD);</span>
<span class='curline'><a href='../S/174.html#L273'>ms</a>                273 ext/fileinfo/libmagic/magic.c magic_compile(struct magic_set *ms, const char *magicfile)</span>
<span class='curline'><a href='../S/174.html#L275'>ms</a>                275 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/174.html#L277'>ms</a>                277 ext/fileinfo/libmagic/magic.c 	return file_apprentice(ms, magicfile, FILE_COMPILE);</span>
<span class='curline'><a href='../S/174.html#L282'>ms</a>                282 ext/fileinfo/libmagic/magic.c magic_list(struct magic_set *ms, const char *magicfile)</span>
<span class='curline'><a href='../S/174.html#L284'>ms</a>                284 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/174.html#L286'>ms</a>                286 ext/fileinfo/libmagic/magic.c 	return file_apprentice(ms, magicfile, FILE_LIST);</span>
<span class='curline'><a href='../S/174.html#L290'>ms</a>                290 ext/fileinfo/libmagic/magic.c close_and_restore(const struct magic_set *ms, const char *name, int fd,</span>
<span class='curline'><a href='../S/174.html#L294'>ms</a>                294 ext/fileinfo/libmagic/magic.c 	if ((ms-&gt;flags &amp; MAGIC_PRESERVE_ATIME) != 0) {</span>
<span class='curline'><a href='../S/174.html#L324'>ms</a>                324 ext/fileinfo/libmagic/magic.c magic_descriptor(struct magic_set *ms, int fd)</span>
<span class='curline'><a href='../S/174.html#L326'>ms</a>                326 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/174.html#L328'>ms</a>                328 ext/fileinfo/libmagic/magic.c 	return file_or_stream(ms, NULL, NULL);</span>
<span class='curline'><a href='../S/174.html#L335'>ms</a>                335 ext/fileinfo/libmagic/magic.c magic_file(struct magic_set *ms, const char *inname)</span>
<span class='curline'><a href='../S/174.html#L337'>ms</a>                337 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/174.html#L339'>ms</a>                339 ext/fileinfo/libmagic/magic.c 	return file_or_stream(ms, inname, NULL);</span>
<span class='curline'><a href='../S/174.html#L343'>ms</a>                343 ext/fileinfo/libmagic/magic.c magic_stream(struct magic_set *ms, php_stream *stream)</span>
<span class='curline'><a href='../S/174.html#L345'>ms</a>                345 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/174.html#L347'>ms</a>                347 ext/fileinfo/libmagic/magic.c 	return file_or_stream(ms, NULL, stream);</span>
<span class='curline'><a href='../S/174.html#L351'>ms</a>                351 ext/fileinfo/libmagic/magic.c file_or_stream(struct magic_set *ms, const char *inname, php_stream *stream)</span>
<span class='curline'><a href='../S/174.html#L370'>ms</a>                370 ext/fileinfo/libmagic/magic.c 	if (file_reset(ms) == -1)</span>
<span class='curline'><a href='../S/174.html#L373'>ms</a>                373 ext/fileinfo/libmagic/magic.c 	switch (file_fsmagic(ms, inname, &amp;sb, stream)) {</span>
<span class='curline'><a href='../S/174.html#L391'>ms</a>                391 ext/fileinfo/libmagic/magic.c 		if (unreadable_info(ms, sb.st_mode, inname) == -1)</span>
<span class='curline'><a href='../S/174.html#L405'>ms</a>                405 ext/fileinfo/libmagic/magic.c 		file_error(ms, errno, "cannot read `%s'", inname);</span>
<span class='curline'><a href='../S/174.html#L410'>ms</a>                410 ext/fileinfo/libmagic/magic.c 	if (file_buffer(ms, stream, inname, buf, (size_t)nbytes) == -1)</span>
<span class='curline'><a href='../S/174.html#L420'>ms</a>                420 ext/fileinfo/libmagic/magic.c 	close_and_restore(ms, inname, 0, &amp;sb);</span>
<span class='curline'><a href='../S/174.html#L421'>ms</a>                421 ext/fileinfo/libmagic/magic.c 	return rv == 0 ? file_getbuffer(ms) : NULL;</span>
<span class='curline'><a href='../S/174.html#L426'>ms</a>                426 ext/fileinfo/libmagic/magic.c magic_buffer(struct magic_set *ms, const void *buf, size_t nb)</span>
<span class='curline'><a href='../S/174.html#L428'>ms</a>                428 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/174.html#L430'>ms</a>                430 ext/fileinfo/libmagic/magic.c 	if (file_reset(ms) == -1)</span>
<span class='curline'><a href='../S/174.html#L436'>ms</a>                436 ext/fileinfo/libmagic/magic.c 	if (file_buffer(ms, NULL, NULL, buf, nb) == -1) {</span>
<span class='curline'><a href='../S/174.html#L439'>ms</a>                439 ext/fileinfo/libmagic/magic.c 	return file_getbuffer(ms);</span>
<span class='curline'><a href='../S/174.html#L443'>ms</a>                443 ext/fileinfo/libmagic/magic.c magic_error(struct magic_set *ms)</span>
<span class='curline'><a href='../S/174.html#L445'>ms</a>                445 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/174.html#L447'>ms</a>                447 ext/fileinfo/libmagic/magic.c 	return (ms-&gt;event_flags &amp; EVENT_HAD_ERR) ? ms-&gt;o.buf : NULL;</span>
<span class='curline'><a href='../S/174.html#L451'>ms</a>                451 ext/fileinfo/libmagic/magic.c magic_errno(struct magic_set *ms)</span>
<span class='curline'><a href='../S/174.html#L453'>ms</a>                453 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/174.html#L455'>ms</a>                455 ext/fileinfo/libmagic/magic.c 	return (ms-&gt;event_flags &amp; EVENT_HAD_ERR) ? ms-&gt;error : 0;</span>
<span class='curline'><a href='../S/174.html#L459'>ms</a>                459 ext/fileinfo/libmagic/magic.c magic_setflags(struct magic_set *ms, int flags)</span>
<span class='curline'><a href='../S/174.html#L461'>ms</a>                461 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/174.html#L467'>ms</a>                467 ext/fileinfo/libmagic/magic.c 	ms-&gt;flags = flags;</span>
<span class='curline'><a href='../S/174.html#L478'>ms</a>                478 ext/fileinfo/libmagic/magic.c magic_setparam(struct magic_set *ms, int param, const void *val)</span>
<span class='curline'><a href='../S/174.html#L482'>ms</a>                482 ext/fileinfo/libmagic/magic.c 		ms-&gt;indir_max = (uint16_t)*(const size_t *)val;</span>
<span class='curline'><a href='../S/174.html#L485'>ms</a>                485 ext/fileinfo/libmagic/magic.c 		ms-&gt;name_max = (uint16_t)*(const size_t *)val;</span>
<span class='curline'><a href='../S/174.html#L488'>ms</a>                488 ext/fileinfo/libmagic/magic.c 		ms-&gt;elf_phnum_max = (uint16_t)*(const size_t *)val;</span>
<span class='curline'><a href='../S/174.html#L491'>ms</a>                491 ext/fileinfo/libmagic/magic.c 		ms-&gt;elf_shnum_max = (uint16_t)*(const size_t *)val;</span>
<span class='curline'><a href='../S/174.html#L494'>ms</a>                494 ext/fileinfo/libmagic/magic.c 		ms-&gt;elf_notes_max = (uint16_t)*(const size_t *)val;</span>
<span class='curline'><a href='../S/174.html#L503'>ms</a>                503 ext/fileinfo/libmagic/magic.c magic_getparam(struct magic_set *ms, int param, void *val)</span>
<span class='curline'><a href='../S/174.html#L507'>ms</a>                507 ext/fileinfo/libmagic/magic.c 		*(size_t *)val = ms-&gt;indir_max;</span>
<span class='curline'><a href='../S/174.html#L510'>ms</a>                510 ext/fileinfo/libmagic/magic.c 		*(size_t *)val = ms-&gt;name_max;</span>
<span class='curline'><a href='../S/174.html#L513'>ms</a>                513 ext/fileinfo/libmagic/magic.c 		*(size_t *)val = ms-&gt;elf_phnum_max;</span>
<span class='curline'><a href='../S/174.html#L516'>ms</a>                516 ext/fileinfo/libmagic/magic.c 		*(size_t *)val = ms-&gt;elf_shnum_max;</span>
<span class='curline'><a href='../S/174.html#L519'>ms</a>                519 ext/fileinfo/libmagic/magic.c 		*(size_t *)val = ms-&gt;elf_notes_max;</span>
<span class='curline'><a href='../S/177.html#L59'>ms</a>                 59 ext/fileinfo/libmagic/print.c file_magwarn(struct magic_set *ms, const char *f, ...)</span>
<span class='curline'><a href='../S/178.html#L52'>ms</a>                 52 ext/fileinfo/libmagic/readcdf.c #define NOTMIME(ms) (((ms)-&gt;flags &amp; MAGIC_MIME) == 0)</span>
<span class='curline'><a href='../S/178.html#L133'>ms</a>                133 ext/fileinfo/libmagic/readcdf.c cdf_file_property_info(struct magic_set *ms, const cdf_property_info_t *info,</span>
<span class='curline'><a href='../S/178.html#L146'>ms</a>                146 ext/fileinfo/libmagic/readcdf.c         if (!NOTMIME(ms) &amp;&amp; root_storage)</span>
<span class='curline'><a href='../S/178.html#L156'>ms</a>                156 ext/fileinfo/libmagic/readcdf.c                         if (NOTMIME(ms) &amp;&amp; file_printf(ms, ", %s: %hd", buf,</span>
<span class='curline'><a href='../S/178.html#L161'>ms</a>                161 ext/fileinfo/libmagic/readcdf.c                         if (NOTMIME(ms) &amp;&amp; file_printf(ms, ", %s: %d", buf,</span>
<span class='curline'><a href='../S/178.html#L166'>ms</a>                166 ext/fileinfo/libmagic/readcdf.c                         if (NOTMIME(ms) &amp;&amp; file_printf(ms, ", %s: %u", buf,</span>
<span class='curline'><a href='../S/178.html#L171'>ms</a>                171 ext/fileinfo/libmagic/readcdf.c                         if (NOTMIME(ms) &amp;&amp; file_printf(ms, ", %s: %g", buf,</span>
<span class='curline'><a href='../S/178.html#L176'>ms</a>                176 ext/fileinfo/libmagic/readcdf.c                         if (NOTMIME(ms) &amp;&amp; file_printf(ms, ", %s: %g", buf,</span>
<span class='curline'><a href='../S/178.html#L199'>ms</a>                199 ext/fileinfo/libmagic/readcdf.c                                 if (NOTMIME(ms)) {</span>
<span class='curline'><a href='../S/178.html#L201'>ms</a>                201 ext/fileinfo/libmagic/readcdf.c                                                 if (file_printf(ms, ", %s: %s",</span>
<span class='curline'><a href='../S/178.html#L218'>ms</a>                218 ext/fileinfo/libmagic/readcdf.c                                         if (NOTMIME(ms) &amp;&amp; file_printf(ms,</span>
<span class='curline'><a href='../S/178.html#L232'>ms</a>                232 ext/fileinfo/libmagic/readcdf.c                                         if (NOTMIME(ms) &amp;&amp; file_printf(ms,</span>
<span class='curline'><a href='../S/178.html#L244'>ms</a>                244 ext/fileinfo/libmagic/readcdf.c         if (!NOTMIME(ms)) {</span>
<span class='curline'><a href='../S/178.html#L247'>ms</a>                247 ext/fileinfo/libmagic/readcdf.c                 if (file_printf(ms, "application/%s", str) == -1)</span>
<span class='curline'><a href='../S/178.html#L254'>ms</a>                254 ext/fileinfo/libmagic/readcdf.c cdf_file_catalog(struct magic_set *ms, const cdf_header_t *h,</span>
<span class='curline'><a href='../S/178.html#L262'>ms</a>                262 ext/fileinfo/libmagic/readcdf.c         if (NOTMIME(ms)) {</span>
<span class='curline'><a href='../S/178.html#L263'>ms</a>                263 ext/fileinfo/libmagic/readcdf.c 		if (file_printf(ms, "Microsoft Thumbs.db [") == -1)</span>
<span class='curline'><a href='../S/178.html#L270'>ms</a>                270 ext/fileinfo/libmagic/readcdf.c 			if (file_printf(ms, "%s%s",</span>
<span class='curline'><a href='../S/178.html#L278'>ms</a>                278 ext/fileinfo/libmagic/readcdf.c 		if (file_printf(ms, "application/CDFV2") == -1)</span>
<span class='curline'><a href='../S/178.html#L285'>ms</a>                285 ext/fileinfo/libmagic/readcdf.c cdf_file_summary_info(struct magic_set *ms, const cdf_header_t *h,</span>
<span class='curline'><a href='../S/178.html#L296'>ms</a>                296 ext/fileinfo/libmagic/readcdf.c         if (NOTMIME(ms)) {</span>
<span class='curline'><a href='../S/178.html#L299'>ms</a>                299 ext/fileinfo/libmagic/readcdf.c                 if (file_printf(ms, "Composite Document File V2 Document")</span>
<span class='curline'><a href='../S/178.html#L303'>ms</a>                303 ext/fileinfo/libmagic/readcdf.c                 if (file_printf(ms, ", %s Endian",</span>
<span class='curline'><a href='../S/178.html#L308'>ms</a>                308 ext/fileinfo/libmagic/readcdf.c                         if (file_printf(ms, ", Os: Windows, Version %d.%d",</span>
<span class='curline'><a href='../S/178.html#L314'>ms</a>                314 ext/fileinfo/libmagic/readcdf.c                         if (file_printf(ms, ", Os: MacOS, Version %d.%d",</span>
<span class='curline'><a href='../S/178.html#L320'>ms</a>                320 ext/fileinfo/libmagic/readcdf.c                         if (file_printf(ms, ", Os %d, Version: %d.%d", si.si_os,</span>
<span class='curline'><a href='../S/178.html#L330'>ms</a>                330 ext/fileinfo/libmagic/readcdf.c 				if (file_printf(ms, ", %s", str) == -1)</span>
<span class='curline'><a href='../S/178.html#L336'>ms</a>                336 ext/fileinfo/libmagic/readcdf.c         m = cdf_file_property_info(ms, info, count, root_storage);</span>
<span class='curline'><a href='../S/178.html#L357'>ms</a>                357 ext/fileinfo/libmagic/readcdf.c cdf_file_catalog_info(struct magic_set *ms, const cdf_info_t *info,</span>
<span class='curline'><a href='../S/178.html#L369'>ms</a>                369 ext/fileinfo/libmagic/readcdf.c 	if ((i = cdf_file_catalog(ms, h, scn)) == -1)</span>
<span class='curline'><a href='../S/178.html#L409'>ms</a>                409 ext/fileinfo/libmagic/readcdf.c cdf_file_dir_info(struct magic_set *ms, const cdf_dir_t *dir)</span>
<span class='curline'><a href='../S/178.html#L427'>ms</a>                427 ext/fileinfo/libmagic/readcdf.c 		if (NOTMIME(ms)) {</span>
<span class='curline'><a href='../S/178.html#L428'>ms</a>                428 ext/fileinfo/libmagic/readcdf.c 			if (file_printf(ms, "CDFV2 %s", si-&gt;name) == -1)</span>
<span class='curline'><a href='../S/178.html#L431'>ms</a>                431 ext/fileinfo/libmagic/readcdf.c 			if (file_printf(ms, "application/CDFV2-%s",</span>
<span class='curline'><a href='../S/178.html#L441'>ms</a>                441 ext/fileinfo/libmagic/readcdf.c file_trycdf(struct magic_set *ms, int fd, const unsigned char *buf,</span>
<span class='curline'><a href='../S/178.html#L456'>ms</a>                456 ext/fileinfo/libmagic/readcdf.c         if (ms-&gt;flags &amp; MAGIC_APPLE)</span>
<span class='curline'><a href='../S/178.html#L495'>ms</a>                495 ext/fileinfo/libmagic/readcdf.c 		if (NOTMIME(ms)) {</span>
<span class='curline'><a href='../S/178.html#L497'>ms</a>                497 ext/fileinfo/libmagic/readcdf.c 			if (file_printf(ms, "CLSID %s, ",</span>
<span class='curline'><a href='../S/178.html#L511'>ms</a>                511 ext/fileinfo/libmagic/readcdf.c 		    if (NOTMIME(ms)) {</span>
<span class='curline'><a href='../S/178.html#L512'>ms</a>                512 ext/fileinfo/libmagic/readcdf.c 			if (file_printf(ms,</span>
<span class='curline'><a href='../S/178.html#L516'>ms</a>                516 ext/fileinfo/libmagic/readcdf.c 			if (file_printf(ms, "application/x-hwp") == -1)</span>
<span class='curline'><a href='../S/178.html#L535'>ms</a>                535 ext/fileinfo/libmagic/readcdf.c 		i = cdf_file_catalog_info(ms, &amp;info, &amp;h, &amp;sat, &amp;ssat, &amp;sst,</span>
<span class='curline'><a href='../S/178.html#L539'>ms</a>                539 ext/fileinfo/libmagic/readcdf.c 		i = cdf_file_dir_info(ms, &amp;dir);</span>
<span class='curline'><a href='../S/178.html#L549'>ms</a>                549 ext/fileinfo/libmagic/readcdf.c         if ((i = cdf_file_summary_info(ms, &amp;h, &amp;scn, root_storage)) &lt; 0)</span>
<span class='curline'><a href='../S/178.html#L563'>ms</a>                563 ext/fileinfo/libmagic/readcdf.c 			    NOTMIME(ms) ? name2desc : name2mime);</span>
<span class='curline'><a href='../S/178.html#L565'>ms</a>                565 ext/fileinfo/libmagic/readcdf.c 		if (NOTMIME(ms)) {</span>
<span class='curline'><a href='../S/178.html#L567'>ms</a>                567 ext/fileinfo/libmagic/readcdf.c 				if (file_printf(ms, "%s", str) == -1)</span>
<span class='curline'><a href='../S/178.html#L574'>ms</a>                574 ext/fileinfo/libmagic/readcdf.c 			if (file_printf(ms, "application/%s", str) == -1)</span>
<span class='curline'><a href='../S/178.html#L591'>ms</a>                591 ext/fileinfo/libmagic/readcdf.c 	    if (NOTMIME(ms)) {</span>
<span class='curline'><a href='../S/178.html#L592'>ms</a>                592 ext/fileinfo/libmagic/readcdf.c 		if (file_printf(ms,</span>
<span class='curline'><a href='../S/178.html#L596'>ms</a>                596 ext/fileinfo/libmagic/readcdf.c 		    if (file_printf(ms, ", %s", expn) == -1)</span>
<span class='curline'><a href='../S/178.html#L599'>ms</a>                599 ext/fileinfo/libmagic/readcdf.c 		if (file_printf(ms, "application/CDFV2-unknown") == -1)</span>
<span class='curline'><a href='../S/179.html#L81'>ms</a>                 81 ext/fileinfo/libmagic/softmagic.c file_softmagic(struct magic_set *ms, const unsigned char *buf, size_t nbytes,</span>
<span class='curline'><a href='../S/179.html#L93'>ms</a>                 93 ext/fileinfo/libmagic/softmagic.c 	for (ml = ms-&gt;mlist[0]-&gt;next; ml != ms-&gt;mlist[0]; ml = ml-&gt;next)</span>
<span class='curline'><a href='../S/179.html#L94'>ms</a>                 94 ext/fileinfo/libmagic/softmagic.c 		if ((rv = match(ms, ml-&gt;magic, ml-&gt;nmagic, buf, nbytes, 0, mode,</span>
<span class='curline'><a href='../S/179.html#L107'>ms</a>                107 ext/fileinfo/libmagic/softmagic.c file_fmtcheck(struct magic_set *ms, const struct magic *m, const char *def,</span>
<span class='curline'><a href='../S/179.html#L112'>ms</a>                112 ext/fileinfo/libmagic/softmagic.c 		file_magerror(ms,</span>
<span class='curline'><a href='../S/179.html#L151'>ms</a>                151 ext/fileinfo/libmagic/softmagic.c match(struct magic_set *ms, struct magic *magic, uint32_t nmagic,</span>
<span class='curline'><a href='../S/179.html#L160'>ms</a>                160 ext/fileinfo/libmagic/softmagic.c 	int print = (ms-&gt;flags &amp; (MAGIC_MIME|MAGIC_APPLE)) == 0;</span>
<span class='curline'><a href='../S/179.html#L165'>ms</a>                165 ext/fileinfo/libmagic/softmagic.c 	if (file_check_mem(ms, cont_level) == -1)</span>
<span class='curline'><a href='../S/179.html#L186'>ms</a>                186 ext/fileinfo/libmagic/softmagic.c 		ms-&gt;offset = m-&gt;offset;</span>
<span class='curline'><a href='../S/179.html#L187'>ms</a>                187 ext/fileinfo/libmagic/softmagic.c 		ms-&gt;line = m-&gt;lineno;</span>
<span class='curline'><a href='../S/179.html#L190'>ms</a>                190 ext/fileinfo/libmagic/softmagic.c 		switch (mget(ms, s, m, nbytes, offset, cont_level, mode, text,</span>
<span class='curline'><a href='../S/179.html#L202'>ms</a>                202 ext/fileinfo/libmagic/softmagic.c 			switch (magiccheck(ms, m)) {</span>
<span class='curline'><a href='../S/179.html#L225'>ms</a>                225 ext/fileinfo/libmagic/softmagic.c 		if ((e = handle_annotation(ms, m)) != 0) {</span>
<span class='curline'><a href='../S/179.html#L238'>ms</a>                238 ext/fileinfo/libmagic/softmagic.c 			if (print_sep(ms, firstline) == -1)</span>
<span class='curline'><a href='../S/179.html#L243'>ms</a>                243 ext/fileinfo/libmagic/softmagic.c 		if (print &amp;&amp; mprint(ms, m) == -1)</span>
<span class='curline'><a href='../S/179.html#L246'>ms</a>                246 ext/fileinfo/libmagic/softmagic.c 		ms-&gt;c.li[cont_level].off = moffset(ms, m);</span>
<span class='curline'><a href='../S/179.html#L249'>ms</a>                249 ext/fileinfo/libmagic/softmagic.c 		if (file_check_mem(ms, ++cont_level) == -1)</span>
<span class='curline'><a href='../S/179.html#L255'>ms</a>                255 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;line = m-&gt;lineno; /* for messages */</span>
<span class='curline'><a href='../S/179.html#L266'>ms</a>                266 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;offset = m-&gt;offset;</span>
<span class='curline'><a href='../S/179.html#L268'>ms</a>                268 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;offset +=</span>
<span class='curline'><a href='../S/179.html#L269'>ms</a>                269 ext/fileinfo/libmagic/softmagic.c 				    ms-&gt;c.li[cont_level - 1].off;</span>
<span class='curline'><a href='../S/179.html#L275'>ms</a>                275 ext/fileinfo/libmagic/softmagic.c 				if (ms-&gt;c.li[cont_level].last_match == 1)</span>
<span class='curline'><a href='../S/179.html#L279'>ms</a>                279 ext/fileinfo/libmagic/softmagic.c 			switch (mget(ms, s, m, nbytes, offset, cont_level, mode,</span>
<span class='curline'><a href='../S/179.html#L296'>ms</a>                296 ext/fileinfo/libmagic/softmagic.c 			switch (flush ? 1 : magiccheck(ms, m)) {</span>
<span class='curline'><a href='../S/179.html#L301'>ms</a>                301 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;c.li[cont_level].last_match = 0;</span>
<span class='curline'><a href='../S/179.html#L306'>ms</a>                306 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;c.li[cont_level].last_match = 1;</span>
<span class='curline'><a href='../S/179.html#L309'>ms</a>                309 ext/fileinfo/libmagic/softmagic.c 					ms-&gt;c.li[cont_level].got_match = 0;</span>
<span class='curline'><a href='../S/179.html#L310'>ms</a>                310 ext/fileinfo/libmagic/softmagic.c 				else if (ms-&gt;c.li[cont_level].got_match) {</span>
<span class='curline'><a href='../S/179.html#L314'>ms</a>                314 ext/fileinfo/libmagic/softmagic.c 					ms-&gt;c.li[cont_level].got_match = 1;</span>
<span class='curline'><a href='../S/179.html#L315'>ms</a>                315 ext/fileinfo/libmagic/softmagic.c 				if ((e = handle_annotation(ms, m)) != 0) {</span>
<span class='curline'><a href='../S/179.html#L328'>ms</a>                328 ext/fileinfo/libmagic/softmagic.c 						if (print_sep(ms, firstline)</span>
<span class='curline'><a href='../S/179.html#L344'>ms</a>                344 ext/fileinfo/libmagic/softmagic.c 					    file_printf(ms, " ") == -1)</span>
<span class='curline'><a href='../S/179.html#L348'>ms</a>                348 ext/fileinfo/libmagic/softmagic.c 				if (print &amp;&amp; mprint(ms, m) == -1)</span>
<span class='curline'><a href='../S/179.html#L351'>ms</a>                351 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;c.li[cont_level].off = moffset(ms, m);</span>
<span class='curline'><a href='../S/179.html#L361'>ms</a>                361 ext/fileinfo/libmagic/softmagic.c 				if (file_check_mem(ms, ++cont_level) == -1)</span>
<span class='curline'><a href='../S/179.html#L371'>ms</a>                371 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_CONTINUE) == 0 &amp;&amp; *printed_something) {</span>
<span class='curline'><a href='../S/179.html#L380'>ms</a>                380 ext/fileinfo/libmagic/softmagic.c check_fmt(struct magic_set *ms, struct magic *m)</span>
<span class='curline'><a href='../S/179.html#L403'>ms</a>                403 ext/fileinfo/libmagic/softmagic.c mprint(struct magic_set *ms, struct magic *m)</span>
<span class='curline'><a href='../S/179.html#L410'>ms</a>                410 ext/fileinfo/libmagic/softmagic.c 	union VALUETYPE *p = &amp;ms-&gt;ms_value;</span>
<span class='curline'><a href='../S/179.html#L414'>ms</a>                414 ext/fileinfo/libmagic/softmagic.c 		v = file_signextend(ms, m, (uint64_t)p-&gt;b);</span>
<span class='curline'><a href='../S/179.html#L415'>ms</a>                415 ext/fileinfo/libmagic/softmagic.c 		switch (check_fmt(ms, m)) {</span>
<span class='curline'><a href='../S/179.html#L421'>ms</a>                421 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(ms, m, "%s"), buf) == -1)</span>
<span class='curline'><a href='../S/179.html#L425'>ms</a>                425 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(ms, m, "%d"),</span>
<span class='curline'><a href='../S/179.html#L430'>ms</a>                430 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(char);</span>
<span class='curline'><a href='../S/179.html#L436'>ms</a>                436 ext/fileinfo/libmagic/softmagic.c 		v = file_signextend(ms, m, (uint64_t)p-&gt;h);</span>
<span class='curline'><a href='../S/179.html#L437'>ms</a>                437 ext/fileinfo/libmagic/softmagic.c 		switch (check_fmt(ms, m)) {</span>
<span class='curline'><a href='../S/179.html#L443'>ms</a>                443 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(ms, m, "%s"), buf) == -1)</span>
<span class='curline'><a href='../S/179.html#L447'>ms</a>                447 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(ms, m, "%u"),</span>
<span class='curline'><a href='../S/179.html#L452'>ms</a>                452 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(short);</span>
<span class='curline'><a href='../S/179.html#L459'>ms</a>                459 ext/fileinfo/libmagic/softmagic.c 		v = file_signextend(ms, m, (uint64_t)p-&gt;l);</span>
<span class='curline'><a href='../S/179.html#L460'>ms</a>                460 ext/fileinfo/libmagic/softmagic.c 		switch (check_fmt(ms, m)) {</span>
<span class='curline'><a href='../S/179.html#L465'>ms</a>                465 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(ms, m, "%s"), buf) == -1)</span>
<span class='curline'><a href='../S/179.html#L469'>ms</a>                469 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(ms, m, "%u"), (uint32_t) v) == -1)</span>
<span class='curline'><a href='../S/179.html#L473'>ms</a>                473 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(int32_t);</span>
<span class='curline'><a href='../S/179.html#L479'>ms</a>                479 ext/fileinfo/libmagic/softmagic.c 		v = file_signextend(ms, m, p-&gt;q);</span>
<span class='curline'><a href='../S/179.html#L480'>ms</a>                480 ext/fileinfo/libmagic/softmagic.c 		switch (check_fmt(ms, m)) {</span>
<span class='curline'><a href='../S/179.html#L486'>ms</a>                486 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(ms, m, "%s"), buf) == -1)</span>
<span class='curline'><a href='../S/179.html#L490'>ms</a>                490 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(ms, m, "%" INT64_T_FORMAT "u"),</span>
<span class='curline'><a href='../S/179.html#L495'>ms</a>                495 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(int64_t);</span>
<span class='curline'><a href='../S/179.html#L503'>ms</a>                503 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(ms, m, "%s"), </span>
<span class='curline'><a href='../S/179.html#L507'>ms</a>                507 ext/fileinfo/libmagic/softmagic.c 			t = ms-&gt;offset + m-&gt;vallen;</span>
<span class='curline'><a href='../S/179.html#L513'>ms</a>                513 ext/fileinfo/libmagic/softmagic.c 			t = ms-&gt;offset + strlen(str);</span>
<span class='curline'><a href='../S/179.html#L531'>ms</a>                531 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(ms, m, "%s"),</span>
<span class='curline'><a href='../S/179.html#L544'>ms</a>                544 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, F(ms, m, "%s"),</span>
<span class='curline'><a href='../S/179.html#L547'>ms</a>                547 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(uint32_t);</span>
<span class='curline'><a href='../S/179.html#L554'>ms</a>                554 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, F(ms, m, "%s"),</span>
<span class='curline'><a href='../S/179.html#L557'>ms</a>                557 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(uint32_t);</span>
<span class='curline'><a href='../S/179.html#L563'>ms</a>                563 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, F(ms, m, "%s"),</span>
<span class='curline'><a href='../S/179.html#L566'>ms</a>                566 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(uint64_t);</span>
<span class='curline'><a href='../S/179.html#L572'>ms</a>                572 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, F(ms, m, "%s"),</span>
<span class='curline'><a href='../S/179.html#L575'>ms</a>                575 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(uint64_t);</span>
<span class='curline'><a href='../S/179.html#L581'>ms</a>                581 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, F(ms, m, "%s"),</span>
<span class='curline'><a href='../S/179.html#L584'>ms</a>                584 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(uint64_t);</span>
<span class='curline'><a href='../S/179.html#L591'>ms</a>                591 ext/fileinfo/libmagic/softmagic.c 		switch (check_fmt(ms, m)) {</span>
<span class='curline'><a href='../S/179.html#L596'>ms</a>                596 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(ms, m, "%s"), buf) == -1)</span>
<span class='curline'><a href='../S/179.html#L600'>ms</a>                600 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(ms, m, "%g"), vf) == -1)</span>
<span class='curline'><a href='../S/179.html#L604'>ms</a>                604 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(float);</span>
<span class='curline'><a href='../S/179.html#L611'>ms</a>                611 ext/fileinfo/libmagic/softmagic.c 		switch (check_fmt(ms, m)) {</span>
<span class='curline'><a href='../S/179.html#L616'>ms</a>                616 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(ms, m, "%s"), buf) == -1)</span>
<span class='curline'><a href='../S/179.html#L620'>ms</a>                620 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(ms, m, "%g"), vd) == -1)</span>
<span class='curline'><a href='../S/179.html#L624'>ms</a>                624 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(double);</span>
<span class='curline'><a href='../S/179.html#L631'>ms</a>                631 ext/fileinfo/libmagic/softmagic.c 		cp = estrndup((const char *)ms-&gt;search.s, ms-&gt;search.rm_len);</span>
<span class='curline'><a href='../S/179.html#L633'>ms</a>                633 ext/fileinfo/libmagic/softmagic.c 			file_oomem(ms, ms-&gt;search.rm_len);</span>
<span class='curline'><a href='../S/179.html#L636'>ms</a>                636 ext/fileinfo/libmagic/softmagic.c 		rval = file_printf(ms, F(ms, m, "%s"),</span>
<span class='curline'><a href='../S/179.html#L644'>ms</a>                644 ext/fileinfo/libmagic/softmagic.c 			t = ms-&gt;search.offset;</span>
<span class='curline'><a href='../S/179.html#L646'>ms</a>                646 ext/fileinfo/libmagic/softmagic.c 			t = ms-&gt;search.offset + ms-&gt;search.rm_len;</span>
<span class='curline'><a href='../S/179.html#L651'>ms</a>                651 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, F(ms, m, "%s"), m-&gt;value.s) == -1)</span>
<span class='curline'><a href='../S/179.html#L654'>ms</a>                654 ext/fileinfo/libmagic/softmagic.c 			t = ms-&gt;search.offset;</span>
<span class='curline'><a href='../S/179.html#L656'>ms</a>                656 ext/fileinfo/libmagic/softmagic.c 			t = ms-&gt;search.offset + m-&gt;vallen;</span>
<span class='curline'><a href='../S/179.html#L661'>ms</a>                661 ext/fileinfo/libmagic/softmagic.c 	  	if (file_printf(ms, "%s", m-&gt;desc) == -1)</span>
<span class='curline'><a href='../S/179.html#L663'>ms</a>                663 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset;</span>
<span class='curline'><a href='../S/179.html#L669'>ms</a>                669 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset;</span>
<span class='curline'><a href='../S/179.html#L673'>ms</a>                673 ext/fileinfo/libmagic/softmagic.c 		file_magerror(ms, "invalid m-&gt;type (%d) in mprint()", m-&gt;type);</span>
<span class='curline'><a href='../S/179.html#L680'>ms</a>                680 ext/fileinfo/libmagic/softmagic.c moffset(struct magic_set *ms, struct magic *m)</span>
<span class='curline'><a href='../S/179.html#L684'>ms</a>                684 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(char)));</span>
<span class='curline'><a href='../S/179.html#L689'>ms</a>                689 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(short)));</span>
<span class='curline'><a href='../S/179.html#L695'>ms</a>                695 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(int32_t)));</span>
<span class='curline'><a href='../S/179.html#L700'>ms</a>                700 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(int64_t)));</span>
<span class='curline'><a href='../S/179.html#L707'>ms</a>                707 ext/fileinfo/libmagic/softmagic.c 			return ms-&gt;offset + m-&gt;vallen;</span>
<span class='curline'><a href='../S/179.html#L709'>ms</a>                709 ext/fileinfo/libmagic/softmagic.c 			union VALUETYPE *p = &amp;ms-&gt;ms_value;</span>
<span class='curline'><a href='../S/179.html#L714'>ms</a>                714 ext/fileinfo/libmagic/softmagic.c 			t = CAST(uint32_t, (ms-&gt;offset + strlen(p-&gt;s)));</span>
<span class='curline'><a href='../S/179.html#L724'>ms</a>                724 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(uint32_t)));</span>
<span class='curline'><a href='../S/179.html#L730'>ms</a>                730 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(uint32_t)));</span>
<span class='curline'><a href='../S/179.html#L735'>ms</a>                735 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(uint64_t)));</span>
<span class='curline'><a href='../S/179.html#L740'>ms</a>                740 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(uint64_t)));</span>
<span class='curline'><a href='../S/179.html#L745'>ms</a>                745 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(float)));</span>
<span class='curline'><a href='../S/179.html#L750'>ms</a>                750 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(double)));</span>
<span class='curline'><a href='../S/179.html#L754'>ms</a>                754 ext/fileinfo/libmagic/softmagic.c 			return CAST(int32_t, ms-&gt;search.offset);</span>
<span class='curline'><a href='../S/179.html#L756'>ms</a>                756 ext/fileinfo/libmagic/softmagic.c 			return CAST(int32_t, (ms-&gt;search.offset +</span>
<span class='curline'><a href='../S/179.html#L757'>ms</a>                757 ext/fileinfo/libmagic/softmagic.c 			    ms-&gt;search.rm_len));</span>
<span class='curline'><a href='../S/179.html#L761'>ms</a>                761 ext/fileinfo/libmagic/softmagic.c 			return CAST(int32_t, ms-&gt;search.offset);</span>
<span class='curline'><a href='../S/179.html#L763'>ms</a>                763 ext/fileinfo/libmagic/softmagic.c 			return CAST(int32_t, (ms-&gt;search.offset + m-&gt;vallen));</span>
<span class='curline'><a href='../S/179.html#L768'>ms</a>                768 ext/fileinfo/libmagic/softmagic.c 		return ms-&gt;offset;</span>
<span class='curline'><a href='../S/179.html#L915'>ms</a>                915 ext/fileinfo/libmagic/softmagic.c mconvert(struct magic_set *ms, struct magic *m, int flip)</span>
<span class='curline'><a href='../S/179.html#L917'>ms</a>                917 ext/fileinfo/libmagic/softmagic.c 	union VALUETYPE *p = &amp;ms-&gt;ms_value;</span>
<span class='curline'><a href='../S/179.html#L1055'>ms</a>               1055 ext/fileinfo/libmagic/softmagic.c 		file_magerror(ms, "invalid type %d in mconvert()", m-&gt;type);</span>
<span class='curline'><a href='../S/179.html#L1071'>ms</a>               1071 ext/fileinfo/libmagic/softmagic.c mcopy(struct magic_set *ms, union VALUETYPE *p, int type, int indir,</span>
<span class='curline'><a href='../S/179.html#L1081'>ms</a>               1081 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;search.s = RCAST(const char *, s) + offset;</span>
<span class='curline'><a href='../S/179.html#L1082'>ms</a>               1082 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;search.s_len = nbytes - offset;</span>
<span class='curline'><a href='../S/179.html#L1083'>ms</a>               1083 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;search.offset = offset;</span>
<span class='curline'><a href='../S/179.html#L1095'>ms</a>               1095 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;search.s_len = 0;</span>
<span class='curline'><a href='../S/179.html#L1096'>ms</a>               1096 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;search.s = NULL;</span>
<span class='curline'><a href='../S/179.html#L1116'>ms</a>               1116 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;search.s_len = 0;</span>
<span class='curline'><a href='../S/179.html#L1117'>ms</a>               1117 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;search.s = NULL;</span>
<span class='curline'><a href='../S/179.html#L1136'>ms</a>               1136 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;search.s = buf;</span>
<span class='curline'><a href='../S/179.html#L1137'>ms</a>               1137 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;search.s_len = last - buf;</span>
<span class='curline'><a href='../S/179.html#L1138'>ms</a>               1138 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;search.offset = offset;</span>
<span class='curline'><a href='../S/179.html#L1139'>ms</a>               1139 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;search.rm_len = 0;</span>
<span class='curline'><a href='../S/179.html#L1199'>ms</a>               1199 ext/fileinfo/libmagic/softmagic.c mget(struct magic_set *ms, const unsigned char *s, struct magic *m,</span>
<span class='curline'><a href='../S/179.html#L1204'>ms</a>               1204 ext/fileinfo/libmagic/softmagic.c 	uint32_t offset = ms-&gt;offset;</span>
<span class='curline'><a href='../S/179.html#L1209'>ms</a>               1209 ext/fileinfo/libmagic/softmagic.c 	union VALUETYPE *p = &amp;ms-&gt;ms_value;</span>
<span class='curline'><a href='../S/179.html#L1212'>ms</a>               1212 ext/fileinfo/libmagic/softmagic.c 	if (indir_level &gt;= ms-&gt;indir_max) {</span>
<span class='curline'><a href='../S/179.html#L1213'>ms</a>               1213 ext/fileinfo/libmagic/softmagic.c 		file_error(ms, 0, "indirect recursion nesting (%hu) exceeded",</span>
<span class='curline'><a href='../S/179.html#L1218'>ms</a>               1218 ext/fileinfo/libmagic/softmagic.c 	if (*name_count &gt;= ms-&gt;name_max) {</span>
<span class='curline'><a href='../S/179.html#L1219'>ms</a>               1219 ext/fileinfo/libmagic/softmagic.c 		file_error(ms, 0, "name use count (%hu) exceeded",</span>
<span class='curline'><a href='../S/179.html#L1224'>ms</a>               1224 ext/fileinfo/libmagic/softmagic.c 	if (mcopy(ms, p, m-&gt;type, m-&gt;flag &amp; INDIR, s, (uint32_t)(offset + o),</span>
<span class='curline'><a href='../S/179.html#L1228'>ms</a>               1228 ext/fileinfo/libmagic/softmagic.c 	if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0) {</span>
<span class='curline'><a href='../S/179.html#L1273'>ms</a>               1273 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/179.html#L1579'>ms</a>               1579 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/179.html#L1587'>ms</a>               1587 ext/fileinfo/libmagic/softmagic.c 			offset += ms-&gt;c.li[cont_level-1].off;</span>
<span class='curline'><a href='../S/179.html#L1589'>ms</a>               1589 ext/fileinfo/libmagic/softmagic.c 				if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/179.html#L1594'>ms</a>               1594 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/179.html#L1597'>ms</a>               1597 ext/fileinfo/libmagic/softmagic.c 		if (mcopy(ms, p, m-&gt;type, 0, s, offset, nbytes, m) == -1)</span>
<span class='curline'><a href='../S/179.html#L1599'>ms</a>               1599 ext/fileinfo/libmagic/softmagic.c 		ms-&gt;offset = offset;</span>
<span class='curline'><a href='../S/179.html#L1601'>ms</a>               1601 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0) {</span>
<span class='curline'><a href='../S/179.html#L1668'>ms</a>               1668 ext/fileinfo/libmagic/softmagic.c 		if ((pb = file_push_buffer(ms)) == NULL)</span>
<span class='curline'><a href='../S/179.html#L1671'>ms</a>               1671 ext/fileinfo/libmagic/softmagic.c 		rv = file_softmagic(ms, s + offset, nbytes - offset,</span>
<span class='curline'><a href='../S/179.html#L1674'>ms</a>               1674 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/179.html#L1677'>ms</a>               1677 ext/fileinfo/libmagic/softmagic.c 		rbuf = file_pop_buffer(ms, pb);</span>
<span class='curline'><a href='../S/179.html#L1678'>ms</a>               1678 ext/fileinfo/libmagic/softmagic.c 		if (rbuf == NULL &amp;&amp; ms-&gt;event_flags &amp; EVENT_HAD_ERR)</span>
<span class='curline'><a href='../S/179.html#L1682'>ms</a>               1682 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; (MAGIC_MIME|MAGIC_APPLE)) == 0 &amp;&amp;</span>
<span class='curline'><a href='../S/179.html#L1683'>ms</a>               1683 ext/fileinfo/libmagic/softmagic.c 			    file_printf(ms, F(ms, m, "%u"), offset) == -1) {</span>
<span class='curline'><a href='../S/179.html#L1687'>ms</a>               1687 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, "%s", rbuf) == -1) {</span>
<span class='curline'><a href='../S/179.html#L1703'>ms</a>               1703 ext/fileinfo/libmagic/softmagic.c 		if (file_magicfind(ms, rbuf, &amp;ml) == -1) {</span>
<span class='curline'><a href='../S/179.html#L1704'>ms</a>               1704 ext/fileinfo/libmagic/softmagic.c 			file_error(ms, 0, "cannot find entry `%s'", rbuf);</span>
<span class='curline'><a href='../S/179.html#L1711'>ms</a>               1711 ext/fileinfo/libmagic/softmagic.c 		rv = match(ms, ml.magic, ml.nmagic, s, nbytes, offset + o,</span>
<span class='curline'><a href='../S/179.html#L1719'>ms</a>               1719 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, "%s", m-&gt;desc) == -1)</span>
<span class='curline'><a href='../S/179.html#L1727'>ms</a>               1727 ext/fileinfo/libmagic/softmagic.c 	if (!mconvert(ms, m, flip))</span>
<span class='curline'><a href='../S/179.html#L1843'>ms</a>               1843 ext/fileinfo/libmagic/softmagic.c magiccheck(struct magic_set *ms, struct magic *m)</span>
<span class='curline'><a href='../S/179.html#L1850'>ms</a>               1850 ext/fileinfo/libmagic/softmagic.c 	union VALUETYPE *p = &amp;ms-&gt;ms_value;</span>
<span class='curline'><a href='../S/179.html#L1920'>ms</a>               1920 ext/fileinfo/libmagic/softmagic.c 			file_magerror(ms, "cannot happen with float: invalid relation `%c'",</span>
<span class='curline'><a href='../S/179.html#L1953'>ms</a>               1953 ext/fileinfo/libmagic/softmagic.c 			file_magerror(ms, "cannot happen with double: invalid relation `%c'", m-&gt;reln);</span>
<span class='curline'><a href='../S/179.html#L1980'>ms</a>               1980 ext/fileinfo/libmagic/softmagic.c 		if (ms-&gt;search.s == NULL)</span>
<span class='curline'><a href='../S/179.html#L1988'>ms</a>               1988 ext/fileinfo/libmagic/softmagic.c 			if (slen + idx &gt; ms-&gt;search.s_len)</span>
<span class='curline'><a href='../S/179.html#L1991'>ms</a>               1991 ext/fileinfo/libmagic/softmagic.c 			v = file_strncmp(m-&gt;value.s, ms-&gt;search.s + idx, slen,</span>
<span class='curline'><a href='../S/179.html#L1994'>ms</a>               1994 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;search.offset += idx;</span>
<span class='curline'><a href='../S/179.html#L1995'>ms</a>               1995 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;search.rm_len = m-&gt;str_range - idx;</span>
<span class='curline'><a href='../S/179.html#L2028'>ms</a>               2028 ext/fileinfo/libmagic/softmagic.c 			haystack = estrndup(ms-&gt;search.s, ms-&gt;search.s_len);</span>
<span class='curline'><a href='../S/179.html#L2031'>ms</a>               2031 ext/fileinfo/libmagic/softmagic.c 			php_pcre_match_impl(pce, haystack, ms-&gt;search.s_len, &amp;retval, &amp;subpats, 0, 1, PREG_OFFSET_CAPTURE, 0);</span>
<span class='curline'><a href='../S/179.html#L2054'>ms</a>               2054 ext/fileinfo/libmagic/softmagic.c 						ms-&gt;search.s += Z_LVAL_P(offset); /* this is where the match starts */</span>
<span class='curline'><a href='../S/179.html#L2055'>ms</a>               2055 ext/fileinfo/libmagic/softmagic.c 						ms-&gt;search.offset += Z_LVAL_P(offset); /* this is where the match starts as size_t */</span>
<span class='curline'><a href='../S/179.html#L2056'>ms</a>               2056 ext/fileinfo/libmagic/softmagic.c 						ms-&gt;search.rm_len = Z_STRLEN_P(match) /* This is the length of the matched pattern */;</span>
<span class='curline'><a href='../S/179.html#L2080'>ms</a>               2080 ext/fileinfo/libmagic/softmagic.c 		file_magerror(ms, "invalid type %d in magiccheck()", m-&gt;type);</span>
<span class='curline'><a href='../S/179.html#L2084'>ms</a>               2084 ext/fileinfo/libmagic/softmagic.c 	v = file_signextend(ms, m, v);</span>
<span class='curline'><a href='../S/179.html#L2088'>ms</a>               2088 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/179.html#L2096'>ms</a>               2096 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/179.html#L2104'>ms</a>               2104 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/179.html#L2113'>ms</a>               2113 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/179.html#L2121'>ms</a>               2121 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/179.html#L2131'>ms</a>               2131 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/179.html#L2139'>ms</a>               2139 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/179.html#L2148'>ms</a>               2148 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/179.html#L2158'>ms</a>               2158 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/179.html#L2167'>ms</a>               2167 ext/fileinfo/libmagic/softmagic.c 		file_magerror(ms, "cannot happen: invalid relation `%c'",</span>
<span class='curline'><a href='../S/179.html#L2176'>ms</a>               2176 ext/fileinfo/libmagic/softmagic.c handle_annotation(struct magic_set *ms, struct magic *m)</span>
<span class='curline'><a href='../S/179.html#L2178'>ms</a>               2178 ext/fileinfo/libmagic/softmagic.c 	if (ms-&gt;flags &amp; MAGIC_APPLE) {</span>
<span class='curline'><a href='../S/179.html#L2179'>ms</a>               2179 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, "%.8s", m-&gt;apple) == -1)</span>
<span class='curline'><a href='../S/179.html#L2183'>ms</a>               2183 ext/fileinfo/libmagic/softmagic.c 	if ((ms-&gt;flags &amp; MAGIC_MIME_TYPE) &amp;&amp; m-&gt;mimetype[0]) {</span>
<span class='curline'><a href='../S/179.html#L2184'>ms</a>               2184 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, "%s", m-&gt;mimetype) == -1)</span>
<span class='curline'><a href='../S/179.html#L2192'>ms</a>               2192 ext/fileinfo/libmagic/softmagic.c print_sep(struct magic_set *ms, int firstline)</span>
<span class='curline'><a href='../S/179.html#L2194'>ms</a>               2194 ext/fileinfo/libmagic/softmagic.c 	if (ms-&gt;flags &amp; MAGIC_MIME)</span>
<span class='curline'><a href='../S/179.html#L2202'>ms</a>               2202 ext/fileinfo/libmagic/softmagic.c 	return file_printf(ms, "\n- ");</span>
<span class='curline'><a href='../S/1054.html#L2383'>ms</a>               2383 ext/sqlite3/libsqlite/sqlite3.c SQLITE_API int SQLITE_STDCALL sqlite3_busy_timeout(sqlite3*, int ms);</span>
<span class='curline'><a href='../S/1054.html#L15497'>ms</a>               15497 ext/sqlite3/libsqlite/sqlite3.c   double ms = 0.0;</span>
<span class='curline'><a href='../S/1054.html#L15512'>ms</a>               15512 ext/sqlite3/libsqlite/sqlite3.c         ms = ms*10.0 + *zDate - '0';</span>
<span class='curline'><a href='../S/1054.html#L15516'>ms</a>               15516 ext/sqlite3/libsqlite/sqlite3.c       ms /= rScale;</span>
<span class='curline'><a href='../S/1054.html#L15525'>ms</a>               15525 ext/sqlite3/libsqlite/sqlite3.c   p-&gt;s = s + ms;</span>
<span class='curline'><a href='../S/1054.html#L101904'>ms</a>               101904 ext/sqlite3/libsqlite/sqlite3.c   int  (*busy_timeout)(sqlite3*,int ms);</span>
<span class='curline'><a href='../S/1054.html#L129478'>ms</a>               129478 ext/sqlite3/libsqlite/sqlite3.c SQLITE_API int SQLITE_STDCALL sqlite3_busy_timeout(sqlite3 *db, int ms){</span>
<span class='curline'><a href='../S/1054.html#L129482'>ms</a>               129482 ext/sqlite3/libsqlite/sqlite3.c   if( ms&gt;0 ){</span>
<span class='curline'><a href='../S/1054.html#L129484'>ms</a>               129484 ext/sqlite3/libsqlite/sqlite3.c     db-&gt;busyTimeout = ms;</span>
<span class='curline'><a href='../S/1054.html#L131283'>ms</a>               131283 ext/sqlite3/libsqlite/sqlite3.c SQLITE_API int SQLITE_STDCALL sqlite3_sleep(int ms){</span>
<span class='curline'><a href='../S/1054.html#L131292'>ms</a>               131292 ext/sqlite3/libsqlite/sqlite3.c   rc = (sqlite3OsSleep(pVfs, 1000*ms)/1000);</span>
<span class='curline'><a href='../S/1055.html#L2176'>ms</a>               2176 ext/sqlite3/libsqlite/sqlite3.h SQLITE_API int SQLITE_STDCALL sqlite3_busy_timeout(sqlite3*, int ms);</span>
<span class='curline'><a href='../S/1056.html#L49'>ms</a>                 49 ext/sqlite3/libsqlite/sqlite3ext.h   int  (*busy_timeout)(sqlite3*,int ms);</span>
<span class='curline'><a href='../S/1059.html#L321'>ms</a>                321 ext/sqlite3/sqlite3.c 	zend_long ms;</span>
<span class='curline'><a href='../S/1059.html#L327'>ms</a>                327 ext/sqlite3/sqlite3.c 	if (FAILURE == zend_parse_parameters(ZEND_NUM_ARGS(), "l", &amp;ms)) {</span>
<span class='curline'><a href='../S/1059.html#L331'>ms</a>                331 ext/sqlite3/sqlite3.c 	return_code = sqlite3_busy_timeout(db_obj-&gt;db, ms);</span>
<span class='curline'><a href='../S/1059.html#L1836'>ms</a>               1836 ext/sqlite3/sqlite3.c 	ZEND_ARG_INFO(0, ms)</span>
<span class='curline'><a href='../S/1416.html#L51'>ms</a>                 51 main/streams/memory.c 	php_stream_memory_data *ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1416.html#L52'>ms</a>                 52 main/streams/memory.c 	assert(ms != NULL);</span>
<span class='curline'><a href='../S/1416.html#L54'>ms</a>                 54 main/streams/memory.c 	if (ms-&gt;mode &amp; TEMP_STREAM_READONLY) {</span>
<span class='curline'><a href='../S/1416.html#L57'>ms</a>                 57 main/streams/memory.c 	if (ms-&gt;fpos + count &gt; ms-&gt;fsize) {</span>
<span class='curline'><a href='../S/1416.html#L60'>ms</a>                 60 main/streams/memory.c 		if (!ms-&gt;data) {</span>
<span class='curline'><a href='../S/1416.html#L61'>ms</a>                 61 main/streams/memory.c 			tmp = emalloc(ms-&gt;fpos + count);</span>
<span class='curline'><a href='../S/1416.html#L63'>ms</a>                 63 main/streams/memory.c 			tmp = erealloc(ms-&gt;data, ms-&gt;fpos + count);</span>
<span class='curline'><a href='../S/1416.html#L66'>ms</a>                 66 main/streams/memory.c 			count = ms-&gt;fsize - ms-&gt;fpos + 1;</span>
<span class='curline'><a href='../S/1416.html#L68'>ms</a>                 68 main/streams/memory.c 			ms-&gt;data = tmp;</span>
<span class='curline'><a href='../S/1416.html#L69'>ms</a>                 69 main/streams/memory.c 			ms-&gt;fsize = ms-&gt;fpos + count;</span>
<span class='curline'><a href='../S/1416.html#L72'>ms</a>                 72 main/streams/memory.c 	if (!ms-&gt;data)</span>
<span class='curline'><a href='../S/1416.html#L76'>ms</a>                 76 main/streams/memory.c 		memcpy(ms-&gt;data+ms-&gt;fpos, (char*)buf, count);</span>
<span class='curline'><a href='../S/1416.html#L77'>ms</a>                 77 main/streams/memory.c 		ms-&gt;fpos += count;</span>
<span class='curline'><a href='../S/1416.html#L87'>ms</a>                 87 main/streams/memory.c 	php_stream_memory_data *ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1416.html#L88'>ms</a>                 88 main/streams/memory.c 	assert(ms != NULL);</span>
<span class='curline'><a href='../S/1416.html#L90'>ms</a>                 90 main/streams/memory.c 	if (ms-&gt;fpos == ms-&gt;fsize) {</span>
<span class='curline'><a href='../S/1416.html#L94'>ms</a>                 94 main/streams/memory.c 		if (ms-&gt;fpos + count &gt;= ms-&gt;fsize) {</span>
<span class='curline'><a href='../S/1416.html#L95'>ms</a>                 95 main/streams/memory.c 			count = ms-&gt;fsize - ms-&gt;fpos;</span>
<span class='curline'><a href='../S/1416.html#L98'>ms</a>                 98 main/streams/memory.c 			assert(ms-&gt;data!= NULL);</span>
<span class='curline'><a href='../S/1416.html#L100'>ms</a>                100 main/streams/memory.c 			memcpy(buf, ms-&gt;data+ms-&gt;fpos, count);</span>
<span class='curline'><a href='../S/1416.html#L101'>ms</a>                101 main/streams/memory.c 			ms-&gt;fpos += count;</span>
<span class='curline'><a href='../S/1416.html#L112'>ms</a>                112 main/streams/memory.c 	php_stream_memory_data *ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1416.html#L113'>ms</a>                113 main/streams/memory.c 	assert(ms != NULL);</span>
<span class='curline'><a href='../S/1416.html#L115'>ms</a>                115 main/streams/memory.c 	if (ms-&gt;data &amp;&amp; close_handle &amp;&amp; ms-&gt;mode != TEMP_STREAM_READONLY) {</span>
<span class='curline'><a href='../S/1416.html#L116'>ms</a>                116 main/streams/memory.c 		efree(ms-&gt;data);</span>
<span class='curline'><a href='../S/1416.html#L118'>ms</a>                118 main/streams/memory.c 	efree(ms);</span>
<span class='curline'><a href='../S/1416.html#L136'>ms</a>                136 main/streams/memory.c 	php_stream_memory_data *ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1416.html#L137'>ms</a>                137 main/streams/memory.c 	assert(ms != NULL);</span>
<span class='curline'><a href='../S/1416.html#L142'>ms</a>                142 main/streams/memory.c 				if (ms-&gt;fpos &lt; (size_t)(-offset)) {</span>
<span class='curline'><a href='../S/1416.html#L143'>ms</a>                143 main/streams/memory.c 					ms-&gt;fpos = 0;</span>
<span class='curline'><a href='../S/1416.html#L147'>ms</a>                147 main/streams/memory.c 					ms-&gt;fpos = ms-&gt;fpos + offset;</span>
<span class='curline'><a href='../S/1416.html#L148'>ms</a>                148 main/streams/memory.c 					*newoffs = ms-&gt;fpos;</span>
<span class='curline'><a href='../S/1416.html#L153'>ms</a>                153 main/streams/memory.c 				if (ms-&gt;fpos + (size_t)(offset) &gt; ms-&gt;fsize) {</span>
<span class='curline'><a href='../S/1416.html#L154'>ms</a>                154 main/streams/memory.c 					ms-&gt;fpos = ms-&gt;fsize;</span>
<span class='curline'><a href='../S/1416.html#L158'>ms</a>                158 main/streams/memory.c 					ms-&gt;fpos = ms-&gt;fpos + offset;</span>
<span class='curline'><a href='../S/1416.html#L159'>ms</a>                159 main/streams/memory.c 					*newoffs = ms-&gt;fpos;</span>
<span class='curline'><a href='../S/1416.html#L165'>ms</a>                165 main/streams/memory.c 			if (ms-&gt;fsize &lt; (size_t)(offset)) {</span>
<span class='curline'><a href='../S/1416.html#L166'>ms</a>                166 main/streams/memory.c 				ms-&gt;fpos = ms-&gt;fsize;</span>
<span class='curline'><a href='../S/1416.html#L170'>ms</a>                170 main/streams/memory.c 				ms-&gt;fpos = offset;</span>
<span class='curline'><a href='../S/1416.html#L171'>ms</a>                171 main/streams/memory.c 				*newoffs = ms-&gt;fpos;</span>
<span class='curline'><a href='../S/1416.html#L177'>ms</a>                177 main/streams/memory.c 				ms-&gt;fpos = ms-&gt;fsize;</span>
<span class='curline'><a href='../S/1416.html#L180'>ms</a>                180 main/streams/memory.c 			} else if (ms-&gt;fsize &lt; (size_t)(-offset)) {</span>
<span class='curline'><a href='../S/1416.html#L181'>ms</a>                181 main/streams/memory.c 				ms-&gt;fpos = 0;</span>
<span class='curline'><a href='../S/1416.html#L185'>ms</a>                185 main/streams/memory.c 				ms-&gt;fpos = ms-&gt;fsize + offset;</span>
<span class='curline'><a href='../S/1416.html#L186'>ms</a>                186 main/streams/memory.c 				*newoffs = ms-&gt;fpos;</span>
<span class='curline'><a href='../S/1416.html#L191'>ms</a>                191 main/streams/memory.c 			*newoffs = ms-&gt;fpos;</span>
<span class='curline'><a href='../S/1416.html#L207'>ms</a>                207 main/streams/memory.c 	php_stream_memory_data *ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1416.html#L208'>ms</a>                208 main/streams/memory.c 	assert(ms != NULL);</span>
<span class='curline'><a href='../S/1416.html#L213'>ms</a>                213 main/streams/memory.c 	ssb-&gt;sb.st_mode = ms-&gt;mode &amp; TEMP_STREAM_READONLY ? 0444 : 0666;</span>
<span class='curline'><a href='../S/1416.html#L215'>ms</a>                215 main/streams/memory.c 	ssb-&gt;sb.st_size = ms-&gt;fsize;</span>
<span class='curline'><a href='../S/1416.html#L249'>ms</a>                249 main/streams/memory.c 	php_stream_memory_data *ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1416.html#L259'>ms</a>                259 main/streams/memory.c 					if (ms-&gt;mode &amp; TEMP_STREAM_READONLY) {</span>
<span class='curline'><a href='../S/1416.html#L263'>ms</a>                263 main/streams/memory.c 					if (newsize &lt;= ms-&gt;fsize) {</span>
<span class='curline'><a href='../S/1416.html#L264'>ms</a>                264 main/streams/memory.c 						if (newsize &lt; ms-&gt;fpos) {</span>
<span class='curline'><a href='../S/1416.html#L265'>ms</a>                265 main/streams/memory.c 							ms-&gt;fpos = newsize;</span>
<span class='curline'><a href='../S/1416.html#L268'>ms</a>                268 main/streams/memory.c 						ms-&gt;data = erealloc(ms-&gt;data, newsize);</span>
<span class='curline'><a href='../S/1416.html#L269'>ms</a>                269 main/streams/memory.c 						memset(ms-&gt;data+ms-&gt;fsize, 0, newsize - ms-&gt;fsize);</span>
<span class='curline'><a href='../S/1416.html#L270'>ms</a>                270 main/streams/memory.c 						ms-&gt;fsize = newsize;</span>
<span class='curline'><a href='../S/1416.html#L272'>ms</a>                272 main/streams/memory.c 					ms-&gt;fsize = newsize;</span>
<span class='curline'><a href='../S/1416.html#L316'>ms</a>                316 main/streams/memory.c 	php_stream_memory_data *ms;</span>
<span class='curline'><a href='../S/1416.html#L319'>ms</a>                319 main/streams/memory.c 		ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1416.html#L323'>ms</a>                323 main/streams/memory.c 			ms-&gt;data = buf;</span>
<span class='curline'><a href='../S/1416.html#L324'>ms</a>                324 main/streams/memory.c 			ms-&gt;fsize = length;</span>
<span class='curline'><a href='../S/1416.html#L340'>ms</a>                340 main/streams/memory.c 	php_stream_memory_data *ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1416.html#L342'>ms</a>                342 main/streams/memory.c 	assert(ms != NULL);</span>
<span class='curline'><a href='../S/1416.html#L345'>ms</a>                345 main/streams/memory.c 	*length = ms-&gt;fsize;</span>
<span class='curline'><a href='../S/1416.html#L346'>ms</a>                346 main/streams/memory.c 	return ms-&gt;data;</span>
<span class='curline'><a href='../S/1483.html#L376'>ms</a>                376 sapi/fpm/fpm/fpm_events.c 		struct timeval ms;</span>
<span class='curline'><a href='../S/1483.html#L388'>ms</a>                388 sapi/fpm/fpm/fpm_events.c 		timerclear(&amp;ms);</span>
<span class='curline'><a href='../S/1483.html#L393'>ms</a>                393 sapi/fpm/fpm/fpm_events.c 			if (!timerisset(&amp;ms)) {</span>
<span class='curline'><a href='../S/1483.html#L394'>ms</a>                394 sapi/fpm/fpm/fpm_events.c 				ms = q-&gt;ev-&gt;timeout;</span>
<span class='curline'><a href='../S/1483.html#L396'>ms</a>                396 sapi/fpm/fpm/fpm_events.c 				if (timercmp(&amp;q-&gt;ev-&gt;timeout, &amp;ms, &lt;)) {</span>
<span class='curline'><a href='../S/1483.html#L397'>ms</a>                397 sapi/fpm/fpm/fpm_events.c 					ms = q-&gt;ev-&gt;timeout;</span>
<span class='curline'><a href='../S/1483.html#L404'>ms</a>                404 sapi/fpm/fpm/fpm_events.c 		if (!timerisset(&amp;ms) || timercmp(&amp;ms, &amp;now, &lt;) || timercmp(&amp;ms, &amp;now, ==)) {</span>
<span class='curline'><a href='../S/1483.html#L407'>ms</a>                407 sapi/fpm/fpm/fpm_events.c 			timersub(&amp;ms, &amp;now, &amp;tmp);</span>
</pre>
</body>
</html>
