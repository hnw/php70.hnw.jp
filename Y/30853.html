<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>pSorter</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/1054.html#L14586'>pSorter</a>          14586 ext/sqlite3/libsqlite/sqlite3.c   VdbeSorter *pSorter;  /* Sorter object for OP_SorterOpen cursors */</span>
<span class='curline'><a href='../S/1054.html#L70911'>pSorter</a>          70911 ext/sqlite3/libsqlite/sqlite3.c #define isSorter(x) ((x)-&gt;pSorter!=0)</span>
<span class='curline'><a href='../S/1054.html#L74311'>pSorter</a>          74311 ext/sqlite3/libsqlite/sqlite3.c   assert( pC-&gt;pSorter );</span>
<span class='curline'><a href='../S/1054.html#L75889'>pSorter</a>          75889 ext/sqlite3/libsqlite/sqlite3.c   if( pC-&gt;pSorter ){</span>
<span class='curline'><a href='../S/1054.html#L75890'>pSorter</a>          75890 ext/sqlite3/libsqlite/sqlite3.c     sqlite3VdbeSorterReset(db, pC-&gt;pSorter);</span>
<span class='curline'><a href='../S/1054.html#L78196'>pSorter</a>          78196 ext/sqlite3/libsqlite/sqlite3.c   VdbeSorter *pSorter;            /* Sorter that owns this sub-task */</span>
<span class='curline'><a href='../S/1054.html#L78513'>pSorter</a>          78513 ext/sqlite3/libsqlite/sqlite3.c   if( pFile-&gt;iEof&lt;=(i64)(pTask-&gt;pSorter-&gt;db-&gt;nMaxSorterMmap) ){</span>
<span class='curline'><a href='../S/1054.html#L78549'>pSorter</a>          78549 ext/sqlite3/libsqlite/sqlite3.c     int pgsz = pTask-&gt;pSorter-&gt;pgsz;</span>
<span class='curline'><a href='../S/1054.html#L78663'>pSorter</a>          78663 ext/sqlite3/libsqlite/sqlite3.c     sqlite3VdbeRecordUnpack(pTask-&gt;pSorter-&gt;pKeyInfo, nKey2, pKey2, r2);</span>
<span class='curline'><a href='../S/1054.html#L78690'>pSorter</a>          78690 ext/sqlite3/libsqlite/sqlite3.c     sqlite3VdbeRecordUnpack(pTask-&gt;pSorter-&gt;pKeyInfo, nKey2, pKey2, r2);</span>
<span class='curline'><a href='../S/1054.html#L78724'>pSorter</a>          78724 ext/sqlite3/libsqlite/sqlite3.c     if( pTask-&gt;pSorter-&gt;pKeyInfo-&gt;nField&gt;1 ){</span>
<span class='curline'><a href='../S/1054.html#L78730'>pSorter</a>          78730 ext/sqlite3/libsqlite/sqlite3.c     if( pTask-&gt;pSorter-&gt;pKeyInfo-&gt;aSortOrder[0] ){</span>
<span class='curline'><a href='../S/1054.html#L78794'>pSorter</a>          78794 ext/sqlite3/libsqlite/sqlite3.c     if( pTask-&gt;pSorter-&gt;pKeyInfo-&gt;nField&gt;1 ){</span>
<span class='curline'><a href='../S/1054.html#L78799'>pSorter</a>          78799 ext/sqlite3/libsqlite/sqlite3.c   }else if( pTask-&gt;pSorter-&gt;pKeyInfo-&gt;aSortOrder[0] ){</span>
<span class='curline'><a href='../S/1054.html#L78833'>pSorter</a>          78833 ext/sqlite3/libsqlite/sqlite3.c   VdbeSorter *pSorter;            /* The new sorter */</span>
<span class='curline'><a href='../S/1054.html#L78865'>pSorter</a>          78865 ext/sqlite3/libsqlite/sqlite3.c   pSorter = (VdbeSorter*)sqlite3DbMallocZero(db, sz + szKeyInfo);</span>
<span class='curline'><a href='../S/1054.html#L78866'>pSorter</a>          78866 ext/sqlite3/libsqlite/sqlite3.c   pCsr-&gt;pSorter = pSorter;</span>
<span class='curline'><a href='../S/1054.html#L78867'>pSorter</a>          78867 ext/sqlite3/libsqlite/sqlite3.c   if( pSorter==0 ){</span>
<span class='curline'><a href='../S/1054.html#L78870'>pSorter</a>          78870 ext/sqlite3/libsqlite/sqlite3.c     pSorter-&gt;pKeyInfo = pKeyInfo = (KeyInfo*)((u8*)pSorter + sz);</span>
<span class='curline'><a href='../S/1054.html#L78877'>pSorter</a>          78877 ext/sqlite3/libsqlite/sqlite3.c     pSorter-&gt;pgsz = pgsz = sqlite3BtreeGetPageSize(db-&gt;aDb[0].pBt);</span>
<span class='curline'><a href='../S/1054.html#L78878'>pSorter</a>          78878 ext/sqlite3/libsqlite/sqlite3.c     pSorter-&gt;nTask = nWorker + 1;</span>
<span class='curline'><a href='../S/1054.html#L78879'>pSorter</a>          78879 ext/sqlite3/libsqlite/sqlite3.c     pSorter-&gt;iPrev = nWorker-1;</span>
<span class='curline'><a href='../S/1054.html#L78880'>pSorter</a>          78880 ext/sqlite3/libsqlite/sqlite3.c     pSorter-&gt;bUseThreads = (pSorter-&gt;nTask&gt;1);</span>
<span class='curline'><a href='../S/1054.html#L78881'>pSorter</a>          78881 ext/sqlite3/libsqlite/sqlite3.c     pSorter-&gt;db = db;</span>
<span class='curline'><a href='../S/1054.html#L78882'>pSorter</a>          78882 ext/sqlite3/libsqlite/sqlite3.c     for(i=0; i&lt;pSorter-&gt;nTask; i++){</span>
<span class='curline'><a href='../S/1054.html#L78883'>pSorter</a>          78883 ext/sqlite3/libsqlite/sqlite3.c       SortSubtask *pTask = &amp;pSorter-&gt;aTask[i];</span>
<span class='curline'><a href='../S/1054.html#L78884'>pSorter</a>          78884 ext/sqlite3/libsqlite/sqlite3.c       pTask-&gt;pSorter = pSorter;</span>
<span class='curline'><a href='../S/1054.html#L78889'>pSorter</a>          78889 ext/sqlite3/libsqlite/sqlite3.c       pSorter-&gt;mnPmaSize = szPma * pgsz;</span>
<span class='curline'><a href='../S/1054.html#L78892'>pSorter</a>          78892 ext/sqlite3/libsqlite/sqlite3.c       pSorter-&gt;mxPmaSize = MIN((i64)mxCache*pgsz, SQLITE_MAX_PMASZ);</span>
<span class='curline'><a href='../S/1054.html#L78899'>pSorter</a>          78899 ext/sqlite3/libsqlite/sqlite3.c         assert( pSorter-&gt;iMemory==0 );</span>
<span class='curline'><a href='../S/1054.html#L78900'>pSorter</a>          78900 ext/sqlite3/libsqlite/sqlite3.c         pSorter-&gt;nMemory = pgsz;</span>
<span class='curline'><a href='../S/1054.html#L78901'>pSorter</a>          78901 ext/sqlite3/libsqlite/sqlite3.c         pSorter-&gt;list.aMemory = (u8*)sqlite3Malloc(pgsz);</span>
<span class='curline'><a href='../S/1054.html#L78902'>pSorter</a>          78902 ext/sqlite3/libsqlite/sqlite3.c         if( !pSorter-&gt;list.aMemory ) rc = SQLITE_NOMEM;</span>
<span class='curline'><a href='../S/1054.html#L78909'>pSorter</a>          78909 ext/sqlite3/libsqlite/sqlite3.c       pSorter-&gt;typeMask = SORTER_TYPE_INTEGER | SORTER_TYPE_TEXT;</span>
<span class='curline'><a href='../S/1054.html#L78958'>pSorter</a>          78958 ext/sqlite3/libsqlite/sqlite3.c   int iTask = (pTask - pTask-&gt;pSorter-&gt;aTask);</span>
<span class='curline'><a href='../S/1054.html#L78959'>pSorter</a>          78959 ext/sqlite3/libsqlite/sqlite3.c   sqlite3OsCurrentTimeInt64(pTask-&gt;pSorter-&gt;db-&gt;pVfs, &amp;t);</span>
<span class='curline'><a href='../S/1054.html#L78972'>pSorter</a>          78972 ext/sqlite3/libsqlite/sqlite3.c   int iTask = (pTask - pTask-&gt;pSorter-&gt;aTask);</span>
<span class='curline'><a href='../S/1054.html#L78973'>pSorter</a>          78973 ext/sqlite3/libsqlite/sqlite3.c   sqlite3OsCurrentTimeInt64(pTask-&gt;pSorter-&gt;db-&gt;pVfs, &amp;t);</span>
<span class='curline'><a href='../S/1054.html#L78983'>pSorter</a>          78983 ext/sqlite3/libsqlite/sqlite3.c     sqlite3OsCurrentTimeInt64(pTask-&gt;pSorter-&gt;db-&gt;pVfs, &amp;t);</span>
<span class='curline'><a href='../S/1054.html#L79032'>pSorter</a>          79032 ext/sqlite3/libsqlite/sqlite3.c static int vdbeSorterJoinAll(VdbeSorter *pSorter, int rcin){</span>
<span class='curline'><a href='../S/1054.html#L79043'>pSorter</a>          79043 ext/sqlite3/libsqlite/sqlite3.c   for(i=pSorter-&gt;nTask-1; i&gt;=0; i--){</span>
<span class='curline'><a href='../S/1054.html#L79044'>pSorter</a>          79044 ext/sqlite3/libsqlite/sqlite3.c     SortSubtask *pTask = &amp;pSorter-&gt;aTask[i];</span>
<span class='curline'><a href='../S/1054.html#L79116'>pSorter</a>          79116 ext/sqlite3/libsqlite/sqlite3.c SQLITE_PRIVATE void sqlite3VdbeSorterReset(sqlite3 *db, VdbeSorter *pSorter){</span>
<span class='curline'><a href='../S/1054.html#L79118'>pSorter</a>          79118 ext/sqlite3/libsqlite/sqlite3.c   (void)vdbeSorterJoinAll(pSorter, SQLITE_OK);</span>
<span class='curline'><a href='../S/1054.html#L79119'>pSorter</a>          79119 ext/sqlite3/libsqlite/sqlite3.c   assert( pSorter-&gt;bUseThreads || pSorter-&gt;pReader==0 );</span>
<span class='curline'><a href='../S/1054.html#L79121'>pSorter</a>          79121 ext/sqlite3/libsqlite/sqlite3.c   if( pSorter-&gt;pReader ){</span>
<span class='curline'><a href='../S/1054.html#L79122'>pSorter</a>          79122 ext/sqlite3/libsqlite/sqlite3.c     vdbePmaReaderClear(pSorter-&gt;pReader);</span>
<span class='curline'><a href='../S/1054.html#L79123'>pSorter</a>          79123 ext/sqlite3/libsqlite/sqlite3.c     sqlite3DbFree(db, pSorter-&gt;pReader);</span>
<span class='curline'><a href='../S/1054.html#L79124'>pSorter</a>          79124 ext/sqlite3/libsqlite/sqlite3.c     pSorter-&gt;pReader = 0;</span>
<span class='curline'><a href='../S/1054.html#L79127'>pSorter</a>          79127 ext/sqlite3/libsqlite/sqlite3.c   vdbeMergeEngineFree(pSorter-&gt;pMerger);</span>
<span class='curline'><a href='../S/1054.html#L79128'>pSorter</a>          79128 ext/sqlite3/libsqlite/sqlite3.c   pSorter-&gt;pMerger = 0;</span>
<span class='curline'><a href='../S/1054.html#L79129'>pSorter</a>          79129 ext/sqlite3/libsqlite/sqlite3.c   for(i=0; i&lt;pSorter-&gt;nTask; i++){</span>
<span class='curline'><a href='../S/1054.html#L79130'>pSorter</a>          79130 ext/sqlite3/libsqlite/sqlite3.c     SortSubtask *pTask = &amp;pSorter-&gt;aTask[i];</span>
<span class='curline'><a href='../S/1054.html#L79132'>pSorter</a>          79132 ext/sqlite3/libsqlite/sqlite3.c     pTask-&gt;pSorter = pSorter;</span>
<span class='curline'><a href='../S/1054.html#L79134'>pSorter</a>          79134 ext/sqlite3/libsqlite/sqlite3.c   if( pSorter-&gt;list.aMemory==0 ){</span>
<span class='curline'><a href='../S/1054.html#L79135'>pSorter</a>          79135 ext/sqlite3/libsqlite/sqlite3.c     vdbeSorterRecordFree(0, pSorter-&gt;list.pList);</span>
<span class='curline'><a href='../S/1054.html#L79137'>pSorter</a>          79137 ext/sqlite3/libsqlite/sqlite3.c   pSorter-&gt;list.pList = 0;</span>
<span class='curline'><a href='../S/1054.html#L79138'>pSorter</a>          79138 ext/sqlite3/libsqlite/sqlite3.c   pSorter-&gt;list.szPMA = 0;</span>
<span class='curline'><a href='../S/1054.html#L79139'>pSorter</a>          79139 ext/sqlite3/libsqlite/sqlite3.c   pSorter-&gt;bUsePMA = 0;</span>
<span class='curline'><a href='../S/1054.html#L79140'>pSorter</a>          79140 ext/sqlite3/libsqlite/sqlite3.c   pSorter-&gt;iMemory = 0;</span>
<span class='curline'><a href='../S/1054.html#L79141'>pSorter</a>          79141 ext/sqlite3/libsqlite/sqlite3.c   pSorter-&gt;mxKeysize = 0;</span>
<span class='curline'><a href='../S/1054.html#L79142'>pSorter</a>          79142 ext/sqlite3/libsqlite/sqlite3.c   sqlite3DbFree(db, pSorter-&gt;pUnpacked);</span>
<span class='curline'><a href='../S/1054.html#L79143'>pSorter</a>          79143 ext/sqlite3/libsqlite/sqlite3.c   pSorter-&gt;pUnpacked = 0;</span>
<span class='curline'><a href='../S/1054.html#L79150'>pSorter</a>          79150 ext/sqlite3/libsqlite/sqlite3.c   VdbeSorter *pSorter = pCsr-&gt;pSorter;</span>
<span class='curline'><a href='../S/1054.html#L79151'>pSorter</a>          79151 ext/sqlite3/libsqlite/sqlite3.c   if( pSorter ){</span>
<span class='curline'><a href='../S/1054.html#L79152'>pSorter</a>          79152 ext/sqlite3/libsqlite/sqlite3.c     sqlite3VdbeSorterReset(db, pSorter);</span>
<span class='curline'><a href='../S/1054.html#L79153'>pSorter</a>          79153 ext/sqlite3/libsqlite/sqlite3.c     sqlite3_free(pSorter-&gt;list.aMemory);</span>
<span class='curline'><a href='../S/1054.html#L79154'>pSorter</a>          79154 ext/sqlite3/libsqlite/sqlite3.c     sqlite3DbFree(db, pSorter);</span>
<span class='curline'><a href='../S/1054.html#L79155'>pSorter</a>          79155 ext/sqlite3/libsqlite/sqlite3.c     pCsr-&gt;pSorter = 0;</span>
<span class='curline'><a href='../S/1054.html#L79219'>pSorter</a>          79219 ext/sqlite3/libsqlite/sqlite3.c         pTask-&gt;pSorter-&gt;pKeyInfo, 0, 0, &amp;pFree</span>
<span class='curline'><a href='../S/1054.html#L79223'>pSorter</a>          79223 ext/sqlite3/libsqlite/sqlite3.c     pTask-&gt;pUnpacked-&gt;nField = pTask-&gt;pSorter-&gt;pKeyInfo-&gt;nField;</span>
<span class='curline'><a href='../S/1054.html#L79293'>pSorter</a>          79293 ext/sqlite3/libsqlite/sqlite3.c   pTask-&gt;xCompare = vdbeSorterGetCompare(pTask-&gt;pSorter);</span>
<span class='curline'><a href='../S/1054.html#L79434'>pSorter</a>          79434 ext/sqlite3/libsqlite/sqlite3.c   sqlite3 *db = pTask-&gt;pSorter-&gt;db;</span>
<span class='curline'><a href='../S/1054.html#L79470'>pSorter</a>          79470 ext/sqlite3/libsqlite/sqlite3.c     vdbePmaWriterInit(pTask-&gt;file.pFd, &amp;writer, pTask-&gt;pSorter-&gt;pgsz,</span>
<span class='curline'><a href='../S/1054.html#L79582'>pSorter</a>          79582 ext/sqlite3/libsqlite/sqlite3.c static int vdbeSorterFlushPMA(VdbeSorter *pSorter){</span>
<span class='curline'><a href='../S/1054.html#L79584'>pSorter</a>          79584 ext/sqlite3/libsqlite/sqlite3.c   pSorter-&gt;bUsePMA = 1;</span>
<span class='curline'><a href='../S/1054.html#L79585'>pSorter</a>          79585 ext/sqlite3/libsqlite/sqlite3.c   return vdbeSorterListToPMA(&amp;pSorter-&gt;aTask[0], &amp;pSorter-&gt;list);</span>
<span class='curline'><a href='../S/1054.html#L79590'>pSorter</a>          79590 ext/sqlite3/libsqlite/sqlite3.c   int nWorker = (pSorter-&gt;nTask-1);</span>
<span class='curline'><a href='../S/1054.html#L79594'>pSorter</a>          79594 ext/sqlite3/libsqlite/sqlite3.c   pSorter-&gt;bUsePMA = 1;</span>
<span class='curline'><a href='../S/1054.html#L79605'>pSorter</a>          79605 ext/sqlite3/libsqlite/sqlite3.c     int iTest = (pSorter-&gt;iPrev + i + 1) % nWorker;</span>
<span class='curline'><a href='../S/1054.html#L79606'>pSorter</a>          79606 ext/sqlite3/libsqlite/sqlite3.c     pTask = &amp;pSorter-&gt;aTask[iTest];</span>
<span class='curline'><a href='../S/1054.html#L79616'>pSorter</a>          79616 ext/sqlite3/libsqlite/sqlite3.c       rc = vdbeSorterListToPMA(&amp;pSorter-&gt;aTask[nWorker], &amp;pSorter-&gt;list);</span>
<span class='curline'><a href='../S/1054.html#L79624'>pSorter</a>          79624 ext/sqlite3/libsqlite/sqlite3.c       assert( pTask-&gt;list.aMemory==0 || pSorter-&gt;list.aMemory!=0 );</span>
<span class='curline'><a href='../S/1054.html#L79626'>pSorter</a>          79626 ext/sqlite3/libsqlite/sqlite3.c       pSorter-&gt;iPrev = (u8)(pTask - pSorter-&gt;aTask);</span>
<span class='curline'><a href='../S/1054.html#L79627'>pSorter</a>          79627 ext/sqlite3/libsqlite/sqlite3.c       pTask-&gt;list = pSorter-&gt;list;</span>
<span class='curline'><a href='../S/1054.html#L79628'>pSorter</a>          79628 ext/sqlite3/libsqlite/sqlite3.c       pSorter-&gt;list.pList = 0;</span>
<span class='curline'><a href='../S/1054.html#L79629'>pSorter</a>          79629 ext/sqlite3/libsqlite/sqlite3.c       pSorter-&gt;list.szPMA = 0;</span>
<span class='curline'><a href='../S/1054.html#L79631'>pSorter</a>          79631 ext/sqlite3/libsqlite/sqlite3.c         pSorter-&gt;list.aMemory = aMem;</span>
<span class='curline'><a href='../S/1054.html#L79632'>pSorter</a>          79632 ext/sqlite3/libsqlite/sqlite3.c         pSorter-&gt;nMemory = sqlite3MallocSize(aMem);</span>
<span class='curline'><a href='../S/1054.html#L79633'>pSorter</a>          79633 ext/sqlite3/libsqlite/sqlite3.c       }else if( pSorter-&gt;list.aMemory ){</span>
<span class='curline'><a href='../S/1054.html#L79634'>pSorter</a>          79634 ext/sqlite3/libsqlite/sqlite3.c         pSorter-&gt;list.aMemory = sqlite3Malloc(pSorter-&gt;nMemory);</span>
<span class='curline'><a href='../S/1054.html#L79635'>pSorter</a>          79635 ext/sqlite3/libsqlite/sqlite3.c         if( !pSorter-&gt;list.aMemory ) return SQLITE_NOMEM;</span>
<span class='curline'><a href='../S/1054.html#L79653'>pSorter</a>          79653 ext/sqlite3/libsqlite/sqlite3.c   VdbeSorter *pSorter = pCsr-&gt;pSorter;</span>
<span class='curline'><a href='../S/1054.html#L79664'>pSorter</a>          79664 ext/sqlite3/libsqlite/sqlite3.c     pSorter-&gt;typeMask &amp;= SORTER_TYPE_INTEGER;</span>
<span class='curline'><a href='../S/1054.html#L79666'>pSorter</a>          79666 ext/sqlite3/libsqlite/sqlite3.c     pSorter-&gt;typeMask &amp;= SORTER_TYPE_TEXT;</span>
<span class='curline'><a href='../S/1054.html#L79668'>pSorter</a>          79668 ext/sqlite3/libsqlite/sqlite3.c     pSorter-&gt;typeMask = 0;</span>
<span class='curline'><a href='../S/1054.html#L79671'>pSorter</a>          79671 ext/sqlite3/libsqlite/sqlite3.c   assert( pSorter );</span>
<span class='curline'><a href='../S/1054.html#L79691'>pSorter</a>          79691 ext/sqlite3/libsqlite/sqlite3.c   if( pSorter-&gt;mxPmaSize ){</span>
<span class='curline'><a href='../S/1054.html#L79692'>pSorter</a>          79692 ext/sqlite3/libsqlite/sqlite3.c     if( pSorter-&gt;list.aMemory ){</span>
<span class='curline'><a href='../S/1054.html#L79693'>pSorter</a>          79693 ext/sqlite3/libsqlite/sqlite3.c       bFlush = pSorter-&gt;iMemory &amp;&amp; (pSorter-&gt;iMemory+nReq) &gt; pSorter-&gt;mxPmaSize;</span>
<span class='curline'><a href='../S/1054.html#L79696'>pSorter</a>          79696 ext/sqlite3/libsqlite/sqlite3.c           (pSorter-&gt;list.szPMA &gt; pSorter-&gt;mxPmaSize)</span>
<span class='curline'><a href='../S/1054.html#L79697'>pSorter</a>          79697 ext/sqlite3/libsqlite/sqlite3.c        || (pSorter-&gt;list.szPMA &gt; pSorter-&gt;mnPmaSize &amp;&amp; sqlite3HeapNearlyFull())</span>
<span class='curline'><a href='../S/1054.html#L79701'>pSorter</a>          79701 ext/sqlite3/libsqlite/sqlite3.c       rc = vdbeSorterFlushPMA(pSorter);</span>
<span class='curline'><a href='../S/1054.html#L79702'>pSorter</a>          79702 ext/sqlite3/libsqlite/sqlite3.c       pSorter-&gt;list.szPMA = 0;</span>
<span class='curline'><a href='../S/1054.html#L79703'>pSorter</a>          79703 ext/sqlite3/libsqlite/sqlite3.c       pSorter-&gt;iMemory = 0;</span>
<span class='curline'><a href='../S/1054.html#L79704'>pSorter</a>          79704 ext/sqlite3/libsqlite/sqlite3.c       assert( rc!=SQLITE_OK || pSorter-&gt;list.pList==0 );</span>
<span class='curline'><a href='../S/1054.html#L79708'>pSorter</a>          79708 ext/sqlite3/libsqlite/sqlite3.c   pSorter-&gt;list.szPMA += nPMA;</span>
<span class='curline'><a href='../S/1054.html#L79709'>pSorter</a>          79709 ext/sqlite3/libsqlite/sqlite3.c   if( nPMA&gt;pSorter-&gt;mxKeysize ){</span>
<span class='curline'><a href='../S/1054.html#L79710'>pSorter</a>          79710 ext/sqlite3/libsqlite/sqlite3.c     pSorter-&gt;mxKeysize = nPMA;</span>
<span class='curline'><a href='../S/1054.html#L79713'>pSorter</a>          79713 ext/sqlite3/libsqlite/sqlite3.c   if( pSorter-&gt;list.aMemory ){</span>
<span class='curline'><a href='../S/1054.html#L79714'>pSorter</a>          79714 ext/sqlite3/libsqlite/sqlite3.c     int nMin = pSorter-&gt;iMemory + nReq;</span>
<span class='curline'><a href='../S/1054.html#L79716'>pSorter</a>          79716 ext/sqlite3/libsqlite/sqlite3.c     if( nMin&gt;pSorter-&gt;nMemory ){</span>
<span class='curline'><a href='../S/1054.html#L79718'>pSorter</a>          79718 ext/sqlite3/libsqlite/sqlite3.c       int nNew = pSorter-&gt;nMemory * 2;</span>
<span class='curline'><a href='../S/1054.html#L79720'>pSorter</a>          79720 ext/sqlite3/libsqlite/sqlite3.c       if( nNew &gt; pSorter-&gt;mxPmaSize ) nNew = pSorter-&gt;mxPmaSize;</span>
<span class='curline'><a href='../S/1054.html#L79723'>pSorter</a>          79723 ext/sqlite3/libsqlite/sqlite3.c       aNew = sqlite3Realloc(pSorter-&gt;list.aMemory, nNew);</span>
<span class='curline'><a href='../S/1054.html#L79725'>pSorter</a>          79725 ext/sqlite3/libsqlite/sqlite3.c       pSorter-&gt;list.pList = (SorterRecord*)(</span>
<span class='curline'><a href='../S/1054.html#L79726'>pSorter</a>          79726 ext/sqlite3/libsqlite/sqlite3.c           aNew + ((u8*)pSorter-&gt;list.pList - pSorter-&gt;list.aMemory)</span>
<span class='curline'><a href='../S/1054.html#L79728'>pSorter</a>          79728 ext/sqlite3/libsqlite/sqlite3.c       pSorter-&gt;list.aMemory = aNew;</span>
<span class='curline'><a href='../S/1054.html#L79729'>pSorter</a>          79729 ext/sqlite3/libsqlite/sqlite3.c       pSorter-&gt;nMemory = nNew;</span>
<span class='curline'><a href='../S/1054.html#L79732'>pSorter</a>          79732 ext/sqlite3/libsqlite/sqlite3.c     pNew = (SorterRecord*)&amp;pSorter-&gt;list.aMemory[pSorter-&gt;iMemory];</span>
<span class='curline'><a href='../S/1054.html#L79733'>pSorter</a>          79733 ext/sqlite3/libsqlite/sqlite3.c     pSorter-&gt;iMemory += ROUND8(nReq);</span>
<span class='curline'><a href='../S/1054.html#L79734'>pSorter</a>          79734 ext/sqlite3/libsqlite/sqlite3.c     pNew-&gt;u.iNext = (int)((u8*)(pSorter-&gt;list.pList) - pSorter-&gt;list.aMemory);</span>
<span class='curline'><a href='../S/1054.html#L79740'>pSorter</a>          79740 ext/sqlite3/libsqlite/sqlite3.c     pNew-&gt;u.pNext = pSorter-&gt;list.pList;</span>
<span class='curline'><a href='../S/1054.html#L79745'>pSorter</a>          79745 ext/sqlite3/libsqlite/sqlite3.c   pSorter-&gt;list.pList = pNew;</span>
<span class='curline'><a href='../S/1054.html#L79767'>pSorter</a>          79767 ext/sqlite3/libsqlite/sqlite3.c   vdbePmaWriterInit(pOut-&gt;pFd, &amp;writer, pTask-&gt;pSorter-&gt;pgsz, iStart);</span>
<span class='curline'><a href='../S/1054.html#L79881'>pSorter</a>          79881 ext/sqlite3/libsqlite/sqlite3.c     pIncr-&gt;mxSz = MAX(pTask-&gt;pSorter-&gt;mxKeysize+9,pTask-&gt;pSorter-&gt;mxPmaSize/2);</span>
<span class='curline'><a href='../S/1054.html#L80064'>pSorter</a>          80064 ext/sqlite3/libsqlite/sqlite3.c   sqlite3 *db = pTask-&gt;pSorter-&gt;db;</span>
<span class='curline'><a href='../S/1054.html#L80292'>pSorter</a>          80292 ext/sqlite3/libsqlite/sqlite3.c   VdbeSorter *pSorter,       /* The VDBE cursor that implements the sort */</span>
<span class='curline'><a href='../S/1054.html#L80303'>pSorter</a>          80303 ext/sqlite3/libsqlite/sqlite3.c   assert( pSorter-&gt;bUseThreads || pSorter-&gt;nTask==1 );</span>
<span class='curline'><a href='../S/1054.html#L80304'>pSorter</a>          80304 ext/sqlite3/libsqlite/sqlite3.c   if( pSorter-&gt;nTask&gt;1 ){</span>
<span class='curline'><a href='../S/1054.html#L80305'>pSorter</a>          80305 ext/sqlite3/libsqlite/sqlite3.c     pMain = vdbeMergeEngineNew(pSorter-&gt;nTask);</span>
<span class='curline'><a href='../S/1054.html#L80310'>pSorter</a>          80310 ext/sqlite3/libsqlite/sqlite3.c   for(iTask=0; rc==SQLITE_OK &amp;&amp; iTask&lt;pSorter-&gt;nTask; iTask++){</span>
<span class='curline'><a href='../S/1054.html#L80311'>pSorter</a>          80311 ext/sqlite3/libsqlite/sqlite3.c     SortSubtask *pTask = &amp;pSorter-&gt;aTask[iTask];</span>
<span class='curline'><a href='../S/1054.html#L80370'>pSorter</a>          80370 ext/sqlite3/libsqlite/sqlite3.c static int vdbeSorterSetupMerge(VdbeSorter *pSorter){</span>
<span class='curline'><a href='../S/1054.html#L80372'>pSorter</a>          80372 ext/sqlite3/libsqlite/sqlite3.c   SortSubtask *pTask0 = &amp;pSorter-&gt;aTask[0];</span>
<span class='curline'><a href='../S/1054.html#L80375'>pSorter</a>          80375 ext/sqlite3/libsqlite/sqlite3.c   sqlite3 *db = pTask0-&gt;pSorter-&gt;db;</span>
<span class='curline'><a href='../S/1054.html#L80377'>pSorter</a>          80377 ext/sqlite3/libsqlite/sqlite3.c   SorterCompare xCompare = vdbeSorterGetCompare(pSorter);</span>
<span class='curline'><a href='../S/1054.html#L80378'>pSorter</a>          80378 ext/sqlite3/libsqlite/sqlite3.c   for(i=0; i&lt;pSorter-&gt;nTask; i++){</span>
<span class='curline'><a href='../S/1054.html#L80379'>pSorter</a>          80379 ext/sqlite3/libsqlite/sqlite3.c     pSorter-&gt;aTask[i].xCompare = xCompare;</span>
<span class='curline'><a href='../S/1054.html#L80383'>pSorter</a>          80383 ext/sqlite3/libsqlite/sqlite3.c   rc = vdbeSorterMergeTreeBuild(pSorter, &amp;pMain);</span>
<span class='curline'><a href='../S/1054.html#L80386'>pSorter</a>          80386 ext/sqlite3/libsqlite/sqlite3.c     assert( pSorter-&gt;bUseThreads==0 || pSorter-&gt;nTask&gt;1 );</span>
<span class='curline'><a href='../S/1054.html#L80387'>pSorter</a>          80387 ext/sqlite3/libsqlite/sqlite3.c     if( pSorter-&gt;bUseThreads ){</span>
<span class='curline'><a href='../S/1054.html#L80390'>pSorter</a>          80390 ext/sqlite3/libsqlite/sqlite3.c       SortSubtask *pLast = &amp;pSorter-&gt;aTask[pSorter-&gt;nTask-1];</span>
<span class='curline'><a href='../S/1054.html#L80394'>pSorter</a>          80394 ext/sqlite3/libsqlite/sqlite3.c         pSorter-&gt;pReader = pReadr;</span>
<span class='curline'><a href='../S/1054.html#L80401'>pSorter</a>          80401 ext/sqlite3/libsqlite/sqlite3.c           for(iTask=0; iTask&lt;(pSorter-&gt;nTask-1); iTask++){</span>
<span class='curline'><a href='../S/1054.html#L80408'>pSorter</a>          80408 ext/sqlite3/libsqlite/sqlite3.c           for(iTask=0; rc==SQLITE_OK &amp;&amp; iTask&lt;pSorter-&gt;nTask; iTask++){</span>
<span class='curline'><a href='../S/1054.html#L80420'>pSorter</a>          80420 ext/sqlite3/libsqlite/sqlite3.c                 (p-&gt;pIncr-&gt;pTask==&amp;pSorter-&gt;aTask[iTask])             /* a */</span>
<span class='curline'><a href='../S/1054.html#L80421'>pSorter</a>          80421 ext/sqlite3/libsqlite/sqlite3.c              &amp;&amp; (iTask!=pSorter-&gt;nTask-1 || p-&gt;pIncr-&gt;bUseThread==0)  /* b */</span>
<span class='curline'><a href='../S/1054.html#L80435'>pSorter</a>          80435 ext/sqlite3/libsqlite/sqlite3.c       pSorter-&gt;pMerger = pMain;</span>
<span class='curline'><a href='../S/1054.html#L80453'>pSorter</a>          80453 ext/sqlite3/libsqlite/sqlite3.c   VdbeSorter *pSorter = pCsr-&gt;pSorter;</span>
<span class='curline'><a href='../S/1054.html#L80456'>pSorter</a>          80456 ext/sqlite3/libsqlite/sqlite3.c   assert( pSorter );</span>
<span class='curline'><a href='../S/1054.html#L80461'>pSorter</a>          80461 ext/sqlite3/libsqlite/sqlite3.c   if( pSorter-&gt;bUsePMA==0 ){</span>
<span class='curline'><a href='../S/1054.html#L80462'>pSorter</a>          80462 ext/sqlite3/libsqlite/sqlite3.c     if( pSorter-&gt;list.pList ){</span>
<span class='curline'><a href='../S/1054.html#L80464'>pSorter</a>          80464 ext/sqlite3/libsqlite/sqlite3.c       rc = vdbeSorterSort(&amp;pSorter-&gt;aTask[0], &amp;pSorter-&gt;list);</span>
<span class='curline'><a href='../S/1054.html#L80475'>pSorter</a>          80475 ext/sqlite3/libsqlite/sqlite3.c   assert( pSorter-&gt;list.pList );</span>
<span class='curline'><a href='../S/1054.html#L80476'>pSorter</a>          80476 ext/sqlite3/libsqlite/sqlite3.c   rc = vdbeSorterFlushPMA(pSorter);</span>
<span class='curline'><a href='../S/1054.html#L80479'>pSorter</a>          80479 ext/sqlite3/libsqlite/sqlite3.c   rc = vdbeSorterJoinAll(pSorter, rc);</span>
<span class='curline'><a href='../S/1054.html#L80485'>pSorter</a>          80485 ext/sqlite3/libsqlite/sqlite3.c   assert( pSorter-&gt;pReader==0 );</span>
<span class='curline'><a href='../S/1054.html#L80487'>pSorter</a>          80487 ext/sqlite3/libsqlite/sqlite3.c     rc = vdbeSorterSetupMerge(pSorter);</span>
<span class='curline'><a href='../S/1054.html#L80499'>pSorter</a>          80499 ext/sqlite3/libsqlite/sqlite3.c   VdbeSorter *pSorter = pCsr-&gt;pSorter;</span>
<span class='curline'><a href='../S/1054.html#L80502'>pSorter</a>          80502 ext/sqlite3/libsqlite/sqlite3.c   assert( pSorter-&gt;bUsePMA || (pSorter-&gt;pReader==0 &amp;&amp; pSorter-&gt;pMerger==0) );</span>
<span class='curline'><a href='../S/1054.html#L80503'>pSorter</a>          80503 ext/sqlite3/libsqlite/sqlite3.c   if( pSorter-&gt;bUsePMA ){</span>
<span class='curline'><a href='../S/1054.html#L80504'>pSorter</a>          80504 ext/sqlite3/libsqlite/sqlite3.c     assert( pSorter-&gt;pReader==0 || pSorter-&gt;pMerger==0 );</span>
<span class='curline'><a href='../S/1054.html#L80505'>pSorter</a>          80505 ext/sqlite3/libsqlite/sqlite3.c     assert( pSorter-&gt;bUseThreads==0 || pSorter-&gt;pReader );</span>
<span class='curline'><a href='../S/1054.html#L80506'>pSorter</a>          80506 ext/sqlite3/libsqlite/sqlite3.c     assert( pSorter-&gt;bUseThreads==1 || pSorter-&gt;pMerger );</span>
<span class='curline'><a href='../S/1054.html#L80508'>pSorter</a>          80508 ext/sqlite3/libsqlite/sqlite3.c     if( pSorter-&gt;bUseThreads ){</span>
<span class='curline'><a href='../S/1054.html#L80509'>pSorter</a>          80509 ext/sqlite3/libsqlite/sqlite3.c       rc = vdbePmaReaderNext(pSorter-&gt;pReader);</span>
<span class='curline'><a href='../S/1054.html#L80510'>pSorter</a>          80510 ext/sqlite3/libsqlite/sqlite3.c       *pbEof = (pSorter-&gt;pReader-&gt;pFd==0);</span>
<span class='curline'><a href='../S/1054.html#L80514'>pSorter</a>          80514 ext/sqlite3/libsqlite/sqlite3.c       assert( pSorter-&gt;pMerger!=0 );</span>
<span class='curline'><a href='../S/1054.html#L80515'>pSorter</a>          80515 ext/sqlite3/libsqlite/sqlite3.c       assert( pSorter-&gt;pMerger-&gt;pTask==(&amp;pSorter-&gt;aTask[0]) );</span>
<span class='curline'><a href='../S/1054.html#L80516'>pSorter</a>          80516 ext/sqlite3/libsqlite/sqlite3.c       rc = vdbeMergeEngineStep(pSorter-&gt;pMerger, pbEof);</span>
<span class='curline'><a href='../S/1054.html#L80519'>pSorter</a>          80519 ext/sqlite3/libsqlite/sqlite3.c     SorterRecord *pFree = pSorter-&gt;list.pList;</span>
<span class='curline'><a href='../S/1054.html#L80520'>pSorter</a>          80520 ext/sqlite3/libsqlite/sqlite3.c     pSorter-&gt;list.pList = pFree-&gt;u.pNext;</span>
<span class='curline'><a href='../S/1054.html#L80522'>pSorter</a>          80522 ext/sqlite3/libsqlite/sqlite3.c     if( pSorter-&gt;list.aMemory==0 ) vdbeSorterRecordFree(db, pFree);</span>
<span class='curline'><a href='../S/1054.html#L80523'>pSorter</a>          80523 ext/sqlite3/libsqlite/sqlite3.c     *pbEof = !pSorter-&gt;list.pList;</span>
<span class='curline'><a href='../S/1054.html#L80534'>pSorter</a>          80534 ext/sqlite3/libsqlite/sqlite3.c   const VdbeSorter *pSorter,      /* Sorter object */</span>
<span class='curline'><a href='../S/1054.html#L80538'>pSorter</a>          80538 ext/sqlite3/libsqlite/sqlite3.c   if( pSorter-&gt;bUsePMA ){</span>
<span class='curline'><a href='../S/1054.html#L80541'>pSorter</a>          80541 ext/sqlite3/libsqlite/sqlite3.c     if( pSorter-&gt;bUseThreads ){</span>
<span class='curline'><a href='../S/1054.html#L80542'>pSorter</a>          80542 ext/sqlite3/libsqlite/sqlite3.c       pReader = pSorter-&gt;pReader;</span>
<span class='curline'><a href='../S/1054.html#L80546'>pSorter</a>          80546 ext/sqlite3/libsqlite/sqlite3.c       pReader = &amp;pSorter-&gt;pMerger-&gt;aReadr[pSorter-&gt;pMerger-&gt;aTree[1]];</span>
<span class='curline'><a href='../S/1054.html#L80551'>pSorter</a>          80551 ext/sqlite3/libsqlite/sqlite3.c     *pnKey = pSorter-&gt;list.pList-&gt;nVal;</span>
<span class='curline'><a href='../S/1054.html#L80552'>pSorter</a>          80552 ext/sqlite3/libsqlite/sqlite3.c     pKey = SRVAL(pSorter-&gt;list.pList);</span>
<span class='curline'><a href='../S/1054.html#L80561'>pSorter</a>          80561 ext/sqlite3/libsqlite/sqlite3.c   VdbeSorter *pSorter = pCsr-&gt;pSorter;</span>
<span class='curline'><a href='../S/1054.html#L80564'>pSorter</a>          80564 ext/sqlite3/libsqlite/sqlite3.c   pKey = vdbeSorterRowkey(pSorter, &amp;nKey);</span>
<span class='curline'><a href='../S/1054.html#L80597'>pSorter</a>          80597 ext/sqlite3/libsqlite/sqlite3.c   VdbeSorter *pSorter = pCsr-&gt;pSorter;</span>
<span class='curline'><a href='../S/1054.html#L80598'>pSorter</a>          80598 ext/sqlite3/libsqlite/sqlite3.c   UnpackedRecord *r2 = pSorter-&gt;pUnpacked;</span>
<span class='curline'><a href='../S/1054.html#L80605'>pSorter</a>          80605 ext/sqlite3/libsqlite/sqlite3.c     r2 = pSorter-&gt;pUnpacked = sqlite3VdbeAllocUnpackedRecord(pKeyInfo,0,0,&amp;p);</span>
<span class='curline'><a href='../S/1054.html#L80606'>pSorter</a>          80606 ext/sqlite3/libsqlite/sqlite3.c     assert( pSorter-&gt;pUnpacked==(UnpackedRecord*)p );</span>
<span class='curline'><a href='../S/1054.html#L80612'>pSorter</a>          80612 ext/sqlite3/libsqlite/sqlite3.c   pKey = vdbeSorterRowkey(pSorter, &amp;nKey);</span>
</pre>
</body>
</html>
